<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.6.1"/>
    <title>maze_dataset.tokenization.maze_tokenizer API documentation</title>
<link rel="stylesheet" href="../../resources/bootstrap-reboot.min.css"><link rel="stylesheet" href="../../resources/syntax-highlighting.css"><link rel="stylesheet" href="../../resources/theme.css"><link rel="stylesheet" href="../../resources/layout.css"><link rel="stylesheet" href="../../resources/content.css"><link rel="stylesheet" href="../../resources/custom.css"><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
<div class="package-version">
    docs for <a href="https://github.com/understanding-search/maze-dataset">maze-dataset</a> v1.0.1<br>
</div>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button">
            <img src="../../resources/svg/navtoggle.svg" alt="Toggle navigation"> 
        </label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../tokenization.html">
                <img src="../../resources/svg/box-arrow-in-left.svg" alt="Back to parent module"/>
                &nbsp;maze_dataset.tokenization</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#TokenError">TokenError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TokenizationMode">TokenizationMode</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TokenizationMode.AOTP_UT_rasterized">AOTP_UT_rasterized</a>
                        </li>
                        <li>
                                <a class="variable" href="#TokenizationMode.AOTP_UT_uniform">AOTP_UT_uniform</a>
                        </li>
                        <li>
                                <a class="variable" href="#TokenizationMode.AOTP_CTT_indexed">AOTP_CTT_indexed</a>
                        </li>
                        <li>
                                <a class="function" href="#TokenizationMode.to_legacy_tokenizer">to_legacy_tokenizer</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#is_UT">is_UT</a>
            </li>
            <li>
                    <a class="function" href="#get_tokens_up_to_path_start">get_tokens_up_to_path_start</a>
            </li>
            <li>
                    <a class="class" href="#MazeTokenizer">MazeTokenizer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MazeTokenizer.__init__">MazeTokenizer</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.tokenization_mode">tokenization_mode</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.max_grid_size">max_grid_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.node_strings_map">node_strings_map</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.token_arr">token_arr</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.tokenizer_map">tokenizer_map</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.vocab_size">vocab_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.n_tokens">n_tokens</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.padding_token_index">padding_token_index</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.coords_to_strings">coords_to_strings</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.strings_to_coords">strings_to_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.encode">encode</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.decode">decode</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.coordinate_tokens_coords">coordinate_tokens_coords</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizer.coordinate_tokens_ids">coordinate_tokens_ids</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.summary">summary</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.is_AOTP">is_AOTP</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.is_UT">is_UT</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.clear_cache">clear_cache</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.serialize">serialize</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizer.validate_fields_types">validate_fields_types</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#mark_as_unsupported">mark_as_unsupported</a>
            </li>
            <li>
                    <a class="class" href="#CoordTokenizers">CoordTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#CoordTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#CoordTokenizers.UT">CoordTokenizers.UT</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.__init__">UT</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.UT.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#CoordTokenizers.CTT">CoordTokenizers.CTT</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.__init__">CTT</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#CoordTokenizers.CTT.pre">pre</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#CoordTokenizers.CTT.intra">intra</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#CoordTokenizers.CTT.post">post</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#CoordTokenizers.CTT.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EdgeGroupings">EdgeGroupings</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EdgeGroupings.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.__init__">Ungrouped</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.Ungrouped.connection_token_ordinal">connection_token_ordinal</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.Ungrouped.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgeGroupings.ByLeadingCoord">EdgeGroupings.ByLeadingCoord</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.__init__">ByLeadingCoord</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.ByLeadingCoord.intra">intra</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.ByLeadingCoord.shuffle_group">shuffle_group</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeGroupings.ByLeadingCoord.connection_token_ordinal">connection_token_ordinal</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeGroupings.ByLeadingCoord.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EdgePermuters">EdgePermuters</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EdgePermuters.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#EdgePermuters.SortedCoords">EdgePermuters.SortedCoords</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.__init__">SortedCoords</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.SortedCoords.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.__init__">RandomCoords</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.RandomCoords.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.__init__">BothCoords</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgePermuters.BothCoords.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EdgeSubsets">EdgeSubsets</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EdgeSubsets.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#EdgeSubsets.AllLatticeEdges">EdgeSubsets.AllLatticeEdges</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.__init__">AllLatticeEdges</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.AllLatticeEdges.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.__init__">ConnectionEdges</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#EdgeSubsets.ConnectionEdges.walls">walls</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#EdgeSubsets.ConnectionEdges.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AdjListTokenizers">AdjListTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AdjListTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.__init__">AdjListCoord</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#AdjListTokenizers.AdjListCoord.edge_permuter">edge_permuter</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCoord.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#AdjListTokenizers.AdjListCardinal">AdjListTokenizers.AdjListCardinal</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.__init__">AdjListCardinal</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#AdjListTokenizers.AdjListCardinal.edge_permuter">edge_permuter</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#AdjListTokenizers.AdjListCardinal.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TargetTokenizers">TargetTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TargetTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.__init__">Unlabeled</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#TargetTokenizers.Unlabeled.post">post</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#TargetTokenizers.Unlabeled.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StepSizes">StepSizes</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#StepSizes.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#StepSizes.Singles">StepSizes.Singles</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.__init__">Singles</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Singles.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepSizes.Straightaways">StepSizes.Straightaways</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.__init__">Straightaways</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Straightaways.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepSizes.Forks">StepSizes.Forks</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.__init__">Forks</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.Forks.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepSizes.ForksAndStraightaways">StepSizes.ForksAndStraightaways</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.__init__">ForksAndStraightaways</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepSizes.ForksAndStraightaways.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StepTokenizers">StepTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#StepTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Coord">StepTokenizers.Coord</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.__init__">Coord</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Coord.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Cardinal">StepTokenizers.Cardinal</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.__init__">Cardinal</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Cardinal.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Relative">StepTokenizers.Relative</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.__init__">Relative</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Relative.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#StepTokenizers.Distance">StepTokenizers.Distance</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.__init__">Distance</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#StepTokenizers.Distance.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#StepTokenizers.StepTokenizerPermutation">StepTokenizerPermutation</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PathTokenizers">PathTokenizers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PathTokenizers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.__init__">StepSequence</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.step_size">step_size</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.step_tokenizers">step_tokenizers</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.pre">pre</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.intra">intra</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PathTokenizers.StepSequence.post">post</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.to_tokens">to_tokens</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.is_valid">is_valid</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PathTokenizers.StepSequence.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PromptSequencers">PromptSequencers</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#PromptSequencers.key">key</a>
                        </li>
                        <li>
                                <a class="class" href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.__init__">AOTP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PromptSequencers.AOTP.target_tokenizer">target_tokenizer</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PromptSequencers.AOTP.path_tokenizer">path_tokenizer</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOTP.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="class" href="#PromptSequencers.AOP">PromptSequencers.AOP</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.__init__">AOP</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#PromptSequencers.AOP.path_tokenizer">path_tokenizer</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.serialize">serialize</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.load">load</a>
                                    </li>
                                    <li>
                                            <a class="function" href="#PromptSequencers.AOP.validate_fields_types">validate_fields_types</a>
                                    </li>
                            </ul>

                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MazeTokenizerModular">MazeTokenizerModular</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MazeTokenizerModular.__init__">MazeTokenizerModular</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.prompt_sequencer">prompt_sequencer</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.hash_int">hash_int</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.hash_b64">hash_b64</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.tokenizer_elements">tokenizer_elements</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.tokenizer_element_tree">tokenizer_element_tree</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.tokenizer_element_tree_concrete">tokenizer_element_tree_concrete</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.tokenizer_element_dict">tokenizer_element_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.name">name</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.summary">summary</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.has_element">has_element</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.is_valid">is_valid</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.is_legacy_equivalent">is_legacy_equivalent</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.is_tested_tokenizer">is_tested_tokenizer</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.is_AOTP">is_AOTP</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.is_UT">is_UT</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.from_legacy">from_legacy</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.from_tokens">from_tokens</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.token_arr">token_arr</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.tokenizer_map">tokenizer_map</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.vocab_size">vocab_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.n_tokens">n_tokens</a>
                        </li>
                        <li>
                                <a class="variable" href="#MazeTokenizerModular.padding_token_index">padding_token_index</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.to_tokens">to_tokens</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.coords_to_strings">coords_to_strings</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.strings_to_coords">strings_to_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.encode">encode</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.decode">decode</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.serialize">serialize</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#MazeTokenizerModular.validate_fields_types">validate_fields_types</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#set_tokenizer_hashes_path">set_tokenizer_hashes_path</a>
            </li>
            <li>
                    <a class="function" href="#get_all_tokenizer_hashes">get_all_tokenizer_hashes</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span>
            <img src="../../resources/svg/pdoc-logo.svg" alt="pdoc logo"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py">View Source on GitHub</a>
                    <h1 class="modulename">
<a href="./../../maze_dataset.html">maze_dataset</a><wbr>.<a href="./../tokenization.html">tokenization</a><wbr>.maze_tokenizer    </h1>

                        <div class="docstring"><p>turning a maze into text: <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> and the legacy <code><a href="#TokenizationMode">TokenizationMode</a></code> enum and <code><a href="#MazeTokenizer">MazeTokenizer</a></code> class</p>
</div>

                        <input id="mod-maze_tokenizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mod-maze_tokenizer-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L0-L2256" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

                <br/>
                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;turning a maze into text: `MazeTokenizerModular` and the legacy `TokenizationMode` enum and `MazeTokenizer` class&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span> <span class="nn">abc</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">base64</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">import</span> <span class="nn">hashlib</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span> <span class="nn">random</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">cached_property</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a>    <span class="n">Any</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>    <span class="n">Callable</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>    <span class="n">Iterable</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a>    <span class="n">Literal</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>    <span class="n">Mapping</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>    <span class="n">Sequence</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>    <span class="n">TypedDict</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>    <span class="n">TypeVar</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="p">)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">from</span> <span class="nn">jaxtyping</span> <span class="kn">import</span> <span class="n">Bool</span><span class="p">,</span> <span class="n">Int</span><span class="p">,</span> <span class="n">Int64</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">from</span> <span class="nn">muutils.json_serialize</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>    <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>    <span class="n">serializable_dataclass</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>    <span class="n">serializable_field</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="p">)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">from</span> <span class="nn">muutils.kappa</span> <span class="kn">import</span> <span class="n">Kappa</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">from</span> <span class="nn">muutils.misc</span> <span class="kn">import</span> <span class="n">empty_sequence_if_attr_false</span><span class="p">,</span> <span class="n">flatten</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="kn">from</span> <span class="nn">muutils.misc.sequence</span> <span class="kn">import</span> <span class="n">WhenMissing</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">from</span> <span class="nn">zanj.loading</span> <span class="kn">import</span> <span class="n">load_item_recursive</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="c1"># from maze_dataset import SolvedMaze</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="kn">from</span> <span class="nn">maze_dataset.constants</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>    <span class="n">SPECIAL_TOKENS</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>    <span class="n">VOCAB</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>    <span class="n">VOCAB_LIST</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>    <span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>    <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>    <span class="n">ConnectionList</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>    <span class="n">Coord</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>    <span class="n">CoordTup</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="p">)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="kn">from</span> <span class="nn">maze_dataset.generation</span> <span class="kn">import</span> <span class="n">numpy_rng</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="kn">from</span> <span class="nn">maze_dataset.maze.lattice_maze</span> <span class="kn">import</span> <span class="n">LatticeMaze</span><span class="p">,</span> <span class="n">SolvedMaze</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="kn">from</span> <span class="nn">maze_dataset.token_utils</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>    <span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>    <span class="n">_coord_to_strings_indexed</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>    <span class="n">_coord_to_strings_UT</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>    <span class="n">connection_list_to_adj_list</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>    <span class="n">coords_to_strings</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>    <span class="n">get_cardinal_direction</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>    <span class="n">get_relative_direction</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>    <span class="n">is_connection</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>    <span class="n">strings_to_coords</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>    <span class="n">tokens_between</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="kn">from</span> <span class="nn">maze_dataset.utils</span> <span class="kn">import</span> <span class="n">corner_first_ndindex</span><span class="p">,</span> <span class="n">lattice_connection_array</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="k">class</span> <span class="nc">TokenError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;error for tokenization&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>    <span class="k">pass</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="k">class</span> <span class="nc">TokenizationMode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;legacy tokenization modes</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">    &gt; [!CAUTION]</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    &gt; Legacy mode of tokenization. will still be around in future releases, but is no longer recommended for use.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    &gt; Use `MazeTokenizerModular` instead.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    # Abbreviations:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    - `AOTP`: Ajacency list, Origin, Target, Path</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    - `UT`: Unique Token (for each coordiate)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    - `CTT`: Coordinate Tuple Tokens (each coordinate is tokenized as a tuple of integers)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    # Modes:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    - `AOTP_UT_rasterized`: the &quot;classic&quot; mode: assigning tokens to each coordinate is done via rasterization</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">        example: for a 3x3 maze, token order is `(0,0), (0,1), (0,2), (1,0), (1,1), (1,2), (2,0), (2,1), (2,2)`</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    - `AOTP_UT_uniform`: new mode, where a 3x3 tokenization scheme and 5x5 tokenizations scheme are compatible</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">        uses `corner_first_ndindex` function to order the tokens</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">    - `AOTP_CTT_indexed`: each coordinate is a tuple of integers</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>    <span class="n">AOTP_UT_rasterized</span> <span class="o">=</span> <span class="s2">&quot;AOTP_UT_rasterized&quot;</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>    <span class="n">AOTP_UT_uniform</span> <span class="o">=</span> <span class="s2">&quot;AOTP_UT_uniform&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>    <span class="n">AOTP_CTT_indexed</span> <span class="o">=</span> <span class="s2">&quot;AOTP_CTT_indexed&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>    <span class="k">def</span> <span class="nf">to_legacy_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>        <span class="k">return</span> <span class="n">MazeTokenizer</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_grid_size</span><span class="o">=</span><span class="n">max_grid_size</span><span class="p">)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="n">_NDINDEX_FUNC_MAP</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>    <span class="n">TokenizationMode</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>    <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)),</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">corner_first_ndindex</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="p">}</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="p">:</span> <span class="n">TokenizationMode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="k">return</span> <span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>        <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>        <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>    <span class="p">)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="k">def</span> <span class="nf">get_tokens_up_to_path_start</span><span class="p">(</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>    <span class="n">include_start_coord</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>    <span class="n">tokenization_mode</span><span class="p">:</span> <span class="n">TokenizationMode</span> <span class="o">=</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>        <span class="s2">&quot;`maze_tokenizer.get_tokens_up_to_path_start` will be deprecated for a `MazeTokenizerModular`-compatible function in a future release.&quot;</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>        <span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>    <span class="p">)</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>    <span class="n">path_start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>    <span class="k">if</span> <span class="n">include_start_coord</span><span class="p">:</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="k">if</span> <span class="n">is_UT</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="p">):</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>            <span class="k">return</span> <span class="n">tokens</span><span class="p">[:</span> <span class="n">path_start_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="k">elif</span> <span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>            <span class="k">return</span> <span class="n">tokens</span><span class="p">[:</span> <span class="n">path_start_idx</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode: </span><span class="si">{</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="k">return</span> <span class="n">tokens</span><span class="p">[:</span><span class="n">path_start_idx</span><span class="p">]</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="n">_MAZETOKENIZER_PROPERTIES_TO_SERIALIZE</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>    <span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>    <span class="s2">&quot;max_grid_size&quot;</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="s2">&quot;token_arr&quot;</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>    <span class="s2">&quot;tokenizer_map&quot;</span><span class="p">,</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>    <span class="s2">&quot;vocab_size&quot;</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>    <span class="s2">&quot;padding_token_index&quot;</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="p">]</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>    <span class="n">properties_to_serialize</span><span class="o">=</span><span class="n">_MAZETOKENIZER_PROPERTIES_TO_SERIALIZE</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="k">class</span> <span class="nc">MazeTokenizer</span><span class="p">(</span><span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;LEGACY Tokenizer for mazes</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">    &gt; [!CAUTION]</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">    &gt; `MazeTokenizerModular` is the new standard for tokenization. This class is no longer recommended</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">    &gt; for use, but will remain for compatibility with existing code.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">    # Parameters:</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">     - `tokenization_mode: TokenizationMode`</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        mode of tokenization. required.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">    - `max_grid_size: int | None`</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">        maximum grid size. required for actually turning text tokens to numerical tokens, but not for moving between coordinates/mazes and text</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">    # Properties</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">    - `name: str`</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        auto-generated name of the tokenizer from mode and size</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="sd">    ## Conditional Properties</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">    - `node_strings_map: Mapping[CoordTup, str]`</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="sd">        map from node to string. This returns a `muutils.kappa.Kappa` object which you can use like a dictionary. returns `None` if not a `UT` mode</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">    these all return `None` if `max_grid_size` is `None`.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="sd">    Prepend `_` to the name to get a guaranteed type, and cause an exception if `max_grid_size` is `None`</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">    - `token_arr: list[str]`</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">        list of tokens, in order of their indices in the vocabulary</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">    - `tokenizer_map: Mapping[str, int]`</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">        map from token to index</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">    - `vocab_size: int`</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">        size of the vocabulary</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">    - `padding_token_index: int`</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">        index of the padding token</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">    # Methods</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">    - `coords_to_strings(coords: list[CoordTup]) -&gt; list[str]`</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">        convert a list of coordinates to a list of tokens. Optionally except, skip, or ignore non-coordinates</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">    - `strings_to_coords(strings: list[str]) -&gt; list[CoordTup]`</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        convert a list of tokens to a list of coordinates. Optionally except, skip, or ignore non-coordinates</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>    <span class="c1"># parameters</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="c1"># ============================================================</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>    <span class="n">tokenization_mode</span><span class="p">:</span> <span class="n">TokenizationMode</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="n">default</span><span class="o">=</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TokenizationMode</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;tokenization_mode&quot;</span><span class="p">]],</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>    <span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>    <span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>    <span class="c1"># properties</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="c1"># ============================================================</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>    <span class="nd">@property</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>        <span class="n">max_grid_size_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>            <span class="sa">f</span><span class="s2">&quot;-g</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>        <span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;maze_tokenizer-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="o">.</span><span class="n">value</span><span class="si">}{</span><span class="n">max_grid_size_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>    <span class="k">def</span> <span class="nf">_node_strings_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map a coordinate to a token&quot;&quot;&quot;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="k">return</span> <span class="n">Kappa</span><span class="p">(</span><span class="n">_coord_to_strings_UT</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="k">return</span> <span class="n">Kappa</span><span class="p">(</span><span class="n">_coord_to_strings_indexed</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>            <span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>    <span class="k">def</span> <span class="nf">node_strings_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map a coordinate to a token&quot;&quot;&quot;</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="p">):</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_strings_map</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>    <span class="c1"># conditional properties (on max_grid_size existing)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>    <span class="c1"># ------------------------------------------------------------</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>    <span class="k">def</span> <span class="nf">_token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from index to token&quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>                <span class="sa">f</span><span class="s2">&quot;max_grid_size must be specified to use token_arr property: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>            <span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="p">):</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>                <span class="p">[</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_node_strings_map</span><span class="p">[</span><span class="n">coord</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>                    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">_NDINDEX_FUNC_MAP</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="p">](</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>                    <span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>                <span class="p">]</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>            <span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>            <span class="c1"># TODO: this is hacky, but we don&#39;t want to modify the original SPECIAL_TOKENS since that will break old models</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>                <span class="p">[</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>                    <span class="s2">&quot;(&quot;</span><span class="p">,</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>                    <span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>                    <span class="s2">&quot;)&quot;</span><span class="p">,</span>  <span class="c1"># new special chars</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>                    <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="p">)),</span>  <span class="c1"># numbers</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>                <span class="p">]</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>            <span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>            <span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>    <span class="k">def</span> <span class="nf">token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>    <span class="k">def</span> <span class="nf">_tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from token to index&quot;&quot;&quot;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">token</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span><span class="p">)}</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>    <span class="k">def</span> <span class="nf">tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer_map</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>    <span class="nd">@property</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>    <span class="k">def</span> <span class="nf">_vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span><span class="p">)</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>    <span class="nd">@property</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>    <span class="k">def</span> <span class="nf">vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vocab_size</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>    <span class="nd">@property</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>    <span class="k">def</span> <span class="nf">_n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="c1"># TODO: deprecate</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vocab_size</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="nd">@property</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="k">def</span> <span class="nf">n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_tokens</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>    <span class="k">def</span> <span class="nf">_padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_map</span><span class="p">[</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PADDING</span><span class="p">]</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>    <span class="k">def</span> <span class="nf">padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padding_token_index</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>    <span class="c1"># conversion functions</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>    <span class="c1"># ============================================================</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>    <span class="k">def</span> <span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">],</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="p">):</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>            <span class="k">return</span> <span class="n">coords_to_strings</span><span class="p">(</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>                <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>                <span class="n">coord_to_strings_func</span><span class="o">=</span><span class="n">_coord_to_strings_UT</span><span class="p">,</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>                <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">,</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>            <span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>            <span class="k">return</span> <span class="n">coords_to_strings</span><span class="p">(</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>                <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>                <span class="n">coord_to_strings_func</span><span class="o">=</span><span class="n">_coord_to_strings_indexed</span><span class="p">,</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>                <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">,</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>            <span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>    <span class="k">def</span> <span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="k">return</span> <span class="n">strings_to_coords</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;encode a string or list of strings into a list of tokens&quot;&quot;&quot;</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_map</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>                <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>                <span class="sa">f</span><span class="s2">&quot;in vocabulary of </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;decode a list of tokens into a string or list of strings&quot;&quot;&quot;</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>            <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>                <span class="sa">f</span><span class="s2">&quot;Token index &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39; not found in vocabulary of length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>        <span class="k">if</span> <span class="n">joined_tokens</span><span class="p">:</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>            <span class="k">return</span> <span class="n">output</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>    <span class="c1"># UT-only coordinate stuff</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>    <span class="c1"># ============================================================</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>    <span class="k">def</span> <span class="nf">coordinate_tokens_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_UT</span><span class="p">():</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>                <span class="sa">f</span><span class="s2">&quot;coordinate_tokens_coords is only valid for UT tokenization modes, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>            <span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>                <span class="sa">f</span><span class="s2">&quot;max_grid_size must be specified to use coordinate_tokens: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>            <span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="n">raw_converted</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strings_to_coords</span><span class="p">(</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="s2">&quot;include&quot;</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="c1"># filter out non-coordinates</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>            <span class="n">coord</span><span class="p">:</span> <span class="n">i</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_converted</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="p">}</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>    <span class="k">def</span> <span class="nf">coordinate_tokens_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="c1"># checks performed in call</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="n">output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_tokens_coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>            <span class="n">_for_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_to_strings</span><span class="p">([</span><span class="n">coord</span><span class="p">])</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">_for_key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>            <span class="n">output</span><span class="p">[</span><span class="n">_for_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>    <span class="c1"># other</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>    <span class="c1"># ============================================================</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns a summary of the tokenization mode&quot;&quot;&quot;</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>            <span class="s2">&quot;tokenization_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>            <span class="s2">&quot;max_grid_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="p">,</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>            <span class="s2">&quot;vocab_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>        <span class="p">}</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>    <span class="k">def</span> <span class="nf">is_AOTP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns true if a tokenization mode is Adjacency list, Origin, Target, Path&quot;&quot;&quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="p">)</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>    <span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="k">return</span> <span class="n">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="p">)</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;clears all cached properties&quot;&quot;&quot;</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="c1"># delete the properties only if they exist</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">cached_property</span><span class="p">):</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>                <span class="c1"># if the property exists, delete it</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>                    <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>                    <span class="k">pass</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a><span class="k">class</span> <span class="nc">_TokenizerElement</span><span class="p">(</span><span class="n">SerializableDataclass</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Superclass for tokenizer elements.</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">    Subclasses contain modular functionality for maze tokenization.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">    # Development</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">    &gt; [!TIP]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">    &gt; Due to the functionality of `get_all_tokenizers()`, `_TokenizerElement` subclasses</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">    &gt; may only contain fields of type `utils.FiniteValued`.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">    &gt; Implementing a subclass with an `int` or `float`-typed field, for example, is not supported.</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="sd">    &gt; In the event that adding such fields is deemed necessary, `get_all_tokenizers()` must be updated.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>    <span class="k">def</span> <span class="nf">_stringify</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">):</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">v</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>    <span class="nd">@property</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="n">members_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_stringify</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;_type_&quot;</span><span class="p">]</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>        <span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">members_str</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">output</span> <span class="ow">and</span> <span class="n">output</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>            <span class="k">return</span> <span class="n">output</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>    <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">        Hack: dataclass hashes don&#39;t include the class itself in the hash function inputs.</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">        This causes dataclasses with identical fields but different types to hash identically.</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">        This hack circumvents this by adding a slightly hidden field to every subclass with a value of `repr(cls)`.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a><span class="sd">        To maintain compatibility with `all_instances`, the static type of the new field can only have 1 possible value.</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="sd">        So we type it as a singleton `Literal` type.</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">        muutils 0.6.1 doesn&#39;t support `Literal` type validation, so `assert_type=False`.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">        Ignore Pylance complaining about the arg to `Literal` being an expression.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_type_</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>            <span class="n">init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="bp">cls</span><span class="p">),</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;_type_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="bp">cls</span><span class="p">)]</span>  <span class="c1"># type: ignore</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="s2">&quot;Stable hash to identify unique `MazeTokenizerModular` instances. uses name&quot;</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>            <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>        <span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>    <span class="k">def</span> <span class="nf">_level_one_subclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;_TokenizerElement&quot;</span><span class="p">]:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the immediate subclass of `_TokenizerElement` of which `cls` is an instance.&quot;&quot;&quot;</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="nb">set</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()))</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="p">)</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>    <span class="k">def</span> <span class="nf">tokenizer_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_TokenizerElement&quot;</span><span class="p">]:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">        Returns a list of all `_TokenizerElement` instances contained in the subtree.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">        Currently only detects `_TokenizerElement` instances which are either direct attributes of another instance or</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">        which sit inside a `tuple` without further nesting.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">        # Parameters</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">        - `deep: bool`: Whether to return elements nested arbitrarily deeply or just a single layer.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>                    <span class="p">[</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                        <span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">+</span> <span class="n">el</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">()</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                    <span class="p">]</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                <span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                <span class="k">if</span> <span class="n">deep</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                <span class="k">else</span> <span class="nb">filter</span><span class="p">(</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>                    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>                <span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>            <span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>            <span class="n">non_tuple_elems</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>                    <span class="p">[</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                        <span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">+</span> <span class="n">el</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">()</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>                        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>                    <span class="p">]</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>                    <span class="k">if</span> <span class="n">deep</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>                    <span class="k">else</span> <span class="nb">filter</span><span class="p">(</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">),</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>                    <span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>                <span class="p">)</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>            <span class="p">)</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>            <span class="n">tuple_elems</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>                    <span class="p">[</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>                        <span class="p">(</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>                            <span class="p">[</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>                                <span class="p">[</span><span class="n">tup_el</span><span class="p">]</span> <span class="o">+</span> <span class="n">tup_el</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">()</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>                                <span class="k">for</span> <span class="n">tup_el</span> <span class="ow">in</span> <span class="n">el</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tup_el</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>                            <span class="p">]</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>                            <span class="k">if</span> <span class="n">deep</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>                            <span class="k">else</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">),</span> <span class="n">el</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>                        <span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>                        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                    <span class="p">]</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>                <span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>            <span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>            <span class="n">non_tuple_elems</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tuple_elems</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>            <span class="k">return</span> <span class="n">non_tuple_elems</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">abstract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">        Returns a string representation of the tree of tokenizer elements contained in `self`.</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a><span class="sd">        # Parameters</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">        - `depth: int`: Current depth in the tree. Used internally for recursion, no need to specify.</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a><span class="sd">        - `abstract: bool`: Whether to print the name of the abstract base class or the concrete class for each `_TokenizerElement` instance.</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">depth</span> <span class="o">+</span> <span class="p">(</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">abstract</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="k">else</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_level_one_subclass</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>            <span class="n">name</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>            <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>                <span class="n">el</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">(</span><span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">abstract</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>                <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>            <span class="p">)</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="p">)</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">        Returns a dictionary representation of the tree of tokenizer elements contained in `self`.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>                <span class="n">key</span><span class="p">:</span> <span class="p">(</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>                    <span class="n">val</span><span class="o">.</span><span class="n">tokenizer_element_dict</span><span class="p">()</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>                    <span class="k">else</span> <span class="p">(</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>                        <span class="n">val</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>                        <span class="k">else</span> <span class="p">[</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>                            <span class="p">(</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>                                <span class="n">el</span><span class="o">.</span><span class="n">tokenizer_element_dict</span><span class="p">()</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>                                <span class="k">else</span> <span class="n">el</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>                            <span class="p">)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>                            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">val</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>                        <span class="p">]</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>                    <span class="p">)</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>                <span class="p">)</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;_type_&quot;</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>            <span class="p">}</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="p">}</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>    <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the binding used in `MazeTokenizerModular` for that type of `_TokenizerElement`.&quot;&quot;&quot;</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>    <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a maze element into a list of tokens.</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">        Not all `_TokenizerElement` subclasses produce tokens, so this is not an abstract method.</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">        Those subclasses which do produce tokens should override this method.</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if `self` contains data members capable of producing an overall valid `MazeTokenizerModular`.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        Some `_TokenizerElement` instances may be created which are not useful despite obeying data member type hints.</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a><span class="sd">        `is_valid` allows for more precise detection of invalid `_TokenizerElement`s beyond type hinting alone.</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">        If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply `return True` for that subclass.</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">        # Types of Invalidity</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">        In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">        Invalidity types, in ascending order of invalidity:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">        - Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        E.g., `_TokenizerElement`s which are strictly worse than some alternative.</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">        - Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">        - Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a><span class="sd">        - Erroneous: These tokenizers might raise exceptions during use.</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        # Development</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        `is_invalid` is implemented to always return `True` in some abstract classes where all currently possible subclass instances are valid.</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">        ## Nesting</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        In general, when implementing this method, there is no need to recursively call `is_valid` on nested `_TokenizerElement`s contained in the class.</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">        In other words, failures of `is_valid` need not bubble up to the top of the nested `_TokenizerElement` tree.</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">        `MazeTokenizerModular.is_valid` calls `is_valid` on each of its `_TokenizerElement`s individually, so failure at any level will be detected.</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">        ## Types of Invalidity</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">        If it&#39;s judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">        This could be used to create more or less stringent filters on the valid `_TokenizerElement` instances.</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="k">def</span> <span class="nf">mark_as_unsupported</span><span class="p">(</span><span class="n">is_valid</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;mark a _TokenizerElement as unsupported.</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">    Classes marked with this decorator won&#39;t show up in `get_all_tokenizers()` and thus wont be tested.</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">    The classes marked in release 1.0.0 did work reliably before being marked, but they can&#39;t be instantiated since the decorator adds an abstract method.</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">    The decorator exists to prune the space of tokenizers returned by `all_instances` both for testing and usage.</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">    Previously, the space was too large, resulting in impractical runtimes.</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">    These decorators could be removed in future releases to expand the space of possible tokenizers.</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="n">is_valid</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="k">return</span> <span class="bp">cls</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>    <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="k">class</span> <span class="nc">__TokenizerElementNamespace</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;ABC for namespaces</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">    # Properties</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">    - key: The binding used in `MazeTokenizerModular` for instances of the classes contained within that `__TokenizerElementNamespace`.</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="ne">NotImplementedError</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="k">def</span> <span class="nf">_load_tokenizer_element</span><span class="p">(</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">__TokenizerElementNamespace</span><span class="p">]</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_TokenizerElement</span><span class="p">:</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a `TokenizerElement` stored via zanj.&quot;&quot;&quot;</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">namespace</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>    <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;__format__&quot;</span><span class="p">]</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>    <span class="n">cls_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">cls_name</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        <span class="n">k</span><span class="p">:</span> <span class="n">load_item_recursive</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">())</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>    <span class="p">}</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>    <span class="k">if</span> <span class="s2">&quot;__format__&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;__format__&quot;</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="k">class</span> <span class="nc">CoordTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_CoordTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;coord_tokenizer&quot;</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>    <span class="k">class</span> <span class="nc">_CoordTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">        Superclass for classes which tokenize singular coords in a maze.</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            <span class="k">pass</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>            <span class="k">return</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>    <span class="k">class</span> <span class="nc">UT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Unique token coordinate tokenizer.&quot;&quot;&quot;</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>    <span class="k">class</span> <span class="nc">CTT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Coordinate tuple tokenizer</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">        # Parameters</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">        - `pre`: Whether all coords include an integral preceding delimiter token</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        - `intra`: Whether all coords include a delimiter token between coordinates</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">        - `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>        <span class="c1"># Implement methods</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>            <span class="p">]</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="k">class</span> <span class="nc">EdgeGroupings</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgeGrouping` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_grouping&quot;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>    <span class="k">class</span> <span class="nc">_GroupingTokenParams</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A uniform private hyperparameter interface used by `AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="n">grouped</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>    <span class="k">class</span> <span class="nc">_EdgeGrouping</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called a edge grouping.&quot;&quot;&quot;</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Divides a ConnectionArray into groups of edges.</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">            Shuffles/sequences within each group if applicable.</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>            <span class="k">pass</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the tok.nization hyperparameters necessary for an `AdjListTokenizer` to tokenize.</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="sd">            These hyperparameters are not used by `_EdgeGrouping` internally.</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">            They are located in `_EdgeGrouping` rather than in `AdjListTokenizer`</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">            since the hyperparameter space is a function of the `_EdgeGrouping` subclass.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">            This function resolves the `_EdgeGrouping` hyperparameter space which is non-uniform across subclasses</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">            into a uniform private interface used by `AdjListTokenizer`.</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>            <span class="k">pass</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="k">class</span> <span class="nc">Ungrouped</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;No grouping occurs, each edge is tokenized individually.</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">        # Parameters</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        - `connection_token_ordinal`: At which index in the edge tokenization the connector (or wall) token appears.</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">        Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="p">)</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>                <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>            <span class="p">)</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionList</span><span class="p">]:</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>    <span class="k">class</span> <span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">        # Parameters</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">        - `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">        Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        - `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">        If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">        In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        - `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">        Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>        <span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>                <span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>            <span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>            <span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>            <span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>                <span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>            <span class="p">)</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>            <span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>            <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>                <span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>            <span class="p">)</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>                <span class="p">[</span><span class="n">numpy_rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>            <span class="k">return</span> <span class="n">groups</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="k">class</span> <span class="nc">EdgePermuters</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgePermuter` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_permuter&quot;</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="k">class</span> <span class="nc">_EdgePermuter</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Specifies how to sequence the two coords that encode a lattice edge.&quot;&quot;&quot;</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>            <span class="k">return</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="nd">@staticmethod</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a><span class="sd">            Executes a permutation.</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">            Warning: Caller should be aware that `lattice_edges` may be modified in-place depending on the subclass&#39;s implementation.</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">            # Parameters</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a><span class="sd">            - `lattice_edges`: Array of lattice edges.</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">            The two coords in shape[1] must be adjacent in the lattice.</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">            # Returns</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">            - Array of lattice edges with entries along shape[1] systematically permuted.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="sd">            - shape[0] of the returned array is NOT guaranteed to match `lattice_edges.shape[1]`.</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>            <span class="k">pass</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>    <span class="k">class</span> <span class="nc">SortedCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns a sorted representation. useful for checking consistency&quot;&quot;&quot;</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="nd">@staticmethod</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>            <span class="k">return</span> <span class="n">lattice_edges</span><span class="p">[</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>                    <span class="p">(</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>                    <span class="p">)</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>                <span class="p">),</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>                <span class="o">...</span><span class="p">,</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>            <span class="p">]</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>    <span class="k">class</span> <span class="nc">RandomCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Permutes each edge randomly.&quot;&quot;&quot;</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="nd">@staticmethod</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="n">numpy_rng</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">lattice_edges</span><span class="p">)</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="k">return</span> <span class="n">lattice_edges</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>    <span class="k">class</span> <span class="nc">BothCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Includes both possible permutations of every edge in the output.</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">        Since input ConnectionList has only 1 instance of each edge,</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">        a call to `BothCoords._permute` will modify `lattice_edges` in-place, doubling `shape[0]`.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>        <span class="nd">@staticmethod</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="k">class</span> <span class="nc">EdgeSubsets</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">    Namespace for `_EdgeSubset` subclass hierarchy used by `_AdjListTokenizer`.</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_subset&quot;</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>    <span class="k">class</span> <span class="nc">_EdgeSubset</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">        Component of an `AdjListTokenizers._AdjListTokenizer` which specifies the subset of lattice edges to be tokenized.</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="k">return</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">            Returns the set of lattice edges to be tokenized.</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>            <span class="k">pass</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>    <span class="k">class</span> <span class="nc">AllLatticeEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        All 2n**2-2n edges of the lattice are tokenized.</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">        If a wall exists on that edge, the edge is tokenized in the same manner, using `VOCAB.ADJLIST_WALL` in place of `VOCAB.CONNECTOR`.</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="k">return</span> <span class="n">lattice_connection_array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">grid_n</span><span class="p">)</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>    <span class="k">class</span> <span class="nc">ConnectionEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">        Only edges which contain a connection are tokenized.</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        Alternatively, only edges which contain a wall are tokenized.</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">        - `walls`: Whether wall edges or connection edges are tokenized.</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">        If true, `VOCAB.ADJLIST_WALL` is used in place of `VOCAB.CONNECTOR`.</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        <span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>            <span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>                <span class="n">conn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">conn_list</span><span class="p">)</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                <span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>                <span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>            <span class="k">return</span> <span class="n">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>                <span class="n">conn_list</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle_d1</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>            <span class="p">)</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="k">class</span> <span class="nc">AdjListTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_AdjListTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="n">self_</span><span class="o">.</span><span class="n">pre</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>    <span class="k">class</span> <span class="nc">_AdjListTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">        Specifies how the adjacency list is tokenized.</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">        Tokenization behavior is decomposed into specification of edge subsets, groupings, and permutations.</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">        See documentation of `EdgeSubset` and `EdgeGrouping` classes for more details.</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        - `pre`: Whether all edge groupings include a preceding delimiter token</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        - `post`: Whether all edge groupings include a following delimiter token</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        - `shuffle_d0`: Specifies how to sequence the edge groupings.</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">        If true, groupings are shuffled randomly. If false, groupings are sorted by the leading coord of each group.</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">        - `edge_grouping`: Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called an edge grouping.</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">        - `edge_subset`: Specifies the subset of lattice edges to be tokenized.</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">        - `edge_permuter`: Specifies, in each edge tokenization, which coord either:</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">          1. Appears first in the tokenization, for `AdjListCoord`.</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">          2. Is tokenized directly as a coord, for `AdjListCardinal`.</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">          - `shuffle`: For each edge, the leading coord is selected randomly.</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">          - `all`: Each edge appears twice in the tokenization, appearing with both leading coords.</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">          - `evens`, `odds`: The leading coord is the one belonging to that coord subset. See `EdgeSubsets.ChessboardSublattice` for details.</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>        <span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>        <span class="n">edge_grouping</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">Ungrouped</span><span class="p">(),</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeGroupings</span><span class="p">),</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>        <span class="p">)</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>        <span class="n">edge_subset</span><span class="p">:</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">ConnectionEdges</span><span class="p">(),</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeSubsets</span><span class="p">),</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>        <span class="p">)</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="p">)</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>            <span class="k">return</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>        <span class="p">):</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">            Returns a sequence of callables which take an index in `edges` and return parts of that edge tokenization.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">            # Returns</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">            - `[0]`: leading coord tokens</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">            - `[1]`: connector tokens</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">            - `[2]`: trailing coord tokens</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>            <span class="k">pass</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>        <span class="k">def</span> <span class="nf">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>            <span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">,</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a><span class="sd">            Tokenizes a single edge grouping.</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="n">cxn_ord</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;connection_token_ordinal&quot;</span><span class="p">]</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_connection</span><span class="p">(</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>                <span class="n">edges</span><span class="p">,</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>            <span class="p">)</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">tokenize_callables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>                <span class="n">edges</span><span class="p">,</span> <span class="n">is_conn</span><span class="p">,</span> <span class="n">coord_tokenizer</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>            <span class="p">)</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;grouped&quot;</span><span class="p">]:</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>                <span class="c1"># If grouped</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>                <span class="n">callable_permutation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">cxn_ord</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>                <span class="n">repeated_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>                    <span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>                <span class="p">]</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>                <span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>                    <span class="p">[</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>                        <span class="n">tokenize_callables</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>                        <span class="p">[</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>                            <span class="p">[</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>                                <span class="o">*</span><span class="p">[</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>                                    <span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                                    <span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">repeated_callables</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>                                <span class="p">],</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                                <span class="o">*</span><span class="p">(</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>                                    <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,)</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                                    <span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;intra&quot;</span><span class="p">]</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>                                    <span class="k">else</span> <span class="p">()</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>                                <span class="p">),</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>                            <span class="p">]</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>                        <span class="p">],</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>                    <span class="p">]</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>                <span class="p">)</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>                <span class="c1"># If ungrouped</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>                <span class="n">callable_permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>                <span class="n">callable_permutation</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">cxn_ord</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>                <span class="n">tokenize_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>                    <span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>                <span class="p">]</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>                <span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>                    <span class="p">[</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>                        <span class="p">[</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>                            <span class="p">[</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>                                <span class="o">*</span><span class="p">[</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>                                    <span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>                                    <span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">tokenize_callables</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>                                <span class="p">],</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>                                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>                                    <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,),</span> <span class="n">group_params</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>                                <span class="p">),</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>                            <span class="p">]</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>                        <span class="p">]</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>                    <span class="p">]</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>                <span class="p">)</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>            <span class="c1"># Get the set of edges to be tokenized</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_subset</span><span class="o">.</span><span class="n">_get_edges</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>            <span class="c1"># Systematically permute the leading coord of each edge</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_permuter</span><span class="o">.</span><span class="n">_permute</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>            <span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_token_params</span><span class="p">()</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>            <span class="p">)</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>            <span class="c1"># then, we need to group the edges</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>            <span class="n">groups</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_group_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>            <span class="c1"># shuffle the groups if specified</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_d0</span><span class="p">:</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>                    <span class="n">numpy_rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>                        <span class="sa">f</span><span class="s2">&quot;`groups` is an unexpected type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span><span class="si">}</span><span class="s2">. Only types `list` and `np.ndarray` are currently supported.&quot;</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>                    <span class="p">)</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>            <span class="c1"># Tokenize each group with optional delimiters</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>            <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>                    <span class="p">[</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>                        <span class="p">[</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>                                <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>                            <span class="p">),</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>                            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>                                <span class="n">group</span><span class="p">,</span> <span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">,</span> <span class="n">group_params</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>                            <span class="p">),</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                                <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJACENCY_ENDLINE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>                            <span class="p">),</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>                        <span class="p">]</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>                        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>                    <span class="p">]</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>                <span class="p">)</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>            <span class="p">)</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>            <span class="k">return</span> <span class="n">tokens</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>    <span class="k">class</span> <span class="nc">AdjListCoord</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.&quot;&quot;&quot;</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="p">)</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>        <span class="p">):</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>            <span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>            <span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>                <span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>                <span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>            <span class="p">}</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>            <span class="p">]</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>    <span class="k">class</span> <span class="nc">AdjListCardinal</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">        - `coord_first`: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">BothCoords</span><span class="p">(),</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>        <span class="p">)</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>        <span class="p">):</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>            <span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>            <span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>                <span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>                <span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>            <span class="p">}</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>            <span class="p">]</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="k">class</span> <span class="nc">TargetTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_TargetTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;target_tokenizer&quot;</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>    <span class="k">class</span> <span class="nc">_TargetTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze targets.&quot;&quot;&quot;</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>            <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens representing the target.&quot;&quot;&quot;</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>            <span class="k">pass</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>            <span class="k">return</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>    <span class="k">class</span> <span class="nc">Unlabeled</span><span class="p">(</span><span class="n">_TargetTokenizer</span><span class="p">):</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Targets are simply listed as coord tokens.</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        - `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>            <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>                    <span class="p">[</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>                        <span class="p">[</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>                            <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>                                <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>                            <span class="p">),</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>                        <span class="p">]</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>                        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>                    <span class="p">]</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>                <span class="p">)</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>            <span class="p">)</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a><span class="k">class</span> <span class="nc">StepSizes</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_StepSize` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_size&quot;</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>    <span class="k">class</span> <span class="nc">_StepSize</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">        Specifies which coords in `maze.solution` are used to represent the path.</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>            <span class="k">return</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>  <span class="c1"># TODO: make this a static/class method, allowing ForksAndStraightaways to skip object construction at every call</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>                <span class="s2">&quot;Subclasses must implement `StepSize.step_indices.&quot;</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>            <span class="p">)</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>        <span class="k">def</span> <span class="nf">step_start_end_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns steps as tuples of starting and ending positions for each step.&quot;&quot;&quot;</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>            <span class="k">return</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>    <span class="k">class</span> <span class="nc">Singles</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">        Every coord in `maze.solution` is represented.</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">        Legacy tokenizers all use this behavior.</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>    <span class="k">class</span> <span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="sd">        Only coords where the path turns are represented in the path.</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">        I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">        specified by the coords at the turns.</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>            <span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>                <span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>                    <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>                    <span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>            <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>            <span class="k">return</span> <span class="n">indices</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>    <span class="k">class</span> <span class="nc">Forks</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a><span class="sd">        Only coords at forks, where the path has &gt;=2 options for the next step are included.</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a><span class="sd">        Excludes the option of backtracking.</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="sd">        The starting and ending coords are always included.</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>            <span class="k">return</span> <span class="n">maze</span><span class="o">.</span><span class="n">get_solution_forking_points</span><span class="p">(</span><span class="n">always_include_endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>    <span class="k">class</span> <span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a><span class="sd">        Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        See documentation for those classes for details.</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>                        <span class="p">(</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>                        <span class="p">)</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>                    <span class="p">)</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>                <span class="p">)</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>            <span class="p">)</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a><span class="k">class</span> <span class="nc">StepTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_StepTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_tokenizers&quot;</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>    <span class="k">class</span> <span class="nc">_StepTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">        Specifies how a single step (as specified by an instance of `_StepSize`) is tokenized.</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>            <span class="k">return</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>            <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>            <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Tokenizes a single step in the solution.</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">            # Parameters</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">            - `maze`: Maze to be tokenized</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">            - `start_index`: The index of the Coord in `maze.solution` at which the current step starts</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a><span class="sd">            - `end_index`: The index of the Coord in `maze.solution` at which the current step ends</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>                <span class="s2">&quot;Subclasses must implement `StepTokenizer.to_tokens.&quot;</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>            <span class="p">)</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>    <span class="k">class</span> <span class="nc">Coord</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">        A direct tokenization of the end position coord represents the step.</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>            <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>            <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>            <span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>    <span class="k">class</span> <span class="nc">Cardinal</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">        A step is tokenized with a cardinal direction token.</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">        It is the direction of the step from the starting position along the solution.</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>                <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>            <span class="p">]</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>    <span class="k">class</span> <span class="nc">Relative</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a><span class="sd">        To simplify the indeterminacy, at the start of a solution the &quot;agent&quot; solving the maze is assumed to be facing NORTH.</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a><span class="sd">        Similarly to `Cardinal`, the direction is that of the step from the starting position.</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>            <span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>                <span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>                    <span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>                            <span class="p">(</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>                                <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>                                <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>                            <span class="p">),</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>                        <span class="p">)</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>                    <span class="p">)</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>                <span class="p">]</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>                <span class="n">get_relative_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>            <span class="p">]</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>    <span class="k">class</span> <span class="nc">Distance</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">        A count of the number of individual steps from the starting point to the end point.</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">        Contains no information about directionality, only the distance traveled in the step.</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="sd">        `Distance` must be combined with at least one other `_StepTokenizer` in a `StepTokenizerPermutation`.</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        This constraint is enforced in `_PathTokenizer.is_valid`.</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>            <span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a><span class="sd">    `StepTokenizerPermutation`</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a><span class="sd">    A sequence of unique `_StepTokenizer`s.</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a><span class="sd">    This type exists mostly just for the clarity and convenience of `_PathTokenizer` code.</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>    <span class="n">StepTokenizerPermutation</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>        <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>    <span class="p">)</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="k">class</span> <span class="nc">PathTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_PathTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;path_tokenizer&quot;</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>    <span class="k">class</span> <span class="nc">_PathTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze solution paths.&quot;&quot;&quot;</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens representing the solution path.&quot;&quot;&quot;</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>            <span class="k">pass</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>            <span class="k">return</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>    <span class="k">class</span> <span class="nc">StepSequence</span><span class="p">(</span><span class="n">_PathTokenizer</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any `PathTokenizer` where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a><span class="sd">        Allows for a sequence of leading and trailing tokens which don&#39;t fit the step pattern.</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a><span class="sd">        - `step_size`: Selects the size of a single step in the sequence</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a><span class="sd">        - `step_tokenizers`: Selects the combination and permutation of tokens</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="sd">        - `pre`: Whether all steps include an integral preceding delimiter token</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a><span class="sd">        - `intra`: Whether all steps include a delimiter token after each individual `_StepTokenizer` tokenization.</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">        - `post`: Whether all steps include an integral following delimiter token</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>        <span class="n">step_size</span><span class="p">:</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">Singles</span><span class="p">(),</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">StepSizes</span><span class="p">),</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>        <span class="p">)</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>        <span class="n">step_tokenizers</span><span class="p">:</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">StepTokenizerPermutation</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>            <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">(),),</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>            <span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>        <span class="p">)</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>                    <span class="p">[</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>                    <span class="p">]</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>                <span class="p">),</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>            <span class="p">]</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>        <span class="k">def</span> <span class="nf">_single_step_tokens</span><span class="p">(</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>            <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>            <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the token sequence representing a single step along the path.&quot;&quot;&quot;</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>            <span class="n">step_rep_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>                <span class="n">step_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>                <span class="k">for</span> <span class="n">step_tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>            <span class="p">]</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">:</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>                <span class="p">)</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_rep_tokens</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>                    <span class="n">step_rep_tokens</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>                <span class="p">)</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>                <span class="n">step_rep_tokens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens_and_intra</span><span class="p">))</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>            <span class="n">all_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">),</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_POST</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>            <span class="p">]</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>            <span class="k">return</span> <span class="n">all_tokens</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>        <span class="k">def</span> <span class="nf">_leading_tokens</span><span class="p">(</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens preceding those from the sequence from `_single_step_tokens`.</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">            Since the for loop in `to_tokens` iterates `len(path)-1` times, a fencepost problem exists with `StepTokenizers.Coord`.</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a><span class="sd">            &lt;PATH_START&gt; should NOT be included.</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>            <span class="k">if</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">:</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>                    <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>                    <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]),</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>                    <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>                <span class="p">]</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>        <span class="k">def</span> <span class="nf">_trailing_tokens</span><span class="p">(</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens following those from the sequence from `_single_step_tokens`.</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="sd">            &lt;PATH_END&gt; should NOT be included.</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>                <span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>            <span class="p">):</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>                <span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a><span class="k">class</span> <span class="nc">PromptSequencers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_PromptSequencer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;prompt_sequencer&quot;</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>    <span class="k">class</span> <span class="nc">_PromptSequencer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a><span class="sd">        Sequences token regions into a complete maze tokenization.</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a><span class="sd">        - `coord_tokenizer`: Tokenizer element which tokenizes a single `Coord` aka maze position.</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a><span class="sd">        - `adj_list_tokenizer`: Tokenizer element which tokenizes the adjacency list of a `LatticeMaze`.</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if needed in other `TokenizerElement`s.</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>        <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">(),</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">CoordTokenizers</span><span class="p">),</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>        <span class="p">)</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>        <span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">AdjListCoord</span><span class="p">(),</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">AdjListTokenizers</span><span class="p">),</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>        <span class="p">)</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>        <span class="nd">@classmethod</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>            <span class="k">return</span> <span class="n">PromptSequencers</span><span class="o">.</span><span class="n">key</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>        <span class="nd">@staticmethod</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>        <span class="k">def</span> <span class="nf">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>            <span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_untargeted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">is_unsolved</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>        <span class="p">):</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Trims a full `SolvedMaze` prompt if the maze data reflects an unsolved or untargeted maze.</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a><span class="sd">            # Development</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="sd">            This implementation should function for `AOTP`, `AOP`, and other concrete classes using any subsequence of AOTP.</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a><span class="sd">            It is not located in `token_utils.py` because it may need to be overridden in more exotic `PromptSequencer` subclasses.</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>            <span class="k">if</span> <span class="n">is_untargeted</span><span class="p">:</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>                <span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>                    <span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>                    <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>                    <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>                    <span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>                    <span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>                <span class="p">)</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>            <span class="k">if</span> <span class="n">is_unsolved</span><span class="p">:</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>                <span class="k">if</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span> <span class="ow">in</span> <span class="n">untrimmed</span><span class="p">:</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>                    <span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>                        <span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>                        <span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>                        <span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>                    <span class="p">)</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>                    <span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>                        <span class="n">untrimmed</span><span class="p">,</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>                        <span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>                        <span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>                    <span class="p">)</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>            <span class="k">return</span> <span class="n">untrimmed</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns a complete list of tokens for a given set of maze elements.&quot;&quot;&quot;</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>            <span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_regions</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>            <span class="p">)</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>                <span class="n">untrimmed</span><span class="p">,</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">),</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>            <span class="p">)</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>        <span class="k">def</span> <span class="nf">_get_prompt_regions</span><span class="p">(</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Gets the prompt regions of a maze in a fixed sequence.</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a><span class="sd">            This method is NOT responsible for including/excluding any prompt regions.</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a><span class="sd">            Always return according to the API described under Returns.</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a><span class="sd">            This implementation is expected to be suitable for most `PromptSequencer` subclasses.</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a><span class="sd">            Subclasses may override this method if needed for special behavior.</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a><span class="sd">            # Returns</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a><span class="sd">            - [0]: list[str] Adjacency list tokens</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a><span class="sd">            - [1]: list[str] Origin tokens</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a><span class="sd">            - [2]: list[str] Target tokens</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a><span class="sd">            - [3]: list[str] Path tokens</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a><span class="sd">            # `None`-valued Args</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a><span class="sd">            If one or more of `origin`, `target`, or `path` are `None`, that indicates that an unsolved or untargeted maze is being tokenized.</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a><span class="sd">            To ensure unpackability in `_sequence_tokens`, these `None` values are substituted for empty iterables.</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>                <span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;end_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>            <span class="p">]</span>  <span class="c1"># TargetTokenizer requires target: Sequence[Coord]</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>                <span class="p">(</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">adj_list_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>                        <span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>                    <span class="p">)</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span><span class="p">)</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>                    <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>                <span class="p">),</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>                <span class="p">(</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>                        <span class="n">target</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>                    <span class="p">)</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a>                    <span class="k">if</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;target_tokenizer&quot;</span><span class="p">)</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>                    <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>                <span class="p">),</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>                <span class="p">(</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">path_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a>                        <span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a>                    <span class="p">)</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;path_tokenizer&quot;</span><span class="p">)</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a>                    <span class="k">else</span> <span class="p">[]</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a>                <span class="p">),</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a>            <span class="p">]</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Sequences token regions into a complete prompt.</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a><span class="sd">            Includes any boundary tokens in `constants.SPECIAL_TOKENS` such as &lt;ADJLIST_START&gt;, &lt;ORIGIN_END&gt;, etc.</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a><span class="sd">            # Parameters</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a><span class="sd">            - `adj_list`: Tokens representing the adjacency list</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a><span class="sd">            - `origin`: Tokens representing the origin</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a><span class="sd">            - `target`: Tokens representing the target</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a><span class="sd">            - `path`: Tokens representing the path</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a>            <span class="k">pass</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>    <span class="k">class</span> <span class="nc">AOTP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a><span class="sd">        Sequences a prompt as [adjacency list, origin, target, path].</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a><span class="sd">        - `target_tokenizer`: Tokenizer element which tokenizes the target(s) of a `TargetedLatticeMaze`.</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `TargetTokenizer`.</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a><span class="sd">        - `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>        <span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">Unlabeled</span><span class="p">(),</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">TargetTokenizers</span><span class="p">),</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>        <span class="p">)</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a>        <span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>        <span class="p">)</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>                <span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>                <span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>                <span class="o">*</span><span class="n">target</span><span class="p">,</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>                <span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>            <span class="p">]</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>    <span class="k">class</span> <span class="nc">AOP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, path].</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a><span class="sd">        Still includes &quot;&lt;TARGET_START&gt;&quot; and &quot;&lt;TARGET_END&gt;&quot; tokens, but no representation of the target itself.</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a><span class="sd">        - `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>        <span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a>        <span class="p">)</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>                <span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>                <span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>                <span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>            <span class="p">]</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>    <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>    <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>    <span class="n">properties_to_serialize</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tokenizer_element_tree_concrete&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a><span class="p">)</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a><span class="k">class</span> <span class="nc">MazeTokenizerModular</span><span class="p">(</span><span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tokenizer for mazes</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a><span class="sd">    # Parameters</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a><span class="sd">    - `prompt_sequencer`: Tokenizer element which assembles token regions (adjacency list, origin, target, path) into a complete prompt.</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a><span class="sd">    # Development</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a><span class="sd">    - To ensure backwards compatibility, the default constructor must always return a tokenizer equivalent to the legacy `TokenizationMode.AOTP_UT_Uniform`.</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a><span class="sd">    - Furthermore, the mapping reflected in `from_legacy` must also be maintained.</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a><span class="sd">    - Updates to `MazeTokenizerModular` or the `_TokenizerElement` hierarchy must maintain that behavior.</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>    <span class="n">prompt_sequencer</span><span class="p">:</span> <span class="n">PromptSequencers</span><span class="o">.</span><span class="n">_PromptSequencer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>        <span class="n">default</span><span class="o">=</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">(),</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>        <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PromptSequencers</span><span class="p">),</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>    <span class="p">)</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>    <span class="k">def</span> <span class="nf">hash_int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>            <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>            <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>        <span class="p">)</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>        <span class="s2">&quot;Stable hash to identify unique `MazeTokenizerModular` instances. uses name&quot;</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_int</span><span class="p">()</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>    <span class="k">def</span> <span class="nf">hash_b64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;filename-safe base64 encoding of the hash&quot;&quot;&quot;</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>        <span class="c1"># Use modulus to ensure the integer fits within n_bytes * 8 bits</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>        <span class="n">hash_mod</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_int</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">n_bytes</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>        <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>            <span class="n">hash_mod</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span> <span class="n">altchars</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;-_&quot;</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>        <span class="c1"># Remove any padding equals signs</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>        <span class="k">return</span> <span class="n">encoded</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>    <span class="c1"># Information Querying Methods</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>    <span class="nd">@cached_property</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>    <span class="k">def</span> <span class="nf">tokenizer_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]:</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">()]</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a><span class="sd">        Returns a string representation of the tree of tokenizer elements contained in `self`.</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a><span class="sd">        # Parameters</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a><span class="sd">        - `abstract: bool`: Whether to print the name of the abstract base class or the concrete class for each `_TokenizerElement` instance.</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>            <span class="p">[</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>                <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">(</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>                    <span class="n">abstract</span><span class="o">=</span><span class="n">abstract</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>                <span class="p">),</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>            <span class="p">]</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>        <span class="p">)</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>    <span class="nd">@property</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree_concrete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a><span class="sd">        Property wrapper for `tokenizer_element_tree` so that it can be used in `properties_to_serialize`.</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">()</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a><span class="sd">        Nested dictionary of the internal `TokenizerElement`s.</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a>        <span class="k">return</span> <span class="p">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_element_dict</span><span class="p">()}</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a>    <span class="nd">@property</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serializes MazeTokenizer into a key for encoding in zanj&quot;&quot;&quot;</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>        <span class="k">return</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a><span class="sd">        Single-level dictionary of the internal `TokenizerElement`s.</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>            <span class="c1"># &quot;prompt_sequencer&quot;: self.prompt_sequencer.name,</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>            <span class="o">**</span><span class="p">{</span><span class="n">elem</span><span class="o">.</span><span class="n">attribute_key</span><span class="p">():</span> <span class="n">elem</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">}</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>        <span class="p">}</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>    <span class="k">def</span> <span class="nf">_type_check</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method for `has_element`&quot;&quot;&quot;</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">))</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>        <span class="p">):</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> is not a `_TokenizerElement` instance or subclass.&quot;</span><span class="p">)</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>    <span class="k">def</span> <span class="nf">_has_element_singular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">el</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">|</span> <span class="n">_TokenizerElement</span><span class="p">):</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method for `has_element`&quot;&quot;&quot;</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type_check</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>            <span class="k">return</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">])</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>            <span class="k">return</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>    <span class="k">def</span> <span class="nf">has_element</span><span class="p">(</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>        <span class="o">*</span><span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">|</span> <span class="n">_TokenizerElement</span><span class="p">],</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if the `MazeTokenizerModular` instance contains ALL of the items specified in `elements`.</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a><span class="sd">        Querying with a partial subset of `_TokenizerElement` fields is not currently supported.</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="sd">        To do such a query, assemble multiple calls to `has_elements`.</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="sd">        # Parameters</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">        - `elements`: Singleton or iterable of `_TokenizerElement` instances or classes.</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a><span class="sd">        If an instance is provided, then comparison is done via instance equality.</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">        If a class is provided, then comparison isdone via `isinstance`. I.e., any instance of that class is accepted.</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>            <span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_has_element_singular</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">])</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a><span class="sd">        Returns `True` if `self` is a valid tokenizer.</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a><span class="sd">        Evaluates the validity of all of `self.tokenizer_elements` according to each one&#39;s method.</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">el</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">])</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>    <span class="k">def</span> <span class="nf">is_legacy_equivalent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if `self` has identical stringification behavior as any legacy `MazeTokenizer`.&quot;&quot;&quot;</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>            <span class="p">[</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>                <span class="bp">self</span> <span class="o">==</span> <span class="n">MazeTokenizerModular</span><span class="o">.</span><span class="n">from_legacy</span><span class="p">(</span><span class="n">tok_mode</span><span class="p">)</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>                <span class="k">for</span> <span class="n">tok_mode</span> <span class="ow">in</span> <span class="n">TokenizationMode</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>            <span class="p">]</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>        <span class="p">)</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>    <span class="k">def</span> <span class="nf">is_tested_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_assert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if the tokenizer is returned by `all_tokenizers.get_all_tokenizers`, the set of tested and reliable tokenizers.</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a><span class="sd">        Since evaluating `all_tokenizers.get_all_tokenizers` is expensive,</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a><span class="sd">        instead checks for membership of `self`&#39;s hash in `get_all_tokenizer_hashes()`.</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a><span class="sd">        if `do_assert` is `True`, raises an `AssertionError` if the tokenizer is not tested.</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>        <span class="n">all_tokenizer_hashes</span><span class="p">:</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a>            <span class="n">get_all_tokenizer_hashes</span><span class="p">()</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>        <span class="p">)</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a>        <span class="n">hash_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>        <span class="n">in_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">hash_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">)</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>        <span class="n">hashes_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">all_tokenizer_hashes</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>        <span class="n">is_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>        <span class="k">if</span> <span class="n">do_assert</span><span class="p">:</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>                <span class="n">in_range</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hash_index</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is invalid, must be at most </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>                <span class="n">hashes_match</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">all_tokenizer_hashes</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2"> != </span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a>            <span class="k">assert</span> <span class="n">is_valid</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;self.is_valid returns False&quot;</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>            <span class="k">return</span> <span class="n">in_range</span> <span class="ow">and</span> <span class="n">hashes_match</span> <span class="ow">and</span> <span class="n">is_valid</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>    <span class="k">def</span> <span class="nf">is_AOTP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_element</span><span class="p">(</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">)</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>    <span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_element</span><span class="p">(</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">)</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>    <span class="c1"># Alternate Constructors</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>    <span class="c1"># ======================</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>    <span class="k">def</span> <span class="nf">from_legacy</span><span class="p">(</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>        <span class="bp">cls</span><span class="p">,</span> <span class="n">legacy_maze_tokenizer</span><span class="p">:</span> <span class="n">MazeTokenizer</span> <span class="o">|</span> <span class="n">TokenizationMode</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeTokenizerModular&quot;</span><span class="p">:</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Maps a legacy `MazeTokenizer` or `TokenizationMode` to its equivalent `MazeTokenizerModular` instance.&quot;&quot;&quot;</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legacy_maze_tokenizer</span><span class="p">,</span> <span class="n">MazeTokenizer</span><span class="p">):</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>            <span class="n">legacy_maze_tokenizer</span> <span class="o">=</span> <span class="n">legacy_maze_tokenizer</span><span class="o">.</span><span class="n">tokenization_mode</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(),</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(),</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>                <span class="n">prompt_sequencer</span><span class="o">=</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">(</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>                    <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">CTT</span><span class="p">()</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>                <span class="p">)</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>            <span class="p">),</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a>        <span class="p">}[</span><span class="n">legacy_maze_tokenizer</span><span class="p">]</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a>    <span class="c1"># Simple properties</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>    <span class="c1"># =================</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>    <span class="k">def</span> <span class="nf">from_tokens</span><span class="p">(</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>        <span class="n">tokens</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeTokenizerModular&quot;</span><span class="p">:</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a><span class="sd">        Infers most `MazeTokenizerModular` parameters from a full sequence of tokens.</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>            <span class="s2">&quot;Recovering tokenizer objects from MazeTokenizerModular-produced strings is not supported&quot;</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>        <span class="p">)</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>    <span class="nd">@property</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>    <span class="k">def</span> <span class="nf">token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from index to token&quot;&quot;&quot;</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>        <span class="k">return</span> <span class="n">VOCAB_LIST</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>    <span class="nd">@property</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>    <span class="k">def</span> <span class="nf">tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from token to index&quot;&quot;&quot;</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>        <span class="k">return</span> <span class="n">VOCAB_TOKEN_TO_INDEX</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>    <span class="nd">@property</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>    <span class="k">def</span> <span class="nf">vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of tokens in the static vocab&quot;&quot;&quot;</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">VOCAB_LIST</span><span class="p">)</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>    <span class="nd">@property</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>    <span class="k">def</span> <span class="nf">n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>            <span class="s2">&quot;`MazeTokenizerModular.n_tokens` has been removed. Use `len(maze_dataset.VOCAB_LIST)` instead.&quot;</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>        <span class="p">)</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>    <span class="nd">@property</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>    <span class="k">def</span> <span class="nf">padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>        <span class="k">return</span> <span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PADDING</span><span class="p">]</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>    <span class="c1"># conversion functions</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>    <span class="c1"># ============================================================</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>    <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>        <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts maze into a list of tokens.&quot;&quot;&quot;</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>    <span class="k">def</span> <span class="nf">coords_to_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span> <span class="o">|</span> <span class="n">Coord</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>            <span class="n">flatten</span><span class="p">(</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>            <span class="p">)</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a>        <span class="p">)</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>    <span class="k">def</span> <span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a>            <span class="s2">&quot;`MazeTokenizerModular.strings_to_coords` only supports legacy UT strings.&quot;</span><span class="p">,</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>            <span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>        <span class="p">)</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>        <span class="k">return</span> <span class="n">strings_to_coords</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">)</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;encode a string or list of strings into a list of tokens&quot;&quot;&quot;</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a>                <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a>                <span class="sa">f</span><span class="s2">&quot;in `VOCAB`.&quot;</span><span class="p">,</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>        <span class="n">token_ids</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;decode a list of tokens into a string or list of strings&quot;&quot;&quot;</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>            <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB_LIST</span><span class="p">[</span><span class="n">token_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">token_id</span> <span class="ow">in</span> <span class="n">token_ids</span><span class="p">]</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token index &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39; not found in `VOCAB`.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>        <span class="k">if</span> <span class="n">joined_tokens</span><span class="p">:</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>            <span class="k">return</span> <span class="n">output</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a><span class="n">_ALL_TOKENIZER_HASHES</span><span class="p">:</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a><span class="s2">&quot;private array of all tokenizer hashes&quot;</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a><span class="n">_TOKENIZER_HASHES_PATH</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;MazeTokenizerModular_hashes.npz&quot;</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a><span class="s2">&quot;path to where we expect the hashes file -- in the same dir as this file, by default. change with `set_tokenizer_hashes_path`&quot;</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a><span class="k">def</span> <span class="nf">set_tokenizer_hashes_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;set path to tokenizer hashes, and reload the hashes if needed</span>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a><span class="sd">    the hashes are expected to be stored in and read from `_TOKENIZER_HASHES_PATH`,</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a><span class="sd">    which by default is `Path(__file__).parent / &quot;MazeTokenizerModular_hashes.npz&quot;` or in this file&#39;s directory.</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a><span class="sd">    However, this might not always work, so we provide a way to change this.</span>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a>    <span class="k">global</span> <span class="n">_TOKENIZER_HASHES_PATH</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a>    <span class="k">global</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;MazeTokenizerModular_hashes.npz&quot;</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;could not find maze tokenizer hashes file at: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a>    <span class="k">if</span> <span class="n">_TOKENIZER_HASHES_PATH</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span> <span class="o">!=</span> <span class="n">path</span><span class="o">.</span><span class="n">absolute</span><span class="p">():</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a>        <span class="c1"># reload if they aren&#39;t equal</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a>        <span class="n">_TOKENIZER_HASHES_PATH</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a>        <span class="n">_ALL_TOKENIZER_HASHES</span> <span class="o">=</span> <span class="n">_load_tokenizer_hashes</span><span class="p">()</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a>        <span class="c1"># always set to new path</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a>        <span class="n">_TOKENIZER_HASHES_PATH</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a><span class="k">def</span> <span class="nf">_load_tokenizer_hashes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]:</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the sorted list of `all_tokenizers.get_all_tokenizers()` hashes from disk.&quot;&quot;&quot;</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a>    <span class="k">global</span> <span class="n">_TOKENIZER_HASHES_PATH</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>        <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">_TOKENIZER_HASHES_PATH</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="s2">&quot;hashes&quot;</span><span class="p">]</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>    <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a>            <span class="s2">&quot;Tokenizers hashes cannot be loaded. To fix this, run&quot;</span><span class="p">,</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a>            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`python -m maze-dataset.tokenization.save_hashes` which will save the hashes to&quot;</span><span class="p">,</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`data/MazeTokenizerModular_hashes.npz`&quot;</span><span class="p">,</span>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a>            <span class="s2">&quot;relative to the current working directory -- this is where the code looks for them.&quot;</span><span class="p">,</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a>        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a><span class="k">def</span> <span class="nf">get_all_tokenizer_hashes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]:</span>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a>    <span class="k">global</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a>        <span class="n">got_tokenizers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_ALL_TOKENIZER_HASHES</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a>        <span class="k">if</span> <span class="n">got_tokenizers</span><span class="p">:</span>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a>            <span class="k">return</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a>            <span class="n">_ALL_TOKENIZER_HASHES</span> <span class="o">=</span> <span class="n">_load_tokenizer_hashes</span><span class="p">()</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a>    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a>        <span class="n">_ALL_TOKENIZER_HASHES</span> <span class="o">=</span> <span class="n">_load_tokenizer_hashes</span><span class="p">()</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a>    <span class="k">return</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span></pre></div>


                <br/>
            </section>
                <section id="TokenError">
                            <input id="TokenError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TokenError</span><wbr>(<span class="base">builtins.ValueError</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TokenError-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L62-L65" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TokenError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TokenError-63"><a href="#TokenError-63"><span class="linenos">63</span></a><span class="k">class</span> <span class="nc">TokenError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
</span><span id="TokenError-64"><a href="#TokenError-64"><span class="linenos">64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;error for tokenization&quot;&quot;&quot;</span>
</span><span id="TokenError-65"><a href="#TokenError-65"><span class="linenos">65</span></a>
</span><span id="TokenError-66"><a href="#TokenError-66"><span class="linenos">66</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>error for tokenization</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.ValueError</dt>
                                <dd id="TokenError.__init__" class="function">ValueError</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TokenError.with_traceback" class="function">with_traceback</dd>
                <dd id="TokenError.add_note" class="function">add_note</dd>
                <dd id="TokenError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TokenizationMode">
                            <input id="TokenizationMode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TokenizationMode</span><wbr>(<span class="base">enum.Enum</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TokenizationMode-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L68-L93" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TokenizationMode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TokenizationMode-69"><a href="#TokenizationMode-69"><span class="linenos">69</span></a><span class="k">class</span> <span class="nc">TokenizationMode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="TokenizationMode-70"><a href="#TokenizationMode-70"><span class="linenos">70</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;legacy tokenization modes</span>
</span><span id="TokenizationMode-71"><a href="#TokenizationMode-71"><span class="linenos">71</span></a>
</span><span id="TokenizationMode-72"><a href="#TokenizationMode-72"><span class="linenos">72</span></a><span class="sd">    &gt; [!CAUTION]</span>
</span><span id="TokenizationMode-73"><a href="#TokenizationMode-73"><span class="linenos">73</span></a><span class="sd">    &gt; Legacy mode of tokenization. will still be around in future releases, but is no longer recommended for use.</span>
</span><span id="TokenizationMode-74"><a href="#TokenizationMode-74"><span class="linenos">74</span></a><span class="sd">    &gt; Use `MazeTokenizerModular` instead.</span>
</span><span id="TokenizationMode-75"><a href="#TokenizationMode-75"><span class="linenos">75</span></a>
</span><span id="TokenizationMode-76"><a href="#TokenizationMode-76"><span class="linenos">76</span></a><span class="sd">    # Abbreviations:</span>
</span><span id="TokenizationMode-77"><a href="#TokenizationMode-77"><span class="linenos">77</span></a><span class="sd">    - `AOTP`: Ajacency list, Origin, Target, Path</span>
</span><span id="TokenizationMode-78"><a href="#TokenizationMode-78"><span class="linenos">78</span></a><span class="sd">    - `UT`: Unique Token (for each coordiate)</span>
</span><span id="TokenizationMode-79"><a href="#TokenizationMode-79"><span class="linenos">79</span></a><span class="sd">    - `CTT`: Coordinate Tuple Tokens (each coordinate is tokenized as a tuple of integers)</span>
</span><span id="TokenizationMode-80"><a href="#TokenizationMode-80"><span class="linenos">80</span></a>
</span><span id="TokenizationMode-81"><a href="#TokenizationMode-81"><span class="linenos">81</span></a><span class="sd">    # Modes:</span>
</span><span id="TokenizationMode-82"><a href="#TokenizationMode-82"><span class="linenos">82</span></a><span class="sd">    - `AOTP_UT_rasterized`: the &quot;classic&quot; mode: assigning tokens to each coordinate is done via rasterization</span>
</span><span id="TokenizationMode-83"><a href="#TokenizationMode-83"><span class="linenos">83</span></a><span class="sd">        example: for a 3x3 maze, token order is `(0,0), (0,1), (0,2), (1,0), (1,1), (1,2), (2,0), (2,1), (2,2)`</span>
</span><span id="TokenizationMode-84"><a href="#TokenizationMode-84"><span class="linenos">84</span></a><span class="sd">    - `AOTP_UT_uniform`: new mode, where a 3x3 tokenization scheme and 5x5 tokenizations scheme are compatible</span>
</span><span id="TokenizationMode-85"><a href="#TokenizationMode-85"><span class="linenos">85</span></a><span class="sd">        uses `corner_first_ndindex` function to order the tokens</span>
</span><span id="TokenizationMode-86"><a href="#TokenizationMode-86"><span class="linenos">86</span></a><span class="sd">    - `AOTP_CTT_indexed`: each coordinate is a tuple of integers</span>
</span><span id="TokenizationMode-87"><a href="#TokenizationMode-87"><span class="linenos">87</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TokenizationMode-88"><a href="#TokenizationMode-88"><span class="linenos">88</span></a>
</span><span id="TokenizationMode-89"><a href="#TokenizationMode-89"><span class="linenos">89</span></a>    <span class="n">AOTP_UT_rasterized</span> <span class="o">=</span> <span class="s2">&quot;AOTP_UT_rasterized&quot;</span>
</span><span id="TokenizationMode-90"><a href="#TokenizationMode-90"><span class="linenos">90</span></a>    <span class="n">AOTP_UT_uniform</span> <span class="o">=</span> <span class="s2">&quot;AOTP_UT_uniform&quot;</span>
</span><span id="TokenizationMode-91"><a href="#TokenizationMode-91"><span class="linenos">91</span></a>    <span class="n">AOTP_CTT_indexed</span> <span class="o">=</span> <span class="s2">&quot;AOTP_CTT_indexed&quot;</span>
</span><span id="TokenizationMode-92"><a href="#TokenizationMode-92"><span class="linenos">92</span></a>
</span><span id="TokenizationMode-93"><a href="#TokenizationMode-93"><span class="linenos">93</span></a>    <span class="k">def</span> <span class="nf">to_legacy_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="TokenizationMode-94"><a href="#TokenizationMode-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="n">MazeTokenizer</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_grid_size</span><span class="o">=</span><span class="n">max_grid_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>legacy tokenization modes</p>

<div class="alert caution">
<em>Caution</em>
<p>Legacy mode of tokenization. will still be around in future releases, but is no longer recommended for use.
  Use <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> instead.</p>
</div>

<h1 id="abbreviations">Abbreviations:</h1>

<ul>
<li><code>AOTP</code>: Ajacency list, Origin, Target, Path</li>
<li><code>UT</code>: Unique Token (for each coordiate)</li>
<li><code>CTT</code>: Coordinate Tuple Tokens (each coordinate is tokenized as a tuple of integers)</li>
</ul>

<h1 id="modes">Modes:</h1>

<ul>
<li><code><a href="#TokenizationMode.AOTP_UT_rasterized">AOTP_UT_rasterized</a></code>: the "classic" mode: assigning tokens to each coordinate is done via rasterization
example: for a 3x3 maze, token order is <code>(0,0), (0,1), (0,2), (1,0), (1,1), (1,2), (2,0), (2,1), (2,2)</code></li>
<li><code><a href="#TokenizationMode.AOTP_UT_uniform">AOTP_UT_uniform</a></code>: new mode, where a 3x3 tokenization scheme and 5x5 tokenizations scheme are compatible
uses <code>corner_first_ndindex</code> function to order the tokens</li>
<li><code><a href="#TokenizationMode.AOTP_CTT_indexed">AOTP_CTT_indexed</a></code>: each coordinate is a tuple of integers</li>
</ul>
</div>


                            <div id="TokenizationMode.AOTP_UT_rasterized" class="classattr">
                                <div class="attr variable">
            <span class="name">AOTP_UT_rasterized</span>        =
<span class="default_value">&lt;<a href="#TokenizationMode.AOTP_UT_rasterized">TokenizationMode.AOTP_UT_rasterized</a>: &#39;AOTP_UT_rasterized&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TokenizationMode.AOTP_UT_rasterized"></a>
    
    

                            </div>
                            <div id="TokenizationMode.AOTP_UT_uniform" class="classattr">
                                <div class="attr variable">
            <span class="name">AOTP_UT_uniform</span>        =
<span class="default_value">&lt;<a href="#TokenizationMode.AOTP_UT_uniform">TokenizationMode.AOTP_UT_uniform</a>: &#39;AOTP_UT_uniform&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TokenizationMode.AOTP_UT_uniform"></a>
    
    

                            </div>
                            <div id="TokenizationMode.AOTP_CTT_indexed" class="classattr">
                                <div class="attr variable">
            <span class="name">AOTP_CTT_indexed</span>        =
<span class="default_value">&lt;<a href="#TokenizationMode.AOTP_CTT_indexed">TokenizationMode.AOTP_CTT_indexed</a>: &#39;AOTP_CTT_indexed&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#TokenizationMode.AOTP_CTT_indexed"></a>
    
    

                            </div>
                            <div id="TokenizationMode.to_legacy_tokenizer" class="classattr">
                                        <input id="TokenizationMode.to_legacy_tokenizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_legacy_tokenizer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TokenizationMode.to_legacy_tokenizer-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L92-L93" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TokenizationMode.to_legacy_tokenizer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TokenizationMode.to_legacy_tokenizer-93"><a href="#TokenizationMode.to_legacy_tokenizer-93"><span class="linenos">93</span></a>    <span class="k">def</span> <span class="nf">to_legacy_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="TokenizationMode.to_legacy_tokenizer-94"><a href="#TokenizationMode.to_legacy_tokenizer-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="n">MazeTokenizer</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_grid_size</span><span class="o">=</span><span class="n">max_grid_size</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="TokenizationMode.name" class="variable">name</dd>
                <dd id="TokenizationMode.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="is_UT">
                            <input id="is_UT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_UT</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">tokenization_mode</span><span class="p">:</span> <span class="n"><a href="#TokenizationMode">TokenizationMode</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="is_UT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L104-L108" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#is_UT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_UT-105"><a href="#is_UT-105"><span class="linenos">105</span></a><span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="p">:</span> <span class="n">TokenizationMode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="is_UT-106"><a href="#is_UT-106"><span class="linenos">106</span></a>    <span class="k">return</span> <span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="is_UT-107"><a href="#is_UT-107"><span class="linenos">107</span></a>        <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="is_UT-108"><a href="#is_UT-108"><span class="linenos">108</span></a>        <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="is_UT-109"><a href="#is_UT-109"><span class="linenos">109</span></a>    <span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="get_tokens_up_to_path_start">
                            <input id="get_tokens_up_to_path_start-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tokens_up_to_path_start</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">include_start_coord</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">tokenization_mode</span><span class="p">:</span> <span class="n"><a href="#TokenizationMode">TokenizationMode</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#TokenizationMode.AOTP_UT_uniform">TokenizationMode.AOTP_UT_uniform</a></span><span class="p">:</span> <span class="s1">&#39;AOTP_UT_uniform&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_tokens_up_to_path_start-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L111-L129" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_tokens_up_to_path_start"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_tokens_up_to_path_start-112"><a href="#get_tokens_up_to_path_start-112"><span class="linenos">112</span></a><span class="k">def</span> <span class="nf">get_tokens_up_to_path_start</span><span class="p">(</span>
</span><span id="get_tokens_up_to_path_start-113"><a href="#get_tokens_up_to_path_start-113"><span class="linenos">113</span></a>    <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="get_tokens_up_to_path_start-114"><a href="#get_tokens_up_to_path_start-114"><span class="linenos">114</span></a>    <span class="n">include_start_coord</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="get_tokens_up_to_path_start-115"><a href="#get_tokens_up_to_path_start-115"><span class="linenos">115</span></a>    <span class="n">tokenization_mode</span><span class="p">:</span> <span class="n">TokenizationMode</span> <span class="o">=</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="get_tokens_up_to_path_start-116"><a href="#get_tokens_up_to_path_start-116"><span class="linenos">116</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_tokens_up_to_path_start-117"><a href="#get_tokens_up_to_path_start-117"><span class="linenos">117</span></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="get_tokens_up_to_path_start-118"><a href="#get_tokens_up_to_path_start-118"><span class="linenos">118</span></a>        <span class="s2">&quot;`maze_tokenizer.get_tokens_up_to_path_start` will be deprecated for a `MazeTokenizerModular`-compatible function in a future release.&quot;</span><span class="p">,</span>
</span><span id="get_tokens_up_to_path_start-119"><a href="#get_tokens_up_to_path_start-119"><span class="linenos">119</span></a>        <span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="get_tokens_up_to_path_start-120"><a href="#get_tokens_up_to_path_start-120"><span class="linenos">120</span></a>    <span class="p">)</span>
</span><span id="get_tokens_up_to_path_start-121"><a href="#get_tokens_up_to_path_start-121"><span class="linenos">121</span></a>    <span class="n">path_start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="get_tokens_up_to_path_start-122"><a href="#get_tokens_up_to_path_start-122"><span class="linenos">122</span></a>    <span class="k">if</span> <span class="n">include_start_coord</span><span class="p">:</span>
</span><span id="get_tokens_up_to_path_start-123"><a href="#get_tokens_up_to_path_start-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">is_UT</span><span class="p">(</span><span class="n">tokenization_mode</span><span class="p">):</span>
</span><span id="get_tokens_up_to_path_start-124"><a href="#get_tokens_up_to_path_start-124"><span class="linenos">124</span></a>            <span class="k">return</span> <span class="n">tokens</span><span class="p">[:</span> <span class="n">path_start_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="get_tokens_up_to_path_start-125"><a href="#get_tokens_up_to_path_start-125"><span class="linenos">125</span></a>        <span class="k">elif</span> <span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="get_tokens_up_to_path_start-126"><a href="#get_tokens_up_to_path_start-126"><span class="linenos">126</span></a>            <span class="k">return</span> <span class="n">tokens</span><span class="p">[:</span> <span class="n">path_start_idx</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span>
</span><span id="get_tokens_up_to_path_start-127"><a href="#get_tokens_up_to_path_start-127"><span class="linenos">127</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="get_tokens_up_to_path_start-128"><a href="#get_tokens_up_to_path_start-128"><span class="linenos">128</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode: </span><span class="si">{</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_tokens_up_to_path_start-129"><a href="#get_tokens_up_to_path_start-129"><span class="linenos">129</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="get_tokens_up_to_path_start-130"><a href="#get_tokens_up_to_path_start-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="n">tokens</span><span class="p">[:</span><span class="n">path_start_idx</span><span class="p">]</span>
</span></pre></div>


    

                </section>
                <section id="MazeTokenizer">
                            <input id="MazeTokenizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(properties_to_serialize=_MAZETOKENIZER_PROPERTIES_TO_SERIALIZE, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">MazeTokenizer</span><wbr>(<span class="base">muutils.json_serialize.serializable_dataclass.SerializableDataclass</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L142-L459" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer-143"><a href="#MazeTokenizer-143"><span class="linenos">143</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span>
</span><span id="MazeTokenizer-144"><a href="#MazeTokenizer-144"><span class="linenos">144</span></a>    <span class="n">properties_to_serialize</span><span class="o">=</span><span class="n">_MAZETOKENIZER_PROPERTIES_TO_SERIALIZE</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span>
</span><span id="MazeTokenizer-145"><a href="#MazeTokenizer-145"><span class="linenos">145</span></a><span class="p">)</span>
</span><span id="MazeTokenizer-146"><a href="#MazeTokenizer-146"><span class="linenos">146</span></a><span class="k">class</span> <span class="nc">MazeTokenizer</span><span class="p">(</span><span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="MazeTokenizer-147"><a href="#MazeTokenizer-147"><span class="linenos">147</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;LEGACY Tokenizer for mazes</span>
</span><span id="MazeTokenizer-148"><a href="#MazeTokenizer-148"><span class="linenos">148</span></a>
</span><span id="MazeTokenizer-149"><a href="#MazeTokenizer-149"><span class="linenos">149</span></a><span class="sd">    &gt; [!CAUTION]</span>
</span><span id="MazeTokenizer-150"><a href="#MazeTokenizer-150"><span class="linenos">150</span></a><span class="sd">    &gt; `MazeTokenizerModular` is the new standard for tokenization. This class is no longer recommended</span>
</span><span id="MazeTokenizer-151"><a href="#MazeTokenizer-151"><span class="linenos">151</span></a><span class="sd">    &gt; for use, but will remain for compatibility with existing code.</span>
</span><span id="MazeTokenizer-152"><a href="#MazeTokenizer-152"><span class="linenos">152</span></a>
</span><span id="MazeTokenizer-153"><a href="#MazeTokenizer-153"><span class="linenos">153</span></a><span class="sd">    # Parameters:</span>
</span><span id="MazeTokenizer-154"><a href="#MazeTokenizer-154"><span class="linenos">154</span></a><span class="sd">     - `tokenization_mode: TokenizationMode`</span>
</span><span id="MazeTokenizer-155"><a href="#MazeTokenizer-155"><span class="linenos">155</span></a><span class="sd">        mode of tokenization. required.</span>
</span><span id="MazeTokenizer-156"><a href="#MazeTokenizer-156"><span class="linenos">156</span></a><span class="sd">    - `max_grid_size: int | None`</span>
</span><span id="MazeTokenizer-157"><a href="#MazeTokenizer-157"><span class="linenos">157</span></a><span class="sd">        maximum grid size. required for actually turning text tokens to numerical tokens, but not for moving between coordinates/mazes and text</span>
</span><span id="MazeTokenizer-158"><a href="#MazeTokenizer-158"><span class="linenos">158</span></a>
</span><span id="MazeTokenizer-159"><a href="#MazeTokenizer-159"><span class="linenos">159</span></a><span class="sd">    # Properties</span>
</span><span id="MazeTokenizer-160"><a href="#MazeTokenizer-160"><span class="linenos">160</span></a><span class="sd">    - `name: str`</span>
</span><span id="MazeTokenizer-161"><a href="#MazeTokenizer-161"><span class="linenos">161</span></a><span class="sd">        auto-generated name of the tokenizer from mode and size</span>
</span><span id="MazeTokenizer-162"><a href="#MazeTokenizer-162"><span class="linenos">162</span></a>
</span><span id="MazeTokenizer-163"><a href="#MazeTokenizer-163"><span class="linenos">163</span></a><span class="sd">    ## Conditional Properties</span>
</span><span id="MazeTokenizer-164"><a href="#MazeTokenizer-164"><span class="linenos">164</span></a>
</span><span id="MazeTokenizer-165"><a href="#MazeTokenizer-165"><span class="linenos">165</span></a><span class="sd">    - `node_strings_map: Mapping[CoordTup, str]`</span>
</span><span id="MazeTokenizer-166"><a href="#MazeTokenizer-166"><span class="linenos">166</span></a><span class="sd">        map from node to string. This returns a `muutils.kappa.Kappa` object which you can use like a dictionary. returns `None` if not a `UT` mode</span>
</span><span id="MazeTokenizer-167"><a href="#MazeTokenizer-167"><span class="linenos">167</span></a>
</span><span id="MazeTokenizer-168"><a href="#MazeTokenizer-168"><span class="linenos">168</span></a><span class="sd">    these all return `None` if `max_grid_size` is `None`.</span>
</span><span id="MazeTokenizer-169"><a href="#MazeTokenizer-169"><span class="linenos">169</span></a><span class="sd">    Prepend `_` to the name to get a guaranteed type, and cause an exception if `max_grid_size` is `None`</span>
</span><span id="MazeTokenizer-170"><a href="#MazeTokenizer-170"><span class="linenos">170</span></a>
</span><span id="MazeTokenizer-171"><a href="#MazeTokenizer-171"><span class="linenos">171</span></a><span class="sd">    - `token_arr: list[str]`</span>
</span><span id="MazeTokenizer-172"><a href="#MazeTokenizer-172"><span class="linenos">172</span></a><span class="sd">        list of tokens, in order of their indices in the vocabulary</span>
</span><span id="MazeTokenizer-173"><a href="#MazeTokenizer-173"><span class="linenos">173</span></a><span class="sd">    - `tokenizer_map: Mapping[str, int]`</span>
</span><span id="MazeTokenizer-174"><a href="#MazeTokenizer-174"><span class="linenos">174</span></a><span class="sd">        map from token to index</span>
</span><span id="MazeTokenizer-175"><a href="#MazeTokenizer-175"><span class="linenos">175</span></a><span class="sd">    - `vocab_size: int`</span>
</span><span id="MazeTokenizer-176"><a href="#MazeTokenizer-176"><span class="linenos">176</span></a><span class="sd">        size of the vocabulary</span>
</span><span id="MazeTokenizer-177"><a href="#MazeTokenizer-177"><span class="linenos">177</span></a><span class="sd">    - `padding_token_index: int`</span>
</span><span id="MazeTokenizer-178"><a href="#MazeTokenizer-178"><span class="linenos">178</span></a><span class="sd">        index of the padding token</span>
</span><span id="MazeTokenizer-179"><a href="#MazeTokenizer-179"><span class="linenos">179</span></a>
</span><span id="MazeTokenizer-180"><a href="#MazeTokenizer-180"><span class="linenos">180</span></a><span class="sd">    # Methods</span>
</span><span id="MazeTokenizer-181"><a href="#MazeTokenizer-181"><span class="linenos">181</span></a><span class="sd">    - `coords_to_strings(coords: list[CoordTup]) -&gt; list[str]`</span>
</span><span id="MazeTokenizer-182"><a href="#MazeTokenizer-182"><span class="linenos">182</span></a><span class="sd">        convert a list of coordinates to a list of tokens. Optionally except, skip, or ignore non-coordinates</span>
</span><span id="MazeTokenizer-183"><a href="#MazeTokenizer-183"><span class="linenos">183</span></a><span class="sd">    - `strings_to_coords(strings: list[str]) -&gt; list[CoordTup]`</span>
</span><span id="MazeTokenizer-184"><a href="#MazeTokenizer-184"><span class="linenos">184</span></a><span class="sd">        convert a list of tokens to a list of coordinates. Optionally except, skip, or ignore non-coordinates</span>
</span><span id="MazeTokenizer-185"><a href="#MazeTokenizer-185"><span class="linenos">185</span></a>
</span><span id="MazeTokenizer-186"><a href="#MazeTokenizer-186"><span class="linenos">186</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-187"><a href="#MazeTokenizer-187"><span class="linenos">187</span></a>
</span><span id="MazeTokenizer-188"><a href="#MazeTokenizer-188"><span class="linenos">188</span></a>    <span class="c1"># parameters</span>
</span><span id="MazeTokenizer-189"><a href="#MazeTokenizer-189"><span class="linenos">189</span></a>    <span class="c1"># ============================================================</span>
</span><span id="MazeTokenizer-190"><a href="#MazeTokenizer-190"><span class="linenos">190</span></a>
</span><span id="MazeTokenizer-191"><a href="#MazeTokenizer-191"><span class="linenos">191</span></a>    <span class="n">tokenization_mode</span><span class="p">:</span> <span class="n">TokenizationMode</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="MazeTokenizer-192"><a href="#MazeTokenizer-192"><span class="linenos">192</span></a>        <span class="n">default</span><span class="o">=</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer-193"><a href="#MazeTokenizer-193"><span class="linenos">193</span></a>        <span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="MazeTokenizer-194"><a href="#MazeTokenizer-194"><span class="linenos">194</span></a>        <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">TokenizationMode</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;tokenization_mode&quot;</span><span class="p">]],</span>
</span><span id="MazeTokenizer-195"><a href="#MazeTokenizer-195"><span class="linenos">195</span></a>    <span class="p">)</span>
</span><span id="MazeTokenizer-196"><a href="#MazeTokenizer-196"><span class="linenos">196</span></a>
</span><span id="MazeTokenizer-197"><a href="#MazeTokenizer-197"><span class="linenos">197</span></a>    <span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="MazeTokenizer-198"><a href="#MazeTokenizer-198"><span class="linenos">198</span></a>
</span><span id="MazeTokenizer-199"><a href="#MazeTokenizer-199"><span class="linenos">199</span></a>    <span class="c1"># properties</span>
</span><span id="MazeTokenizer-200"><a href="#MazeTokenizer-200"><span class="linenos">200</span></a>    <span class="c1"># ============================================================</span>
</span><span id="MazeTokenizer-201"><a href="#MazeTokenizer-201"><span class="linenos">201</span></a>
</span><span id="MazeTokenizer-202"><a href="#MazeTokenizer-202"><span class="linenos">202</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer-203"><a href="#MazeTokenizer-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizer-204"><a href="#MazeTokenizer-204"><span class="linenos">204</span></a>        <span class="n">max_grid_size_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeTokenizer-205"><a href="#MazeTokenizer-205"><span class="linenos">205</span></a>            <span class="sa">f</span><span class="s2">&quot;-g</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="MazeTokenizer-206"><a href="#MazeTokenizer-206"><span class="linenos">206</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizer-207"><a href="#MazeTokenizer-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;maze_tokenizer-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="o">.</span><span class="n">value</span><span class="si">}{</span><span class="n">max_grid_size_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer-208"><a href="#MazeTokenizer-208"><span class="linenos">208</span></a>
</span><span id="MazeTokenizer-209"><a href="#MazeTokenizer-209"><span class="linenos">209</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-210"><a href="#MazeTokenizer-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">_node_strings_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="MazeTokenizer-211"><a href="#MazeTokenizer-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map a coordinate to a token&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-212"><a href="#MazeTokenizer-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer-213"><a href="#MazeTokenizer-213"><span class="linenos">213</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer-214"><a href="#MazeTokenizer-214"><span class="linenos">214</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer-215"><a href="#MazeTokenizer-215"><span class="linenos">215</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizer-216"><a href="#MazeTokenizer-216"><span class="linenos">216</span></a>            <span class="k">return</span> <span class="n">Kappa</span><span class="p">(</span><span class="n">_coord_to_strings_UT</span><span class="p">)</span>
</span><span id="MazeTokenizer-217"><a href="#MazeTokenizer-217"><span class="linenos">217</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="MazeTokenizer-218"><a href="#MazeTokenizer-218"><span class="linenos">218</span></a>            <span class="k">return</span> <span class="n">Kappa</span><span class="p">(</span><span class="n">_coord_to_strings_indexed</span><span class="p">)</span>
</span><span id="MazeTokenizer-219"><a href="#MazeTokenizer-219"><span class="linenos">219</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer-220"><a href="#MazeTokenizer-220"><span class="linenos">220</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer-221"><a href="#MazeTokenizer-221"><span class="linenos">221</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-222"><a href="#MazeTokenizer-222"><span class="linenos">222</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-223"><a href="#MazeTokenizer-223"><span class="linenos">223</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-224"><a href="#MazeTokenizer-224"><span class="linenos">224</span></a>
</span><span id="MazeTokenizer-225"><a href="#MazeTokenizer-225"><span class="linenos">225</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-226"><a href="#MazeTokenizer-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">node_strings_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-227"><a href="#MazeTokenizer-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map a coordinate to a token&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-228"><a href="#MazeTokenizer-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer-229"><a href="#MazeTokenizer-229"><span class="linenos">229</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer-230"><a href="#MazeTokenizer-230"><span class="linenos">230</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer-231"><a href="#MazeTokenizer-231"><span class="linenos">231</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizer-232"><a href="#MazeTokenizer-232"><span class="linenos">232</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer-233"><a href="#MazeTokenizer-233"><span class="linenos">233</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer-234"><a href="#MazeTokenizer-234"><span class="linenos">234</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_strings_map</span>
</span><span id="MazeTokenizer-235"><a href="#MazeTokenizer-235"><span class="linenos">235</span></a>
</span><span id="MazeTokenizer-236"><a href="#MazeTokenizer-236"><span class="linenos">236</span></a>    <span class="c1"># conditional properties (on max_grid_size existing)</span>
</span><span id="MazeTokenizer-237"><a href="#MazeTokenizer-237"><span class="linenos">237</span></a>    <span class="c1"># ------------------------------------------------------------</span>
</span><span id="MazeTokenizer-238"><a href="#MazeTokenizer-238"><span class="linenos">238</span></a>
</span><span id="MazeTokenizer-239"><a href="#MazeTokenizer-239"><span class="linenos">239</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-240"><a href="#MazeTokenizer-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="nf">_token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizer-241"><a href="#MazeTokenizer-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from index to token&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-242"><a href="#MazeTokenizer-242"><span class="linenos">242</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-243"><a href="#MazeTokenizer-243"><span class="linenos">243</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer-244"><a href="#MazeTokenizer-244"><span class="linenos">244</span></a>                <span class="sa">f</span><span class="s2">&quot;max_grid_size must be specified to use token_arr property: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer-245"><a href="#MazeTokenizer-245"><span class="linenos">245</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-246"><a href="#MazeTokenizer-246"><span class="linenos">246</span></a>
</span><span id="MazeTokenizer-247"><a href="#MazeTokenizer-247"><span class="linenos">247</span></a>        <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="MazeTokenizer-248"><a href="#MazeTokenizer-248"><span class="linenos">248</span></a>
</span><span id="MazeTokenizer-249"><a href="#MazeTokenizer-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer-250"><a href="#MazeTokenizer-250"><span class="linenos">250</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer-251"><a href="#MazeTokenizer-251"><span class="linenos">251</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer-252"><a href="#MazeTokenizer-252"><span class="linenos">252</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizer-253"><a href="#MazeTokenizer-253"><span class="linenos">253</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="MazeTokenizer-254"><a href="#MazeTokenizer-254"><span class="linenos">254</span></a>                <span class="p">[</span>
</span><span id="MazeTokenizer-255"><a href="#MazeTokenizer-255"><span class="linenos">255</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_node_strings_map</span><span class="p">[</span><span class="n">coord</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MazeTokenizer-256"><a href="#MazeTokenizer-256"><span class="linenos">256</span></a>                    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">_NDINDEX_FUNC_MAP</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="p">](</span>
</span><span id="MazeTokenizer-257"><a href="#MazeTokenizer-257"><span class="linenos">257</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span>
</span><span id="MazeTokenizer-258"><a href="#MazeTokenizer-258"><span class="linenos">258</span></a>                    <span class="p">)</span>
</span><span id="MazeTokenizer-259"><a href="#MazeTokenizer-259"><span class="linenos">259</span></a>                <span class="p">]</span>
</span><span id="MazeTokenizer-260"><a href="#MazeTokenizer-260"><span class="linenos">260</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-261"><a href="#MazeTokenizer-261"><span class="linenos">261</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="MazeTokenizer-262"><a href="#MazeTokenizer-262"><span class="linenos">262</span></a>            <span class="c1"># TODO: this is hacky, but we don&#39;t want to modify the original SPECIAL_TOKENS since that will break old models</span>
</span><span id="MazeTokenizer-263"><a href="#MazeTokenizer-263"><span class="linenos">263</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="MazeTokenizer-264"><a href="#MazeTokenizer-264"><span class="linenos">264</span></a>                <span class="p">[</span>
</span><span id="MazeTokenizer-265"><a href="#MazeTokenizer-265"><span class="linenos">265</span></a>                    <span class="s2">&quot;(&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-266"><a href="#MazeTokenizer-266"><span class="linenos">266</span></a>                    <span class="s2">&quot;,&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-267"><a href="#MazeTokenizer-267"><span class="linenos">267</span></a>                    <span class="s2">&quot;)&quot;</span><span class="p">,</span>  <span class="c1"># new special chars</span>
</span><span id="MazeTokenizer-268"><a href="#MazeTokenizer-268"><span class="linenos">268</span></a>                    <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="p">)),</span>  <span class="c1"># numbers</span>
</span><span id="MazeTokenizer-269"><a href="#MazeTokenizer-269"><span class="linenos">269</span></a>                <span class="p">]</span>
</span><span id="MazeTokenizer-270"><a href="#MazeTokenizer-270"><span class="linenos">270</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-271"><a href="#MazeTokenizer-271"><span class="linenos">271</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer-272"><a href="#MazeTokenizer-272"><span class="linenos">272</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer-273"><a href="#MazeTokenizer-273"><span class="linenos">273</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-274"><a href="#MazeTokenizer-274"><span class="linenos">274</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-275"><a href="#MazeTokenizer-275"><span class="linenos">275</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-276"><a href="#MazeTokenizer-276"><span class="linenos">276</span></a>
</span><span id="MazeTokenizer-277"><a href="#MazeTokenizer-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="MazeTokenizer-278"><a href="#MazeTokenizer-278"><span class="linenos">278</span></a>
</span><span id="MazeTokenizer-279"><a href="#MazeTokenizer-279"><span class="linenos">279</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-280"><a href="#MazeTokenizer-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-281"><a href="#MazeTokenizer-281"><span class="linenos">281</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-282"><a href="#MazeTokenizer-282"><span class="linenos">282</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer-283"><a href="#MazeTokenizer-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span>
</span><span id="MazeTokenizer-284"><a href="#MazeTokenizer-284"><span class="linenos">284</span></a>
</span><span id="MazeTokenizer-285"><a href="#MazeTokenizer-285"><span class="linenos">285</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-286"><a href="#MazeTokenizer-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">_tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer-287"><a href="#MazeTokenizer-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from token to index&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-288"><a href="#MazeTokenizer-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">token</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span><span class="p">)}</span>
</span><span id="MazeTokenizer-289"><a href="#MazeTokenizer-289"><span class="linenos">289</span></a>
</span><span id="MazeTokenizer-290"><a href="#MazeTokenizer-290"><span class="linenos">290</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-291"><a href="#MazeTokenizer-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-292"><a href="#MazeTokenizer-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-293"><a href="#MazeTokenizer-293"><span class="linenos">293</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer-294"><a href="#MazeTokenizer-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer_map</span>
</span><span id="MazeTokenizer-295"><a href="#MazeTokenizer-295"><span class="linenos">295</span></a>
</span><span id="MazeTokenizer-296"><a href="#MazeTokenizer-296"><span class="linenos">296</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer-297"><a href="#MazeTokenizer-297"><span class="linenos">297</span></a>    <span class="k">def</span> <span class="nf">_vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizer-298"><a href="#MazeTokenizer-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span><span class="p">)</span>
</span><span id="MazeTokenizer-299"><a href="#MazeTokenizer-299"><span class="linenos">299</span></a>
</span><span id="MazeTokenizer-300"><a href="#MazeTokenizer-300"><span class="linenos">300</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer-301"><a href="#MazeTokenizer-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-302"><a href="#MazeTokenizer-302"><span class="linenos">302</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-303"><a href="#MazeTokenizer-303"><span class="linenos">303</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer-304"><a href="#MazeTokenizer-304"><span class="linenos">304</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vocab_size</span>
</span><span id="MazeTokenizer-305"><a href="#MazeTokenizer-305"><span class="linenos">305</span></a>
</span><span id="MazeTokenizer-306"><a href="#MazeTokenizer-306"><span class="linenos">306</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer-307"><a href="#MazeTokenizer-307"><span class="linenos">307</span></a>    <span class="k">def</span> <span class="nf">_n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizer-308"><a href="#MazeTokenizer-308"><span class="linenos">308</span></a>        <span class="c1"># TODO: deprecate</span>
</span><span id="MazeTokenizer-309"><a href="#MazeTokenizer-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vocab_size</span>
</span><span id="MazeTokenizer-310"><a href="#MazeTokenizer-310"><span class="linenos">310</span></a>
</span><span id="MazeTokenizer-311"><a href="#MazeTokenizer-311"><span class="linenos">311</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer-312"><a href="#MazeTokenizer-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-313"><a href="#MazeTokenizer-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-314"><a href="#MazeTokenizer-314"><span class="linenos">314</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer-315"><a href="#MazeTokenizer-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_tokens</span>
</span><span id="MazeTokenizer-316"><a href="#MazeTokenizer-316"><span class="linenos">316</span></a>
</span><span id="MazeTokenizer-317"><a href="#MazeTokenizer-317"><span class="linenos">317</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-318"><a href="#MazeTokenizer-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">_padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizer-319"><a href="#MazeTokenizer-319"><span class="linenos">319</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_map</span><span class="p">[</span><span class="n">SPECIAL_TOKENS</span><span class="o">.</span><span class="n">PADDING</span><span class="p">]</span>
</span><span id="MazeTokenizer-320"><a href="#MazeTokenizer-320"><span class="linenos">320</span></a>
</span><span id="MazeTokenizer-321"><a href="#MazeTokenizer-321"><span class="linenos">321</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-322"><a href="#MazeTokenizer-322"><span class="linenos">322</span></a>    <span class="k">def</span> <span class="nf">padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-323"><a href="#MazeTokenizer-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-324"><a href="#MazeTokenizer-324"><span class="linenos">324</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer-325"><a href="#MazeTokenizer-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padding_token_index</span>
</span><span id="MazeTokenizer-326"><a href="#MazeTokenizer-326"><span class="linenos">326</span></a>
</span><span id="MazeTokenizer-327"><a href="#MazeTokenizer-327"><span class="linenos">327</span></a>    <span class="c1"># conversion functions</span>
</span><span id="MazeTokenizer-328"><a href="#MazeTokenizer-328"><span class="linenos">328</span></a>    <span class="c1"># ============================================================</span>
</span><span id="MazeTokenizer-329"><a href="#MazeTokenizer-329"><span class="linenos">329</span></a>
</span><span id="MazeTokenizer-330"><a href="#MazeTokenizer-330"><span class="linenos">330</span></a>    <span class="k">def</span> <span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="MazeTokenizer-331"><a href="#MazeTokenizer-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MazeTokenizer-332"><a href="#MazeTokenizer-332"><span class="linenos">332</span></a>        <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">],</span>
</span><span id="MazeTokenizer-333"><a href="#MazeTokenizer-333"><span class="linenos">333</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-334"><a href="#MazeTokenizer-334"><span class="linenos">334</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizer-335"><a href="#MazeTokenizer-335"><span class="linenos">335</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer-336"><a href="#MazeTokenizer-336"><span class="linenos">336</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer-337"><a href="#MazeTokenizer-337"><span class="linenos">337</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer-338"><a href="#MazeTokenizer-338"><span class="linenos">338</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizer-339"><a href="#MazeTokenizer-339"><span class="linenos">339</span></a>            <span class="k">return</span> <span class="n">coords_to_strings</span><span class="p">(</span>
</span><span id="MazeTokenizer-340"><a href="#MazeTokenizer-340"><span class="linenos">340</span></a>                <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
</span><span id="MazeTokenizer-341"><a href="#MazeTokenizer-341"><span class="linenos">341</span></a>                <span class="n">coord_to_strings_func</span><span class="o">=</span><span class="n">_coord_to_strings_UT</span><span class="p">,</span>
</span><span id="MazeTokenizer-342"><a href="#MazeTokenizer-342"><span class="linenos">342</span></a>                <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">,</span>
</span><span id="MazeTokenizer-343"><a href="#MazeTokenizer-343"><span class="linenos">343</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-344"><a href="#MazeTokenizer-344"><span class="linenos">344</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="MazeTokenizer-345"><a href="#MazeTokenizer-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="n">coords_to_strings</span><span class="p">(</span>
</span><span id="MazeTokenizer-346"><a href="#MazeTokenizer-346"><span class="linenos">346</span></a>                <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
</span><span id="MazeTokenizer-347"><a href="#MazeTokenizer-347"><span class="linenos">347</span></a>                <span class="n">coord_to_strings_func</span><span class="o">=</span><span class="n">_coord_to_strings_indexed</span><span class="p">,</span>
</span><span id="MazeTokenizer-348"><a href="#MazeTokenizer-348"><span class="linenos">348</span></a>                <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">,</span>
</span><span id="MazeTokenizer-349"><a href="#MazeTokenizer-349"><span class="linenos">349</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-350"><a href="#MazeTokenizer-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer-351"><a href="#MazeTokenizer-351"><span class="linenos">351</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer-352"><a href="#MazeTokenizer-352"><span class="linenos">352</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-353"><a href="#MazeTokenizer-353"><span class="linenos">353</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-354"><a href="#MazeTokenizer-354"><span class="linenos">354</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-355"><a href="#MazeTokenizer-355"><span class="linenos">355</span></a>
</span><span id="MazeTokenizer-356"><a href="#MazeTokenizer-356"><span class="linenos">356</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizer-357"><a href="#MazeTokenizer-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="MazeTokenizer-358"><a href="#MazeTokenizer-358"><span class="linenos">358</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MazeTokenizer-359"><a href="#MazeTokenizer-359"><span class="linenos">359</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-360"><a href="#MazeTokenizer-360"><span class="linenos">360</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="MazeTokenizer-361"><a href="#MazeTokenizer-361"><span class="linenos">361</span></a>        <span class="k">return</span> <span class="n">strings_to_coords</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">)</span>
</span><span id="MazeTokenizer-362"><a href="#MazeTokenizer-362"><span class="linenos">362</span></a>
</span><span id="MazeTokenizer-363"><a href="#MazeTokenizer-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer-364"><a href="#MazeTokenizer-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;encode a string or list of strings into a list of tokens&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-365"><a href="#MazeTokenizer-365"><span class="linenos">365</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer-366"><a href="#MazeTokenizer-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MazeTokenizer-367"><a href="#MazeTokenizer-367"><span class="linenos">367</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="MazeTokenizer-368"><a href="#MazeTokenizer-368"><span class="linenos">368</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_map</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</span><span id="MazeTokenizer-369"><a href="#MazeTokenizer-369"><span class="linenos">369</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer-370"><a href="#MazeTokenizer-370"><span class="linenos">370</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="MazeTokenizer-371"><a href="#MazeTokenizer-371"><span class="linenos">371</span></a>                <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-372"><a href="#MazeTokenizer-372"><span class="linenos">372</span></a>                <span class="sa">f</span><span class="s2">&quot;in vocabulary of </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-373"><a href="#MazeTokenizer-373"><span class="linenos">373</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer-374"><a href="#MazeTokenizer-374"><span class="linenos">374</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizer-375"><a href="#MazeTokenizer-375"><span class="linenos">375</span></a>
</span><span id="MazeTokenizer-376"><a href="#MazeTokenizer-376"><span class="linenos">376</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span>
</span><span id="MazeTokenizer-377"><a href="#MazeTokenizer-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MazeTokenizer-378"><a href="#MazeTokenizer-378"><span class="linenos">378</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizer-379"><a href="#MazeTokenizer-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;decode a list of tokens into a string or list of strings&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-380"><a href="#MazeTokenizer-380"><span class="linenos">380</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer-381"><a href="#MazeTokenizer-381"><span class="linenos">381</span></a>            <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>
</span><span id="MazeTokenizer-382"><a href="#MazeTokenizer-382"><span class="linenos">382</span></a>        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer-383"><a href="#MazeTokenizer-383"><span class="linenos">383</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="MazeTokenizer-384"><a href="#MazeTokenizer-384"><span class="linenos">384</span></a>                <span class="sa">f</span><span class="s2">&quot;Token index &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39; not found in vocabulary of length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer-385"><a href="#MazeTokenizer-385"><span class="linenos">385</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizer-386"><a href="#MazeTokenizer-386"><span class="linenos">386</span></a>        <span class="k">if</span> <span class="n">joined_tokens</span><span class="p">:</span>
</span><span id="MazeTokenizer-387"><a href="#MazeTokenizer-387"><span class="linenos">387</span></a>            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="MazeTokenizer-388"><a href="#MazeTokenizer-388"><span class="linenos">388</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer-389"><a href="#MazeTokenizer-389"><span class="linenos">389</span></a>            <span class="k">return</span> <span class="n">output</span>
</span><span id="MazeTokenizer-390"><a href="#MazeTokenizer-390"><span class="linenos">390</span></a>
</span><span id="MazeTokenizer-391"><a href="#MazeTokenizer-391"><span class="linenos">391</span></a>    <span class="c1"># UT-only coordinate stuff</span>
</span><span id="MazeTokenizer-392"><a href="#MazeTokenizer-392"><span class="linenos">392</span></a>    <span class="c1"># ============================================================</span>
</span><span id="MazeTokenizer-393"><a href="#MazeTokenizer-393"><span class="linenos">393</span></a>
</span><span id="MazeTokenizer-394"><a href="#MazeTokenizer-394"><span class="linenos">394</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-395"><a href="#MazeTokenizer-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">coordinate_tokens_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer-396"><a href="#MazeTokenizer-396"><span class="linenos">396</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="MazeTokenizer-397"><a href="#MazeTokenizer-397"><span class="linenos">397</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_UT</span><span class="p">():</span>
</span><span id="MazeTokenizer-398"><a href="#MazeTokenizer-398"><span class="linenos">398</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer-399"><a href="#MazeTokenizer-399"><span class="linenos">399</span></a>                <span class="sa">f</span><span class="s2">&quot;coordinate_tokens_coords is only valid for UT tokenization modes, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer-400"><a href="#MazeTokenizer-400"><span class="linenos">400</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-401"><a href="#MazeTokenizer-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer-402"><a href="#MazeTokenizer-402"><span class="linenos">402</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer-403"><a href="#MazeTokenizer-403"><span class="linenos">403</span></a>                <span class="sa">f</span><span class="s2">&quot;max_grid_size must be specified to use coordinate_tokens: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer-404"><a href="#MazeTokenizer-404"><span class="linenos">404</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer-405"><a href="#MazeTokenizer-405"><span class="linenos">405</span></a>
</span><span id="MazeTokenizer-406"><a href="#MazeTokenizer-406"><span class="linenos">406</span></a>        <span class="n">raw_converted</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strings_to_coords</span><span class="p">(</span>
</span><span id="MazeTokenizer-407"><a href="#MazeTokenizer-407"><span class="linenos">407</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="s2">&quot;include&quot;</span>
</span><span id="MazeTokenizer-408"><a href="#MazeTokenizer-408"><span class="linenos">408</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizer-409"><a href="#MazeTokenizer-409"><span class="linenos">409</span></a>
</span><span id="MazeTokenizer-410"><a href="#MazeTokenizer-410"><span class="linenos">410</span></a>        <span class="c1"># filter out non-coordinates</span>
</span><span id="MazeTokenizer-411"><a href="#MazeTokenizer-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizer-412"><a href="#MazeTokenizer-412"><span class="linenos">412</span></a>            <span class="n">coord</span><span class="p">:</span> <span class="n">i</span>
</span><span id="MazeTokenizer-413"><a href="#MazeTokenizer-413"><span class="linenos">413</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_converted</span><span class="p">)</span>
</span><span id="MazeTokenizer-414"><a href="#MazeTokenizer-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="MazeTokenizer-415"><a href="#MazeTokenizer-415"><span class="linenos">415</span></a>        <span class="p">}</span>
</span><span id="MazeTokenizer-416"><a href="#MazeTokenizer-416"><span class="linenos">416</span></a>
</span><span id="MazeTokenizer-417"><a href="#MazeTokenizer-417"><span class="linenos">417</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer-418"><a href="#MazeTokenizer-418"><span class="linenos">418</span></a>    <span class="k">def</span> <span class="nf">coordinate_tokens_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer-419"><a href="#MazeTokenizer-419"><span class="linenos">419</span></a>        <span class="c1"># checks performed in call</span>
</span><span id="MazeTokenizer-420"><a href="#MazeTokenizer-420"><span class="linenos">420</span></a>        <span class="n">output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeTokenizer-421"><a href="#MazeTokenizer-421"><span class="linenos">421</span></a>
</span><span id="MazeTokenizer-422"><a href="#MazeTokenizer-422"><span class="linenos">422</span></a>        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_tokens_coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MazeTokenizer-423"><a href="#MazeTokenizer-423"><span class="linenos">423</span></a>            <span class="n">_for_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_to_strings</span><span class="p">([</span><span class="n">coord</span><span class="p">])</span>
</span><span id="MazeTokenizer-424"><a href="#MazeTokenizer-424"><span class="linenos">424</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">_for_key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="MazeTokenizer-425"><a href="#MazeTokenizer-425"><span class="linenos">425</span></a>            <span class="n">output</span><span class="p">[</span><span class="n">_for_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="MazeTokenizer-426"><a href="#MazeTokenizer-426"><span class="linenos">426</span></a>
</span><span id="MazeTokenizer-427"><a href="#MazeTokenizer-427"><span class="linenos">427</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="MazeTokenizer-428"><a href="#MazeTokenizer-428"><span class="linenos">428</span></a>
</span><span id="MazeTokenizer-429"><a href="#MazeTokenizer-429"><span class="linenos">429</span></a>    <span class="c1"># other</span>
</span><span id="MazeTokenizer-430"><a href="#MazeTokenizer-430"><span class="linenos">430</span></a>    <span class="c1"># ============================================================</span>
</span><span id="MazeTokenizer-431"><a href="#MazeTokenizer-431"><span class="linenos">431</span></a>
</span><span id="MazeTokenizer-432"><a href="#MazeTokenizer-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeTokenizer-433"><a href="#MazeTokenizer-433"><span class="linenos">433</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns a summary of the tokenization mode&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-434"><a href="#MazeTokenizer-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizer-435"><a href="#MazeTokenizer-435"><span class="linenos">435</span></a>            <span class="s2">&quot;tokenization_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="MazeTokenizer-436"><a href="#MazeTokenizer-436"><span class="linenos">436</span></a>            <span class="s2">&quot;max_grid_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="p">,</span>
</span><span id="MazeTokenizer-437"><a href="#MazeTokenizer-437"><span class="linenos">437</span></a>            <span class="s2">&quot;vocab_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span>
</span><span id="MazeTokenizer-438"><a href="#MazeTokenizer-438"><span class="linenos">438</span></a>        <span class="p">}</span>
</span><span id="MazeTokenizer-439"><a href="#MazeTokenizer-439"><span class="linenos">439</span></a>
</span><span id="MazeTokenizer-440"><a href="#MazeTokenizer-440"><span class="linenos">440</span></a>    <span class="k">def</span> <span class="nf">is_AOTP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizer-441"><a href="#MazeTokenizer-441"><span class="linenos">441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns true if a tokenization mode is Adjacency list, Origin, Target, Path&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-442"><a href="#MazeTokenizer-442"><span class="linenos">442</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer-443"><a href="#MazeTokenizer-443"><span class="linenos">443</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer-444"><a href="#MazeTokenizer-444"><span class="linenos">444</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer-445"><a href="#MazeTokenizer-445"><span class="linenos">445</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">,</span>
</span><span id="MazeTokenizer-446"><a href="#MazeTokenizer-446"><span class="linenos">446</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizer-447"><a href="#MazeTokenizer-447"><span class="linenos">447</span></a>
</span><span id="MazeTokenizer-448"><a href="#MazeTokenizer-448"><span class="linenos">448</span></a>    <span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizer-449"><a href="#MazeTokenizer-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="n">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="p">)</span>
</span><span id="MazeTokenizer-450"><a href="#MazeTokenizer-450"><span class="linenos">450</span></a>
</span><span id="MazeTokenizer-451"><a href="#MazeTokenizer-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizer-452"><a href="#MazeTokenizer-452"><span class="linenos">452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;clears all cached properties&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer-453"><a href="#MazeTokenizer-453"><span class="linenos">453</span></a>        <span class="c1"># delete the properties only if they exist</span>
</span><span id="MazeTokenizer-454"><a href="#MazeTokenizer-454"><span class="linenos">454</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MazeTokenizer-455"><a href="#MazeTokenizer-455"><span class="linenos">455</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">cached_property</span><span class="p">):</span>
</span><span id="MazeTokenizer-456"><a href="#MazeTokenizer-456"><span class="linenos">456</span></a>                <span class="c1"># if the property exists, delete it</span>
</span><span id="MazeTokenizer-457"><a href="#MazeTokenizer-457"><span class="linenos">457</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer-458"><a href="#MazeTokenizer-458"><span class="linenos">458</span></a>                    <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="MazeTokenizer-459"><a href="#MazeTokenizer-459"><span class="linenos">459</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer-460"><a href="#MazeTokenizer-460"><span class="linenos">460</span></a>                    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>LEGACY Tokenizer for mazes</p>

<div class="alert caution">
<em>Caution</em>
<p><code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> is the new standard for tokenization. This class is no longer recommended
  for use, but will remain for compatibility with existing code.</p>
</div>

<h1 id="parameters">Parameters:</h1>

<ul>
<li><code>tokenization_mode: TokenizationMode</code>
mode of tokenization. required.
<ul>
<li><code>max_grid_size: int | None</code>
maximum grid size. required for actually turning text tokens to numerical tokens, but not for moving between coordinates/mazes and text</li>
</ul></li>
</ul>

<h1 id="properties">Properties</h1>

<ul>
<li><code>name: str</code>
auto-generated name of the tokenizer from mode and size</li>
</ul>

<h2 id="conditional-properties">Conditional Properties</h2>

<ul>
<li><code>node_strings_map: Mapping[CoordTup, str]</code>
map from node to string. This returns a <code>muutils.kappa.Kappa</code> object which you can use like a dictionary. returns <code>None</code> if not a <code>UT</code> mode</li>
</ul>

<p>these all return <code>None</code> if <code><a href="#MazeTokenizer.max_grid_size">max_grid_size</a></code> is <code>None</code>.
Prepend <code>_</code> to the name to get a guaranteed type, and cause an exception if <code><a href="#MazeTokenizer.max_grid_size">max_grid_size</a></code> is <code>None</code></p>

<ul>
<li><code>token_arr: list[str]</code>
list of tokens, in order of their indices in the vocabulary</li>
<li><code>tokenizer_map: Mapping[str, int]</code>
map from token to index</li>
<li><code>vocab_size: int</code>
size of the vocabulary</li>
<li><code>padding_token_index: int</code>
index of the padding token</li>
</ul>

<h1 id="methods">Methods</h1>

<ul>
<li><code>coords_to_strings(coords: list[CoordTup]) -&gt; list[str]</code>
convert a list of coordinates to a list of tokens. Optionally except, skip, or ignore non-coordinates</li>
<li><code>strings_to_coords(strings: list[str]) -&gt; list[CoordTup]</code>
convert a list of tokens to a list of coordinates. Optionally except, skip, or ignore non-coordinates</li>
</ul>
</div>


                            <div id="MazeTokenizer.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">MazeTokenizer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">tokenization_mode</span><span class="p">:</span> <span class="n"><a href="#TokenizationMode">TokenizationMode</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#TokenizationMode.AOTP_UT_uniform">TokenizationMode.AOTP_UT_uniform</a></span><span class="p">:</span> <span class="s1">&#39;AOTP_UT_uniform&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">max_grid_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MazeTokenizer.__init__"></a>
    
    

                            </div>
                            <div id="MazeTokenizer.tokenization_mode" class="classattr">
                                <div class="attr variable">
            <span class="name">tokenization_mode</span><span class="annotation">: <a href="#TokenizationMode">TokenizationMode</a></span>        =
<span class="default_value">&lt;<a href="#TokenizationMode.AOTP_UT_uniform">TokenizationMode.AOTP_UT_uniform</a>: &#39;AOTP_UT_uniform&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#MazeTokenizer.tokenization_mode"></a>
    
    

                            </div>
                            <div id="MazeTokenizer.max_grid_size" class="classattr">
                                <div class="attr variable">
            <span class="name">max_grid_size</span><span class="annotation">: int | None</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#MazeTokenizer.max_grid_size"></a>
    
    

                            </div>
                            <div id="MazeTokenizer.name" class="classattr">
                                        <input id="MazeTokenizer.name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.name-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L201-L206" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.name-202"><a href="#MazeTokenizer.name-202"><span class="linenos">202</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer.name-203"><a href="#MazeTokenizer.name-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizer.name-204"><a href="#MazeTokenizer.name-204"><span class="linenos">204</span></a>        <span class="n">max_grid_size_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeTokenizer.name-205"><a href="#MazeTokenizer.name-205"><span class="linenos">205</span></a>            <span class="sa">f</span><span class="s2">&quot;-g</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="MazeTokenizer.name-206"><a href="#MazeTokenizer.name-206"><span class="linenos">206</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizer.name-207"><a href="#MazeTokenizer.name-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;maze_tokenizer-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="o">.</span><span class="n">value</span><span class="si">}{</span><span class="n">max_grid_size_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.node_strings_map" class="classattr">
                                        <input id="MazeTokenizer.node_strings_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">node_strings_map</span><span class="annotation">: Optional[Mapping[tuple[int, int], list[str]]]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.node_strings_map-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L224-L233" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.node_strings_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.node_strings_map-225"><a href="#MazeTokenizer.node_strings_map-225"><span class="linenos">225</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer.node_strings_map-226"><a href="#MazeTokenizer.node_strings_map-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">node_strings_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.node_strings_map-227"><a href="#MazeTokenizer.node_strings_map-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map a coordinate to a token&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.node_strings_map-228"><a href="#MazeTokenizer.node_strings_map-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer.node_strings_map-229"><a href="#MazeTokenizer.node_strings_map-229"><span class="linenos">229</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer.node_strings_map-230"><a href="#MazeTokenizer.node_strings_map-230"><span class="linenos">230</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer.node_strings_map-231"><a href="#MazeTokenizer.node_strings_map-231"><span class="linenos">231</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizer.node_strings_map-232"><a href="#MazeTokenizer.node_strings_map-232"><span class="linenos">232</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.node_strings_map-233"><a href="#MazeTokenizer.node_strings_map-233"><span class="linenos">233</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer.node_strings_map-234"><a href="#MazeTokenizer.node_strings_map-234"><span class="linenos">234</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_strings_map</span>
</span></pre></div>


            <div class="docstring"><p>map a coordinate to a token</p>
</div>


                            </div>
                            <div id="MazeTokenizer.token_arr" class="classattr">
                                        <input id="MazeTokenizer.token_arr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">token_arr</span><span class="annotation">: list[str] | None</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.token_arr-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L278-L282" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.token_arr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.token_arr-279"><a href="#MazeTokenizer.token_arr-279"><span class="linenos">279</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer.token_arr-280"><a href="#MazeTokenizer.token_arr-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.token_arr-281"><a href="#MazeTokenizer.token_arr-281"><span class="linenos">281</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.token_arr-282"><a href="#MazeTokenizer.token_arr-282"><span class="linenos">282</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.token_arr-283"><a href="#MazeTokenizer.token_arr-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_arr</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.tokenizer_map" class="classattr">
                                        <input id="MazeTokenizer.tokenizer_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tokenizer_map</span><span class="annotation">: dict[str, int] | None</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.tokenizer_map-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L289-L293" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.tokenizer_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.tokenizer_map-290"><a href="#MazeTokenizer.tokenizer_map-290"><span class="linenos">290</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer.tokenizer_map-291"><a href="#MazeTokenizer.tokenizer_map-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.tokenizer_map-292"><a href="#MazeTokenizer.tokenizer_map-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.tokenizer_map-293"><a href="#MazeTokenizer.tokenizer_map-293"><span class="linenos">293</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.tokenizer_map-294"><a href="#MazeTokenizer.tokenizer_map-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer_map</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.vocab_size" class="classattr">
                                        <input id="MazeTokenizer.vocab_size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">vocab_size</span><span class="annotation">: int | None</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.vocab_size-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L299-L303" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.vocab_size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.vocab_size-300"><a href="#MazeTokenizer.vocab_size-300"><span class="linenos">300</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer.vocab_size-301"><a href="#MazeTokenizer.vocab_size-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.vocab_size-302"><a href="#MazeTokenizer.vocab_size-302"><span class="linenos">302</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.vocab_size-303"><a href="#MazeTokenizer.vocab_size-303"><span class="linenos">303</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.vocab_size-304"><a href="#MazeTokenizer.vocab_size-304"><span class="linenos">304</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vocab_size</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.n_tokens" class="classattr">
                                        <input id="MazeTokenizer.n_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n_tokens</span><span class="annotation">: int | None</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.n_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L310-L314" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.n_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.n_tokens-311"><a href="#MazeTokenizer.n_tokens-311"><span class="linenos">311</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizer.n_tokens-312"><a href="#MazeTokenizer.n_tokens-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.n_tokens-313"><a href="#MazeTokenizer.n_tokens-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.n_tokens-314"><a href="#MazeTokenizer.n_tokens-314"><span class="linenos">314</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.n_tokens-315"><a href="#MazeTokenizer.n_tokens-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_tokens</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.padding_token_index" class="classattr">
                                        <input id="MazeTokenizer.padding_token_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">padding_token_index</span><span class="annotation">: int | None</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.padding_token_index-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L320-L324" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.padding_token_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.padding_token_index-321"><a href="#MazeTokenizer.padding_token_index-321"><span class="linenos">321</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer.padding_token_index-322"><a href="#MazeTokenizer.padding_token_index-322"><span class="linenos">322</span></a>    <span class="k">def</span> <span class="nf">padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.padding_token_index-323"><a href="#MazeTokenizer.padding_token_index-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.padding_token_index-324"><a href="#MazeTokenizer.padding_token_index-324"><span class="linenos">324</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.padding_token_index-325"><a href="#MazeTokenizer.padding_token_index-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padding_token_index</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.coords_to_strings" class="classattr">
                                        <input id="MazeTokenizer.coords_to_strings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coords_to_strings</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;except&#39;</span><span class="p">,</span> <span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;skip&#39;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.coords_to_strings-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L329-L353" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.coords_to_strings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.coords_to_strings-330"><a href="#MazeTokenizer.coords_to_strings-330"><span class="linenos">330</span></a>    <span class="k">def</span> <span class="nf">coords_to_strings</span><span class="p">(</span>
</span><span id="MazeTokenizer.coords_to_strings-331"><a href="#MazeTokenizer.coords_to_strings-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-332"><a href="#MazeTokenizer.coords_to_strings-332"><span class="linenos">332</span></a>        <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">],</span>
</span><span id="MazeTokenizer.coords_to_strings-333"><a href="#MazeTokenizer.coords_to_strings-333"><span class="linenos">333</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-334"><a href="#MazeTokenizer.coords_to_strings-334"><span class="linenos">334</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizer.coords_to_strings-335"><a href="#MazeTokenizer.coords_to_strings-335"><span class="linenos">335</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer.coords_to_strings-336"><a href="#MazeTokenizer.coords_to_strings-336"><span class="linenos">336</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-337"><a href="#MazeTokenizer.coords_to_strings-337"><span class="linenos">337</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-338"><a href="#MazeTokenizer.coords_to_strings-338"><span class="linenos">338</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizer.coords_to_strings-339"><a href="#MazeTokenizer.coords_to_strings-339"><span class="linenos">339</span></a>            <span class="k">return</span> <span class="n">coords_to_strings</span><span class="p">(</span>
</span><span id="MazeTokenizer.coords_to_strings-340"><a href="#MazeTokenizer.coords_to_strings-340"><span class="linenos">340</span></a>                <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-341"><a href="#MazeTokenizer.coords_to_strings-341"><span class="linenos">341</span></a>                <span class="n">coord_to_strings_func</span><span class="o">=</span><span class="n">_coord_to_strings_UT</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-342"><a href="#MazeTokenizer.coords_to_strings-342"><span class="linenos">342</span></a>                <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-343"><a href="#MazeTokenizer.coords_to_strings-343"><span class="linenos">343</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer.coords_to_strings-344"><a href="#MazeTokenizer.coords_to_strings-344"><span class="linenos">344</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="o">==</span> <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span>
</span><span id="MazeTokenizer.coords_to_strings-345"><a href="#MazeTokenizer.coords_to_strings-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="n">coords_to_strings</span><span class="p">(</span>
</span><span id="MazeTokenizer.coords_to_strings-346"><a href="#MazeTokenizer.coords_to_strings-346"><span class="linenos">346</span></a>                <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-347"><a href="#MazeTokenizer.coords_to_strings-347"><span class="linenos">347</span></a>                <span class="n">coord_to_strings_func</span><span class="o">=</span><span class="n">_coord_to_strings_indexed</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-348"><a href="#MazeTokenizer.coords_to_strings-348"><span class="linenos">348</span></a>                <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-349"><a href="#MazeTokenizer.coords_to_strings-349"><span class="linenos">349</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer.coords_to_strings-350"><a href="#MazeTokenizer.coords_to_strings-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer.coords_to_strings-351"><a href="#MazeTokenizer.coords_to_strings-351"><span class="linenos">351</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer.coords_to_strings-352"><a href="#MazeTokenizer.coords_to_strings-352"><span class="linenos">352</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid tokenization mode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-353"><a href="#MazeTokenizer.coords_to_strings-353"><span class="linenos">353</span></a>                <span class="sa">f</span><span class="s2">&quot;expected one of </span><span class="si">{</span><span class="n">TokenizationMode</span><span class="o">.</span><span class="n">__members__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.coords_to_strings-354"><a href="#MazeTokenizer.coords_to_strings-354"><span class="linenos">354</span></a>            <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.strings_to_coords" class="classattr">
                                        <input id="MazeTokenizer.strings_to_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">strings_to_coords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;except&#39;</span><span class="p">,</span> <span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;skip&#39;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.strings_to_coords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L355-L360" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.strings_to_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.strings_to_coords-356"><a href="#MazeTokenizer.strings_to_coords-356"><span class="linenos">356</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizer.strings_to_coords-357"><a href="#MazeTokenizer.strings_to_coords-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="MazeTokenizer.strings_to_coords-358"><a href="#MazeTokenizer.strings_to_coords-358"><span class="linenos">358</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MazeTokenizer.strings_to_coords-359"><a href="#MazeTokenizer.strings_to_coords-359"><span class="linenos">359</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.strings_to_coords-360"><a href="#MazeTokenizer.strings_to_coords-360"><span class="linenos">360</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="MazeTokenizer.strings_to_coords-361"><a href="#MazeTokenizer.strings_to_coords-361"><span class="linenos">361</span></a>        <span class="k">return</span> <span class="n">strings_to_coords</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.encode" class="classattr">
                                        <input id="MazeTokenizer.encode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">encode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.encode-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L362-L373" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.encode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.encode-363"><a href="#MazeTokenizer.encode-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer.encode-364"><a href="#MazeTokenizer.encode-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;encode a string or list of strings into a list of tokens&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.encode-365"><a href="#MazeTokenizer.encode-365"><span class="linenos">365</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer.encode-366"><a href="#MazeTokenizer.encode-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MazeTokenizer.encode-367"><a href="#MazeTokenizer.encode-367"><span class="linenos">367</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="MazeTokenizer.encode-368"><a href="#MazeTokenizer.encode-368"><span class="linenos">368</span></a>            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_map</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</span><span id="MazeTokenizer.encode-369"><a href="#MazeTokenizer.encode-369"><span class="linenos">369</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer.encode-370"><a href="#MazeTokenizer.encode-370"><span class="linenos">370</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="MazeTokenizer.encode-371"><a href="#MazeTokenizer.encode-371"><span class="linenos">371</span></a>                <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.encode-372"><a href="#MazeTokenizer.encode-372"><span class="linenos">372</span></a>                <span class="sa">f</span><span class="s2">&quot;in vocabulary of </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.encode-373"><a href="#MazeTokenizer.encode-373"><span class="linenos">373</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.encode-374"><a href="#MazeTokenizer.encode-374"><span class="linenos">374</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span></pre></div>


            <div class="docstring"><p>encode a string or list of strings into a list of tokens</p>
</div>


                            </div>
                            <div id="MazeTokenizer.decode" class="classattr">
                                        <input id="MazeTokenizer.decode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decode</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">tokens</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.decode-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L375-L388" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.decode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.decode-376"><a href="#MazeTokenizer.decode-376"><span class="linenos">376</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span>
</span><span id="MazeTokenizer.decode-377"><a href="#MazeTokenizer.decode-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MazeTokenizer.decode-378"><a href="#MazeTokenizer.decode-378"><span class="linenos">378</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizer.decode-379"><a href="#MazeTokenizer.decode-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;decode a list of tokens into a string or list of strings&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.decode-380"><a href="#MazeTokenizer.decode-380"><span class="linenos">380</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer.decode-381"><a href="#MazeTokenizer.decode-381"><span class="linenos">381</span></a>            <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>
</span><span id="MazeTokenizer.decode-382"><a href="#MazeTokenizer.decode-382"><span class="linenos">382</span></a>        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer.decode-383"><a href="#MazeTokenizer.decode-383"><span class="linenos">383</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="MazeTokenizer.decode-384"><a href="#MazeTokenizer.decode-384"><span class="linenos">384</span></a>                <span class="sa">f</span><span class="s2">&quot;Token index &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39; not found in vocabulary of length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.decode-385"><a href="#MazeTokenizer.decode-385"><span class="linenos">385</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizer.decode-386"><a href="#MazeTokenizer.decode-386"><span class="linenos">386</span></a>        <span class="k">if</span> <span class="n">joined_tokens</span><span class="p">:</span>
</span><span id="MazeTokenizer.decode-387"><a href="#MazeTokenizer.decode-387"><span class="linenos">387</span></a>            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="MazeTokenizer.decode-388"><a href="#MazeTokenizer.decode-388"><span class="linenos">388</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer.decode-389"><a href="#MazeTokenizer.decode-389"><span class="linenos">389</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>decode a list of tokens into a string or list of strings</p>
</div>


                            </div>
                            <div id="MazeTokenizer.coordinate_tokens_coords" class="classattr">
                                        <input id="MazeTokenizer.coordinate_tokens_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">coordinate_tokens_coords</span><span class="annotation">: dict[tuple[int, int], int]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.coordinate_tokens_coords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L393-L414" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.coordinate_tokens_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.coordinate_tokens_coords-394"><a href="#MazeTokenizer.coordinate_tokens_coords-394"><span class="linenos">394</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-395"><a href="#MazeTokenizer.coordinate_tokens_coords-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="nf">coordinate_tokens_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoordTup</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-396"><a href="#MazeTokenizer.coordinate_tokens_coords-396"><span class="linenos">396</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-397"><a href="#MazeTokenizer.coordinate_tokens_coords-397"><span class="linenos">397</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_UT</span><span class="p">():</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-398"><a href="#MazeTokenizer.coordinate_tokens_coords-398"><span class="linenos">398</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-399"><a href="#MazeTokenizer.coordinate_tokens_coords-399"><span class="linenos">399</span></a>                <span class="sa">f</span><span class="s2">&quot;coordinate_tokens_coords is only valid for UT tokenization modes, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-400"><a href="#MazeTokenizer.coordinate_tokens_coords-400"><span class="linenos">400</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-401"><a href="#MazeTokenizer.coordinate_tokens_coords-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-402"><a href="#MazeTokenizer.coordinate_tokens_coords-402"><span class="linenos">402</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-403"><a href="#MazeTokenizer.coordinate_tokens_coords-403"><span class="linenos">403</span></a>                <span class="sa">f</span><span class="s2">&quot;max_grid_size must be specified to use coordinate_tokens: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-404"><a href="#MazeTokenizer.coordinate_tokens_coords-404"><span class="linenos">404</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-405"><a href="#MazeTokenizer.coordinate_tokens_coords-405"><span class="linenos">405</span></a>
</span><span id="MazeTokenizer.coordinate_tokens_coords-406"><a href="#MazeTokenizer.coordinate_tokens_coords-406"><span class="linenos">406</span></a>        <span class="n">raw_converted</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strings_to_coords</span><span class="p">(</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-407"><a href="#MazeTokenizer.coordinate_tokens_coords-407"><span class="linenos">407</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">token_arr</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="s2">&quot;include&quot;</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-408"><a href="#MazeTokenizer.coordinate_tokens_coords-408"><span class="linenos">408</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-409"><a href="#MazeTokenizer.coordinate_tokens_coords-409"><span class="linenos">409</span></a>
</span><span id="MazeTokenizer.coordinate_tokens_coords-410"><a href="#MazeTokenizer.coordinate_tokens_coords-410"><span class="linenos">410</span></a>        <span class="c1"># filter out non-coordinates</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-411"><a href="#MazeTokenizer.coordinate_tokens_coords-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-412"><a href="#MazeTokenizer.coordinate_tokens_coords-412"><span class="linenos">412</span></a>            <span class="n">coord</span><span class="p">:</span> <span class="n">i</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-413"><a href="#MazeTokenizer.coordinate_tokens_coords-413"><span class="linenos">413</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_converted</span><span class="p">)</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-414"><a href="#MazeTokenizer.coordinate_tokens_coords-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="MazeTokenizer.coordinate_tokens_coords-415"><a href="#MazeTokenizer.coordinate_tokens_coords-415"><span class="linenos">415</span></a>        <span class="p">}</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.coordinate_tokens_ids" class="classattr">
                                        <input id="MazeTokenizer.coordinate_tokens_ids-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">coordinate_tokens_ids</span><span class="annotation">: dict[str, int]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.coordinate_tokens_ids-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L416-L426" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.coordinate_tokens_ids"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.coordinate_tokens_ids-417"><a href="#MazeTokenizer.coordinate_tokens_ids-417"><span class="linenos">417</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-418"><a href="#MazeTokenizer.coordinate_tokens_ids-418"><span class="linenos">418</span></a>    <span class="k">def</span> <span class="nf">coordinate_tokens_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-419"><a href="#MazeTokenizer.coordinate_tokens_ids-419"><span class="linenos">419</span></a>        <span class="c1"># checks performed in call</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-420"><a href="#MazeTokenizer.coordinate_tokens_ids-420"><span class="linenos">420</span></a>        <span class="n">output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-421"><a href="#MazeTokenizer.coordinate_tokens_ids-421"><span class="linenos">421</span></a>
</span><span id="MazeTokenizer.coordinate_tokens_ids-422"><a href="#MazeTokenizer.coordinate_tokens_ids-422"><span class="linenos">422</span></a>        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate_tokens_coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-423"><a href="#MazeTokenizer.coordinate_tokens_ids-423"><span class="linenos">423</span></a>            <span class="n">_for_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_to_strings</span><span class="p">([</span><span class="n">coord</span><span class="p">])</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-424"><a href="#MazeTokenizer.coordinate_tokens_ids-424"><span class="linenos">424</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">_for_key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-425"><a href="#MazeTokenizer.coordinate_tokens_ids-425"><span class="linenos">425</span></a>            <span class="n">output</span><span class="p">[</span><span class="n">_for_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="MazeTokenizer.coordinate_tokens_ids-426"><a href="#MazeTokenizer.coordinate_tokens_ids-426"><span class="linenos">426</span></a>
</span><span id="MazeTokenizer.coordinate_tokens_ids-427"><a href="#MazeTokenizer.coordinate_tokens_ids-427"><span class="linenos">427</span></a>        <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.summary" class="classattr">
                                        <input id="MazeTokenizer.summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.summary-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L431-L437" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.summary-432"><a href="#MazeTokenizer.summary-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeTokenizer.summary-433"><a href="#MazeTokenizer.summary-433"><span class="linenos">433</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns a summary of the tokenization mode&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.summary-434"><a href="#MazeTokenizer.summary-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizer.summary-435"><a href="#MazeTokenizer.summary-435"><span class="linenos">435</span></a>            <span class="s2">&quot;tokenization_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="MazeTokenizer.summary-436"><a href="#MazeTokenizer.summary-436"><span class="linenos">436</span></a>            <span class="s2">&quot;max_grid_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grid_size</span><span class="p">,</span>
</span><span id="MazeTokenizer.summary-437"><a href="#MazeTokenizer.summary-437"><span class="linenos">437</span></a>            <span class="s2">&quot;vocab_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span>
</span><span id="MazeTokenizer.summary-438"><a href="#MazeTokenizer.summary-438"><span class="linenos">438</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>returns a summary of the tokenization mode</p>
</div>


                            </div>
                            <div id="MazeTokenizer.is_AOTP" class="classattr">
                                        <input id="MazeTokenizer.is_AOTP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_AOTP</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.is_AOTP-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L439-L445" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.is_AOTP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.is_AOTP-440"><a href="#MazeTokenizer.is_AOTP-440"><span class="linenos">440</span></a>    <span class="k">def</span> <span class="nf">is_AOTP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizer.is_AOTP-441"><a href="#MazeTokenizer.is_AOTP-441"><span class="linenos">441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns true if a tokenization mode is Adjacency list, Origin, Target, Path&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.is_AOTP-442"><a href="#MazeTokenizer.is_AOTP-442"><span class="linenos">442</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MazeTokenizer.is_AOTP-443"><a href="#MazeTokenizer.is_AOTP-443"><span class="linenos">443</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">,</span>
</span><span id="MazeTokenizer.is_AOTP-444"><a href="#MazeTokenizer.is_AOTP-444"><span class="linenos">444</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">,</span>
</span><span id="MazeTokenizer.is_AOTP-445"><a href="#MazeTokenizer.is_AOTP-445"><span class="linenos">445</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">,</span>
</span><span id="MazeTokenizer.is_AOTP-446"><a href="#MazeTokenizer.is_AOTP-446"><span class="linenos">446</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>returns true if a tokenization mode is Adjacency list, Origin, Target, Path</p>
</div>


                            </div>
                            <div id="MazeTokenizer.is_UT" class="classattr">
                                        <input id="MazeTokenizer.is_UT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_UT</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.is_UT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L447-L448" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.is_UT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.is_UT-448"><a href="#MazeTokenizer.is_UT-448"><span class="linenos">448</span></a>    <span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizer.is_UT-449"><a href="#MazeTokenizer.is_UT-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="n">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenization_mode</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizer.clear_cache" class="classattr">
                                        <input id="MazeTokenizer.clear_cache-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_cache</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.clear_cache-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L450-L459" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.clear_cache"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.clear_cache-451"><a href="#MazeTokenizer.clear_cache-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizer.clear_cache-452"><a href="#MazeTokenizer.clear_cache-452"><span class="linenos">452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;clears all cached properties&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.clear_cache-453"><a href="#MazeTokenizer.clear_cache-453"><span class="linenos">453</span></a>        <span class="c1"># delete the properties only if they exist</span>
</span><span id="MazeTokenizer.clear_cache-454"><a href="#MazeTokenizer.clear_cache-454"><span class="linenos">454</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="MazeTokenizer.clear_cache-455"><a href="#MazeTokenizer.clear_cache-455"><span class="linenos">455</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">cached_property</span><span class="p">):</span>
</span><span id="MazeTokenizer.clear_cache-456"><a href="#MazeTokenizer.clear_cache-456"><span class="linenos">456</span></a>                <span class="c1"># if the property exists, delete it</span>
</span><span id="MazeTokenizer.clear_cache-457"><a href="#MazeTokenizer.clear_cache-457"><span class="linenos">457</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer.clear_cache-458"><a href="#MazeTokenizer.clear_cache-458"><span class="linenos">458</span></a>                    <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="MazeTokenizer.clear_cache-459"><a href="#MazeTokenizer.clear_cache-459"><span class="linenos">459</span></a>                <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer.clear_cache-460"><a href="#MazeTokenizer.clear_cache-460"><span class="linenos">460</span></a>                    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>clears all cached properties</p>
</div>


                            </div>
                            <div id="MazeTokenizer.serialize" class="classattr">
                                        <input id="MazeTokenizer.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.serialize-660"><a href="#MazeTokenizer.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="MazeTokenizer.serialize-661"><a href="#MazeTokenizer.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MazeTokenizer.serialize-662"><a href="#MazeTokenizer.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="MazeTokenizer.serialize-663"><a href="#MazeTokenizer.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="MazeTokenizer.serialize-664"><a href="#MazeTokenizer.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="MazeTokenizer.serialize-665"><a href="#MazeTokenizer.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeTokenizer.serialize-666"><a href="#MazeTokenizer.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="MazeTokenizer.serialize-667"><a href="#MazeTokenizer.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="MazeTokenizer.serialize-668"><a href="#MazeTokenizer.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="MazeTokenizer.serialize-669"><a href="#MazeTokenizer.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="MazeTokenizer.serialize-670"><a href="#MazeTokenizer.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="MazeTokenizer.serialize-671"><a href="#MazeTokenizer.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="MazeTokenizer.serialize-672"><a href="#MazeTokenizer.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="MazeTokenizer.serialize-673"><a href="#MazeTokenizer.serialize-673"><span class="linenos">673</span></a>
</span><span id="MazeTokenizer.serialize-674"><a href="#MazeTokenizer.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="MazeTokenizer.serialize-675"><a href="#MazeTokenizer.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="MazeTokenizer.serialize-676"><a href="#MazeTokenizer.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizer.serialize-677"><a href="#MazeTokenizer.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="MazeTokenizer.serialize-678"><a href="#MazeTokenizer.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="MazeTokenizer.serialize-679"><a href="#MazeTokenizer.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="MazeTokenizer.serialize-680"><a href="#MazeTokenizer.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="MazeTokenizer.serialize-681"><a href="#MazeTokenizer.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeTokenizer.serialize-682"><a href="#MazeTokenizer.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="MazeTokenizer.serialize-683"><a href="#MazeTokenizer.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="MazeTokenizer.serialize-684"><a href="#MazeTokenizer.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeTokenizer.serialize-685"><a href="#MazeTokenizer.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="MazeTokenizer.serialize-686"><a href="#MazeTokenizer.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="MazeTokenizer.serialize-687"><a href="#MazeTokenizer.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="MazeTokenizer.serialize-688"><a href="#MazeTokenizer.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeTokenizer.serialize-689"><a href="#MazeTokenizer.serialize-689"><span class="linenos">689</span></a>
</span><span id="MazeTokenizer.serialize-690"><a href="#MazeTokenizer.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="MazeTokenizer.serialize-691"><a href="#MazeTokenizer.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeTokenizer.serialize-692"><a href="#MazeTokenizer.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizer.serialize-693"><a href="#MazeTokenizer.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="MazeTokenizer.serialize-694"><a href="#MazeTokenizer.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeTokenizer.serialize-695"><a href="#MazeTokenizer.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="MazeTokenizer.serialize-696"><a href="#MazeTokenizer.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.serialize-697"><a href="#MazeTokenizer.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.serialize-698"><a href="#MazeTokenizer.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.serialize-699"><a href="#MazeTokenizer.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizer.serialize-700"><a href="#MazeTokenizer.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="MazeTokenizer.serialize-701"><a href="#MazeTokenizer.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="MazeTokenizer.serialize-702"><a href="#MazeTokenizer.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizer.serialize-703"><a href="#MazeTokenizer.serialize-703"><span class="linenos">703</span></a>
</span><span id="MazeTokenizer.serialize-704"><a href="#MazeTokenizer.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="MazeTokenizer.serialize-705"><a href="#MazeTokenizer.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="MazeTokenizer.serialize-706"><a href="#MazeTokenizer.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="MazeTokenizer.serialize-707"><a href="#MazeTokenizer.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="MazeTokenizer.serialize-708"><a href="#MazeTokenizer.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeTokenizer.serialize-709"><a href="#MazeTokenizer.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer.serialize-710"><a href="#MazeTokenizer.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="MazeTokenizer.serialize-711"><a href="#MazeTokenizer.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.serialize-712"><a href="#MazeTokenizer.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.serialize-713"><a href="#MazeTokenizer.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.serialize-714"><a href="#MazeTokenizer.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="MazeTokenizer.serialize-715"><a href="#MazeTokenizer.serialize-715"><span class="linenos">715</span></a>
</span><span id="MazeTokenizer.serialize-716"><a href="#MazeTokenizer.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="MazeTokenizer.load" class="classattr">
                                        <input id="MazeTokenizer.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.load-723"><a href="#MazeTokenizer.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="MazeTokenizer.load-724"><a href="#MazeTokenizer.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="MazeTokenizer.load-725"><a href="#MazeTokenizer.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="MazeTokenizer.load-726"><a href="#MazeTokenizer.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeTokenizer.load-727"><a href="#MazeTokenizer.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="MazeTokenizer.load-728"><a href="#MazeTokenizer.load-728"><span class="linenos">728</span></a>
</span><span id="MazeTokenizer.load-729"><a href="#MazeTokenizer.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeTokenizer.load-730"><a href="#MazeTokenizer.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="MazeTokenizer.load-731"><a href="#MazeTokenizer.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.load-732"><a href="#MazeTokenizer.load-732"><span class="linenos">732</span></a>
</span><span id="MazeTokenizer.load-733"><a href="#MazeTokenizer.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-734"><a href="#MazeTokenizer.load-734"><span class="linenos">734</span></a>
</span><span id="MazeTokenizer.load-735"><a href="#MazeTokenizer.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="MazeTokenizer.load-736"><a href="#MazeTokenizer.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeTokenizer.load-737"><a href="#MazeTokenizer.load-737"><span class="linenos">737</span></a>
</span><span id="MazeTokenizer.load-738"><a href="#MazeTokenizer.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="MazeTokenizer.load-739"><a href="#MazeTokenizer.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeTokenizer.load-740"><a href="#MazeTokenizer.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="MazeTokenizer.load-741"><a href="#MazeTokenizer.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeTokenizer.load-742"><a href="#MazeTokenizer.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="MazeTokenizer.load-743"><a href="#MazeTokenizer.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="MazeTokenizer.load-744"><a href="#MazeTokenizer.load-744"><span class="linenos">744</span></a>
</span><span id="MazeTokenizer.load-745"><a href="#MazeTokenizer.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="MazeTokenizer.load-746"><a href="#MazeTokenizer.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="MazeTokenizer.load-747"><a href="#MazeTokenizer.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="MazeTokenizer.load-748"><a href="#MazeTokenizer.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="MazeTokenizer.load-749"><a href="#MazeTokenizer.load-749"><span class="linenos">749</span></a>
</span><span id="MazeTokenizer.load-750"><a href="#MazeTokenizer.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="MazeTokenizer.load-751"><a href="#MazeTokenizer.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-752"><a href="#MazeTokenizer.load-752"><span class="linenos">752</span></a>
</span><span id="MazeTokenizer.load-753"><a href="#MazeTokenizer.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="MazeTokenizer.load-754"><a href="#MazeTokenizer.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="MazeTokenizer.load-755"><a href="#MazeTokenizer.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="MazeTokenizer.load-756"><a href="#MazeTokenizer.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-757"><a href="#MazeTokenizer.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="MazeTokenizer.load-758"><a href="#MazeTokenizer.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="MazeTokenizer.load-759"><a href="#MazeTokenizer.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-760"><a href="#MazeTokenizer.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="MazeTokenizer.load-761"><a href="#MazeTokenizer.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeTokenizer.load-762"><a href="#MazeTokenizer.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-763"><a href="#MazeTokenizer.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-764"><a href="#MazeTokenizer.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="MazeTokenizer.load-765"><a href="#MazeTokenizer.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="MazeTokenizer.load-766"><a href="#MazeTokenizer.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="MazeTokenizer.load-767"><a href="#MazeTokenizer.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-768"><a href="#MazeTokenizer.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer.load-769"><a href="#MazeTokenizer.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="MazeTokenizer.load-770"><a href="#MazeTokenizer.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizer.load-771"><a href="#MazeTokenizer.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="MazeTokenizer.load-772"><a href="#MazeTokenizer.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizer.load-773"><a href="#MazeTokenizer.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="MazeTokenizer.load-774"><a href="#MazeTokenizer.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="MazeTokenizer.load-775"><a href="#MazeTokenizer.load-775"><span class="linenos">775</span></a>
</span><span id="MazeTokenizer.load-776"><a href="#MazeTokenizer.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="MazeTokenizer.load-777"><a href="#MazeTokenizer.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeTokenizer.load-778"><a href="#MazeTokenizer.load-778"><span class="linenos">778</span></a>
</span><span id="MazeTokenizer.load-779"><a href="#MazeTokenizer.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="MazeTokenizer.load-780"><a href="#MazeTokenizer.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-781"><a href="#MazeTokenizer.load-781"><span class="linenos">781</span></a>
</span><span id="MazeTokenizer.load-782"><a href="#MazeTokenizer.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="MazeTokenizer.load-783"><a href="#MazeTokenizer.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="MazeTokenizer.load-784"><a href="#MazeTokenizer.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="MazeTokenizer.load-785"><a href="#MazeTokenizer.load-785"><span class="linenos">785</span></a>
</span><span id="MazeTokenizer.load-786"><a href="#MazeTokenizer.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="MazeTokenizer.load-787"><a href="#MazeTokenizer.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="MazeTokenizer.validate_fields_types" class="classattr">
                                        <input id="MazeTokenizer.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizer.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizer.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizer.validate_fields_types-271"><a href="#MazeTokenizer.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="MazeTokenizer.validate_fields_types-272"><a href="#MazeTokenizer.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="MazeTokenizer.validate_fields_types-273"><a href="#MazeTokenizer.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="MazeTokenizer.validate_fields_types-274"><a href="#MazeTokenizer.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizer.validate_fields_types-275"><a href="#MazeTokenizer.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="MazeTokenizer.validate_fields_types-276"><a href="#MazeTokenizer.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="MazeTokenizer.validate_fields_types-277"><a href="#MazeTokenizer.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="MazeTokenizer.validate_fields_types-278"><a href="#MazeTokenizer.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="MazeTokenizer.validate_fields_types-279"><a href="#MazeTokenizer.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="MazeTokenizer.validate_fields_types-280"><a href="#MazeTokenizer.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="MazeTokenizer.validate_field_type" class="function">validate_field_type</dd>
                <dd id="MazeTokenizer.diff" class="function">diff</dd>
                <dd id="MazeTokenizer.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="mark_as_unsupported">
                            <input id="mark_as_unsupported-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mark_as_unsupported</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">is_valid</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="o">~</span><span class="n">T</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">) -> <span class="o">~</span><span class="n">T</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mark_as_unsupported-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L686-L700" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#mark_as_unsupported"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="mark_as_unsupported-687"><a href="#mark_as_unsupported-687"><span class="linenos">687</span></a><span class="k">def</span> <span class="nf">mark_as_unsupported</span><span class="p">(</span><span class="n">is_valid</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
</span><span id="mark_as_unsupported-688"><a href="#mark_as_unsupported-688"><span class="linenos">688</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;mark a _TokenizerElement as unsupported.</span>
</span><span id="mark_as_unsupported-689"><a href="#mark_as_unsupported-689"><span class="linenos">689</span></a>
</span><span id="mark_as_unsupported-690"><a href="#mark_as_unsupported-690"><span class="linenos">690</span></a><span class="sd">    Classes marked with this decorator won&#39;t show up in `get_all_tokenizers()` and thus wont be tested.</span>
</span><span id="mark_as_unsupported-691"><a href="#mark_as_unsupported-691"><span class="linenos">691</span></a><span class="sd">    The classes marked in release 1.0.0 did work reliably before being marked, but they can&#39;t be instantiated since the decorator adds an abstract method.</span>
</span><span id="mark_as_unsupported-692"><a href="#mark_as_unsupported-692"><span class="linenos">692</span></a><span class="sd">    The decorator exists to prune the space of tokenizers returned by `all_instances` both for testing and usage.</span>
</span><span id="mark_as_unsupported-693"><a href="#mark_as_unsupported-693"><span class="linenos">693</span></a><span class="sd">    Previously, the space was too large, resulting in impractical runtimes.</span>
</span><span id="mark_as_unsupported-694"><a href="#mark_as_unsupported-694"><span class="linenos">694</span></a><span class="sd">    These decorators could be removed in future releases to expand the space of possible tokenizers.</span>
</span><span id="mark_as_unsupported-695"><a href="#mark_as_unsupported-695"><span class="linenos">695</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="mark_as_unsupported-696"><a href="#mark_as_unsupported-696"><span class="linenos">696</span></a>
</span><span id="mark_as_unsupported-697"><a href="#mark_as_unsupported-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="mark_as_unsupported-698"><a href="#mark_as_unsupported-698"><span class="linenos">698</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">=</span> <span class="n">is_valid</span>
</span><span id="mark_as_unsupported-699"><a href="#mark_as_unsupported-699"><span class="linenos">699</span></a>        <span class="k">return</span> <span class="bp">cls</span>
</span><span id="mark_as_unsupported-700"><a href="#mark_as_unsupported-700"><span class="linenos">700</span></a>
</span><span id="mark_as_unsupported-701"><a href="#mark_as_unsupported-701"><span class="linenos">701</span></a>    <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>mark a _TokenizerElement as unsupported.</p>

<p>Classes marked with this decorator won't show up in <code>get_all_tokenizers()</code> and thus wont be tested.
The classes marked in release 1.0.0 did work reliably before being marked, but they can't be instantiated since the decorator adds an abstract method.
The decorator exists to prune the space of tokenizers returned by <code>all_instances</code> both for testing and usage.
Previously, the space was too large, resulting in impractical runtimes.
These decorators could be removed in future releases to expand the space of possible tokenizers.</p>
</div>


                </section>
                <section id="CoordTokenizers">
                            <input id="CoordTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoordTokenizers</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L729-L781" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers-730"><a href="#CoordTokenizers-730"><span class="linenos">730</span></a><span class="k">class</span> <span class="nc">CoordTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="CoordTokenizers-731"><a href="#CoordTokenizers-731"><span class="linenos">731</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_CoordTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-732"><a href="#CoordTokenizers-732"><span class="linenos">732</span></a>
</span><span id="CoordTokenizers-733"><a href="#CoordTokenizers-733"><span class="linenos">733</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;coord_tokenizer&quot;</span>
</span><span id="CoordTokenizers-734"><a href="#CoordTokenizers-734"><span class="linenos">734</span></a>
</span><span id="CoordTokenizers-735"><a href="#CoordTokenizers-735"><span class="linenos">735</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-736"><a href="#CoordTokenizers-736"><span class="linenos">736</span></a>    <span class="k">class</span> <span class="nc">_CoordTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="CoordTokenizers-737"><a href="#CoordTokenizers-737"><span class="linenos">737</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-738"><a href="#CoordTokenizers-738"><span class="linenos">738</span></a><span class="sd">        Superclass for classes which tokenize singular coords in a maze.</span>
</span><span id="CoordTokenizers-739"><a href="#CoordTokenizers-739"><span class="linenos">739</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-740"><a href="#CoordTokenizers-740"><span class="linenos">740</span></a>
</span><span id="CoordTokenizers-741"><a href="#CoordTokenizers-741"><span class="linenos">741</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="CoordTokenizers-742"><a href="#CoordTokenizers-742"><span class="linenos">742</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers-743"><a href="#CoordTokenizers-743"><span class="linenos">743</span></a>            <span class="k">pass</span>
</span><span id="CoordTokenizers-744"><a href="#CoordTokenizers-744"><span class="linenos">744</span></a>
</span><span id="CoordTokenizers-745"><a href="#CoordTokenizers-745"><span class="linenos">745</span></a>        <span class="nd">@classmethod</span>
</span><span id="CoordTokenizers-746"><a href="#CoordTokenizers-746"><span class="linenos">746</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CoordTokenizers-747"><a href="#CoordTokenizers-747"><span class="linenos">747</span></a>            <span class="k">return</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="CoordTokenizers-748"><a href="#CoordTokenizers-748"><span class="linenos">748</span></a>
</span><span id="CoordTokenizers-749"><a href="#CoordTokenizers-749"><span class="linenos">749</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CoordTokenizers-750"><a href="#CoordTokenizers-750"><span class="linenos">750</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="CoordTokenizers-751"><a href="#CoordTokenizers-751"><span class="linenos">751</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="CoordTokenizers-752"><a href="#CoordTokenizers-752"><span class="linenos">752</span></a>
</span><span id="CoordTokenizers-753"><a href="#CoordTokenizers-753"><span class="linenos">753</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-754"><a href="#CoordTokenizers-754"><span class="linenos">754</span></a>    <span class="k">class</span> <span class="nc">UT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers-755"><a href="#CoordTokenizers-755"><span class="linenos">755</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Unique token coordinate tokenizer.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-756"><a href="#CoordTokenizers-756"><span class="linenos">756</span></a>
</span><span id="CoordTokenizers-757"><a href="#CoordTokenizers-757"><span class="linenos">757</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers-758"><a href="#CoordTokenizers-758"><span class="linenos">758</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span><span id="CoordTokenizers-759"><a href="#CoordTokenizers-759"><span class="linenos">759</span></a>
</span><span id="CoordTokenizers-760"><a href="#CoordTokenizers-760"><span class="linenos">760</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-761"><a href="#CoordTokenizers-761"><span class="linenos">761</span></a>    <span class="k">class</span> <span class="nc">CTT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers-762"><a href="#CoordTokenizers-762"><span class="linenos">762</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Coordinate tuple tokenizer</span>
</span><span id="CoordTokenizers-763"><a href="#CoordTokenizers-763"><span class="linenos">763</span></a>
</span><span id="CoordTokenizers-764"><a href="#CoordTokenizers-764"><span class="linenos">764</span></a><span class="sd">        # Parameters</span>
</span><span id="CoordTokenizers-765"><a href="#CoordTokenizers-765"><span class="linenos">765</span></a><span class="sd">        - `pre`: Whether all coords include an integral preceding delimiter token</span>
</span><span id="CoordTokenizers-766"><a href="#CoordTokenizers-766"><span class="linenos">766</span></a><span class="sd">        - `intra`: Whether all coords include a delimiter token between coordinates</span>
</span><span id="CoordTokenizers-767"><a href="#CoordTokenizers-767"><span class="linenos">767</span></a><span class="sd">        - `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="CoordTokenizers-768"><a href="#CoordTokenizers-768"><span class="linenos">768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoordTokenizers-769"><a href="#CoordTokenizers-769"><span class="linenos">769</span></a>
</span><span id="CoordTokenizers-770"><a href="#CoordTokenizers-770"><span class="linenos">770</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-771"><a href="#CoordTokenizers-771"><span class="linenos">771</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-772"><a href="#CoordTokenizers-772"><span class="linenos">772</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers-773"><a href="#CoordTokenizers-773"><span class="linenos">773</span></a>        <span class="c1"># Implement methods</span>
</span><span id="CoordTokenizers-774"><a href="#CoordTokenizers-774"><span class="linenos">774</span></a>
</span><span id="CoordTokenizers-775"><a href="#CoordTokenizers-775"><span class="linenos">775</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers-776"><a href="#CoordTokenizers-776"><span class="linenos">776</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="CoordTokenizers-777"><a href="#CoordTokenizers-777"><span class="linenos">777</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers-778"><a href="#CoordTokenizers-778"><span class="linenos">778</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="CoordTokenizers-779"><a href="#CoordTokenizers-779"><span class="linenos">779</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers-780"><a href="#CoordTokenizers-780"><span class="linenos">780</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="CoordTokenizers-781"><a href="#CoordTokenizers-781"><span class="linenos">781</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers-782"><a href="#CoordTokenizers-782"><span class="linenos">782</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_CoordTokenizer</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="CoordTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;coord_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="CoordTokenizers.UT">
                            <input id="CoordTokenizers.UT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">CoordTokenizers.UT</span><wbr>(<span class="base"><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L752-L757" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT-753"><a href="#CoordTokenizers.UT-753"><span class="linenos">753</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT-754"><a href="#CoordTokenizers.UT-754"><span class="linenos">754</span></a>    <span class="k">class</span> <span class="nc">UT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT-755"><a href="#CoordTokenizers.UT-755"><span class="linenos">755</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Unique token coordinate tokenizer.&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.UT-756"><a href="#CoordTokenizers.UT-756"><span class="linenos">756</span></a>
</span><span id="CoordTokenizers.UT-757"><a href="#CoordTokenizers.UT-757"><span class="linenos">757</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers.UT-758"><a href="#CoordTokenizers.UT-758"><span class="linenos">758</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>Unique token coordinate tokenizer.</p>
</div>


                            <div id="CoordTokenizers.UT.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CoordTokenizers.UT</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.UT">CoordTokenizers.UT</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.UT">CoordTokenizers.UT</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.__init__"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.UT.to_tokens" class="classattr">
                                        <input id="CoordTokenizers.UT.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L756-L757" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.to_tokens-757"><a href="#CoordTokenizers.UT.to_tokens-757"><span class="linenos">757</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers.UT.to_tokens-758"><a href="#CoordTokenizers.UT.to_tokens-758"><span class="linenos">758</span></a>            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;)&quot;</span><span class="p">])]</span>
</span></pre></div>


            <div class="docstring"><p>Converts a maze element into a list of tokens.
Not all <code>_TokenizerElement</code> subclasses produce tokens, so this is not an abstract method.
Those subclasses which do produce tokens should override this method.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.UT.serialize" class="classattr">
                                        <input id="CoordTokenizers.UT.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.serialize-660"><a href="#CoordTokenizers.UT.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="CoordTokenizers.UT.serialize-661"><a href="#CoordTokenizers.UT.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="CoordTokenizers.UT.serialize-662"><a href="#CoordTokenizers.UT.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-663"><a href="#CoordTokenizers.UT.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="CoordTokenizers.UT.serialize-664"><a href="#CoordTokenizers.UT.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="CoordTokenizers.UT.serialize-665"><a href="#CoordTokenizers.UT.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="CoordTokenizers.UT.serialize-666"><a href="#CoordTokenizers.UT.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="CoordTokenizers.UT.serialize-667"><a href="#CoordTokenizers.UT.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-668"><a href="#CoordTokenizers.UT.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-669"><a href="#CoordTokenizers.UT.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="CoordTokenizers.UT.serialize-670"><a href="#CoordTokenizers.UT.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="CoordTokenizers.UT.serialize-671"><a href="#CoordTokenizers.UT.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-672"><a href="#CoordTokenizers.UT.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-673"><a href="#CoordTokenizers.UT.serialize-673"><span class="linenos">673</span></a>
</span><span id="CoordTokenizers.UT.serialize-674"><a href="#CoordTokenizers.UT.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="CoordTokenizers.UT.serialize-675"><a href="#CoordTokenizers.UT.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-676"><a href="#CoordTokenizers.UT.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-677"><a href="#CoordTokenizers.UT.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="CoordTokenizers.UT.serialize-678"><a href="#CoordTokenizers.UT.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-679"><a href="#CoordTokenizers.UT.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="CoordTokenizers.UT.serialize-680"><a href="#CoordTokenizers.UT.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-681"><a href="#CoordTokenizers.UT.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.serialize-682"><a href="#CoordTokenizers.UT.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="CoordTokenizers.UT.serialize-683"><a href="#CoordTokenizers.UT.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-684"><a href="#CoordTokenizers.UT.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.serialize-685"><a href="#CoordTokenizers.UT.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="CoordTokenizers.UT.serialize-686"><a href="#CoordTokenizers.UT.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="CoordTokenizers.UT.serialize-687"><a href="#CoordTokenizers.UT.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-688"><a href="#CoordTokenizers.UT.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-689"><a href="#CoordTokenizers.UT.serialize-689"><span class="linenos">689</span></a>
</span><span id="CoordTokenizers.UT.serialize-690"><a href="#CoordTokenizers.UT.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="CoordTokenizers.UT.serialize-691"><a href="#CoordTokenizers.UT.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.UT.serialize-692"><a href="#CoordTokenizers.UT.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-693"><a href="#CoordTokenizers.UT.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-694"><a href="#CoordTokenizers.UT.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-695"><a href="#CoordTokenizers.UT.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="CoordTokenizers.UT.serialize-696"><a href="#CoordTokenizers.UT.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-697"><a href="#CoordTokenizers.UT.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-698"><a href="#CoordTokenizers.UT.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-699"><a href="#CoordTokenizers.UT.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.serialize-700"><a href="#CoordTokenizers.UT.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="CoordTokenizers.UT.serialize-701"><a href="#CoordTokenizers.UT.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-702"><a href="#CoordTokenizers.UT.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="CoordTokenizers.UT.serialize-703"><a href="#CoordTokenizers.UT.serialize-703"><span class="linenos">703</span></a>
</span><span id="CoordTokenizers.UT.serialize-704"><a href="#CoordTokenizers.UT.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="CoordTokenizers.UT.serialize-705"><a href="#CoordTokenizers.UT.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-706"><a href="#CoordTokenizers.UT.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.serialize-707"><a href="#CoordTokenizers.UT.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-708"><a href="#CoordTokenizers.UT.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.UT.serialize-709"><a href="#CoordTokenizers.UT.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.serialize-710"><a href="#CoordTokenizers.UT.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.serialize-711"><a href="#CoordTokenizers.UT.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-712"><a href="#CoordTokenizers.UT.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-713"><a href="#CoordTokenizers.UT.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.serialize-714"><a href="#CoordTokenizers.UT.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.UT.serialize-715"><a href="#CoordTokenizers.UT.serialize-715"><span class="linenos">715</span></a>
</span><span id="CoordTokenizers.UT.serialize-716"><a href="#CoordTokenizers.UT.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="CoordTokenizers.UT.load" class="classattr">
                                        <input id="CoordTokenizers.UT.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.load-723"><a href="#CoordTokenizers.UT.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="CoordTokenizers.UT.load-724"><a href="#CoordTokenizers.UT.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="CoordTokenizers.UT.load-725"><a href="#CoordTokenizers.UT.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="CoordTokenizers.UT.load-726"><a href="#CoordTokenizers.UT.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-727"><a href="#CoordTokenizers.UT.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="CoordTokenizers.UT.load-728"><a href="#CoordTokenizers.UT.load-728"><span class="linenos">728</span></a>
</span><span id="CoordTokenizers.UT.load-729"><a href="#CoordTokenizers.UT.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-730"><a href="#CoordTokenizers.UT.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="CoordTokenizers.UT.load-731"><a href="#CoordTokenizers.UT.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.load-732"><a href="#CoordTokenizers.UT.load-732"><span class="linenos">732</span></a>
</span><span id="CoordTokenizers.UT.load-733"><a href="#CoordTokenizers.UT.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-734"><a href="#CoordTokenizers.UT.load-734"><span class="linenos">734</span></a>
</span><span id="CoordTokenizers.UT.load-735"><a href="#CoordTokenizers.UT.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="CoordTokenizers.UT.load-736"><a href="#CoordTokenizers.UT.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.load-737"><a href="#CoordTokenizers.UT.load-737"><span class="linenos">737</span></a>
</span><span id="CoordTokenizers.UT.load-738"><a href="#CoordTokenizers.UT.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="CoordTokenizers.UT.load-739"><a href="#CoordTokenizers.UT.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-740"><a href="#CoordTokenizers.UT.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="CoordTokenizers.UT.load-741"><a href="#CoordTokenizers.UT.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-742"><a href="#CoordTokenizers.UT.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="CoordTokenizers.UT.load-743"><a href="#CoordTokenizers.UT.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="CoordTokenizers.UT.load-744"><a href="#CoordTokenizers.UT.load-744"><span class="linenos">744</span></a>
</span><span id="CoordTokenizers.UT.load-745"><a href="#CoordTokenizers.UT.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="CoordTokenizers.UT.load-746"><a href="#CoordTokenizers.UT.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-747"><a href="#CoordTokenizers.UT.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="CoordTokenizers.UT.load-748"><a href="#CoordTokenizers.UT.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="CoordTokenizers.UT.load-749"><a href="#CoordTokenizers.UT.load-749"><span class="linenos">749</span></a>
</span><span id="CoordTokenizers.UT.load-750"><a href="#CoordTokenizers.UT.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="CoordTokenizers.UT.load-751"><a href="#CoordTokenizers.UT.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-752"><a href="#CoordTokenizers.UT.load-752"><span class="linenos">752</span></a>
</span><span id="CoordTokenizers.UT.load-753"><a href="#CoordTokenizers.UT.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="CoordTokenizers.UT.load-754"><a href="#CoordTokenizers.UT.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-755"><a href="#CoordTokenizers.UT.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="CoordTokenizers.UT.load-756"><a href="#CoordTokenizers.UT.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-757"><a href="#CoordTokenizers.UT.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-758"><a href="#CoordTokenizers.UT.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="CoordTokenizers.UT.load-759"><a href="#CoordTokenizers.UT.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-760"><a href="#CoordTokenizers.UT.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-761"><a href="#CoordTokenizers.UT.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="CoordTokenizers.UT.load-762"><a href="#CoordTokenizers.UT.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-763"><a href="#CoordTokenizers.UT.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-764"><a href="#CoordTokenizers.UT.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-765"><a href="#CoordTokenizers.UT.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="CoordTokenizers.UT.load-766"><a href="#CoordTokenizers.UT.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="CoordTokenizers.UT.load-767"><a href="#CoordTokenizers.UT.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-768"><a href="#CoordTokenizers.UT.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-769"><a href="#CoordTokenizers.UT.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.load-770"><a href="#CoordTokenizers.UT.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.UT.load-771"><a href="#CoordTokenizers.UT.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-772"><a href="#CoordTokenizers.UT.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-773"><a href="#CoordTokenizers.UT.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="CoordTokenizers.UT.load-774"><a href="#CoordTokenizers.UT.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="CoordTokenizers.UT.load-775"><a href="#CoordTokenizers.UT.load-775"><span class="linenos">775</span></a>
</span><span id="CoordTokenizers.UT.load-776"><a href="#CoordTokenizers.UT.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="CoordTokenizers.UT.load-777"><a href="#CoordTokenizers.UT.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.UT.load-778"><a href="#CoordTokenizers.UT.load-778"><span class="linenos">778</span></a>
</span><span id="CoordTokenizers.UT.load-779"><a href="#CoordTokenizers.UT.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="CoordTokenizers.UT.load-780"><a href="#CoordTokenizers.UT.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-781"><a href="#CoordTokenizers.UT.load-781"><span class="linenos">781</span></a>
</span><span id="CoordTokenizers.UT.load-782"><a href="#CoordTokenizers.UT.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="CoordTokenizers.UT.load-783"><a href="#CoordTokenizers.UT.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.load-784"><a href="#CoordTokenizers.UT.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="CoordTokenizers.UT.load-785"><a href="#CoordTokenizers.UT.load-785"><span class="linenos">785</span></a>
</span><span id="CoordTokenizers.UT.load-786"><a href="#CoordTokenizers.UT.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="CoordTokenizers.UT.load-787"><a href="#CoordTokenizers.UT.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="CoordTokenizers.UT.validate_fields_types" class="classattr">
                                        <input id="CoordTokenizers.UT.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.UT.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.UT.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.UT.validate_fields_types-271"><a href="#CoordTokenizers.UT.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-272"><a href="#CoordTokenizers.UT.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-273"><a href="#CoordTokenizers.UT.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-274"><a href="#CoordTokenizers.UT.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-275"><a href="#CoordTokenizers.UT.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-276"><a href="#CoordTokenizers.UT.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-277"><a href="#CoordTokenizers.UT.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-278"><a href="#CoordTokenizers.UT.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-279"><a href="#CoordTokenizers.UT.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CoordTokenizers.UT.validate_fields_types-280"><a href="#CoordTokenizers.UT.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></dt>
                                <dd id="CoordTokenizers.UT.attribute_key" class="function"><a href="#CoordTokenizers._CoordTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="CoordTokenizers.UT.is_valid" class="function"><a href="#CoordTokenizers._CoordTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="CoordTokenizers.UT.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="CoordTokenizers.UT.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="CoordTokenizers.UT.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="CoordTokenizers.UT.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="CoordTokenizers.UT.validate_field_type" class="function">validate_field_type</dd>
                <dd id="CoordTokenizers.UT.diff" class="function">diff</dd>
                <dd id="CoordTokenizers.UT.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoordTokenizers.CTT">
                            <input id="CoordTokenizers.CTT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">CoordTokenizers.CTT</span><wbr>(<span class="base"><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L759-L781" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT-760"><a href="#CoordTokenizers.CTT-760"><span class="linenos">760</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-761"><a href="#CoordTokenizers.CTT-761"><span class="linenos">761</span></a>    <span class="k">class</span> <span class="nc">CTT</span><span class="p">(</span><span class="n">_CoordTokenizer</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT-762"><a href="#CoordTokenizers.CTT-762"><span class="linenos">762</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Coordinate tuple tokenizer</span>
</span><span id="CoordTokenizers.CTT-763"><a href="#CoordTokenizers.CTT-763"><span class="linenos">763</span></a>
</span><span id="CoordTokenizers.CTT-764"><a href="#CoordTokenizers.CTT-764"><span class="linenos">764</span></a><span class="sd">        # Parameters</span>
</span><span id="CoordTokenizers.CTT-765"><a href="#CoordTokenizers.CTT-765"><span class="linenos">765</span></a><span class="sd">        - `pre`: Whether all coords include an integral preceding delimiter token</span>
</span><span id="CoordTokenizers.CTT-766"><a href="#CoordTokenizers.CTT-766"><span class="linenos">766</span></a><span class="sd">        - `intra`: Whether all coords include a delimiter token between coordinates</span>
</span><span id="CoordTokenizers.CTT-767"><a href="#CoordTokenizers.CTT-767"><span class="linenos">767</span></a><span class="sd">        - `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="CoordTokenizers.CTT-768"><a href="#CoordTokenizers.CTT-768"><span class="linenos">768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.CTT-769"><a href="#CoordTokenizers.CTT-769"><span class="linenos">769</span></a>
</span><span id="CoordTokenizers.CTT-770"><a href="#CoordTokenizers.CTT-770"><span class="linenos">770</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-771"><a href="#CoordTokenizers.CTT-771"><span class="linenos">771</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-772"><a href="#CoordTokenizers.CTT-772"><span class="linenos">772</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT-773"><a href="#CoordTokenizers.CTT-773"><span class="linenos">773</span></a>        <span class="c1"># Implement methods</span>
</span><span id="CoordTokenizers.CTT-774"><a href="#CoordTokenizers.CTT-774"><span class="linenos">774</span></a>
</span><span id="CoordTokenizers.CTT-775"><a href="#CoordTokenizers.CTT-775"><span class="linenos">775</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers.CTT-776"><a href="#CoordTokenizers.CTT-776"><span class="linenos">776</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="CoordTokenizers.CTT-777"><a href="#CoordTokenizers.CTT-777"><span class="linenos">777</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT-778"><a href="#CoordTokenizers.CTT-778"><span class="linenos">778</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT-779"><a href="#CoordTokenizers.CTT-779"><span class="linenos">779</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT-780"><a href="#CoordTokenizers.CTT-780"><span class="linenos">780</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT-781"><a href="#CoordTokenizers.CTT-781"><span class="linenos">781</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT-782"><a href="#CoordTokenizers.CTT-782"><span class="linenos">782</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Coordinate tuple tokenizer</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#CoordTokenizers.CTT.pre">pre</a></code>: Whether all coords include an integral preceding delimiter token</li>
<li><code><a href="#CoordTokenizers.CTT.intra">intra</a></code>: Whether all coords include a delimiter token between coordinates</li>
<li><code><a href="#CoordTokenizers.CTT.post">post</a></code>: Whether all coords include an integral following delimiter token</li>
</ul>
</div>


                            <div id="CoordTokenizers.CTT.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CoordTokenizers.CTT</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.CTT">CoordTokenizers.CTT</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#CoordTokenizers.CTT">CoordTokenizers.CTT</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.__init__"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.pre" class="classattr">
                                <div class="attr variable">
            <span class="name">pre</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.pre"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.intra" class="classattr">
                                <div class="attr variable">
            <span class="name">intra</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.intra"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.post" class="classattr">
                                <div class="attr variable">
            <span class="name">post</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.post"></a>
    
    

                            </div>
                            <div id="CoordTokenizers.CTT.to_tokens" class="classattr">
                                        <input id="CoordTokenizers.CTT.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">coord</span><span class="p">:</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L774-L781" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.to_tokens-775"><a href="#CoordTokenizers.CTT.to_tokens-775"><span class="linenos">775</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="CoordTokenizers.CTT.to_tokens-776"><a href="#CoordTokenizers.CTT.to_tokens-776"><span class="linenos">776</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="CoordTokenizers.CTT.to_tokens-777"><a href="#CoordTokenizers.CTT.to_tokens-777"><span class="linenos">777</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_PRE</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-778"><a href="#CoordTokenizers.CTT.to_tokens-778"><span class="linenos">778</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-779"><a href="#CoordTokenizers.CTT.to_tokens-779"><span class="linenos">779</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_INTRA</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-780"><a href="#CoordTokenizers.CTT.to_tokens-780"><span class="linenos">780</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-781"><a href="#CoordTokenizers.CTT.to_tokens-781"><span class="linenos">781</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">([</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">COORD_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="CoordTokenizers.CTT.to_tokens-782"><a href="#CoordTokenizers.CTT.to_tokens-782"><span class="linenos">782</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Converts a maze element into a list of tokens.
Not all <code>_TokenizerElement</code> subclasses produce tokens, so this is not an abstract method.
Those subclasses which do produce tokens should override this method.</p>
</div>


                            </div>
                            <div id="CoordTokenizers.CTT.serialize" class="classattr">
                                        <input id="CoordTokenizers.CTT.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.serialize-660"><a href="#CoordTokenizers.CTT.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="CoordTokenizers.CTT.serialize-661"><a href="#CoordTokenizers.CTT.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="CoordTokenizers.CTT.serialize-662"><a href="#CoordTokenizers.CTT.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-663"><a href="#CoordTokenizers.CTT.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="CoordTokenizers.CTT.serialize-664"><a href="#CoordTokenizers.CTT.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="CoordTokenizers.CTT.serialize-665"><a href="#CoordTokenizers.CTT.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="CoordTokenizers.CTT.serialize-666"><a href="#CoordTokenizers.CTT.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="CoordTokenizers.CTT.serialize-667"><a href="#CoordTokenizers.CTT.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-668"><a href="#CoordTokenizers.CTT.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-669"><a href="#CoordTokenizers.CTT.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-670"><a href="#CoordTokenizers.CTT.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-671"><a href="#CoordTokenizers.CTT.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-672"><a href="#CoordTokenizers.CTT.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-673"><a href="#CoordTokenizers.CTT.serialize-673"><span class="linenos">673</span></a>
</span><span id="CoordTokenizers.CTT.serialize-674"><a href="#CoordTokenizers.CTT.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="CoordTokenizers.CTT.serialize-675"><a href="#CoordTokenizers.CTT.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-676"><a href="#CoordTokenizers.CTT.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-677"><a href="#CoordTokenizers.CTT.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="CoordTokenizers.CTT.serialize-678"><a href="#CoordTokenizers.CTT.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-679"><a href="#CoordTokenizers.CTT.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="CoordTokenizers.CTT.serialize-680"><a href="#CoordTokenizers.CTT.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-681"><a href="#CoordTokenizers.CTT.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.serialize-682"><a href="#CoordTokenizers.CTT.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="CoordTokenizers.CTT.serialize-683"><a href="#CoordTokenizers.CTT.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-684"><a href="#CoordTokenizers.CTT.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.serialize-685"><a href="#CoordTokenizers.CTT.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="CoordTokenizers.CTT.serialize-686"><a href="#CoordTokenizers.CTT.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="CoordTokenizers.CTT.serialize-687"><a href="#CoordTokenizers.CTT.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-688"><a href="#CoordTokenizers.CTT.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-689"><a href="#CoordTokenizers.CTT.serialize-689"><span class="linenos">689</span></a>
</span><span id="CoordTokenizers.CTT.serialize-690"><a href="#CoordTokenizers.CTT.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="CoordTokenizers.CTT.serialize-691"><a href="#CoordTokenizers.CTT.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.CTT.serialize-692"><a href="#CoordTokenizers.CTT.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-693"><a href="#CoordTokenizers.CTT.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-694"><a href="#CoordTokenizers.CTT.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-695"><a href="#CoordTokenizers.CTT.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="CoordTokenizers.CTT.serialize-696"><a href="#CoordTokenizers.CTT.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-697"><a href="#CoordTokenizers.CTT.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-698"><a href="#CoordTokenizers.CTT.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-699"><a href="#CoordTokenizers.CTT.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.serialize-700"><a href="#CoordTokenizers.CTT.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="CoordTokenizers.CTT.serialize-701"><a href="#CoordTokenizers.CTT.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-702"><a href="#CoordTokenizers.CTT.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="CoordTokenizers.CTT.serialize-703"><a href="#CoordTokenizers.CTT.serialize-703"><span class="linenos">703</span></a>
</span><span id="CoordTokenizers.CTT.serialize-704"><a href="#CoordTokenizers.CTT.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="CoordTokenizers.CTT.serialize-705"><a href="#CoordTokenizers.CTT.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-706"><a href="#CoordTokenizers.CTT.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.serialize-707"><a href="#CoordTokenizers.CTT.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-708"><a href="#CoordTokenizers.CTT.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.CTT.serialize-709"><a href="#CoordTokenizers.CTT.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.serialize-710"><a href="#CoordTokenizers.CTT.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.serialize-711"><a href="#CoordTokenizers.CTT.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-712"><a href="#CoordTokenizers.CTT.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-713"><a href="#CoordTokenizers.CTT.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.serialize-714"><a href="#CoordTokenizers.CTT.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.serialize-715"><a href="#CoordTokenizers.CTT.serialize-715"><span class="linenos">715</span></a>
</span><span id="CoordTokenizers.CTT.serialize-716"><a href="#CoordTokenizers.CTT.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="CoordTokenizers.CTT.load" class="classattr">
                                        <input id="CoordTokenizers.CTT.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.load-723"><a href="#CoordTokenizers.CTT.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="CoordTokenizers.CTT.load-724"><a href="#CoordTokenizers.CTT.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="CoordTokenizers.CTT.load-725"><a href="#CoordTokenizers.CTT.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="CoordTokenizers.CTT.load-726"><a href="#CoordTokenizers.CTT.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-727"><a href="#CoordTokenizers.CTT.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="CoordTokenizers.CTT.load-728"><a href="#CoordTokenizers.CTT.load-728"><span class="linenos">728</span></a>
</span><span id="CoordTokenizers.CTT.load-729"><a href="#CoordTokenizers.CTT.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-730"><a href="#CoordTokenizers.CTT.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="CoordTokenizers.CTT.load-731"><a href="#CoordTokenizers.CTT.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.load-732"><a href="#CoordTokenizers.CTT.load-732"><span class="linenos">732</span></a>
</span><span id="CoordTokenizers.CTT.load-733"><a href="#CoordTokenizers.CTT.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-734"><a href="#CoordTokenizers.CTT.load-734"><span class="linenos">734</span></a>
</span><span id="CoordTokenizers.CTT.load-735"><a href="#CoordTokenizers.CTT.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="CoordTokenizers.CTT.load-736"><a href="#CoordTokenizers.CTT.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.load-737"><a href="#CoordTokenizers.CTT.load-737"><span class="linenos">737</span></a>
</span><span id="CoordTokenizers.CTT.load-738"><a href="#CoordTokenizers.CTT.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="CoordTokenizers.CTT.load-739"><a href="#CoordTokenizers.CTT.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-740"><a href="#CoordTokenizers.CTT.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="CoordTokenizers.CTT.load-741"><a href="#CoordTokenizers.CTT.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-742"><a href="#CoordTokenizers.CTT.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="CoordTokenizers.CTT.load-743"><a href="#CoordTokenizers.CTT.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="CoordTokenizers.CTT.load-744"><a href="#CoordTokenizers.CTT.load-744"><span class="linenos">744</span></a>
</span><span id="CoordTokenizers.CTT.load-745"><a href="#CoordTokenizers.CTT.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="CoordTokenizers.CTT.load-746"><a href="#CoordTokenizers.CTT.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-747"><a href="#CoordTokenizers.CTT.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="CoordTokenizers.CTT.load-748"><a href="#CoordTokenizers.CTT.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="CoordTokenizers.CTT.load-749"><a href="#CoordTokenizers.CTT.load-749"><span class="linenos">749</span></a>
</span><span id="CoordTokenizers.CTT.load-750"><a href="#CoordTokenizers.CTT.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="CoordTokenizers.CTT.load-751"><a href="#CoordTokenizers.CTT.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-752"><a href="#CoordTokenizers.CTT.load-752"><span class="linenos">752</span></a>
</span><span id="CoordTokenizers.CTT.load-753"><a href="#CoordTokenizers.CTT.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="CoordTokenizers.CTT.load-754"><a href="#CoordTokenizers.CTT.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-755"><a href="#CoordTokenizers.CTT.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="CoordTokenizers.CTT.load-756"><a href="#CoordTokenizers.CTT.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-757"><a href="#CoordTokenizers.CTT.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-758"><a href="#CoordTokenizers.CTT.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="CoordTokenizers.CTT.load-759"><a href="#CoordTokenizers.CTT.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-760"><a href="#CoordTokenizers.CTT.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-761"><a href="#CoordTokenizers.CTT.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="CoordTokenizers.CTT.load-762"><a href="#CoordTokenizers.CTT.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-763"><a href="#CoordTokenizers.CTT.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-764"><a href="#CoordTokenizers.CTT.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-765"><a href="#CoordTokenizers.CTT.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="CoordTokenizers.CTT.load-766"><a href="#CoordTokenizers.CTT.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="CoordTokenizers.CTT.load-767"><a href="#CoordTokenizers.CTT.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-768"><a href="#CoordTokenizers.CTT.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-769"><a href="#CoordTokenizers.CTT.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.load-770"><a href="#CoordTokenizers.CTT.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="CoordTokenizers.CTT.load-771"><a href="#CoordTokenizers.CTT.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-772"><a href="#CoordTokenizers.CTT.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-773"><a href="#CoordTokenizers.CTT.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="CoordTokenizers.CTT.load-774"><a href="#CoordTokenizers.CTT.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="CoordTokenizers.CTT.load-775"><a href="#CoordTokenizers.CTT.load-775"><span class="linenos">775</span></a>
</span><span id="CoordTokenizers.CTT.load-776"><a href="#CoordTokenizers.CTT.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="CoordTokenizers.CTT.load-777"><a href="#CoordTokenizers.CTT.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="CoordTokenizers.CTT.load-778"><a href="#CoordTokenizers.CTT.load-778"><span class="linenos">778</span></a>
</span><span id="CoordTokenizers.CTT.load-779"><a href="#CoordTokenizers.CTT.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="CoordTokenizers.CTT.load-780"><a href="#CoordTokenizers.CTT.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-781"><a href="#CoordTokenizers.CTT.load-781"><span class="linenos">781</span></a>
</span><span id="CoordTokenizers.CTT.load-782"><a href="#CoordTokenizers.CTT.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="CoordTokenizers.CTT.load-783"><a href="#CoordTokenizers.CTT.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.load-784"><a href="#CoordTokenizers.CTT.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="CoordTokenizers.CTT.load-785"><a href="#CoordTokenizers.CTT.load-785"><span class="linenos">785</span></a>
</span><span id="CoordTokenizers.CTT.load-786"><a href="#CoordTokenizers.CTT.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="CoordTokenizers.CTT.load-787"><a href="#CoordTokenizers.CTT.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="CoordTokenizers.CTT.validate_fields_types" class="classattr">
                                        <input id="CoordTokenizers.CTT.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="CoordTokenizers.CTT.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#CoordTokenizers.CTT.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoordTokenizers.CTT.validate_fields_types-271"><a href="#CoordTokenizers.CTT.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-272"><a href="#CoordTokenizers.CTT.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-273"><a href="#CoordTokenizers.CTT.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-274"><a href="#CoordTokenizers.CTT.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-275"><a href="#CoordTokenizers.CTT.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-276"><a href="#CoordTokenizers.CTT.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-277"><a href="#CoordTokenizers.CTT.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-278"><a href="#CoordTokenizers.CTT.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-279"><a href="#CoordTokenizers.CTT.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CoordTokenizers.CTT.validate_fields_types-280"><a href="#CoordTokenizers.CTT.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#CoordTokenizers._CoordTokenizer">CoordTokenizers._CoordTokenizer</a></dt>
                                <dd id="CoordTokenizers.CTT.attribute_key" class="function"><a href="#CoordTokenizers._CoordTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="CoordTokenizers.CTT.is_valid" class="function"><a href="#CoordTokenizers._CoordTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="CoordTokenizers.CTT.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="CoordTokenizers.CTT.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="CoordTokenizers.CTT.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="CoordTokenizers.CTT.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="CoordTokenizers.CTT.validate_field_type" class="function">validate_field_type</dd>
                <dd id="CoordTokenizers.CTT.diff" class="function">diff</dd>
                <dd id="CoordTokenizers.CTT.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeGroupings">
                            <input id="EdgeGroupings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EdgeGroupings</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L784-L889" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings-785"><a href="#EdgeGroupings-785"><span class="linenos">785</span></a><span class="k">class</span> <span class="nc">EdgeGroupings</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="EdgeGroupings-786"><a href="#EdgeGroupings-786"><span class="linenos">786</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgeGrouping` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-787"><a href="#EdgeGroupings-787"><span class="linenos">787</span></a>
</span><span id="EdgeGroupings-788"><a href="#EdgeGroupings-788"><span class="linenos">788</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_grouping&quot;</span>
</span><span id="EdgeGroupings-789"><a href="#EdgeGroupings-789"><span class="linenos">789</span></a>
</span><span id="EdgeGroupings-790"><a href="#EdgeGroupings-790"><span class="linenos">790</span></a>    <span class="k">class</span> <span class="nc">_GroupingTokenParams</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="EdgeGroupings-791"><a href="#EdgeGroupings-791"><span class="linenos">791</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A uniform private hyperparameter interface used by `AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-792"><a href="#EdgeGroupings-792"><span class="linenos">792</span></a>
</span><span id="EdgeGroupings-793"><a href="#EdgeGroupings-793"><span class="linenos">793</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="EdgeGroupings-794"><a href="#EdgeGroupings-794"><span class="linenos">794</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="EdgeGroupings-795"><a href="#EdgeGroupings-795"><span class="linenos">795</span></a>        <span class="n">grouped</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="EdgeGroupings-796"><a href="#EdgeGroupings-796"><span class="linenos">796</span></a>
</span><span id="EdgeGroupings-797"><a href="#EdgeGroupings-797"><span class="linenos">797</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-798"><a href="#EdgeGroupings-798"><span class="linenos">798</span></a>    <span class="k">class</span> <span class="nc">_EdgeGrouping</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EdgeGroupings-799"><a href="#EdgeGroupings-799"><span class="linenos">799</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called a edge grouping.&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-800"><a href="#EdgeGroupings-800"><span class="linenos">800</span></a>
</span><span id="EdgeGroupings-801"><a href="#EdgeGroupings-801"><span class="linenos">801</span></a>        <span class="nd">@classmethod</span>
</span><span id="EdgeGroupings-802"><a href="#EdgeGroupings-802"><span class="linenos">802</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="EdgeGroupings-803"><a href="#EdgeGroupings-803"><span class="linenos">803</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">key</span>
</span><span id="EdgeGroupings-804"><a href="#EdgeGroupings-804"><span class="linenos">804</span></a>
</span><span id="EdgeGroupings-805"><a href="#EdgeGroupings-805"><span class="linenos">805</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeGroupings-806"><a href="#EdgeGroupings-806"><span class="linenos">806</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="EdgeGroupings-807"><a href="#EdgeGroupings-807"><span class="linenos">807</span></a>
</span><span id="EdgeGroupings-808"><a href="#EdgeGroupings-808"><span class="linenos">808</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgeGroupings-809"><a href="#EdgeGroupings-809"><span class="linenos">809</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings-810"><a href="#EdgeGroupings-810"><span class="linenos">810</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Divides a ConnectionArray into groups of edges.</span>
</span><span id="EdgeGroupings-811"><a href="#EdgeGroupings-811"><span class="linenos">811</span></a><span class="sd">            Shuffles/sequences within each group if applicable.</span>
</span><span id="EdgeGroupings-812"><a href="#EdgeGroupings-812"><span class="linenos">812</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-813"><a href="#EdgeGroupings-813"><span class="linenos">813</span></a>            <span class="k">pass</span>
</span><span id="EdgeGroupings-814"><a href="#EdgeGroupings-814"><span class="linenos">814</span></a>
</span><span id="EdgeGroupings-815"><a href="#EdgeGroupings-815"><span class="linenos">815</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgeGroupings-816"><a href="#EdgeGroupings-816"><span class="linenos">816</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings-817"><a href="#EdgeGroupings-817"><span class="linenos">817</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the tok.nization hyperparameters necessary for an `AdjListTokenizer` to tokenize.</span>
</span><span id="EdgeGroupings-818"><a href="#EdgeGroupings-818"><span class="linenos">818</span></a>
</span><span id="EdgeGroupings-819"><a href="#EdgeGroupings-819"><span class="linenos">819</span></a><span class="sd">            These hyperparameters are not used by `_EdgeGrouping` internally.</span>
</span><span id="EdgeGroupings-820"><a href="#EdgeGroupings-820"><span class="linenos">820</span></a><span class="sd">            They are located in `_EdgeGrouping` rather than in `AdjListTokenizer`</span>
</span><span id="EdgeGroupings-821"><a href="#EdgeGroupings-821"><span class="linenos">821</span></a><span class="sd">            since the hyperparameter space is a function of the `_EdgeGrouping` subclass.</span>
</span><span id="EdgeGroupings-822"><a href="#EdgeGroupings-822"><span class="linenos">822</span></a><span class="sd">            This function resolves the `_EdgeGrouping` hyperparameter space which is non-uniform across subclasses</span>
</span><span id="EdgeGroupings-823"><a href="#EdgeGroupings-823"><span class="linenos">823</span></a><span class="sd">            into a uniform private interface used by `AdjListTokenizer`.</span>
</span><span id="EdgeGroupings-824"><a href="#EdgeGroupings-824"><span class="linenos">824</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-825"><a href="#EdgeGroupings-825"><span class="linenos">825</span></a>            <span class="k">pass</span>
</span><span id="EdgeGroupings-826"><a href="#EdgeGroupings-826"><span class="linenos">826</span></a>
</span><span id="EdgeGroupings-827"><a href="#EdgeGroupings-827"><span class="linenos">827</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-828"><a href="#EdgeGroupings-828"><span class="linenos">828</span></a>    <span class="k">class</span> <span class="nc">Ungrouped</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings-829"><a href="#EdgeGroupings-829"><span class="linenos">829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;No grouping occurs, each edge is tokenized individually.</span>
</span><span id="EdgeGroupings-830"><a href="#EdgeGroupings-830"><span class="linenos">830</span></a>
</span><span id="EdgeGroupings-831"><a href="#EdgeGroupings-831"><span class="linenos">831</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeGroupings-832"><a href="#EdgeGroupings-832"><span class="linenos">832</span></a><span class="sd">        - `connection_token_ordinal`: At which index in the edge tokenization the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings-833"><a href="#EdgeGroupings-833"><span class="linenos">833</span></a><span class="sd">        Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</span>
</span><span id="EdgeGroupings-834"><a href="#EdgeGroupings-834"><span class="linenos">834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-835"><a href="#EdgeGroupings-835"><span class="linenos">835</span></a>
</span><span id="EdgeGroupings-836"><a href="#EdgeGroupings-836"><span class="linenos">836</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings-837"><a href="#EdgeGroupings-837"><span class="linenos">837</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeGroupings-838"><a href="#EdgeGroupings-838"><span class="linenos">838</span></a>        <span class="p">)</span>
</span><span id="EdgeGroupings-839"><a href="#EdgeGroupings-839"><span class="linenos">839</span></a>
</span><span id="EdgeGroupings-840"><a href="#EdgeGroupings-840"><span class="linenos">840</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings-841"><a href="#EdgeGroupings-841"><span class="linenos">841</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings-842"><a href="#EdgeGroupings-842"><span class="linenos">842</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings-843"><a href="#EdgeGroupings-843"><span class="linenos">843</span></a>                <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings-844"><a href="#EdgeGroupings-844"><span class="linenos">844</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings-845"><a href="#EdgeGroupings-845"><span class="linenos">845</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings-846"><a href="#EdgeGroupings-846"><span class="linenos">846</span></a>
</span><span id="EdgeGroupings-847"><a href="#EdgeGroupings-847"><span class="linenos">847</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionList</span><span class="p">]:</span>
</span><span id="EdgeGroupings-848"><a href="#EdgeGroupings-848"><span class="linenos">848</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EdgeGroupings-849"><a href="#EdgeGroupings-849"><span class="linenos">849</span></a>
</span><span id="EdgeGroupings-850"><a href="#EdgeGroupings-850"><span class="linenos">850</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-851"><a href="#EdgeGroupings-851"><span class="linenos">851</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeGroupings-852"><a href="#EdgeGroupings-852"><span class="linenos">852</span></a>    <span class="k">class</span> <span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings-853"><a href="#EdgeGroupings-853"><span class="linenos">853</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="EdgeGroupings-854"><a href="#EdgeGroupings-854"><span class="linenos">854</span></a>
</span><span id="EdgeGroupings-855"><a href="#EdgeGroupings-855"><span class="linenos">855</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeGroupings-856"><a href="#EdgeGroupings-856"><span class="linenos">856</span></a><span class="sd">        - `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="EdgeGroupings-857"><a href="#EdgeGroupings-857"><span class="linenos">857</span></a><span class="sd">        Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="EdgeGroupings-858"><a href="#EdgeGroupings-858"><span class="linenos">858</span></a><span class="sd">        - `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="EdgeGroupings-859"><a href="#EdgeGroupings-859"><span class="linenos">859</span></a><span class="sd">        If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="EdgeGroupings-860"><a href="#EdgeGroupings-860"><span class="linenos">860</span></a><span class="sd">        In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="EdgeGroupings-861"><a href="#EdgeGroupings-861"><span class="linenos">861</span></a><span class="sd">        - `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings-862"><a href="#EdgeGroupings-862"><span class="linenos">862</span></a><span class="sd">        Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="EdgeGroupings-863"><a href="#EdgeGroupings-863"><span class="linenos">863</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings-864"><a href="#EdgeGroupings-864"><span class="linenos">864</span></a>
</span><span id="EdgeGroupings-865"><a href="#EdgeGroupings-865"><span class="linenos">865</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-866"><a href="#EdgeGroupings-866"><span class="linenos">866</span></a>        <span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings-867"><a href="#EdgeGroupings-867"><span class="linenos">867</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings-868"><a href="#EdgeGroupings-868"><span class="linenos">868</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeGroupings-869"><a href="#EdgeGroupings-869"><span class="linenos">869</span></a>        <span class="p">)</span>
</span><span id="EdgeGroupings-870"><a href="#EdgeGroupings-870"><span class="linenos">870</span></a>
</span><span id="EdgeGroupings-871"><a href="#EdgeGroupings-871"><span class="linenos">871</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings-872"><a href="#EdgeGroupings-872"><span class="linenos">872</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings-873"><a href="#EdgeGroupings-873"><span class="linenos">873</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings-874"><a href="#EdgeGroupings-874"><span class="linenos">874</span></a>                <span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="EdgeGroupings-875"><a href="#EdgeGroupings-875"><span class="linenos">875</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EdgeGroupings-876"><a href="#EdgeGroupings-876"><span class="linenos">876</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings-877"><a href="#EdgeGroupings-877"><span class="linenos">877</span></a>
</span><span id="EdgeGroupings-878"><a href="#EdgeGroupings-878"><span class="linenos">878</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings-879"><a href="#EdgeGroupings-879"><span class="linenos">879</span></a>            <span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="EdgeGroupings-880"><a href="#EdgeGroupings-880"><span class="linenos">880</span></a>            <span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgeGroupings-881"><a href="#EdgeGroupings-881"><span class="linenos">881</span></a>                <span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="EdgeGroupings-882"><a href="#EdgeGroupings-882"><span class="linenos">882</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings-883"><a href="#EdgeGroupings-883"><span class="linenos">883</span></a>            <span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="EdgeGroupings-884"><a href="#EdgeGroupings-884"><span class="linenos">884</span></a>            <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="EdgeGroupings-885"><a href="#EdgeGroupings-885"><span class="linenos">885</span></a>                <span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="EdgeGroupings-886"><a href="#EdgeGroupings-886"><span class="linenos">886</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="EdgeGroupings-887"><a href="#EdgeGroupings-887"><span class="linenos">887</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings-888"><a href="#EdgeGroupings-888"><span class="linenos">888</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="EdgeGroupings-889"><a href="#EdgeGroupings-889"><span class="linenos">889</span></a>                <span class="p">[</span><span class="n">numpy_rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="EdgeGroupings-890"><a href="#EdgeGroupings-890"><span class="linenos">890</span></a>            <span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_EdgeGrouping</code> subclass hierarchy used by <code>_AdjListTokenizer</code>.</p>
</div>


                            <div id="EdgeGroupings.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;edge_grouping&#39;</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.key"></a>
    
    

                            </div>
                </section>
                <section id="EdgeGroupings.Ungrouped">
                            <input id="EdgeGroupings.Ungrouped-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgeGroupings.Ungrouped</span><wbr>(<span class="base"><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L826-L847" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped-827"><a href="#EdgeGroupings.Ungrouped-827"><span class="linenos">827</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped-828"><a href="#EdgeGroupings.Ungrouped-828"><span class="linenos">828</span></a>    <span class="k">class</span> <span class="nc">Ungrouped</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped-829"><a href="#EdgeGroupings.Ungrouped-829"><span class="linenos">829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;No grouping occurs, each edge is tokenized individually.</span>
</span><span id="EdgeGroupings.Ungrouped-830"><a href="#EdgeGroupings.Ungrouped-830"><span class="linenos">830</span></a>
</span><span id="EdgeGroupings.Ungrouped-831"><a href="#EdgeGroupings.Ungrouped-831"><span class="linenos">831</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeGroupings.Ungrouped-832"><a href="#EdgeGroupings.Ungrouped-832"><span class="linenos">832</span></a><span class="sd">        - `connection_token_ordinal`: At which index in the edge tokenization the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings.Ungrouped-833"><a href="#EdgeGroupings.Ungrouped-833"><span class="linenos">833</span></a><span class="sd">        Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</span>
</span><span id="EdgeGroupings.Ungrouped-834"><a href="#EdgeGroupings.Ungrouped-834"><span class="linenos">834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.Ungrouped-835"><a href="#EdgeGroupings.Ungrouped-835"><span class="linenos">835</span></a>
</span><span id="EdgeGroupings.Ungrouped-836"><a href="#EdgeGroupings.Ungrouped-836"><span class="linenos">836</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped-837"><a href="#EdgeGroupings.Ungrouped-837"><span class="linenos">837</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeGroupings.Ungrouped-838"><a href="#EdgeGroupings.Ungrouped-838"><span class="linenos">838</span></a>        <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped-839"><a href="#EdgeGroupings.Ungrouped-839"><span class="linenos">839</span></a>
</span><span id="EdgeGroupings.Ungrouped-840"><a href="#EdgeGroupings.Ungrouped-840"><span class="linenos">840</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped-841"><a href="#EdgeGroupings.Ungrouped-841"><span class="linenos">841</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped-842"><a href="#EdgeGroupings.Ungrouped-842"><span class="linenos">842</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-843"><a href="#EdgeGroupings.Ungrouped-843"><span class="linenos">843</span></a>                <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-844"><a href="#EdgeGroupings.Ungrouped-844"><span class="linenos">844</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped-845"><a href="#EdgeGroupings.Ungrouped-845"><span class="linenos">845</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped-846"><a href="#EdgeGroupings.Ungrouped-846"><span class="linenos">846</span></a>
</span><span id="EdgeGroupings.Ungrouped-847"><a href="#EdgeGroupings.Ungrouped-847"><span class="linenos">847</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionList</span><span class="p">]:</span>
</span><span id="EdgeGroupings.Ungrouped-848"><a href="#EdgeGroupings.Ungrouped-848"><span class="linenos">848</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>No grouping occurs, each edge is tokenized individually.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#EdgeGroupings.Ungrouped.connection_token_ordinal">connection_token_ordinal</a></code>: At which index in the edge tokenization the connector (or wall) token appears.
Edge tokenizations contain 3 parts: a leading coord, a connector (or wall) token, and either a second coord or cardinal direction tokenization.</li>
</ul>
</div>


                            <div id="EdgeGroupings.Ungrouped.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeGroupings.Ungrouped</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.__init__"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.Ungrouped.connection_token_ordinal" class="classattr">
                                <div class="attr variable">
            <span class="name">connection_token_ordinal</span><span class="annotation">: Literal[0, 1, 2]</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.connection_token_ordinal"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.Ungrouped.serialize" class="classattr">
                                        <input id="EdgeGroupings.Ungrouped.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped.serialize-660"><a href="#EdgeGroupings.Ungrouped.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-661"><a href="#EdgeGroupings.Ungrouped.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-662"><a href="#EdgeGroupings.Ungrouped.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-663"><a href="#EdgeGroupings.Ungrouped.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-664"><a href="#EdgeGroupings.Ungrouped.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-665"><a href="#EdgeGroupings.Ungrouped.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-666"><a href="#EdgeGroupings.Ungrouped.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-667"><a href="#EdgeGroupings.Ungrouped.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-668"><a href="#EdgeGroupings.Ungrouped.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-669"><a href="#EdgeGroupings.Ungrouped.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-670"><a href="#EdgeGroupings.Ungrouped.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-671"><a href="#EdgeGroupings.Ungrouped.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-672"><a href="#EdgeGroupings.Ungrouped.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-673"><a href="#EdgeGroupings.Ungrouped.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-674"><a href="#EdgeGroupings.Ungrouped.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-675"><a href="#EdgeGroupings.Ungrouped.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-676"><a href="#EdgeGroupings.Ungrouped.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-677"><a href="#EdgeGroupings.Ungrouped.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-678"><a href="#EdgeGroupings.Ungrouped.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-679"><a href="#EdgeGroupings.Ungrouped.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-680"><a href="#EdgeGroupings.Ungrouped.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-681"><a href="#EdgeGroupings.Ungrouped.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-682"><a href="#EdgeGroupings.Ungrouped.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-683"><a href="#EdgeGroupings.Ungrouped.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-684"><a href="#EdgeGroupings.Ungrouped.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-685"><a href="#EdgeGroupings.Ungrouped.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-686"><a href="#EdgeGroupings.Ungrouped.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-687"><a href="#EdgeGroupings.Ungrouped.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-688"><a href="#EdgeGroupings.Ungrouped.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-689"><a href="#EdgeGroupings.Ungrouped.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-690"><a href="#EdgeGroupings.Ungrouped.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-691"><a href="#EdgeGroupings.Ungrouped.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-692"><a href="#EdgeGroupings.Ungrouped.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-693"><a href="#EdgeGroupings.Ungrouped.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-694"><a href="#EdgeGroupings.Ungrouped.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-695"><a href="#EdgeGroupings.Ungrouped.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-696"><a href="#EdgeGroupings.Ungrouped.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-697"><a href="#EdgeGroupings.Ungrouped.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-698"><a href="#EdgeGroupings.Ungrouped.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-699"><a href="#EdgeGroupings.Ungrouped.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-700"><a href="#EdgeGroupings.Ungrouped.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-701"><a href="#EdgeGroupings.Ungrouped.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-702"><a href="#EdgeGroupings.Ungrouped.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-703"><a href="#EdgeGroupings.Ungrouped.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-704"><a href="#EdgeGroupings.Ungrouped.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-705"><a href="#EdgeGroupings.Ungrouped.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-706"><a href="#EdgeGroupings.Ungrouped.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-707"><a href="#EdgeGroupings.Ungrouped.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-708"><a href="#EdgeGroupings.Ungrouped.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-709"><a href="#EdgeGroupings.Ungrouped.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-710"><a href="#EdgeGroupings.Ungrouped.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-711"><a href="#EdgeGroupings.Ungrouped.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-712"><a href="#EdgeGroupings.Ungrouped.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-713"><a href="#EdgeGroupings.Ungrouped.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-714"><a href="#EdgeGroupings.Ungrouped.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.serialize-715"><a href="#EdgeGroupings.Ungrouped.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgeGroupings.Ungrouped.serialize-716"><a href="#EdgeGroupings.Ungrouped.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeGroupings.Ungrouped.load" class="classattr">
                                        <input id="EdgeGroupings.Ungrouped.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped.load-723"><a href="#EdgeGroupings.Ungrouped.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeGroupings.Ungrouped.load-724"><a href="#EdgeGroupings.Ungrouped.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeGroupings.Ungrouped.load-725"><a href="#EdgeGroupings.Ungrouped.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeGroupings.Ungrouped.load-726"><a href="#EdgeGroupings.Ungrouped.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-727"><a href="#EdgeGroupings.Ungrouped.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeGroupings.Ungrouped.load-728"><a href="#EdgeGroupings.Ungrouped.load-728"><span class="linenos">728</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-729"><a href="#EdgeGroupings.Ungrouped.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-730"><a href="#EdgeGroupings.Ungrouped.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeGroupings.Ungrouped.load-731"><a href="#EdgeGroupings.Ungrouped.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-732"><a href="#EdgeGroupings.Ungrouped.load-732"><span class="linenos">732</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-733"><a href="#EdgeGroupings.Ungrouped.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-734"><a href="#EdgeGroupings.Ungrouped.load-734"><span class="linenos">734</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-735"><a href="#EdgeGroupings.Ungrouped.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeGroupings.Ungrouped.load-736"><a href="#EdgeGroupings.Ungrouped.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.load-737"><a href="#EdgeGroupings.Ungrouped.load-737"><span class="linenos">737</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-738"><a href="#EdgeGroupings.Ungrouped.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeGroupings.Ungrouped.load-739"><a href="#EdgeGroupings.Ungrouped.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-740"><a href="#EdgeGroupings.Ungrouped.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeGroupings.Ungrouped.load-741"><a href="#EdgeGroupings.Ungrouped.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-742"><a href="#EdgeGroupings.Ungrouped.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeGroupings.Ungrouped.load-743"><a href="#EdgeGroupings.Ungrouped.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-744"><a href="#EdgeGroupings.Ungrouped.load-744"><span class="linenos">744</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-745"><a href="#EdgeGroupings.Ungrouped.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeGroupings.Ungrouped.load-746"><a href="#EdgeGroupings.Ungrouped.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-747"><a href="#EdgeGroupings.Ungrouped.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeGroupings.Ungrouped.load-748"><a href="#EdgeGroupings.Ungrouped.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeGroupings.Ungrouped.load-749"><a href="#EdgeGroupings.Ungrouped.load-749"><span class="linenos">749</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-750"><a href="#EdgeGroupings.Ungrouped.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeGroupings.Ungrouped.load-751"><a href="#EdgeGroupings.Ungrouped.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-752"><a href="#EdgeGroupings.Ungrouped.load-752"><span class="linenos">752</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-753"><a href="#EdgeGroupings.Ungrouped.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeGroupings.Ungrouped.load-754"><a href="#EdgeGroupings.Ungrouped.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-755"><a href="#EdgeGroupings.Ungrouped.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.load-756"><a href="#EdgeGroupings.Ungrouped.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-757"><a href="#EdgeGroupings.Ungrouped.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-758"><a href="#EdgeGroupings.Ungrouped.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeGroupings.Ungrouped.load-759"><a href="#EdgeGroupings.Ungrouped.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-760"><a href="#EdgeGroupings.Ungrouped.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-761"><a href="#EdgeGroupings.Ungrouped.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeGroupings.Ungrouped.load-762"><a href="#EdgeGroupings.Ungrouped.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-763"><a href="#EdgeGroupings.Ungrouped.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-764"><a href="#EdgeGroupings.Ungrouped.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-765"><a href="#EdgeGroupings.Ungrouped.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeGroupings.Ungrouped.load-766"><a href="#EdgeGroupings.Ungrouped.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeGroupings.Ungrouped.load-767"><a href="#EdgeGroupings.Ungrouped.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-768"><a href="#EdgeGroupings.Ungrouped.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-769"><a href="#EdgeGroupings.Ungrouped.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.load-770"><a href="#EdgeGroupings.Ungrouped.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.load-771"><a href="#EdgeGroupings.Ungrouped.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-772"><a href="#EdgeGroupings.Ungrouped.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-773"><a href="#EdgeGroupings.Ungrouped.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeGroupings.Ungrouped.load-774"><a href="#EdgeGroupings.Ungrouped.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgeGroupings.Ungrouped.load-775"><a href="#EdgeGroupings.Ungrouped.load-775"><span class="linenos">775</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-776"><a href="#EdgeGroupings.Ungrouped.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeGroupings.Ungrouped.load-777"><a href="#EdgeGroupings.Ungrouped.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.Ungrouped.load-778"><a href="#EdgeGroupings.Ungrouped.load-778"><span class="linenos">778</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-779"><a href="#EdgeGroupings.Ungrouped.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeGroupings.Ungrouped.load-780"><a href="#EdgeGroupings.Ungrouped.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-781"><a href="#EdgeGroupings.Ungrouped.load-781"><span class="linenos">781</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-782"><a href="#EdgeGroupings.Ungrouped.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeGroupings.Ungrouped.load-783"><a href="#EdgeGroupings.Ungrouped.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.load-784"><a href="#EdgeGroupings.Ungrouped.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgeGroupings.Ungrouped.load-785"><a href="#EdgeGroupings.Ungrouped.load-785"><span class="linenos">785</span></a>
</span><span id="EdgeGroupings.Ungrouped.load-786"><a href="#EdgeGroupings.Ungrouped.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeGroupings.Ungrouped.load-787"><a href="#EdgeGroupings.Ungrouped.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeGroupings.Ungrouped.validate_fields_types" class="classattr">
                                        <input id="EdgeGroupings.Ungrouped.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.Ungrouped.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.Ungrouped.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.Ungrouped.validate_fields_types-271"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-272"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-273"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-274"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-275"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-276"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-277"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-278"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-279"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeGroupings.Ungrouped.validate_fields_types-280"><a href="#EdgeGroupings.Ungrouped.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></dt>
                                <dd id="EdgeGroupings.Ungrouped.attribute_key" class="function"><a href="#EdgeGroupings._EdgeGrouping.attribute_key">attribute_key</a></dd>
                <dd id="EdgeGroupings.Ungrouped.is_valid" class="function"><a href="#EdgeGroupings._EdgeGrouping.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgeGroupings.Ungrouped.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeGroupings.Ungrouped.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeGroupings.Ungrouped.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeGroupings.Ungrouped.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeGroupings.Ungrouped.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeGroupings.Ungrouped.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeGroupings.Ungrouped.diff" class="function">diff</dd>
                <dd id="EdgeGroupings.Ungrouped.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeGroupings.ByLeadingCoord">
                            <input id="EdgeGroupings.ByLeadingCoord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>
        <div class="decorator">@mark_as_unsupported(lambda self_: False)</div>

    <span class="def">class</span>
    <span class="name">EdgeGroupings.ByLeadingCoord</span><wbr>(<span class="base"><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L849-L889" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord-850"><a href="#EdgeGroupings.ByLeadingCoord-850"><span class="linenos">850</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-851"><a href="#EdgeGroupings.ByLeadingCoord-851"><span class="linenos">851</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-852"><a href="#EdgeGroupings.ByLeadingCoord-852"><span class="linenos">852</span></a>    <span class="k">class</span> <span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord-853"><a href="#EdgeGroupings.ByLeadingCoord-853"><span class="linenos">853</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-854"><a href="#EdgeGroupings.ByLeadingCoord-854"><span class="linenos">854</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-855"><a href="#EdgeGroupings.ByLeadingCoord-855"><span class="linenos">855</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeGroupings.ByLeadingCoord-856"><a href="#EdgeGroupings.ByLeadingCoord-856"><span class="linenos">856</span></a><span class="sd">        - `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-857"><a href="#EdgeGroupings.ByLeadingCoord-857"><span class="linenos">857</span></a><span class="sd">        Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-858"><a href="#EdgeGroupings.ByLeadingCoord-858"><span class="linenos">858</span></a><span class="sd">        - `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-859"><a href="#EdgeGroupings.ByLeadingCoord-859"><span class="linenos">859</span></a><span class="sd">        If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="EdgeGroupings.ByLeadingCoord-860"><a href="#EdgeGroupings.ByLeadingCoord-860"><span class="linenos">860</span></a><span class="sd">        In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-861"><a href="#EdgeGroupings.ByLeadingCoord-861"><span class="linenos">861</span></a><span class="sd">        - `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-862"><a href="#EdgeGroupings.ByLeadingCoord-862"><span class="linenos">862</span></a><span class="sd">        Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="EdgeGroupings.ByLeadingCoord-863"><a href="#EdgeGroupings.ByLeadingCoord-863"><span class="linenos">863</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord-864"><a href="#EdgeGroupings.ByLeadingCoord-864"><span class="linenos">864</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-865"><a href="#EdgeGroupings.ByLeadingCoord-865"><span class="linenos">865</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-866"><a href="#EdgeGroupings.ByLeadingCoord-866"><span class="linenos">866</span></a>        <span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-867"><a href="#EdgeGroupings.ByLeadingCoord-867"><span class="linenos">867</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-868"><a href="#EdgeGroupings.ByLeadingCoord-868"><span class="linenos">868</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeGroupings.ByLeadingCoord-869"><a href="#EdgeGroupings.ByLeadingCoord-869"><span class="linenos">869</span></a>        <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-870"><a href="#EdgeGroupings.ByLeadingCoord-870"><span class="linenos">870</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-871"><a href="#EdgeGroupings.ByLeadingCoord-871"><span class="linenos">871</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord-872"><a href="#EdgeGroupings.ByLeadingCoord-872"><span class="linenos">872</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-873"><a href="#EdgeGroupings.ByLeadingCoord-873"><span class="linenos">873</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-874"><a href="#EdgeGroupings.ByLeadingCoord-874"><span class="linenos">874</span></a>                <span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-875"><a href="#EdgeGroupings.ByLeadingCoord-875"><span class="linenos">875</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-876"><a href="#EdgeGroupings.ByLeadingCoord-876"><span class="linenos">876</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-877"><a href="#EdgeGroupings.ByLeadingCoord-877"><span class="linenos">877</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord-878"><a href="#EdgeGroupings.ByLeadingCoord-878"><span class="linenos">878</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord-879"><a href="#EdgeGroupings.ByLeadingCoord-879"><span class="linenos">879</span></a>            <span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="EdgeGroupings.ByLeadingCoord-880"><a href="#EdgeGroupings.ByLeadingCoord-880"><span class="linenos">880</span></a>            <span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-881"><a href="#EdgeGroupings.ByLeadingCoord-881"><span class="linenos">881</span></a>                <span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="EdgeGroupings.ByLeadingCoord-882"><a href="#EdgeGroupings.ByLeadingCoord-882"><span class="linenos">882</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-883"><a href="#EdgeGroupings.ByLeadingCoord-883"><span class="linenos">883</span></a>            <span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord-884"><a href="#EdgeGroupings.ByLeadingCoord-884"><span class="linenos">884</span></a>            <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord-885"><a href="#EdgeGroupings.ByLeadingCoord-885"><span class="linenos">885</span></a>                <span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord-886"><a href="#EdgeGroupings.ByLeadingCoord-886"><span class="linenos">886</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="EdgeGroupings.ByLeadingCoord-887"><a href="#EdgeGroupings.ByLeadingCoord-887"><span class="linenos">887</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord-888"><a href="#EdgeGroupings.ByLeadingCoord-888"><span class="linenos">888</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord-889"><a href="#EdgeGroupings.ByLeadingCoord-889"><span class="linenos">889</span></a>                <span class="p">[</span><span class="n">numpy_rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord-890"><a href="#EdgeGroupings.ByLeadingCoord-890"><span class="linenos">890</span></a>            <span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>All edges with the same leading coord are grouped together.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#EdgeGroupings.ByLeadingCoord.intra">intra</a></code>: Whether all edge groupings include a delimiter token between individual edge representations.
Note that each edge representation will already always include a connector token (<code>VOCAB.CONNECTOR</code>, or possibly `)</li>
<li><code><a href="#EdgeGroupings.ByLeadingCoord.shuffle_group">shuffle_group</a></code>: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.
If false, the fixed order is lexicographical by (row, col).
In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</li>
<li><code><a href="#EdgeGroupings.ByLeadingCoord.connection_token_ordinal">connection_token_ordinal</a></code>: At which index in token sequence representing a single edge the connector (or wall) token appears.
Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</li>
</ul>
</div>


                            <div id="EdgeGroupings.ByLeadingCoord.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeGroupings.ByLeadingCoord</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.ByLeadingCoord">EdgeGroupings.ByLeadingCoord</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeGroupings.ByLeadingCoord">EdgeGroupings.ByLeadingCoord</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.__init__"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.intra" class="classattr">
                                <div class="attr variable">
            <span class="name">intra</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.intra"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.shuffle_group" class="classattr">
                                <div class="attr variable">
            <span class="name">shuffle_group</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.shuffle_group"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.connection_token_ordinal" class="classattr">
                                <div class="attr variable">
            <span class="name">connection_token_ordinal</span><span class="annotation">: Literal[0, 1]</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.connection_token_ordinal"></a>
    
    

                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.is_valid" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">self_</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L850-L889" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.is_valid-851"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-851"><span class="linenos">851</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-852"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-852"><span class="linenos">852</span></a>    <span class="k">class</span> <span class="nc">ByLeadingCoord</span><span class="p">(</span><span class="n">_EdgeGrouping</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-853"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-853"><span class="linenos">853</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;All edges with the same leading coord are grouped together.</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-854"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-854"><span class="linenos">854</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-855"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-855"><span class="linenos">855</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-856"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-856"><span class="linenos">856</span></a><span class="sd">        - `intra`: Whether all edge groupings include a delimiter token between individual edge representations.</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-857"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-857"><span class="linenos">857</span></a><span class="sd">        Note that each edge representation will already always include a connector token (`VOCAB.CONNECTOR`, or possibly `)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-858"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-858"><span class="linenos">858</span></a><span class="sd">        - `shuffle_group`: Whether the sequence of edges within the group should be shuffled or appear in a fixed order.</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-859"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-859"><span class="linenos">859</span></a><span class="sd">        If false, the fixed order is lexicographical by (row, col).</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-860"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-860"><span class="linenos">860</span></a><span class="sd">        In effect, lexicographical sorting sorts edges by their cardinal direction in the sequence NORTH, WEST, EAST, SOUTH, where the directions indicate the position of the trailing coord relative to the leading coord.</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-861"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-861"><span class="linenos">861</span></a><span class="sd">        - `connection_token_ordinal`: At which index in token sequence representing a single edge the connector (or wall) token appears.</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-862"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-862"><span class="linenos">862</span></a><span class="sd">        Edge tokenizations contain 2 parts: a connector (or wall) token and a coord or cardinal tokenization.</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-863"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-863"><span class="linenos">863</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-864"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-864"><span class="linenos">864</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-865"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-865"><span class="linenos">865</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-866"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-866"><span class="linenos">866</span></a>        <span class="n">shuffle_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-867"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-867"><span class="linenos">867</span></a>        <span class="n">connection_token_ordinal</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-868"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-868"><span class="linenos">868</span></a>            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-869"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-869"><span class="linenos">869</span></a>        <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-870"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-870"><span class="linenos">870</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-871"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-871"><span class="linenos">871</span></a>        <span class="k">def</span> <span class="nf">_token_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EdgeGroupings._GroupingTokenParams&quot;</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-872"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-872"><span class="linenos">872</span></a>            <span class="k">return</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-873"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-873"><span class="linenos">873</span></a>                <span class="n">connection_token_ordinal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_token_ordinal</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-874"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-874"><span class="linenos">874</span></a>                <span class="n">intra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-875"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-875"><span class="linenos">875</span></a>                <span class="n">grouped</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-876"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-876"><span class="linenos">876</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-877"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-877"><span class="linenos">877</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-878"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-878"><span class="linenos">878</span></a>        <span class="k">def</span> <span class="nf">_group_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-879"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-879"><span class="linenos">879</span></a>            <span class="c1"># Adapted from: https://stackoverflow.com/questions/38013778/is-there-any-numpy-group-by-function</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-880"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-880"><span class="linenos">880</span></a>            <span class="n">index_array</span><span class="p">:</span> <span class="n">Int</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;sort_indices=edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-881"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-881"><span class="linenos">881</span></a>                <span class="p">(</span><span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-882"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-882"><span class="linenos">882</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-883"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-883"><span class="linenos">883</span></a>            <span class="n">sorted_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="n">index_array</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-884"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-884"><span class="linenos">884</span></a>            <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-885"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-885"><span class="linenos">885</span></a>                <span class="n">sorted_edges</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-886"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-886"><span class="linenos">886</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sorted_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-887"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-887"><span class="linenos">887</span></a>            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-888"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-888"><span class="linenos">888</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_group</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-889"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-889"><span class="linenos">889</span></a>                <span class="p">[</span><span class="n">numpy_rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.is_valid-890"><a href="#EdgeGroupings.ByLeadingCoord.is_valid-890"><span class="linenos">890</span></a>            <span class="k">return</span> <span class="n">groups</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.
Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code><a href="#MazeTokenizerModular.is_valid">MazeTokenizerModular.is_valid</a></code> calls <code><a href="#EdgeGroupings.ByLeadingCoord.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.serialize" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.serialize-660"><a href="#EdgeGroupings.ByLeadingCoord.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-661"><a href="#EdgeGroupings.ByLeadingCoord.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-662"><a href="#EdgeGroupings.ByLeadingCoord.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-663"><a href="#EdgeGroupings.ByLeadingCoord.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-664"><a href="#EdgeGroupings.ByLeadingCoord.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-665"><a href="#EdgeGroupings.ByLeadingCoord.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-666"><a href="#EdgeGroupings.ByLeadingCoord.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-667"><a href="#EdgeGroupings.ByLeadingCoord.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-668"><a href="#EdgeGroupings.ByLeadingCoord.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-669"><a href="#EdgeGroupings.ByLeadingCoord.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-670"><a href="#EdgeGroupings.ByLeadingCoord.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-671"><a href="#EdgeGroupings.ByLeadingCoord.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-672"><a href="#EdgeGroupings.ByLeadingCoord.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-673"><a href="#EdgeGroupings.ByLeadingCoord.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-674"><a href="#EdgeGroupings.ByLeadingCoord.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-675"><a href="#EdgeGroupings.ByLeadingCoord.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-676"><a href="#EdgeGroupings.ByLeadingCoord.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-677"><a href="#EdgeGroupings.ByLeadingCoord.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-678"><a href="#EdgeGroupings.ByLeadingCoord.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-679"><a href="#EdgeGroupings.ByLeadingCoord.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-680"><a href="#EdgeGroupings.ByLeadingCoord.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-681"><a href="#EdgeGroupings.ByLeadingCoord.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-682"><a href="#EdgeGroupings.ByLeadingCoord.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-683"><a href="#EdgeGroupings.ByLeadingCoord.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-684"><a href="#EdgeGroupings.ByLeadingCoord.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-685"><a href="#EdgeGroupings.ByLeadingCoord.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-686"><a href="#EdgeGroupings.ByLeadingCoord.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-687"><a href="#EdgeGroupings.ByLeadingCoord.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-688"><a href="#EdgeGroupings.ByLeadingCoord.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-689"><a href="#EdgeGroupings.ByLeadingCoord.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-690"><a href="#EdgeGroupings.ByLeadingCoord.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-691"><a href="#EdgeGroupings.ByLeadingCoord.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-692"><a href="#EdgeGroupings.ByLeadingCoord.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-693"><a href="#EdgeGroupings.ByLeadingCoord.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-694"><a href="#EdgeGroupings.ByLeadingCoord.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-695"><a href="#EdgeGroupings.ByLeadingCoord.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-696"><a href="#EdgeGroupings.ByLeadingCoord.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-697"><a href="#EdgeGroupings.ByLeadingCoord.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-698"><a href="#EdgeGroupings.ByLeadingCoord.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-699"><a href="#EdgeGroupings.ByLeadingCoord.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-700"><a href="#EdgeGroupings.ByLeadingCoord.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-701"><a href="#EdgeGroupings.ByLeadingCoord.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-702"><a href="#EdgeGroupings.ByLeadingCoord.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-703"><a href="#EdgeGroupings.ByLeadingCoord.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-704"><a href="#EdgeGroupings.ByLeadingCoord.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-705"><a href="#EdgeGroupings.ByLeadingCoord.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-706"><a href="#EdgeGroupings.ByLeadingCoord.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-707"><a href="#EdgeGroupings.ByLeadingCoord.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-708"><a href="#EdgeGroupings.ByLeadingCoord.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-709"><a href="#EdgeGroupings.ByLeadingCoord.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-710"><a href="#EdgeGroupings.ByLeadingCoord.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-711"><a href="#EdgeGroupings.ByLeadingCoord.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-712"><a href="#EdgeGroupings.ByLeadingCoord.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-713"><a href="#EdgeGroupings.ByLeadingCoord.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-714"><a href="#EdgeGroupings.ByLeadingCoord.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-715"><a href="#EdgeGroupings.ByLeadingCoord.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.serialize-716"><a href="#EdgeGroupings.ByLeadingCoord.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.load" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.load-723"><a href="#EdgeGroupings.ByLeadingCoord.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-724"><a href="#EdgeGroupings.ByLeadingCoord.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-725"><a href="#EdgeGroupings.ByLeadingCoord.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-726"><a href="#EdgeGroupings.ByLeadingCoord.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-727"><a href="#EdgeGroupings.ByLeadingCoord.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-728"><a href="#EdgeGroupings.ByLeadingCoord.load-728"><span class="linenos">728</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-729"><a href="#EdgeGroupings.ByLeadingCoord.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-730"><a href="#EdgeGroupings.ByLeadingCoord.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-731"><a href="#EdgeGroupings.ByLeadingCoord.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-732"><a href="#EdgeGroupings.ByLeadingCoord.load-732"><span class="linenos">732</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-733"><a href="#EdgeGroupings.ByLeadingCoord.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-734"><a href="#EdgeGroupings.ByLeadingCoord.load-734"><span class="linenos">734</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-735"><a href="#EdgeGroupings.ByLeadingCoord.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-736"><a href="#EdgeGroupings.ByLeadingCoord.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-737"><a href="#EdgeGroupings.ByLeadingCoord.load-737"><span class="linenos">737</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-738"><a href="#EdgeGroupings.ByLeadingCoord.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-739"><a href="#EdgeGroupings.ByLeadingCoord.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-740"><a href="#EdgeGroupings.ByLeadingCoord.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-741"><a href="#EdgeGroupings.ByLeadingCoord.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-742"><a href="#EdgeGroupings.ByLeadingCoord.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-743"><a href="#EdgeGroupings.ByLeadingCoord.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-744"><a href="#EdgeGroupings.ByLeadingCoord.load-744"><span class="linenos">744</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-745"><a href="#EdgeGroupings.ByLeadingCoord.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-746"><a href="#EdgeGroupings.ByLeadingCoord.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-747"><a href="#EdgeGroupings.ByLeadingCoord.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-748"><a href="#EdgeGroupings.ByLeadingCoord.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-749"><a href="#EdgeGroupings.ByLeadingCoord.load-749"><span class="linenos">749</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-750"><a href="#EdgeGroupings.ByLeadingCoord.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-751"><a href="#EdgeGroupings.ByLeadingCoord.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-752"><a href="#EdgeGroupings.ByLeadingCoord.load-752"><span class="linenos">752</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-753"><a href="#EdgeGroupings.ByLeadingCoord.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-754"><a href="#EdgeGroupings.ByLeadingCoord.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-755"><a href="#EdgeGroupings.ByLeadingCoord.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-756"><a href="#EdgeGroupings.ByLeadingCoord.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-757"><a href="#EdgeGroupings.ByLeadingCoord.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-758"><a href="#EdgeGroupings.ByLeadingCoord.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-759"><a href="#EdgeGroupings.ByLeadingCoord.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-760"><a href="#EdgeGroupings.ByLeadingCoord.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-761"><a href="#EdgeGroupings.ByLeadingCoord.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-762"><a href="#EdgeGroupings.ByLeadingCoord.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-763"><a href="#EdgeGroupings.ByLeadingCoord.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-764"><a href="#EdgeGroupings.ByLeadingCoord.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-765"><a href="#EdgeGroupings.ByLeadingCoord.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-766"><a href="#EdgeGroupings.ByLeadingCoord.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-767"><a href="#EdgeGroupings.ByLeadingCoord.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-768"><a href="#EdgeGroupings.ByLeadingCoord.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-769"><a href="#EdgeGroupings.ByLeadingCoord.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-770"><a href="#EdgeGroupings.ByLeadingCoord.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-771"><a href="#EdgeGroupings.ByLeadingCoord.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-772"><a href="#EdgeGroupings.ByLeadingCoord.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-773"><a href="#EdgeGroupings.ByLeadingCoord.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-774"><a href="#EdgeGroupings.ByLeadingCoord.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-775"><a href="#EdgeGroupings.ByLeadingCoord.load-775"><span class="linenos">775</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-776"><a href="#EdgeGroupings.ByLeadingCoord.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-777"><a href="#EdgeGroupings.ByLeadingCoord.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-778"><a href="#EdgeGroupings.ByLeadingCoord.load-778"><span class="linenos">778</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-779"><a href="#EdgeGroupings.ByLeadingCoord.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-780"><a href="#EdgeGroupings.ByLeadingCoord.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-781"><a href="#EdgeGroupings.ByLeadingCoord.load-781"><span class="linenos">781</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-782"><a href="#EdgeGroupings.ByLeadingCoord.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-783"><a href="#EdgeGroupings.ByLeadingCoord.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-784"><a href="#EdgeGroupings.ByLeadingCoord.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-785"><a href="#EdgeGroupings.ByLeadingCoord.load-785"><span class="linenos">785</span></a>
</span><span id="EdgeGroupings.ByLeadingCoord.load-786"><a href="#EdgeGroupings.ByLeadingCoord.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeGroupings.ByLeadingCoord.load-787"><a href="#EdgeGroupings.ByLeadingCoord.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeGroupings.ByLeadingCoord.validate_fields_types" class="classattr">
                                        <input id="EdgeGroupings.ByLeadingCoord.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeGroupings.ByLeadingCoord.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeGroupings.ByLeadingCoord.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-271"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-272"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-273"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-274"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-275"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-276"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-277"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-278"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-279"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeGroupings.ByLeadingCoord.validate_fields_types-280"><a href="#EdgeGroupings.ByLeadingCoord.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeGroupings._EdgeGrouping">EdgeGroupings._EdgeGrouping</a></dt>
                                <dd id="EdgeGroupings.ByLeadingCoord.attribute_key" class="function"><a href="#EdgeGroupings._EdgeGrouping.attribute_key">attribute_key</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgeGroupings.ByLeadingCoord.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeGroupings.ByLeadingCoord.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeGroupings.ByLeadingCoord.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeGroupings.ByLeadingCoord.diff" class="function">diff</dd>
                <dd id="EdgeGroupings.ByLeadingCoord.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgePermuters">
                            <input id="EdgePermuters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EdgePermuters</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L892-L962" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters-893"><a href="#EdgePermuters-893"><span class="linenos">893</span></a><span class="k">class</span> <span class="nc">EdgePermuters</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="EdgePermuters-894"><a href="#EdgePermuters-894"><span class="linenos">894</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_EdgePermuter` subclass hierarchy used by `_AdjListTokenizer`.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-895"><a href="#EdgePermuters-895"><span class="linenos">895</span></a>
</span><span id="EdgePermuters-896"><a href="#EdgePermuters-896"><span class="linenos">896</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_permuter&quot;</span>
</span><span id="EdgePermuters-897"><a href="#EdgePermuters-897"><span class="linenos">897</span></a>
</span><span id="EdgePermuters-898"><a href="#EdgePermuters-898"><span class="linenos">898</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-899"><a href="#EdgePermuters-899"><span class="linenos">899</span></a>    <span class="k">class</span> <span class="nc">_EdgePermuter</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EdgePermuters-900"><a href="#EdgePermuters-900"><span class="linenos">900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Specifies how to sequence the two coords that encode a lattice edge.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-901"><a href="#EdgePermuters-901"><span class="linenos">901</span></a>
</span><span id="EdgePermuters-902"><a href="#EdgePermuters-902"><span class="linenos">902</span></a>        <span class="nd">@classmethod</span>
</span><span id="EdgePermuters-903"><a href="#EdgePermuters-903"><span class="linenos">903</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="EdgePermuters-904"><a href="#EdgePermuters-904"><span class="linenos">904</span></a>            <span class="k">return</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">key</span>
</span><span id="EdgePermuters-905"><a href="#EdgePermuters-905"><span class="linenos">905</span></a>
</span><span id="EdgePermuters-906"><a href="#EdgePermuters-906"><span class="linenos">906</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters-907"><a href="#EdgePermuters-907"><span class="linenos">907</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="EdgePermuters-908"><a href="#EdgePermuters-908"><span class="linenos">908</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="EdgePermuters-909"><a href="#EdgePermuters-909"><span class="linenos">909</span></a>
</span><span id="EdgePermuters-910"><a href="#EdgePermuters-910"><span class="linenos">910</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-911"><a href="#EdgePermuters-911"><span class="linenos">911</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgePermuters-912"><a href="#EdgePermuters-912"><span class="linenos">912</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-913"><a href="#EdgePermuters-913"><span class="linenos">913</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-914"><a href="#EdgePermuters-914"><span class="linenos">914</span></a><span class="sd">            Executes a permutation.</span>
</span><span id="EdgePermuters-915"><a href="#EdgePermuters-915"><span class="linenos">915</span></a><span class="sd">            Warning: Caller should be aware that `lattice_edges` may be modified in-place depending on the subclass&#39;s implementation.</span>
</span><span id="EdgePermuters-916"><a href="#EdgePermuters-916"><span class="linenos">916</span></a>
</span><span id="EdgePermuters-917"><a href="#EdgePermuters-917"><span class="linenos">917</span></a><span class="sd">            # Parameters</span>
</span><span id="EdgePermuters-918"><a href="#EdgePermuters-918"><span class="linenos">918</span></a><span class="sd">            - `lattice_edges`: Array of lattice edges.</span>
</span><span id="EdgePermuters-919"><a href="#EdgePermuters-919"><span class="linenos">919</span></a><span class="sd">            The two coords in shape[1] must be adjacent in the lattice.</span>
</span><span id="EdgePermuters-920"><a href="#EdgePermuters-920"><span class="linenos">920</span></a>
</span><span id="EdgePermuters-921"><a href="#EdgePermuters-921"><span class="linenos">921</span></a><span class="sd">            # Returns</span>
</span><span id="EdgePermuters-922"><a href="#EdgePermuters-922"><span class="linenos">922</span></a><span class="sd">            - Array of lattice edges with entries along shape[1] systematically permuted.</span>
</span><span id="EdgePermuters-923"><a href="#EdgePermuters-923"><span class="linenos">923</span></a><span class="sd">            - shape[0] of the returned array is NOT guaranteed to match `lattice_edges.shape[1]`.</span>
</span><span id="EdgePermuters-924"><a href="#EdgePermuters-924"><span class="linenos">924</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="EdgePermuters-925"><a href="#EdgePermuters-925"><span class="linenos">925</span></a>            <span class="k">pass</span>
</span><span id="EdgePermuters-926"><a href="#EdgePermuters-926"><span class="linenos">926</span></a>
</span><span id="EdgePermuters-927"><a href="#EdgePermuters-927"><span class="linenos">927</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-928"><a href="#EdgePermuters-928"><span class="linenos">928</span></a>    <span class="k">class</span> <span class="nc">SortedCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters-929"><a href="#EdgePermuters-929"><span class="linenos">929</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns a sorted representation. useful for checking consistency&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-930"><a href="#EdgePermuters-930"><span class="linenos">930</span></a>
</span><span id="EdgePermuters-931"><a href="#EdgePermuters-931"><span class="linenos">931</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-932"><a href="#EdgePermuters-932"><span class="linenos">932</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-933"><a href="#EdgePermuters-933"><span class="linenos">933</span></a>            <span class="k">return</span> <span class="n">lattice_edges</span><span class="p">[</span>
</span><span id="EdgePermuters-934"><a href="#EdgePermuters-934"><span class="linenos">934</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgePermuters-935"><a href="#EdgePermuters-935"><span class="linenos">935</span></a>                    <span class="p">(</span>
</span><span id="EdgePermuters-936"><a href="#EdgePermuters-936"><span class="linenos">936</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters-937"><a href="#EdgePermuters-937"><span class="linenos">937</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters-938"><a href="#EdgePermuters-938"><span class="linenos">938</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters-939"><a href="#EdgePermuters-939"><span class="linenos">939</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters-940"><a href="#EdgePermuters-940"><span class="linenos">940</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters-941"><a href="#EdgePermuters-941"><span class="linenos">941</span></a>                <span class="p">),</span>
</span><span id="EdgePermuters-942"><a href="#EdgePermuters-942"><span class="linenos">942</span></a>                <span class="o">...</span><span class="p">,</span>
</span><span id="EdgePermuters-943"><a href="#EdgePermuters-943"><span class="linenos">943</span></a>            <span class="p">]</span>
</span><span id="EdgePermuters-944"><a href="#EdgePermuters-944"><span class="linenos">944</span></a>
</span><span id="EdgePermuters-945"><a href="#EdgePermuters-945"><span class="linenos">945</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-946"><a href="#EdgePermuters-946"><span class="linenos">946</span></a>    <span class="k">class</span> <span class="nc">RandomCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters-947"><a href="#EdgePermuters-947"><span class="linenos">947</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Permutes each edge randomly.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters-948"><a href="#EdgePermuters-948"><span class="linenos">948</span></a>
</span><span id="EdgePermuters-949"><a href="#EdgePermuters-949"><span class="linenos">949</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-950"><a href="#EdgePermuters-950"><span class="linenos">950</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-951"><a href="#EdgePermuters-951"><span class="linenos">951</span></a>            <span class="n">numpy_rng</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">lattice_edges</span><span class="p">)</span>
</span><span id="EdgePermuters-952"><a href="#EdgePermuters-952"><span class="linenos">952</span></a>            <span class="k">return</span> <span class="n">lattice_edges</span>
</span><span id="EdgePermuters-953"><a href="#EdgePermuters-953"><span class="linenos">953</span></a>
</span><span id="EdgePermuters-954"><a href="#EdgePermuters-954"><span class="linenos">954</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters-955"><a href="#EdgePermuters-955"><span class="linenos">955</span></a>    <span class="k">class</span> <span class="nc">BothCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters-956"><a href="#EdgePermuters-956"><span class="linenos">956</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Includes both possible permutations of every edge in the output.</span>
</span><span id="EdgePermuters-957"><a href="#EdgePermuters-957"><span class="linenos">957</span></a><span class="sd">        Since input ConnectionList has only 1 instance of each edge,</span>
</span><span id="EdgePermuters-958"><a href="#EdgePermuters-958"><span class="linenos">958</span></a><span class="sd">        a call to `BothCoords._permute` will modify `lattice_edges` in-place, doubling `shape[0]`.</span>
</span><span id="EdgePermuters-959"><a href="#EdgePermuters-959"><span class="linenos">959</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgePermuters-960"><a href="#EdgePermuters-960"><span class="linenos">960</span></a>
</span><span id="EdgePermuters-961"><a href="#EdgePermuters-961"><span class="linenos">961</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters-962"><a href="#EdgePermuters-962"><span class="linenos">962</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters-963"><a href="#EdgePermuters-963"><span class="linenos">963</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_EdgePermuter</code> subclass hierarchy used by <code>_AdjListTokenizer</code>.</p>
</div>


                            <div id="EdgePermuters.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;edge_permuter&#39;</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.key"></a>
    
    

                            </div>
                </section>
                <section id="EdgePermuters.SortedCoords">
                            <input id="EdgePermuters.SortedCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgePermuters.SortedCoords</span><wbr>(<span class="base"><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L926-L942" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords-927"><a href="#EdgePermuters.SortedCoords-927"><span class="linenos">927</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords-928"><a href="#EdgePermuters.SortedCoords-928"><span class="linenos">928</span></a>    <span class="k">class</span> <span class="nc">SortedCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords-929"><a href="#EdgePermuters.SortedCoords-929"><span class="linenos">929</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;returns a sorted representation. useful for checking consistency&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.SortedCoords-930"><a href="#EdgePermuters.SortedCoords-930"><span class="linenos">930</span></a>
</span><span id="EdgePermuters.SortedCoords-931"><a href="#EdgePermuters.SortedCoords-931"><span class="linenos">931</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters.SortedCoords-932"><a href="#EdgePermuters.SortedCoords-932"><span class="linenos">932</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords-933"><a href="#EdgePermuters.SortedCoords-933"><span class="linenos">933</span></a>            <span class="k">return</span> <span class="n">lattice_edges</span><span class="p">[</span>
</span><span id="EdgePermuters.SortedCoords-934"><a href="#EdgePermuters.SortedCoords-934"><span class="linenos">934</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords-935"><a href="#EdgePermuters.SortedCoords-935"><span class="linenos">935</span></a>                    <span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords-936"><a href="#EdgePermuters.SortedCoords-936"><span class="linenos">936</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-937"><a href="#EdgePermuters.SortedCoords-937"><span class="linenos">937</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-938"><a href="#EdgePermuters.SortedCoords-938"><span class="linenos">938</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-939"><a href="#EdgePermuters.SortedCoords-939"><span class="linenos">939</span></a>                        <span class="n">lattice_edges</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="EdgePermuters.SortedCoords-940"><a href="#EdgePermuters.SortedCoords-940"><span class="linenos">940</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords-941"><a href="#EdgePermuters.SortedCoords-941"><span class="linenos">941</span></a>                <span class="p">),</span>
</span><span id="EdgePermuters.SortedCoords-942"><a href="#EdgePermuters.SortedCoords-942"><span class="linenos">942</span></a>                <span class="o">...</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords-943"><a href="#EdgePermuters.SortedCoords-943"><span class="linenos">943</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>returns a sorted representation. useful for checking consistency</p>
</div>


                            <div id="EdgePermuters.SortedCoords.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgePermuters.SortedCoords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.SortedCoords">EdgePermuters.SortedCoords</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.SortedCoords">EdgePermuters.SortedCoords</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.__init__"></a>
    
    

                            </div>
                            <div id="EdgePermuters.SortedCoords.serialize" class="classattr">
                                        <input id="EdgePermuters.SortedCoords.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords.serialize-660"><a href="#EdgePermuters.SortedCoords.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-661"><a href="#EdgePermuters.SortedCoords.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgePermuters.SortedCoords.serialize-662"><a href="#EdgePermuters.SortedCoords.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-663"><a href="#EdgePermuters.SortedCoords.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgePermuters.SortedCoords.serialize-664"><a href="#EdgePermuters.SortedCoords.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgePermuters.SortedCoords.serialize-665"><a href="#EdgePermuters.SortedCoords.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgePermuters.SortedCoords.serialize-666"><a href="#EdgePermuters.SortedCoords.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgePermuters.SortedCoords.serialize-667"><a href="#EdgePermuters.SortedCoords.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-668"><a href="#EdgePermuters.SortedCoords.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-669"><a href="#EdgePermuters.SortedCoords.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-670"><a href="#EdgePermuters.SortedCoords.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-671"><a href="#EdgePermuters.SortedCoords.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-672"><a href="#EdgePermuters.SortedCoords.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-673"><a href="#EdgePermuters.SortedCoords.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-674"><a href="#EdgePermuters.SortedCoords.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgePermuters.SortedCoords.serialize-675"><a href="#EdgePermuters.SortedCoords.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-676"><a href="#EdgePermuters.SortedCoords.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-677"><a href="#EdgePermuters.SortedCoords.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgePermuters.SortedCoords.serialize-678"><a href="#EdgePermuters.SortedCoords.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-679"><a href="#EdgePermuters.SortedCoords.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgePermuters.SortedCoords.serialize-680"><a href="#EdgePermuters.SortedCoords.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-681"><a href="#EdgePermuters.SortedCoords.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.serialize-682"><a href="#EdgePermuters.SortedCoords.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgePermuters.SortedCoords.serialize-683"><a href="#EdgePermuters.SortedCoords.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-684"><a href="#EdgePermuters.SortedCoords.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.serialize-685"><a href="#EdgePermuters.SortedCoords.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgePermuters.SortedCoords.serialize-686"><a href="#EdgePermuters.SortedCoords.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgePermuters.SortedCoords.serialize-687"><a href="#EdgePermuters.SortedCoords.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-688"><a href="#EdgePermuters.SortedCoords.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-689"><a href="#EdgePermuters.SortedCoords.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-690"><a href="#EdgePermuters.SortedCoords.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgePermuters.SortedCoords.serialize-691"><a href="#EdgePermuters.SortedCoords.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.SortedCoords.serialize-692"><a href="#EdgePermuters.SortedCoords.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-693"><a href="#EdgePermuters.SortedCoords.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-694"><a href="#EdgePermuters.SortedCoords.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-695"><a href="#EdgePermuters.SortedCoords.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgePermuters.SortedCoords.serialize-696"><a href="#EdgePermuters.SortedCoords.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-697"><a href="#EdgePermuters.SortedCoords.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-698"><a href="#EdgePermuters.SortedCoords.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-699"><a href="#EdgePermuters.SortedCoords.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.serialize-700"><a href="#EdgePermuters.SortedCoords.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgePermuters.SortedCoords.serialize-701"><a href="#EdgePermuters.SortedCoords.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-702"><a href="#EdgePermuters.SortedCoords.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgePermuters.SortedCoords.serialize-703"><a href="#EdgePermuters.SortedCoords.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-704"><a href="#EdgePermuters.SortedCoords.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgePermuters.SortedCoords.serialize-705"><a href="#EdgePermuters.SortedCoords.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-706"><a href="#EdgePermuters.SortedCoords.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.serialize-707"><a href="#EdgePermuters.SortedCoords.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-708"><a href="#EdgePermuters.SortedCoords.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.SortedCoords.serialize-709"><a href="#EdgePermuters.SortedCoords.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.serialize-710"><a href="#EdgePermuters.SortedCoords.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.serialize-711"><a href="#EdgePermuters.SortedCoords.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-712"><a href="#EdgePermuters.SortedCoords.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-713"><a href="#EdgePermuters.SortedCoords.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.serialize-714"><a href="#EdgePermuters.SortedCoords.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.serialize-715"><a href="#EdgePermuters.SortedCoords.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgePermuters.SortedCoords.serialize-716"><a href="#EdgePermuters.SortedCoords.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgePermuters.SortedCoords.load" class="classattr">
                                        <input id="EdgePermuters.SortedCoords.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords.load-723"><a href="#EdgePermuters.SortedCoords.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgePermuters.SortedCoords.load-724"><a href="#EdgePermuters.SortedCoords.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgePermuters.SortedCoords.load-725"><a href="#EdgePermuters.SortedCoords.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgePermuters.SortedCoords.load-726"><a href="#EdgePermuters.SortedCoords.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-727"><a href="#EdgePermuters.SortedCoords.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgePermuters.SortedCoords.load-728"><a href="#EdgePermuters.SortedCoords.load-728"><span class="linenos">728</span></a>
</span><span id="EdgePermuters.SortedCoords.load-729"><a href="#EdgePermuters.SortedCoords.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-730"><a href="#EdgePermuters.SortedCoords.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgePermuters.SortedCoords.load-731"><a href="#EdgePermuters.SortedCoords.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-732"><a href="#EdgePermuters.SortedCoords.load-732"><span class="linenos">732</span></a>
</span><span id="EdgePermuters.SortedCoords.load-733"><a href="#EdgePermuters.SortedCoords.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-734"><a href="#EdgePermuters.SortedCoords.load-734"><span class="linenos">734</span></a>
</span><span id="EdgePermuters.SortedCoords.load-735"><a href="#EdgePermuters.SortedCoords.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgePermuters.SortedCoords.load-736"><a href="#EdgePermuters.SortedCoords.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.load-737"><a href="#EdgePermuters.SortedCoords.load-737"><span class="linenos">737</span></a>
</span><span id="EdgePermuters.SortedCoords.load-738"><a href="#EdgePermuters.SortedCoords.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgePermuters.SortedCoords.load-739"><a href="#EdgePermuters.SortedCoords.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-740"><a href="#EdgePermuters.SortedCoords.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgePermuters.SortedCoords.load-741"><a href="#EdgePermuters.SortedCoords.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-742"><a href="#EdgePermuters.SortedCoords.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgePermuters.SortedCoords.load-743"><a href="#EdgePermuters.SortedCoords.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-744"><a href="#EdgePermuters.SortedCoords.load-744"><span class="linenos">744</span></a>
</span><span id="EdgePermuters.SortedCoords.load-745"><a href="#EdgePermuters.SortedCoords.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgePermuters.SortedCoords.load-746"><a href="#EdgePermuters.SortedCoords.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-747"><a href="#EdgePermuters.SortedCoords.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgePermuters.SortedCoords.load-748"><a href="#EdgePermuters.SortedCoords.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgePermuters.SortedCoords.load-749"><a href="#EdgePermuters.SortedCoords.load-749"><span class="linenos">749</span></a>
</span><span id="EdgePermuters.SortedCoords.load-750"><a href="#EdgePermuters.SortedCoords.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgePermuters.SortedCoords.load-751"><a href="#EdgePermuters.SortedCoords.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-752"><a href="#EdgePermuters.SortedCoords.load-752"><span class="linenos">752</span></a>
</span><span id="EdgePermuters.SortedCoords.load-753"><a href="#EdgePermuters.SortedCoords.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgePermuters.SortedCoords.load-754"><a href="#EdgePermuters.SortedCoords.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-755"><a href="#EdgePermuters.SortedCoords.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgePermuters.SortedCoords.load-756"><a href="#EdgePermuters.SortedCoords.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-757"><a href="#EdgePermuters.SortedCoords.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-758"><a href="#EdgePermuters.SortedCoords.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgePermuters.SortedCoords.load-759"><a href="#EdgePermuters.SortedCoords.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-760"><a href="#EdgePermuters.SortedCoords.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-761"><a href="#EdgePermuters.SortedCoords.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgePermuters.SortedCoords.load-762"><a href="#EdgePermuters.SortedCoords.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-763"><a href="#EdgePermuters.SortedCoords.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-764"><a href="#EdgePermuters.SortedCoords.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-765"><a href="#EdgePermuters.SortedCoords.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgePermuters.SortedCoords.load-766"><a href="#EdgePermuters.SortedCoords.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgePermuters.SortedCoords.load-767"><a href="#EdgePermuters.SortedCoords.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-768"><a href="#EdgePermuters.SortedCoords.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-769"><a href="#EdgePermuters.SortedCoords.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.load-770"><a href="#EdgePermuters.SortedCoords.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.SortedCoords.load-771"><a href="#EdgePermuters.SortedCoords.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-772"><a href="#EdgePermuters.SortedCoords.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-773"><a href="#EdgePermuters.SortedCoords.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgePermuters.SortedCoords.load-774"><a href="#EdgePermuters.SortedCoords.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgePermuters.SortedCoords.load-775"><a href="#EdgePermuters.SortedCoords.load-775"><span class="linenos">775</span></a>
</span><span id="EdgePermuters.SortedCoords.load-776"><a href="#EdgePermuters.SortedCoords.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgePermuters.SortedCoords.load-777"><a href="#EdgePermuters.SortedCoords.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.SortedCoords.load-778"><a href="#EdgePermuters.SortedCoords.load-778"><span class="linenos">778</span></a>
</span><span id="EdgePermuters.SortedCoords.load-779"><a href="#EdgePermuters.SortedCoords.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgePermuters.SortedCoords.load-780"><a href="#EdgePermuters.SortedCoords.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-781"><a href="#EdgePermuters.SortedCoords.load-781"><span class="linenos">781</span></a>
</span><span id="EdgePermuters.SortedCoords.load-782"><a href="#EdgePermuters.SortedCoords.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgePermuters.SortedCoords.load-783"><a href="#EdgePermuters.SortedCoords.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.load-784"><a href="#EdgePermuters.SortedCoords.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgePermuters.SortedCoords.load-785"><a href="#EdgePermuters.SortedCoords.load-785"><span class="linenos">785</span></a>
</span><span id="EdgePermuters.SortedCoords.load-786"><a href="#EdgePermuters.SortedCoords.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgePermuters.SortedCoords.load-787"><a href="#EdgePermuters.SortedCoords.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgePermuters.SortedCoords.validate_fields_types" class="classattr">
                                        <input id="EdgePermuters.SortedCoords.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.SortedCoords.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.SortedCoords.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.SortedCoords.validate_fields_types-271"><a href="#EdgePermuters.SortedCoords.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-272"><a href="#EdgePermuters.SortedCoords.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-273"><a href="#EdgePermuters.SortedCoords.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-274"><a href="#EdgePermuters.SortedCoords.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-275"><a href="#EdgePermuters.SortedCoords.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-276"><a href="#EdgePermuters.SortedCoords.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-277"><a href="#EdgePermuters.SortedCoords.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-278"><a href="#EdgePermuters.SortedCoords.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-279"><a href="#EdgePermuters.SortedCoords.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgePermuters.SortedCoords.validate_fields_types-280"><a href="#EdgePermuters.SortedCoords.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></dt>
                                <dd id="EdgePermuters.SortedCoords.attribute_key" class="function"><a href="#EdgePermuters._EdgePermuter.attribute_key">attribute_key</a></dd>
                <dd id="EdgePermuters.SortedCoords.is_valid" class="function"><a href="#EdgePermuters._EdgePermuter.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgePermuters.SortedCoords.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgePermuters.SortedCoords.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgePermuters.SortedCoords.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgePermuters.SortedCoords.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgePermuters.SortedCoords.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgePermuters.SortedCoords.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgePermuters.SortedCoords.diff" class="function">diff</dd>
                <dd id="EdgePermuters.SortedCoords.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgePermuters.RandomCoords">
                            <input id="EdgePermuters.RandomCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgePermuters.RandomCoords</span><wbr>(<span class="base"><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L944-L951" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords-945"><a href="#EdgePermuters.RandomCoords-945"><span class="linenos">945</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords-946"><a href="#EdgePermuters.RandomCoords-946"><span class="linenos">946</span></a>    <span class="k">class</span> <span class="nc">RandomCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords-947"><a href="#EdgePermuters.RandomCoords-947"><span class="linenos">947</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Permutes each edge randomly.&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.RandomCoords-948"><a href="#EdgePermuters.RandomCoords-948"><span class="linenos">948</span></a>
</span><span id="EdgePermuters.RandomCoords-949"><a href="#EdgePermuters.RandomCoords-949"><span class="linenos">949</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters.RandomCoords-950"><a href="#EdgePermuters.RandomCoords-950"><span class="linenos">950</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords-951"><a href="#EdgePermuters.RandomCoords-951"><span class="linenos">951</span></a>            <span class="n">numpy_rng</span><span class="o">.</span><span class="n">permuted</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">lattice_edges</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords-952"><a href="#EdgePermuters.RandomCoords-952"><span class="linenos">952</span></a>            <span class="k">return</span> <span class="n">lattice_edges</span>
</span></pre></div>


            <div class="docstring"><p>Permutes each edge randomly.</p>
</div>


                            <div id="EdgePermuters.RandomCoords.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgePermuters.RandomCoords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.__init__"></a>
    
    

                            </div>
                            <div id="EdgePermuters.RandomCoords.serialize" class="classattr">
                                        <input id="EdgePermuters.RandomCoords.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords.serialize-660"><a href="#EdgePermuters.RandomCoords.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-661"><a href="#EdgePermuters.RandomCoords.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgePermuters.RandomCoords.serialize-662"><a href="#EdgePermuters.RandomCoords.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-663"><a href="#EdgePermuters.RandomCoords.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgePermuters.RandomCoords.serialize-664"><a href="#EdgePermuters.RandomCoords.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgePermuters.RandomCoords.serialize-665"><a href="#EdgePermuters.RandomCoords.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgePermuters.RandomCoords.serialize-666"><a href="#EdgePermuters.RandomCoords.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgePermuters.RandomCoords.serialize-667"><a href="#EdgePermuters.RandomCoords.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-668"><a href="#EdgePermuters.RandomCoords.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-669"><a href="#EdgePermuters.RandomCoords.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-670"><a href="#EdgePermuters.RandomCoords.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-671"><a href="#EdgePermuters.RandomCoords.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-672"><a href="#EdgePermuters.RandomCoords.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-673"><a href="#EdgePermuters.RandomCoords.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-674"><a href="#EdgePermuters.RandomCoords.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgePermuters.RandomCoords.serialize-675"><a href="#EdgePermuters.RandomCoords.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-676"><a href="#EdgePermuters.RandomCoords.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-677"><a href="#EdgePermuters.RandomCoords.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgePermuters.RandomCoords.serialize-678"><a href="#EdgePermuters.RandomCoords.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-679"><a href="#EdgePermuters.RandomCoords.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgePermuters.RandomCoords.serialize-680"><a href="#EdgePermuters.RandomCoords.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-681"><a href="#EdgePermuters.RandomCoords.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.serialize-682"><a href="#EdgePermuters.RandomCoords.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgePermuters.RandomCoords.serialize-683"><a href="#EdgePermuters.RandomCoords.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-684"><a href="#EdgePermuters.RandomCoords.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.serialize-685"><a href="#EdgePermuters.RandomCoords.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgePermuters.RandomCoords.serialize-686"><a href="#EdgePermuters.RandomCoords.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgePermuters.RandomCoords.serialize-687"><a href="#EdgePermuters.RandomCoords.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-688"><a href="#EdgePermuters.RandomCoords.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-689"><a href="#EdgePermuters.RandomCoords.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-690"><a href="#EdgePermuters.RandomCoords.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgePermuters.RandomCoords.serialize-691"><a href="#EdgePermuters.RandomCoords.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.RandomCoords.serialize-692"><a href="#EdgePermuters.RandomCoords.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-693"><a href="#EdgePermuters.RandomCoords.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-694"><a href="#EdgePermuters.RandomCoords.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-695"><a href="#EdgePermuters.RandomCoords.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgePermuters.RandomCoords.serialize-696"><a href="#EdgePermuters.RandomCoords.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-697"><a href="#EdgePermuters.RandomCoords.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-698"><a href="#EdgePermuters.RandomCoords.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-699"><a href="#EdgePermuters.RandomCoords.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.serialize-700"><a href="#EdgePermuters.RandomCoords.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgePermuters.RandomCoords.serialize-701"><a href="#EdgePermuters.RandomCoords.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-702"><a href="#EdgePermuters.RandomCoords.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgePermuters.RandomCoords.serialize-703"><a href="#EdgePermuters.RandomCoords.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-704"><a href="#EdgePermuters.RandomCoords.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgePermuters.RandomCoords.serialize-705"><a href="#EdgePermuters.RandomCoords.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-706"><a href="#EdgePermuters.RandomCoords.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.serialize-707"><a href="#EdgePermuters.RandomCoords.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-708"><a href="#EdgePermuters.RandomCoords.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.RandomCoords.serialize-709"><a href="#EdgePermuters.RandomCoords.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.serialize-710"><a href="#EdgePermuters.RandomCoords.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.serialize-711"><a href="#EdgePermuters.RandomCoords.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-712"><a href="#EdgePermuters.RandomCoords.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-713"><a href="#EdgePermuters.RandomCoords.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.serialize-714"><a href="#EdgePermuters.RandomCoords.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.serialize-715"><a href="#EdgePermuters.RandomCoords.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgePermuters.RandomCoords.serialize-716"><a href="#EdgePermuters.RandomCoords.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgePermuters.RandomCoords.load" class="classattr">
                                        <input id="EdgePermuters.RandomCoords.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords.load-723"><a href="#EdgePermuters.RandomCoords.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgePermuters.RandomCoords.load-724"><a href="#EdgePermuters.RandomCoords.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgePermuters.RandomCoords.load-725"><a href="#EdgePermuters.RandomCoords.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgePermuters.RandomCoords.load-726"><a href="#EdgePermuters.RandomCoords.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-727"><a href="#EdgePermuters.RandomCoords.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgePermuters.RandomCoords.load-728"><a href="#EdgePermuters.RandomCoords.load-728"><span class="linenos">728</span></a>
</span><span id="EdgePermuters.RandomCoords.load-729"><a href="#EdgePermuters.RandomCoords.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-730"><a href="#EdgePermuters.RandomCoords.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgePermuters.RandomCoords.load-731"><a href="#EdgePermuters.RandomCoords.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-732"><a href="#EdgePermuters.RandomCoords.load-732"><span class="linenos">732</span></a>
</span><span id="EdgePermuters.RandomCoords.load-733"><a href="#EdgePermuters.RandomCoords.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-734"><a href="#EdgePermuters.RandomCoords.load-734"><span class="linenos">734</span></a>
</span><span id="EdgePermuters.RandomCoords.load-735"><a href="#EdgePermuters.RandomCoords.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgePermuters.RandomCoords.load-736"><a href="#EdgePermuters.RandomCoords.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.load-737"><a href="#EdgePermuters.RandomCoords.load-737"><span class="linenos">737</span></a>
</span><span id="EdgePermuters.RandomCoords.load-738"><a href="#EdgePermuters.RandomCoords.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgePermuters.RandomCoords.load-739"><a href="#EdgePermuters.RandomCoords.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-740"><a href="#EdgePermuters.RandomCoords.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgePermuters.RandomCoords.load-741"><a href="#EdgePermuters.RandomCoords.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-742"><a href="#EdgePermuters.RandomCoords.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgePermuters.RandomCoords.load-743"><a href="#EdgePermuters.RandomCoords.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-744"><a href="#EdgePermuters.RandomCoords.load-744"><span class="linenos">744</span></a>
</span><span id="EdgePermuters.RandomCoords.load-745"><a href="#EdgePermuters.RandomCoords.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgePermuters.RandomCoords.load-746"><a href="#EdgePermuters.RandomCoords.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-747"><a href="#EdgePermuters.RandomCoords.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgePermuters.RandomCoords.load-748"><a href="#EdgePermuters.RandomCoords.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgePermuters.RandomCoords.load-749"><a href="#EdgePermuters.RandomCoords.load-749"><span class="linenos">749</span></a>
</span><span id="EdgePermuters.RandomCoords.load-750"><a href="#EdgePermuters.RandomCoords.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgePermuters.RandomCoords.load-751"><a href="#EdgePermuters.RandomCoords.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-752"><a href="#EdgePermuters.RandomCoords.load-752"><span class="linenos">752</span></a>
</span><span id="EdgePermuters.RandomCoords.load-753"><a href="#EdgePermuters.RandomCoords.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgePermuters.RandomCoords.load-754"><a href="#EdgePermuters.RandomCoords.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-755"><a href="#EdgePermuters.RandomCoords.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgePermuters.RandomCoords.load-756"><a href="#EdgePermuters.RandomCoords.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-757"><a href="#EdgePermuters.RandomCoords.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-758"><a href="#EdgePermuters.RandomCoords.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgePermuters.RandomCoords.load-759"><a href="#EdgePermuters.RandomCoords.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-760"><a href="#EdgePermuters.RandomCoords.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-761"><a href="#EdgePermuters.RandomCoords.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgePermuters.RandomCoords.load-762"><a href="#EdgePermuters.RandomCoords.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-763"><a href="#EdgePermuters.RandomCoords.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-764"><a href="#EdgePermuters.RandomCoords.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-765"><a href="#EdgePermuters.RandomCoords.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgePermuters.RandomCoords.load-766"><a href="#EdgePermuters.RandomCoords.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgePermuters.RandomCoords.load-767"><a href="#EdgePermuters.RandomCoords.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-768"><a href="#EdgePermuters.RandomCoords.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-769"><a href="#EdgePermuters.RandomCoords.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.load-770"><a href="#EdgePermuters.RandomCoords.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.RandomCoords.load-771"><a href="#EdgePermuters.RandomCoords.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-772"><a href="#EdgePermuters.RandomCoords.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-773"><a href="#EdgePermuters.RandomCoords.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgePermuters.RandomCoords.load-774"><a href="#EdgePermuters.RandomCoords.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgePermuters.RandomCoords.load-775"><a href="#EdgePermuters.RandomCoords.load-775"><span class="linenos">775</span></a>
</span><span id="EdgePermuters.RandomCoords.load-776"><a href="#EdgePermuters.RandomCoords.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgePermuters.RandomCoords.load-777"><a href="#EdgePermuters.RandomCoords.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.RandomCoords.load-778"><a href="#EdgePermuters.RandomCoords.load-778"><span class="linenos">778</span></a>
</span><span id="EdgePermuters.RandomCoords.load-779"><a href="#EdgePermuters.RandomCoords.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgePermuters.RandomCoords.load-780"><a href="#EdgePermuters.RandomCoords.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-781"><a href="#EdgePermuters.RandomCoords.load-781"><span class="linenos">781</span></a>
</span><span id="EdgePermuters.RandomCoords.load-782"><a href="#EdgePermuters.RandomCoords.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgePermuters.RandomCoords.load-783"><a href="#EdgePermuters.RandomCoords.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.load-784"><a href="#EdgePermuters.RandomCoords.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgePermuters.RandomCoords.load-785"><a href="#EdgePermuters.RandomCoords.load-785"><span class="linenos">785</span></a>
</span><span id="EdgePermuters.RandomCoords.load-786"><a href="#EdgePermuters.RandomCoords.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgePermuters.RandomCoords.load-787"><a href="#EdgePermuters.RandomCoords.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgePermuters.RandomCoords.validate_fields_types" class="classattr">
                                        <input id="EdgePermuters.RandomCoords.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.RandomCoords.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.RandomCoords.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.RandomCoords.validate_fields_types-271"><a href="#EdgePermuters.RandomCoords.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-272"><a href="#EdgePermuters.RandomCoords.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-273"><a href="#EdgePermuters.RandomCoords.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-274"><a href="#EdgePermuters.RandomCoords.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-275"><a href="#EdgePermuters.RandomCoords.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-276"><a href="#EdgePermuters.RandomCoords.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-277"><a href="#EdgePermuters.RandomCoords.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-278"><a href="#EdgePermuters.RandomCoords.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-279"><a href="#EdgePermuters.RandomCoords.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgePermuters.RandomCoords.validate_fields_types-280"><a href="#EdgePermuters.RandomCoords.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></dt>
                                <dd id="EdgePermuters.RandomCoords.attribute_key" class="function"><a href="#EdgePermuters._EdgePermuter.attribute_key">attribute_key</a></dd>
                <dd id="EdgePermuters.RandomCoords.is_valid" class="function"><a href="#EdgePermuters._EdgePermuter.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgePermuters.RandomCoords.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgePermuters.RandomCoords.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgePermuters.RandomCoords.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgePermuters.RandomCoords.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgePermuters.RandomCoords.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgePermuters.RandomCoords.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgePermuters.RandomCoords.diff" class="function">diff</dd>
                <dd id="EdgePermuters.RandomCoords.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgePermuters.BothCoords">
                            <input id="EdgePermuters.BothCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgePermuters.BothCoords</span><wbr>(<span class="base"><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L953-L962" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords-954"><a href="#EdgePermuters.BothCoords-954"><span class="linenos">954</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords-955"><a href="#EdgePermuters.BothCoords-955"><span class="linenos">955</span></a>    <span class="k">class</span> <span class="nc">BothCoords</span><span class="p">(</span><span class="n">_EdgePermuter</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords-956"><a href="#EdgePermuters.BothCoords-956"><span class="linenos">956</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Includes both possible permutations of every edge in the output.</span>
</span><span id="EdgePermuters.BothCoords-957"><a href="#EdgePermuters.BothCoords-957"><span class="linenos">957</span></a><span class="sd">        Since input ConnectionList has only 1 instance of each edge,</span>
</span><span id="EdgePermuters.BothCoords-958"><a href="#EdgePermuters.BothCoords-958"><span class="linenos">958</span></a><span class="sd">        a call to `BothCoords._permute` will modify `lattice_edges` in-place, doubling `shape[0]`.</span>
</span><span id="EdgePermuters.BothCoords-959"><a href="#EdgePermuters.BothCoords-959"><span class="linenos">959</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgePermuters.BothCoords-960"><a href="#EdgePermuters.BothCoords-960"><span class="linenos">960</span></a>
</span><span id="EdgePermuters.BothCoords-961"><a href="#EdgePermuters.BothCoords-961"><span class="linenos">961</span></a>        <span class="nd">@staticmethod</span>
</span><span id="EdgePermuters.BothCoords-962"><a href="#EdgePermuters.BothCoords-962"><span class="linenos">962</span></a>        <span class="k">def</span> <span class="nf">_permute</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords-963"><a href="#EdgePermuters.BothCoords-963"><span class="linenos">963</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lattice_edges</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Includes both possible permutations of every edge in the output.
Since input ConnectionList has only 1 instance of each edge,
a call to <code>BothCoords._permute</code> will modify <code>lattice_edges</code> in-place, doubling <code>shape[0]</code>.</p>
</div>


                            <div id="EdgePermuters.BothCoords.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgePermuters.BothCoords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.__init__"></a>
    
    

                            </div>
                            <div id="EdgePermuters.BothCoords.serialize" class="classattr">
                                        <input id="EdgePermuters.BothCoords.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords.serialize-660"><a href="#EdgePermuters.BothCoords.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgePermuters.BothCoords.serialize-661"><a href="#EdgePermuters.BothCoords.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgePermuters.BothCoords.serialize-662"><a href="#EdgePermuters.BothCoords.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-663"><a href="#EdgePermuters.BothCoords.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgePermuters.BothCoords.serialize-664"><a href="#EdgePermuters.BothCoords.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgePermuters.BothCoords.serialize-665"><a href="#EdgePermuters.BothCoords.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgePermuters.BothCoords.serialize-666"><a href="#EdgePermuters.BothCoords.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgePermuters.BothCoords.serialize-667"><a href="#EdgePermuters.BothCoords.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-668"><a href="#EdgePermuters.BothCoords.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-669"><a href="#EdgePermuters.BothCoords.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-670"><a href="#EdgePermuters.BothCoords.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-671"><a href="#EdgePermuters.BothCoords.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-672"><a href="#EdgePermuters.BothCoords.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-673"><a href="#EdgePermuters.BothCoords.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-674"><a href="#EdgePermuters.BothCoords.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgePermuters.BothCoords.serialize-675"><a href="#EdgePermuters.BothCoords.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-676"><a href="#EdgePermuters.BothCoords.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-677"><a href="#EdgePermuters.BothCoords.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgePermuters.BothCoords.serialize-678"><a href="#EdgePermuters.BothCoords.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-679"><a href="#EdgePermuters.BothCoords.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgePermuters.BothCoords.serialize-680"><a href="#EdgePermuters.BothCoords.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-681"><a href="#EdgePermuters.BothCoords.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.serialize-682"><a href="#EdgePermuters.BothCoords.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgePermuters.BothCoords.serialize-683"><a href="#EdgePermuters.BothCoords.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-684"><a href="#EdgePermuters.BothCoords.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.serialize-685"><a href="#EdgePermuters.BothCoords.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgePermuters.BothCoords.serialize-686"><a href="#EdgePermuters.BothCoords.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgePermuters.BothCoords.serialize-687"><a href="#EdgePermuters.BothCoords.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-688"><a href="#EdgePermuters.BothCoords.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-689"><a href="#EdgePermuters.BothCoords.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-690"><a href="#EdgePermuters.BothCoords.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgePermuters.BothCoords.serialize-691"><a href="#EdgePermuters.BothCoords.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.BothCoords.serialize-692"><a href="#EdgePermuters.BothCoords.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-693"><a href="#EdgePermuters.BothCoords.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-694"><a href="#EdgePermuters.BothCoords.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-695"><a href="#EdgePermuters.BothCoords.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgePermuters.BothCoords.serialize-696"><a href="#EdgePermuters.BothCoords.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-697"><a href="#EdgePermuters.BothCoords.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-698"><a href="#EdgePermuters.BothCoords.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-699"><a href="#EdgePermuters.BothCoords.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.serialize-700"><a href="#EdgePermuters.BothCoords.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgePermuters.BothCoords.serialize-701"><a href="#EdgePermuters.BothCoords.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-702"><a href="#EdgePermuters.BothCoords.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgePermuters.BothCoords.serialize-703"><a href="#EdgePermuters.BothCoords.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-704"><a href="#EdgePermuters.BothCoords.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgePermuters.BothCoords.serialize-705"><a href="#EdgePermuters.BothCoords.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-706"><a href="#EdgePermuters.BothCoords.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.serialize-707"><a href="#EdgePermuters.BothCoords.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-708"><a href="#EdgePermuters.BothCoords.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.BothCoords.serialize-709"><a href="#EdgePermuters.BothCoords.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.serialize-710"><a href="#EdgePermuters.BothCoords.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.serialize-711"><a href="#EdgePermuters.BothCoords.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-712"><a href="#EdgePermuters.BothCoords.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-713"><a href="#EdgePermuters.BothCoords.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.serialize-714"><a href="#EdgePermuters.BothCoords.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.serialize-715"><a href="#EdgePermuters.BothCoords.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgePermuters.BothCoords.serialize-716"><a href="#EdgePermuters.BothCoords.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgePermuters.BothCoords.load" class="classattr">
                                        <input id="EdgePermuters.BothCoords.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords.load-723"><a href="#EdgePermuters.BothCoords.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgePermuters.BothCoords.load-724"><a href="#EdgePermuters.BothCoords.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgePermuters.BothCoords.load-725"><a href="#EdgePermuters.BothCoords.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgePermuters.BothCoords.load-726"><a href="#EdgePermuters.BothCoords.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-727"><a href="#EdgePermuters.BothCoords.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgePermuters.BothCoords.load-728"><a href="#EdgePermuters.BothCoords.load-728"><span class="linenos">728</span></a>
</span><span id="EdgePermuters.BothCoords.load-729"><a href="#EdgePermuters.BothCoords.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-730"><a href="#EdgePermuters.BothCoords.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgePermuters.BothCoords.load-731"><a href="#EdgePermuters.BothCoords.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-732"><a href="#EdgePermuters.BothCoords.load-732"><span class="linenos">732</span></a>
</span><span id="EdgePermuters.BothCoords.load-733"><a href="#EdgePermuters.BothCoords.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-734"><a href="#EdgePermuters.BothCoords.load-734"><span class="linenos">734</span></a>
</span><span id="EdgePermuters.BothCoords.load-735"><a href="#EdgePermuters.BothCoords.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgePermuters.BothCoords.load-736"><a href="#EdgePermuters.BothCoords.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.load-737"><a href="#EdgePermuters.BothCoords.load-737"><span class="linenos">737</span></a>
</span><span id="EdgePermuters.BothCoords.load-738"><a href="#EdgePermuters.BothCoords.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgePermuters.BothCoords.load-739"><a href="#EdgePermuters.BothCoords.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-740"><a href="#EdgePermuters.BothCoords.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgePermuters.BothCoords.load-741"><a href="#EdgePermuters.BothCoords.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-742"><a href="#EdgePermuters.BothCoords.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgePermuters.BothCoords.load-743"><a href="#EdgePermuters.BothCoords.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-744"><a href="#EdgePermuters.BothCoords.load-744"><span class="linenos">744</span></a>
</span><span id="EdgePermuters.BothCoords.load-745"><a href="#EdgePermuters.BothCoords.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgePermuters.BothCoords.load-746"><a href="#EdgePermuters.BothCoords.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-747"><a href="#EdgePermuters.BothCoords.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgePermuters.BothCoords.load-748"><a href="#EdgePermuters.BothCoords.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgePermuters.BothCoords.load-749"><a href="#EdgePermuters.BothCoords.load-749"><span class="linenos">749</span></a>
</span><span id="EdgePermuters.BothCoords.load-750"><a href="#EdgePermuters.BothCoords.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgePermuters.BothCoords.load-751"><a href="#EdgePermuters.BothCoords.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-752"><a href="#EdgePermuters.BothCoords.load-752"><span class="linenos">752</span></a>
</span><span id="EdgePermuters.BothCoords.load-753"><a href="#EdgePermuters.BothCoords.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgePermuters.BothCoords.load-754"><a href="#EdgePermuters.BothCoords.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-755"><a href="#EdgePermuters.BothCoords.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgePermuters.BothCoords.load-756"><a href="#EdgePermuters.BothCoords.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-757"><a href="#EdgePermuters.BothCoords.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-758"><a href="#EdgePermuters.BothCoords.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgePermuters.BothCoords.load-759"><a href="#EdgePermuters.BothCoords.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-760"><a href="#EdgePermuters.BothCoords.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-761"><a href="#EdgePermuters.BothCoords.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgePermuters.BothCoords.load-762"><a href="#EdgePermuters.BothCoords.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-763"><a href="#EdgePermuters.BothCoords.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-764"><a href="#EdgePermuters.BothCoords.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-765"><a href="#EdgePermuters.BothCoords.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgePermuters.BothCoords.load-766"><a href="#EdgePermuters.BothCoords.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgePermuters.BothCoords.load-767"><a href="#EdgePermuters.BothCoords.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-768"><a href="#EdgePermuters.BothCoords.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-769"><a href="#EdgePermuters.BothCoords.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.load-770"><a href="#EdgePermuters.BothCoords.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgePermuters.BothCoords.load-771"><a href="#EdgePermuters.BothCoords.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-772"><a href="#EdgePermuters.BothCoords.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-773"><a href="#EdgePermuters.BothCoords.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgePermuters.BothCoords.load-774"><a href="#EdgePermuters.BothCoords.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgePermuters.BothCoords.load-775"><a href="#EdgePermuters.BothCoords.load-775"><span class="linenos">775</span></a>
</span><span id="EdgePermuters.BothCoords.load-776"><a href="#EdgePermuters.BothCoords.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgePermuters.BothCoords.load-777"><a href="#EdgePermuters.BothCoords.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgePermuters.BothCoords.load-778"><a href="#EdgePermuters.BothCoords.load-778"><span class="linenos">778</span></a>
</span><span id="EdgePermuters.BothCoords.load-779"><a href="#EdgePermuters.BothCoords.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgePermuters.BothCoords.load-780"><a href="#EdgePermuters.BothCoords.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-781"><a href="#EdgePermuters.BothCoords.load-781"><span class="linenos">781</span></a>
</span><span id="EdgePermuters.BothCoords.load-782"><a href="#EdgePermuters.BothCoords.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgePermuters.BothCoords.load-783"><a href="#EdgePermuters.BothCoords.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.load-784"><a href="#EdgePermuters.BothCoords.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgePermuters.BothCoords.load-785"><a href="#EdgePermuters.BothCoords.load-785"><span class="linenos">785</span></a>
</span><span id="EdgePermuters.BothCoords.load-786"><a href="#EdgePermuters.BothCoords.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgePermuters.BothCoords.load-787"><a href="#EdgePermuters.BothCoords.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgePermuters.BothCoords.validate_fields_types" class="classattr">
                                        <input id="EdgePermuters.BothCoords.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgePermuters.BothCoords.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgePermuters.BothCoords.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgePermuters.BothCoords.validate_fields_types-271"><a href="#EdgePermuters.BothCoords.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-272"><a href="#EdgePermuters.BothCoords.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-273"><a href="#EdgePermuters.BothCoords.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-274"><a href="#EdgePermuters.BothCoords.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-275"><a href="#EdgePermuters.BothCoords.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-276"><a href="#EdgePermuters.BothCoords.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-277"><a href="#EdgePermuters.BothCoords.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-278"><a href="#EdgePermuters.BothCoords.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-279"><a href="#EdgePermuters.BothCoords.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgePermuters.BothCoords.validate_fields_types-280"><a href="#EdgePermuters.BothCoords.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgePermuters._EdgePermuter">EdgePermuters._EdgePermuter</a></dt>
                                <dd id="EdgePermuters.BothCoords.attribute_key" class="function"><a href="#EdgePermuters._EdgePermuter.attribute_key">attribute_key</a></dd>
                <dd id="EdgePermuters.BothCoords.is_valid" class="function"><a href="#EdgePermuters._EdgePermuter.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgePermuters.BothCoords.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgePermuters.BothCoords.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgePermuters.BothCoords.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgePermuters.BothCoords.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgePermuters.BothCoords.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgePermuters.BothCoords.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgePermuters.BothCoords.diff" class="function">diff</dd>
                <dd id="EdgePermuters.BothCoords.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeSubsets">
                            <input id="EdgeSubsets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EdgeSubsets</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L965-L1023" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets-966"><a href="#EdgeSubsets-966"><span class="linenos"> 966</span></a><span class="k">class</span> <span class="nc">EdgeSubsets</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="EdgeSubsets-967"><a href="#EdgeSubsets-967"><span class="linenos"> 967</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-968"><a href="#EdgeSubsets-968"><span class="linenos"> 968</span></a><span class="sd">    Namespace for `_EdgeSubset` subclass hierarchy used by `_AdjListTokenizer`.</span>
</span><span id="EdgeSubsets-969"><a href="#EdgeSubsets-969"><span class="linenos"> 969</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-970"><a href="#EdgeSubsets-970"><span class="linenos"> 970</span></a>
</span><span id="EdgeSubsets-971"><a href="#EdgeSubsets-971"><span class="linenos"> 971</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;edge_subset&quot;</span>
</span><span id="EdgeSubsets-972"><a href="#EdgeSubsets-972"><span class="linenos"> 972</span></a>
</span><span id="EdgeSubsets-973"><a href="#EdgeSubsets-973"><span class="linenos"> 973</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets-974"><a href="#EdgeSubsets-974"><span class="linenos"> 974</span></a>    <span class="k">class</span> <span class="nc">_EdgeSubset</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EdgeSubsets-975"><a href="#EdgeSubsets-975"><span class="linenos"> 975</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-976"><a href="#EdgeSubsets-976"><span class="linenos"> 976</span></a><span class="sd">        Component of an `AdjListTokenizers._AdjListTokenizer` which specifies the subset of lattice edges to be tokenized.</span>
</span><span id="EdgeSubsets-977"><a href="#EdgeSubsets-977"><span class="linenos"> 977</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-978"><a href="#EdgeSubsets-978"><span class="linenos"> 978</span></a>
</span><span id="EdgeSubsets-979"><a href="#EdgeSubsets-979"><span class="linenos"> 979</span></a>        <span class="nd">@classmethod</span>
</span><span id="EdgeSubsets-980"><a href="#EdgeSubsets-980"><span class="linenos"> 980</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="EdgeSubsets-981"><a href="#EdgeSubsets-981"><span class="linenos"> 981</span></a>            <span class="k">return</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">key</span>
</span><span id="EdgeSubsets-982"><a href="#EdgeSubsets-982"><span class="linenos"> 982</span></a>
</span><span id="EdgeSubsets-983"><a href="#EdgeSubsets-983"><span class="linenos"> 983</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeSubsets-984"><a href="#EdgeSubsets-984"><span class="linenos"> 984</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="EdgeSubsets-985"><a href="#EdgeSubsets-985"><span class="linenos"> 985</span></a>
</span><span id="EdgeSubsets-986"><a href="#EdgeSubsets-986"><span class="linenos"> 986</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="EdgeSubsets-987"><a href="#EdgeSubsets-987"><span class="linenos"> 987</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets-988"><a href="#EdgeSubsets-988"><span class="linenos"> 988</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-989"><a href="#EdgeSubsets-989"><span class="linenos"> 989</span></a><span class="sd">            Returns the set of lattice edges to be tokenized.</span>
</span><span id="EdgeSubsets-990"><a href="#EdgeSubsets-990"><span class="linenos"> 990</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-991"><a href="#EdgeSubsets-991"><span class="linenos"> 991</span></a>            <span class="k">pass</span>
</span><span id="EdgeSubsets-992"><a href="#EdgeSubsets-992"><span class="linenos"> 992</span></a>
</span><span id="EdgeSubsets-993"><a href="#EdgeSubsets-993"><span class="linenos"> 993</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets-994"><a href="#EdgeSubsets-994"><span class="linenos"> 994</span></a>    <span class="k">class</span> <span class="nc">AllLatticeEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets-995"><a href="#EdgeSubsets-995"><span class="linenos"> 995</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-996"><a href="#EdgeSubsets-996"><span class="linenos"> 996</span></a><span class="sd">        All 2n**2-2n edges of the lattice are tokenized.</span>
</span><span id="EdgeSubsets-997"><a href="#EdgeSubsets-997"><span class="linenos"> 997</span></a><span class="sd">        If a wall exists on that edge, the edge is tokenized in the same manner, using `VOCAB.ADJLIST_WALL` in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets-998"><a href="#EdgeSubsets-998"><span class="linenos"> 998</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-999"><a href="#EdgeSubsets-999"><span class="linenos"> 999</span></a>
</span><span id="EdgeSubsets-1000"><a href="#EdgeSubsets-1000"><span class="linenos">1000</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets-1001"><a href="#EdgeSubsets-1001"><span class="linenos">1001</span></a>            <span class="k">return</span> <span class="n">lattice_connection_array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">grid_n</span><span class="p">)</span>
</span><span id="EdgeSubsets-1002"><a href="#EdgeSubsets-1002"><span class="linenos">1002</span></a>
</span><span id="EdgeSubsets-1003"><a href="#EdgeSubsets-1003"><span class="linenos">1003</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets-1004"><a href="#EdgeSubsets-1004"><span class="linenos">1004</span></a>    <span class="k">class</span> <span class="nc">ConnectionEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets-1005"><a href="#EdgeSubsets-1005"><span class="linenos">1005</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-1006"><a href="#EdgeSubsets-1006"><span class="linenos">1006</span></a><span class="sd">        Only edges which contain a connection are tokenized.</span>
</span><span id="EdgeSubsets-1007"><a href="#EdgeSubsets-1007"><span class="linenos">1007</span></a><span class="sd">        Alternatively, only edges which contain a wall are tokenized.</span>
</span><span id="EdgeSubsets-1008"><a href="#EdgeSubsets-1008"><span class="linenos">1008</span></a>
</span><span id="EdgeSubsets-1009"><a href="#EdgeSubsets-1009"><span class="linenos">1009</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeSubsets-1010"><a href="#EdgeSubsets-1010"><span class="linenos">1010</span></a><span class="sd">        - `walls`: Whether wall edges or connection edges are tokenized.</span>
</span><span id="EdgeSubsets-1011"><a href="#EdgeSubsets-1011"><span class="linenos">1011</span></a><span class="sd">        If true, `VOCAB.ADJLIST_WALL` is used in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets-1012"><a href="#EdgeSubsets-1012"><span class="linenos">1012</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets-1013"><a href="#EdgeSubsets-1013"><span class="linenos">1013</span></a>
</span><span id="EdgeSubsets-1014"><a href="#EdgeSubsets-1014"><span class="linenos">1014</span></a>        <span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeSubsets-1015"><a href="#EdgeSubsets-1015"><span class="linenos">1015</span></a>
</span><span id="EdgeSubsets-1016"><a href="#EdgeSubsets-1016"><span class="linenos">1016</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets-1017"><a href="#EdgeSubsets-1017"><span class="linenos">1017</span></a>            <span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="EdgeSubsets-1018"><a href="#EdgeSubsets-1018"><span class="linenos">1018</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
</span><span id="EdgeSubsets-1019"><a href="#EdgeSubsets-1019"><span class="linenos">1019</span></a>                <span class="n">conn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">conn_list</span><span class="p">)</span>
</span><span id="EdgeSubsets-1020"><a href="#EdgeSubsets-1020"><span class="linenos">1020</span></a>                <span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets-1021"><a href="#EdgeSubsets-1021"><span class="linenos">1021</span></a>                <span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets-1022"><a href="#EdgeSubsets-1022"><span class="linenos">1022</span></a>            <span class="k">return</span> <span class="n">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="EdgeSubsets-1023"><a href="#EdgeSubsets-1023"><span class="linenos">1023</span></a>                <span class="n">conn_list</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle_d1</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeSubsets-1024"><a href="#EdgeSubsets-1024"><span class="linenos">1024</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_EdgeSubset</code> subclass hierarchy used by <code>_AdjListTokenizer</code>.</p>
</div>


                            <div id="EdgeSubsets.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;edge_subset&#39;</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.key"></a>
    
    

                            </div>
                </section>
                <section id="EdgeSubsets.AllLatticeEdges">
                            <input id="EdgeSubsets.AllLatticeEdges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgeSubsets.AllLatticeEdges</span><wbr>(<span class="base"><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L992-L1000" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges-993"><a href="#EdgeSubsets.AllLatticeEdges-993"><span class="linenos"> 993</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges-994"><a href="#EdgeSubsets.AllLatticeEdges-994"><span class="linenos"> 994</span></a>    <span class="k">class</span> <span class="nc">AllLatticeEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges-995"><a href="#EdgeSubsets.AllLatticeEdges-995"><span class="linenos"> 995</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges-996"><a href="#EdgeSubsets.AllLatticeEdges-996"><span class="linenos"> 996</span></a><span class="sd">        All 2n**2-2n edges of the lattice are tokenized.</span>
</span><span id="EdgeSubsets.AllLatticeEdges-997"><a href="#EdgeSubsets.AllLatticeEdges-997"><span class="linenos"> 997</span></a><span class="sd">        If a wall exists on that edge, the edge is tokenized in the same manner, using `VOCAB.ADJLIST_WALL` in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets.AllLatticeEdges-998"><a href="#EdgeSubsets.AllLatticeEdges-998"><span class="linenos"> 998</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges-999"><a href="#EdgeSubsets.AllLatticeEdges-999"><span class="linenos"> 999</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges-1000"><a href="#EdgeSubsets.AllLatticeEdges-1000"><span class="linenos">1000</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges-1001"><a href="#EdgeSubsets.AllLatticeEdges-1001"><span class="linenos">1001</span></a>            <span class="k">return</span> <span class="n">lattice_connection_array</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">grid_n</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>All 2n**2-2n edges of the lattice are tokenized.
If a wall exists on that edge, the edge is tokenized in the same manner, using <code>VOCAB.ADJLIST_WALL</code> in place of <code>VOCAB.CONNECTOR</code>.</p>
</div>


                            <div id="EdgeSubsets.AllLatticeEdges.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeSubsets.AllLatticeEdges</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.AllLatticeEdges">EdgeSubsets.AllLatticeEdges</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.AllLatticeEdges">EdgeSubsets.AllLatticeEdges</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.__init__"></a>
    
    

                            </div>
                            <div id="EdgeSubsets.AllLatticeEdges.serialize" class="classattr">
                                        <input id="EdgeSubsets.AllLatticeEdges.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges.serialize-660"><a href="#EdgeSubsets.AllLatticeEdges.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-661"><a href="#EdgeSubsets.AllLatticeEdges.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-662"><a href="#EdgeSubsets.AllLatticeEdges.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-663"><a href="#EdgeSubsets.AllLatticeEdges.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-664"><a href="#EdgeSubsets.AllLatticeEdges.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-665"><a href="#EdgeSubsets.AllLatticeEdges.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-666"><a href="#EdgeSubsets.AllLatticeEdges.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-667"><a href="#EdgeSubsets.AllLatticeEdges.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-668"><a href="#EdgeSubsets.AllLatticeEdges.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-669"><a href="#EdgeSubsets.AllLatticeEdges.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-670"><a href="#EdgeSubsets.AllLatticeEdges.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-671"><a href="#EdgeSubsets.AllLatticeEdges.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-672"><a href="#EdgeSubsets.AllLatticeEdges.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-673"><a href="#EdgeSubsets.AllLatticeEdges.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-674"><a href="#EdgeSubsets.AllLatticeEdges.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-675"><a href="#EdgeSubsets.AllLatticeEdges.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-676"><a href="#EdgeSubsets.AllLatticeEdges.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-677"><a href="#EdgeSubsets.AllLatticeEdges.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-678"><a href="#EdgeSubsets.AllLatticeEdges.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-679"><a href="#EdgeSubsets.AllLatticeEdges.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-680"><a href="#EdgeSubsets.AllLatticeEdges.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-681"><a href="#EdgeSubsets.AllLatticeEdges.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-682"><a href="#EdgeSubsets.AllLatticeEdges.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-683"><a href="#EdgeSubsets.AllLatticeEdges.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-684"><a href="#EdgeSubsets.AllLatticeEdges.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-685"><a href="#EdgeSubsets.AllLatticeEdges.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-686"><a href="#EdgeSubsets.AllLatticeEdges.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-687"><a href="#EdgeSubsets.AllLatticeEdges.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-688"><a href="#EdgeSubsets.AllLatticeEdges.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-689"><a href="#EdgeSubsets.AllLatticeEdges.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-690"><a href="#EdgeSubsets.AllLatticeEdges.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-691"><a href="#EdgeSubsets.AllLatticeEdges.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-692"><a href="#EdgeSubsets.AllLatticeEdges.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-693"><a href="#EdgeSubsets.AllLatticeEdges.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-694"><a href="#EdgeSubsets.AllLatticeEdges.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-695"><a href="#EdgeSubsets.AllLatticeEdges.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-696"><a href="#EdgeSubsets.AllLatticeEdges.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-697"><a href="#EdgeSubsets.AllLatticeEdges.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-698"><a href="#EdgeSubsets.AllLatticeEdges.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-699"><a href="#EdgeSubsets.AllLatticeEdges.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-700"><a href="#EdgeSubsets.AllLatticeEdges.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-701"><a href="#EdgeSubsets.AllLatticeEdges.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-702"><a href="#EdgeSubsets.AllLatticeEdges.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-703"><a href="#EdgeSubsets.AllLatticeEdges.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-704"><a href="#EdgeSubsets.AllLatticeEdges.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-705"><a href="#EdgeSubsets.AllLatticeEdges.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-706"><a href="#EdgeSubsets.AllLatticeEdges.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-707"><a href="#EdgeSubsets.AllLatticeEdges.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-708"><a href="#EdgeSubsets.AllLatticeEdges.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-709"><a href="#EdgeSubsets.AllLatticeEdges.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-710"><a href="#EdgeSubsets.AllLatticeEdges.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-711"><a href="#EdgeSubsets.AllLatticeEdges.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-712"><a href="#EdgeSubsets.AllLatticeEdges.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-713"><a href="#EdgeSubsets.AllLatticeEdges.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-714"><a href="#EdgeSubsets.AllLatticeEdges.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-715"><a href="#EdgeSubsets.AllLatticeEdges.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.serialize-716"><a href="#EdgeSubsets.AllLatticeEdges.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeSubsets.AllLatticeEdges.load" class="classattr">
                                        <input id="EdgeSubsets.AllLatticeEdges.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges.load-723"><a href="#EdgeSubsets.AllLatticeEdges.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-724"><a href="#EdgeSubsets.AllLatticeEdges.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-725"><a href="#EdgeSubsets.AllLatticeEdges.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-726"><a href="#EdgeSubsets.AllLatticeEdges.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-727"><a href="#EdgeSubsets.AllLatticeEdges.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-728"><a href="#EdgeSubsets.AllLatticeEdges.load-728"><span class="linenos">728</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-729"><a href="#EdgeSubsets.AllLatticeEdges.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-730"><a href="#EdgeSubsets.AllLatticeEdges.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-731"><a href="#EdgeSubsets.AllLatticeEdges.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-732"><a href="#EdgeSubsets.AllLatticeEdges.load-732"><span class="linenos">732</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-733"><a href="#EdgeSubsets.AllLatticeEdges.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-734"><a href="#EdgeSubsets.AllLatticeEdges.load-734"><span class="linenos">734</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-735"><a href="#EdgeSubsets.AllLatticeEdges.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-736"><a href="#EdgeSubsets.AllLatticeEdges.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-737"><a href="#EdgeSubsets.AllLatticeEdges.load-737"><span class="linenos">737</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-738"><a href="#EdgeSubsets.AllLatticeEdges.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-739"><a href="#EdgeSubsets.AllLatticeEdges.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-740"><a href="#EdgeSubsets.AllLatticeEdges.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-741"><a href="#EdgeSubsets.AllLatticeEdges.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-742"><a href="#EdgeSubsets.AllLatticeEdges.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-743"><a href="#EdgeSubsets.AllLatticeEdges.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-744"><a href="#EdgeSubsets.AllLatticeEdges.load-744"><span class="linenos">744</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-745"><a href="#EdgeSubsets.AllLatticeEdges.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-746"><a href="#EdgeSubsets.AllLatticeEdges.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-747"><a href="#EdgeSubsets.AllLatticeEdges.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-748"><a href="#EdgeSubsets.AllLatticeEdges.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-749"><a href="#EdgeSubsets.AllLatticeEdges.load-749"><span class="linenos">749</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-750"><a href="#EdgeSubsets.AllLatticeEdges.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-751"><a href="#EdgeSubsets.AllLatticeEdges.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-752"><a href="#EdgeSubsets.AllLatticeEdges.load-752"><span class="linenos">752</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-753"><a href="#EdgeSubsets.AllLatticeEdges.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-754"><a href="#EdgeSubsets.AllLatticeEdges.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-755"><a href="#EdgeSubsets.AllLatticeEdges.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-756"><a href="#EdgeSubsets.AllLatticeEdges.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-757"><a href="#EdgeSubsets.AllLatticeEdges.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-758"><a href="#EdgeSubsets.AllLatticeEdges.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-759"><a href="#EdgeSubsets.AllLatticeEdges.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-760"><a href="#EdgeSubsets.AllLatticeEdges.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-761"><a href="#EdgeSubsets.AllLatticeEdges.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-762"><a href="#EdgeSubsets.AllLatticeEdges.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-763"><a href="#EdgeSubsets.AllLatticeEdges.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-764"><a href="#EdgeSubsets.AllLatticeEdges.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-765"><a href="#EdgeSubsets.AllLatticeEdges.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-766"><a href="#EdgeSubsets.AllLatticeEdges.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-767"><a href="#EdgeSubsets.AllLatticeEdges.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-768"><a href="#EdgeSubsets.AllLatticeEdges.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-769"><a href="#EdgeSubsets.AllLatticeEdges.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-770"><a href="#EdgeSubsets.AllLatticeEdges.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-771"><a href="#EdgeSubsets.AllLatticeEdges.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-772"><a href="#EdgeSubsets.AllLatticeEdges.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-773"><a href="#EdgeSubsets.AllLatticeEdges.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-774"><a href="#EdgeSubsets.AllLatticeEdges.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-775"><a href="#EdgeSubsets.AllLatticeEdges.load-775"><span class="linenos">775</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-776"><a href="#EdgeSubsets.AllLatticeEdges.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-777"><a href="#EdgeSubsets.AllLatticeEdges.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-778"><a href="#EdgeSubsets.AllLatticeEdges.load-778"><span class="linenos">778</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-779"><a href="#EdgeSubsets.AllLatticeEdges.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-780"><a href="#EdgeSubsets.AllLatticeEdges.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-781"><a href="#EdgeSubsets.AllLatticeEdges.load-781"><span class="linenos">781</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-782"><a href="#EdgeSubsets.AllLatticeEdges.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-783"><a href="#EdgeSubsets.AllLatticeEdges.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-784"><a href="#EdgeSubsets.AllLatticeEdges.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-785"><a href="#EdgeSubsets.AllLatticeEdges.load-785"><span class="linenos">785</span></a>
</span><span id="EdgeSubsets.AllLatticeEdges.load-786"><a href="#EdgeSubsets.AllLatticeEdges.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeSubsets.AllLatticeEdges.load-787"><a href="#EdgeSubsets.AllLatticeEdges.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeSubsets.AllLatticeEdges.validate_fields_types" class="classattr">
                                        <input id="EdgeSubsets.AllLatticeEdges.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.AllLatticeEdges.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.AllLatticeEdges.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-271"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-272"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-273"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-274"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-275"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-276"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-277"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-278"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-279"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeSubsets.AllLatticeEdges.validate_fields_types-280"><a href="#EdgeSubsets.AllLatticeEdges.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></dt>
                                <dd id="EdgeSubsets.AllLatticeEdges.attribute_key" class="function"><a href="#EdgeSubsets._EdgeSubset.attribute_key">attribute_key</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.is_valid" class="function"><a href="#EdgeSubsets._EdgeSubset.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgeSubsets.AllLatticeEdges.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeSubsets.AllLatticeEdges.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeSubsets.AllLatticeEdges.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeSubsets.AllLatticeEdges.diff" class="function">diff</dd>
                <dd id="EdgeSubsets.AllLatticeEdges.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EdgeSubsets.ConnectionEdges">
                            <input id="EdgeSubsets.ConnectionEdges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">EdgeSubsets.ConnectionEdges</span><wbr>(<span class="base"><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1002-L1023" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges-1003"><a href="#EdgeSubsets.ConnectionEdges-1003"><span class="linenos">1003</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges-1004"><a href="#EdgeSubsets.ConnectionEdges-1004"><span class="linenos">1004</span></a>    <span class="k">class</span> <span class="nc">ConnectionEdges</span><span class="p">(</span><span class="n">_EdgeSubset</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges-1005"><a href="#EdgeSubsets.ConnectionEdges-1005"><span class="linenos">1005</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges-1006"><a href="#EdgeSubsets.ConnectionEdges-1006"><span class="linenos">1006</span></a><span class="sd">        Only edges which contain a connection are tokenized.</span>
</span><span id="EdgeSubsets.ConnectionEdges-1007"><a href="#EdgeSubsets.ConnectionEdges-1007"><span class="linenos">1007</span></a><span class="sd">        Alternatively, only edges which contain a wall are tokenized.</span>
</span><span id="EdgeSubsets.ConnectionEdges-1008"><a href="#EdgeSubsets.ConnectionEdges-1008"><span class="linenos">1008</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-1009"><a href="#EdgeSubsets.ConnectionEdges-1009"><span class="linenos">1009</span></a><span class="sd">        # Parameters</span>
</span><span id="EdgeSubsets.ConnectionEdges-1010"><a href="#EdgeSubsets.ConnectionEdges-1010"><span class="linenos">1010</span></a><span class="sd">        - `walls`: Whether wall edges or connection edges are tokenized.</span>
</span><span id="EdgeSubsets.ConnectionEdges-1011"><a href="#EdgeSubsets.ConnectionEdges-1011"><span class="linenos">1011</span></a><span class="sd">        If true, `VOCAB.ADJLIST_WALL` is used in place of `VOCAB.CONNECTOR`.</span>
</span><span id="EdgeSubsets.ConnectionEdges-1012"><a href="#EdgeSubsets.ConnectionEdges-1012"><span class="linenos">1012</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges-1013"><a href="#EdgeSubsets.ConnectionEdges-1013"><span class="linenos">1013</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-1014"><a href="#EdgeSubsets.ConnectionEdges-1014"><span class="linenos">1014</span></a>        <span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges-1015"><a href="#EdgeSubsets.ConnectionEdges-1015"><span class="linenos">1015</span></a>
</span><span id="EdgeSubsets.ConnectionEdges-1016"><a href="#EdgeSubsets.ConnectionEdges-1016"><span class="linenos">1016</span></a>        <span class="k">def</span> <span class="nf">_get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConnectionArray</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges-1017"><a href="#EdgeSubsets.ConnectionEdges-1017"><span class="linenos">1017</span></a>            <span class="n">conn_list</span><span class="p">:</span> <span class="n">ConnectionList</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="EdgeSubsets.ConnectionEdges-1018"><a href="#EdgeSubsets.ConnectionEdges-1018"><span class="linenos">1018</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges-1019"><a href="#EdgeSubsets.ConnectionEdges-1019"><span class="linenos">1019</span></a>                <span class="n">conn_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">conn_list</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges-1020"><a href="#EdgeSubsets.ConnectionEdges-1020"><span class="linenos">1020</span></a>                <span class="n">conn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets.ConnectionEdges-1021"><a href="#EdgeSubsets.ConnectionEdges-1021"><span class="linenos">1021</span></a>                <span class="n">conn_list</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EdgeSubsets.ConnectionEdges-1022"><a href="#EdgeSubsets.ConnectionEdges-1022"><span class="linenos">1022</span></a>            <span class="k">return</span> <span class="n">connection_list_to_adj_list</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges-1023"><a href="#EdgeSubsets.ConnectionEdges-1023"><span class="linenos">1023</span></a>                <span class="n">conn_list</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle_d1</span><span class="o">=</span><span class="kc">False</span>
</span><span id="EdgeSubsets.ConnectionEdges-1024"><a href="#EdgeSubsets.ConnectionEdges-1024"><span class="linenos">1024</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Only edges which contain a connection are tokenized.
Alternatively, only edges which contain a wall are tokenized.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#EdgeSubsets.ConnectionEdges.walls">walls</a></code>: Whether wall edges or connection edges are tokenized.
If true, <code>VOCAB.ADJLIST_WALL</code> is used in place of <code>VOCAB.CONNECTOR</code>.</li>
</ul>
</div>


                            <div id="EdgeSubsets.ConnectionEdges.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">EdgeSubsets.ConnectionEdges</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">walls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.__init__"></a>
    
    

                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.walls" class="classattr">
                                <div class="attr variable">
            <span class="name">walls</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.walls"></a>
    
    

                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.serialize" class="classattr">
                                        <input id="EdgeSubsets.ConnectionEdges.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges.serialize-660"><a href="#EdgeSubsets.ConnectionEdges.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-661"><a href="#EdgeSubsets.ConnectionEdges.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-662"><a href="#EdgeSubsets.ConnectionEdges.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-663"><a href="#EdgeSubsets.ConnectionEdges.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-664"><a href="#EdgeSubsets.ConnectionEdges.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-665"><a href="#EdgeSubsets.ConnectionEdges.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-666"><a href="#EdgeSubsets.ConnectionEdges.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-667"><a href="#EdgeSubsets.ConnectionEdges.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-668"><a href="#EdgeSubsets.ConnectionEdges.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-669"><a href="#EdgeSubsets.ConnectionEdges.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-670"><a href="#EdgeSubsets.ConnectionEdges.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-671"><a href="#EdgeSubsets.ConnectionEdges.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-672"><a href="#EdgeSubsets.ConnectionEdges.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-673"><a href="#EdgeSubsets.ConnectionEdges.serialize-673"><span class="linenos">673</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-674"><a href="#EdgeSubsets.ConnectionEdges.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-675"><a href="#EdgeSubsets.ConnectionEdges.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-676"><a href="#EdgeSubsets.ConnectionEdges.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-677"><a href="#EdgeSubsets.ConnectionEdges.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-678"><a href="#EdgeSubsets.ConnectionEdges.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-679"><a href="#EdgeSubsets.ConnectionEdges.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-680"><a href="#EdgeSubsets.ConnectionEdges.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-681"><a href="#EdgeSubsets.ConnectionEdges.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-682"><a href="#EdgeSubsets.ConnectionEdges.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-683"><a href="#EdgeSubsets.ConnectionEdges.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-684"><a href="#EdgeSubsets.ConnectionEdges.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-685"><a href="#EdgeSubsets.ConnectionEdges.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-686"><a href="#EdgeSubsets.ConnectionEdges.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-687"><a href="#EdgeSubsets.ConnectionEdges.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-688"><a href="#EdgeSubsets.ConnectionEdges.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-689"><a href="#EdgeSubsets.ConnectionEdges.serialize-689"><span class="linenos">689</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-690"><a href="#EdgeSubsets.ConnectionEdges.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-691"><a href="#EdgeSubsets.ConnectionEdges.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-692"><a href="#EdgeSubsets.ConnectionEdges.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-693"><a href="#EdgeSubsets.ConnectionEdges.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-694"><a href="#EdgeSubsets.ConnectionEdges.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-695"><a href="#EdgeSubsets.ConnectionEdges.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-696"><a href="#EdgeSubsets.ConnectionEdges.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-697"><a href="#EdgeSubsets.ConnectionEdges.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-698"><a href="#EdgeSubsets.ConnectionEdges.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-699"><a href="#EdgeSubsets.ConnectionEdges.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-700"><a href="#EdgeSubsets.ConnectionEdges.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-701"><a href="#EdgeSubsets.ConnectionEdges.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-702"><a href="#EdgeSubsets.ConnectionEdges.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-703"><a href="#EdgeSubsets.ConnectionEdges.serialize-703"><span class="linenos">703</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-704"><a href="#EdgeSubsets.ConnectionEdges.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-705"><a href="#EdgeSubsets.ConnectionEdges.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-706"><a href="#EdgeSubsets.ConnectionEdges.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-707"><a href="#EdgeSubsets.ConnectionEdges.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-708"><a href="#EdgeSubsets.ConnectionEdges.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-709"><a href="#EdgeSubsets.ConnectionEdges.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-710"><a href="#EdgeSubsets.ConnectionEdges.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-711"><a href="#EdgeSubsets.ConnectionEdges.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-712"><a href="#EdgeSubsets.ConnectionEdges.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-713"><a href="#EdgeSubsets.ConnectionEdges.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-714"><a href="#EdgeSubsets.ConnectionEdges.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-715"><a href="#EdgeSubsets.ConnectionEdges.serialize-715"><span class="linenos">715</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.serialize-716"><a href="#EdgeSubsets.ConnectionEdges.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.load" class="classattr">
                                        <input id="EdgeSubsets.ConnectionEdges.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges.load-723"><a href="#EdgeSubsets.ConnectionEdges.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-724"><a href="#EdgeSubsets.ConnectionEdges.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-725"><a href="#EdgeSubsets.ConnectionEdges.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-726"><a href="#EdgeSubsets.ConnectionEdges.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-727"><a href="#EdgeSubsets.ConnectionEdges.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-728"><a href="#EdgeSubsets.ConnectionEdges.load-728"><span class="linenos">728</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-729"><a href="#EdgeSubsets.ConnectionEdges.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-730"><a href="#EdgeSubsets.ConnectionEdges.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-731"><a href="#EdgeSubsets.ConnectionEdges.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-732"><a href="#EdgeSubsets.ConnectionEdges.load-732"><span class="linenos">732</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-733"><a href="#EdgeSubsets.ConnectionEdges.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-734"><a href="#EdgeSubsets.ConnectionEdges.load-734"><span class="linenos">734</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-735"><a href="#EdgeSubsets.ConnectionEdges.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-736"><a href="#EdgeSubsets.ConnectionEdges.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-737"><a href="#EdgeSubsets.ConnectionEdges.load-737"><span class="linenos">737</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-738"><a href="#EdgeSubsets.ConnectionEdges.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-739"><a href="#EdgeSubsets.ConnectionEdges.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-740"><a href="#EdgeSubsets.ConnectionEdges.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-741"><a href="#EdgeSubsets.ConnectionEdges.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-742"><a href="#EdgeSubsets.ConnectionEdges.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-743"><a href="#EdgeSubsets.ConnectionEdges.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-744"><a href="#EdgeSubsets.ConnectionEdges.load-744"><span class="linenos">744</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-745"><a href="#EdgeSubsets.ConnectionEdges.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-746"><a href="#EdgeSubsets.ConnectionEdges.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-747"><a href="#EdgeSubsets.ConnectionEdges.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-748"><a href="#EdgeSubsets.ConnectionEdges.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-749"><a href="#EdgeSubsets.ConnectionEdges.load-749"><span class="linenos">749</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-750"><a href="#EdgeSubsets.ConnectionEdges.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-751"><a href="#EdgeSubsets.ConnectionEdges.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-752"><a href="#EdgeSubsets.ConnectionEdges.load-752"><span class="linenos">752</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-753"><a href="#EdgeSubsets.ConnectionEdges.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-754"><a href="#EdgeSubsets.ConnectionEdges.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-755"><a href="#EdgeSubsets.ConnectionEdges.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-756"><a href="#EdgeSubsets.ConnectionEdges.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-757"><a href="#EdgeSubsets.ConnectionEdges.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-758"><a href="#EdgeSubsets.ConnectionEdges.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-759"><a href="#EdgeSubsets.ConnectionEdges.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-760"><a href="#EdgeSubsets.ConnectionEdges.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-761"><a href="#EdgeSubsets.ConnectionEdges.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-762"><a href="#EdgeSubsets.ConnectionEdges.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-763"><a href="#EdgeSubsets.ConnectionEdges.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-764"><a href="#EdgeSubsets.ConnectionEdges.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-765"><a href="#EdgeSubsets.ConnectionEdges.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-766"><a href="#EdgeSubsets.ConnectionEdges.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-767"><a href="#EdgeSubsets.ConnectionEdges.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-768"><a href="#EdgeSubsets.ConnectionEdges.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-769"><a href="#EdgeSubsets.ConnectionEdges.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-770"><a href="#EdgeSubsets.ConnectionEdges.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-771"><a href="#EdgeSubsets.ConnectionEdges.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-772"><a href="#EdgeSubsets.ConnectionEdges.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-773"><a href="#EdgeSubsets.ConnectionEdges.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-774"><a href="#EdgeSubsets.ConnectionEdges.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-775"><a href="#EdgeSubsets.ConnectionEdges.load-775"><span class="linenos">775</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-776"><a href="#EdgeSubsets.ConnectionEdges.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-777"><a href="#EdgeSubsets.ConnectionEdges.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-778"><a href="#EdgeSubsets.ConnectionEdges.load-778"><span class="linenos">778</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-779"><a href="#EdgeSubsets.ConnectionEdges.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-780"><a href="#EdgeSubsets.ConnectionEdges.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-781"><a href="#EdgeSubsets.ConnectionEdges.load-781"><span class="linenos">781</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-782"><a href="#EdgeSubsets.ConnectionEdges.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-783"><a href="#EdgeSubsets.ConnectionEdges.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-784"><a href="#EdgeSubsets.ConnectionEdges.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-785"><a href="#EdgeSubsets.ConnectionEdges.load-785"><span class="linenos">785</span></a>
</span><span id="EdgeSubsets.ConnectionEdges.load-786"><a href="#EdgeSubsets.ConnectionEdges.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="EdgeSubsets.ConnectionEdges.load-787"><a href="#EdgeSubsets.ConnectionEdges.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="EdgeSubsets.ConnectionEdges.validate_fields_types" class="classattr">
                                        <input id="EdgeSubsets.ConnectionEdges.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="EdgeSubsets.ConnectionEdges.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#EdgeSubsets.ConnectionEdges.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-271"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-272"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-273"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-274"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-275"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-276"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-277"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-278"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-279"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="EdgeSubsets.ConnectionEdges.validate_fields_types-280"><a href="#EdgeSubsets.ConnectionEdges.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EdgeSubsets._EdgeSubset">EdgeSubsets._EdgeSubset</a></dt>
                                <dd id="EdgeSubsets.ConnectionEdges.attribute_key" class="function"><a href="#EdgeSubsets._EdgeSubset.attribute_key">attribute_key</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.is_valid" class="function"><a href="#EdgeSubsets._EdgeSubset.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="EdgeSubsets.ConnectionEdges.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="EdgeSubsets.ConnectionEdges.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="EdgeSubsets.ConnectionEdges.validate_field_type" class="function">validate_field_type</dd>
                <dd id="EdgeSubsets.ConnectionEdges.diff" class="function">diff</dd>
                <dd id="EdgeSubsets.ConnectionEdges.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AdjListTokenizers">
                            <input id="AdjListTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AdjListTokenizers</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1026-L1266" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers-1027"><a href="#AdjListTokenizers-1027"><span class="linenos">1027</span></a><span class="k">class</span> <span class="nc">AdjListTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="AdjListTokenizers-1028"><a href="#AdjListTokenizers-1028"><span class="linenos">1028</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_AdjListTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1029"><a href="#AdjListTokenizers-1029"><span class="linenos">1029</span></a>
</span><span id="AdjListTokenizers-1030"><a href="#AdjListTokenizers-1030"><span class="linenos">1030</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span>
</span><span id="AdjListTokenizers-1031"><a href="#AdjListTokenizers-1031"><span class="linenos">1031</span></a>
</span><span id="AdjListTokenizers-1032"><a href="#AdjListTokenizers-1032"><span class="linenos">1032</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1033"><a href="#AdjListTokenizers-1033"><span class="linenos">1033</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="n">self_</span><span class="o">.</span><span class="n">pre</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1034"><a href="#AdjListTokenizers-1034"><span class="linenos">1034</span></a>    <span class="k">class</span> <span class="nc">_AdjListTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="AdjListTokenizers-1035"><a href="#AdjListTokenizers-1035"><span class="linenos">1035</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1036"><a href="#AdjListTokenizers-1036"><span class="linenos">1036</span></a><span class="sd">        Specifies how the adjacency list is tokenized.</span>
</span><span id="AdjListTokenizers-1037"><a href="#AdjListTokenizers-1037"><span class="linenos">1037</span></a><span class="sd">        Tokenization behavior is decomposed into specification of edge subsets, groupings, and permutations.</span>
</span><span id="AdjListTokenizers-1038"><a href="#AdjListTokenizers-1038"><span class="linenos">1038</span></a><span class="sd">        See documentation of `EdgeSubset` and `EdgeGrouping` classes for more details.</span>
</span><span id="AdjListTokenizers-1039"><a href="#AdjListTokenizers-1039"><span class="linenos">1039</span></a>
</span><span id="AdjListTokenizers-1040"><a href="#AdjListTokenizers-1040"><span class="linenos">1040</span></a><span class="sd">        # Parameters</span>
</span><span id="AdjListTokenizers-1041"><a href="#AdjListTokenizers-1041"><span class="linenos">1041</span></a><span class="sd">        - `pre`: Whether all edge groupings include a preceding delimiter token</span>
</span><span id="AdjListTokenizers-1042"><a href="#AdjListTokenizers-1042"><span class="linenos">1042</span></a><span class="sd">        - `post`: Whether all edge groupings include a following delimiter token</span>
</span><span id="AdjListTokenizers-1043"><a href="#AdjListTokenizers-1043"><span class="linenos">1043</span></a><span class="sd">        - `shuffle_d0`: Specifies how to sequence the edge groupings.</span>
</span><span id="AdjListTokenizers-1044"><a href="#AdjListTokenizers-1044"><span class="linenos">1044</span></a><span class="sd">        If true, groupings are shuffled randomly. If false, groupings are sorted by the leading coord of each group.</span>
</span><span id="AdjListTokenizers-1045"><a href="#AdjListTokenizers-1045"><span class="linenos">1045</span></a><span class="sd">        - `edge_grouping`: Specifies if/how multiple coord-coord connections are grouped together in a token subsequence called an edge grouping.</span>
</span><span id="AdjListTokenizers-1046"><a href="#AdjListTokenizers-1046"><span class="linenos">1046</span></a><span class="sd">        - `edge_subset`: Specifies the subset of lattice edges to be tokenized.</span>
</span><span id="AdjListTokenizers-1047"><a href="#AdjListTokenizers-1047"><span class="linenos">1047</span></a><span class="sd">        - `edge_permuter`: Specifies, in each edge tokenization, which coord either:</span>
</span><span id="AdjListTokenizers-1048"><a href="#AdjListTokenizers-1048"><span class="linenos">1048</span></a><span class="sd">          1. Appears first in the tokenization, for `AdjListCoord`.</span>
</span><span id="AdjListTokenizers-1049"><a href="#AdjListTokenizers-1049"><span class="linenos">1049</span></a><span class="sd">          2. Is tokenized directly as a coord, for `AdjListCardinal`.</span>
</span><span id="AdjListTokenizers-1050"><a href="#AdjListTokenizers-1050"><span class="linenos">1050</span></a><span class="sd">          - `shuffle`: For each edge, the leading coord is selected randomly.</span>
</span><span id="AdjListTokenizers-1051"><a href="#AdjListTokenizers-1051"><span class="linenos">1051</span></a><span class="sd">          - `all`: Each edge appears twice in the tokenization, appearing with both leading coords.</span>
</span><span id="AdjListTokenizers-1052"><a href="#AdjListTokenizers-1052"><span class="linenos">1052</span></a><span class="sd">          - `evens`, `odds`: The leading coord is the one belonging to that coord subset. See `EdgeSubsets.ChessboardSublattice` for details.</span>
</span><span id="AdjListTokenizers-1053"><a href="#AdjListTokenizers-1053"><span class="linenos">1053</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1054"><a href="#AdjListTokenizers-1054"><span class="linenos">1054</span></a>
</span><span id="AdjListTokenizers-1055"><a href="#AdjListTokenizers-1055"><span class="linenos">1055</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">assert_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1056"><a href="#AdjListTokenizers-1056"><span class="linenos">1056</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1057"><a href="#AdjListTokenizers-1057"><span class="linenos">1057</span></a>        <span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1058"><a href="#AdjListTokenizers-1058"><span class="linenos">1058</span></a>        <span class="n">edge_grouping</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1059"><a href="#AdjListTokenizers-1059"><span class="linenos">1059</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">Ungrouped</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-1060"><a href="#AdjListTokenizers-1060"><span class="linenos">1060</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeGroupings</span><span class="p">),</span>
</span><span id="AdjListTokenizers-1061"><a href="#AdjListTokenizers-1061"><span class="linenos">1061</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers-1062"><a href="#AdjListTokenizers-1062"><span class="linenos">1062</span></a>        <span class="n">edge_subset</span><span class="p">:</span> <span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1063"><a href="#AdjListTokenizers-1063"><span class="linenos">1063</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">ConnectionEdges</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-1064"><a href="#AdjListTokenizers-1064"><span class="linenos">1064</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgeSubsets</span><span class="p">),</span>
</span><span id="AdjListTokenizers-1065"><a href="#AdjListTokenizers-1065"><span class="linenos">1065</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers-1066"><a href="#AdjListTokenizers-1066"><span class="linenos">1066</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1067"><a href="#AdjListTokenizers-1067"><span class="linenos">1067</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-1068"><a href="#AdjListTokenizers-1068"><span class="linenos">1068</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers-1069"><a href="#AdjListTokenizers-1069"><span class="linenos">1069</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers-1070"><a href="#AdjListTokenizers-1070"><span class="linenos">1070</span></a>
</span><span id="AdjListTokenizers-1071"><a href="#AdjListTokenizers-1071"><span class="linenos">1071</span></a>        <span class="nd">@classmethod</span>
</span><span id="AdjListTokenizers-1072"><a href="#AdjListTokenizers-1072"><span class="linenos">1072</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="AdjListTokenizers-1073"><a href="#AdjListTokenizers-1073"><span class="linenos">1073</span></a>            <span class="k">return</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="AdjListTokenizers-1074"><a href="#AdjListTokenizers-1074"><span class="linenos">1074</span></a>
</span><span id="AdjListTokenizers-1075"><a href="#AdjListTokenizers-1075"><span class="linenos">1075</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="AdjListTokenizers-1076"><a href="#AdjListTokenizers-1076"><span class="linenos">1076</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="AdjListTokenizers-1077"><a href="#AdjListTokenizers-1077"><span class="linenos">1077</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="AdjListTokenizers-1078"><a href="#AdjListTokenizers-1078"><span class="linenos">1078</span></a>
</span><span id="AdjListTokenizers-1079"><a href="#AdjListTokenizers-1079"><span class="linenos">1079</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AdjListTokenizers-1080"><a href="#AdjListTokenizers-1080"><span class="linenos">1080</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1081"><a href="#AdjListTokenizers-1081"><span class="linenos">1081</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1082"><a href="#AdjListTokenizers-1082"><span class="linenos">1082</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1083"><a href="#AdjListTokenizers-1083"><span class="linenos">1083</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers-1084"><a href="#AdjListTokenizers-1084"><span class="linenos">1084</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1085"><a href="#AdjListTokenizers-1085"><span class="linenos">1085</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1086"><a href="#AdjListTokenizers-1086"><span class="linenos">1086</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1087"><a href="#AdjListTokenizers-1087"><span class="linenos">1087</span></a>        <span class="p">):</span>
</span><span id="AdjListTokenizers-1088"><a href="#AdjListTokenizers-1088"><span class="linenos">1088</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1089"><a href="#AdjListTokenizers-1089"><span class="linenos">1089</span></a><span class="sd">            Returns a sequence of callables which take an index in `edges` and return parts of that edge tokenization.</span>
</span><span id="AdjListTokenizers-1090"><a href="#AdjListTokenizers-1090"><span class="linenos">1090</span></a>
</span><span id="AdjListTokenizers-1091"><a href="#AdjListTokenizers-1091"><span class="linenos">1091</span></a><span class="sd">            # Returns</span>
</span><span id="AdjListTokenizers-1092"><a href="#AdjListTokenizers-1092"><span class="linenos">1092</span></a><span class="sd">            - `[0]`: leading coord tokens</span>
</span><span id="AdjListTokenizers-1093"><a href="#AdjListTokenizers-1093"><span class="linenos">1093</span></a><span class="sd">            - `[1]`: connector tokens</span>
</span><span id="AdjListTokenizers-1094"><a href="#AdjListTokenizers-1094"><span class="linenos">1094</span></a><span class="sd">            - `[2]`: trailing coord tokens</span>
</span><span id="AdjListTokenizers-1095"><a href="#AdjListTokenizers-1095"><span class="linenos">1095</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1096"><a href="#AdjListTokenizers-1096"><span class="linenos">1096</span></a>            <span class="k">pass</span>
</span><span id="AdjListTokenizers-1097"><a href="#AdjListTokenizers-1097"><span class="linenos">1097</span></a>
</span><span id="AdjListTokenizers-1098"><a href="#AdjListTokenizers-1098"><span class="linenos">1098</span></a>        <span class="k">def</span> <span class="nf">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1099"><a href="#AdjListTokenizers-1099"><span class="linenos">1099</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1100"><a href="#AdjListTokenizers-1100"><span class="linenos">1100</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1101"><a href="#AdjListTokenizers-1101"><span class="linenos">1101</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1102"><a href="#AdjListTokenizers-1102"><span class="linenos">1102</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1103"><a href="#AdjListTokenizers-1103"><span class="linenos">1103</span></a>            <span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1104"><a href="#AdjListTokenizers-1104"><span class="linenos">1104</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-1105"><a href="#AdjListTokenizers-1105"><span class="linenos">1105</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1106"><a href="#AdjListTokenizers-1106"><span class="linenos">1106</span></a><span class="sd">            Tokenizes a single edge grouping.</span>
</span><span id="AdjListTokenizers-1107"><a href="#AdjListTokenizers-1107"><span class="linenos">1107</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1108"><a href="#AdjListTokenizers-1108"><span class="linenos">1108</span></a>            <span class="n">cxn_ord</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;connection_token_ordinal&quot;</span><span class="p">]</span>
</span><span id="AdjListTokenizers-1109"><a href="#AdjListTokenizers-1109"><span class="linenos">1109</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_connection</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1110"><a href="#AdjListTokenizers-1110"><span class="linenos">1110</span></a>                <span class="n">edges</span><span class="p">,</span> <span class="n">maze</span><span class="o">.</span><span class="n">connection_list</span>
</span><span id="AdjListTokenizers-1111"><a href="#AdjListTokenizers-1111"><span class="linenos">1111</span></a>            <span class="p">)</span>
</span><span id="AdjListTokenizers-1112"><a href="#AdjListTokenizers-1112"><span class="linenos">1112</span></a>            <span class="n">tokenize_callables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1113"><a href="#AdjListTokenizers-1113"><span class="linenos">1113</span></a>                <span class="n">edges</span><span class="p">,</span> <span class="n">is_conn</span><span class="p">,</span> <span class="n">coord_tokenizer</span>
</span><span id="AdjListTokenizers-1114"><a href="#AdjListTokenizers-1114"><span class="linenos">1114</span></a>            <span class="p">)</span>
</span><span id="AdjListTokenizers-1115"><a href="#AdjListTokenizers-1115"><span class="linenos">1115</span></a>
</span><span id="AdjListTokenizers-1116"><a href="#AdjListTokenizers-1116"><span class="linenos">1116</span></a>            <span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;grouped&quot;</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-1117"><a href="#AdjListTokenizers-1117"><span class="linenos">1117</span></a>                <span class="c1"># If grouped</span>
</span><span id="AdjListTokenizers-1118"><a href="#AdjListTokenizers-1118"><span class="linenos">1118</span></a>                <span class="n">callable_permutation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">cxn_ord</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="AdjListTokenizers-1119"><a href="#AdjListTokenizers-1119"><span class="linenos">1119</span></a>                <span class="n">repeated_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-1120"><a href="#AdjListTokenizers-1120"><span class="linenos">1120</span></a>                    <span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="AdjListTokenizers-1121"><a href="#AdjListTokenizers-1121"><span class="linenos">1121</span></a>                <span class="p">]</span>
</span><span id="AdjListTokenizers-1122"><a href="#AdjListTokenizers-1122"><span class="linenos">1122</span></a>                <span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1123"><a href="#AdjListTokenizers-1123"><span class="linenos">1123</span></a>                    <span class="p">[</span>
</span><span id="AdjListTokenizers-1124"><a href="#AdjListTokenizers-1124"><span class="linenos">1124</span></a>                        <span class="n">tokenize_callables</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">0</span><span class="p">),</span>
</span><span id="AdjListTokenizers-1125"><a href="#AdjListTokenizers-1125"><span class="linenos">1125</span></a>                        <span class="p">[</span>
</span><span id="AdjListTokenizers-1126"><a href="#AdjListTokenizers-1126"><span class="linenos">1126</span></a>                            <span class="p">[</span>
</span><span id="AdjListTokenizers-1127"><a href="#AdjListTokenizers-1127"><span class="linenos">1127</span></a>                                <span class="o">*</span><span class="p">[</span>
</span><span id="AdjListTokenizers-1128"><a href="#AdjListTokenizers-1128"><span class="linenos">1128</span></a>                                    <span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1129"><a href="#AdjListTokenizers-1129"><span class="linenos">1129</span></a>                                    <span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">repeated_callables</span>
</span><span id="AdjListTokenizers-1130"><a href="#AdjListTokenizers-1130"><span class="linenos">1130</span></a>                                <span class="p">],</span>
</span><span id="AdjListTokenizers-1131"><a href="#AdjListTokenizers-1131"><span class="linenos">1131</span></a>                                <span class="o">*</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1132"><a href="#AdjListTokenizers-1132"><span class="linenos">1132</span></a>                                    <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,)</span>
</span><span id="AdjListTokenizers-1133"><a href="#AdjListTokenizers-1133"><span class="linenos">1133</span></a>                                    <span class="k">if</span> <span class="n">group_params</span><span class="p">[</span><span class="s2">&quot;intra&quot;</span><span class="p">]</span>
</span><span id="AdjListTokenizers-1134"><a href="#AdjListTokenizers-1134"><span class="linenos">1134</span></a>                                    <span class="k">else</span> <span class="p">()</span>
</span><span id="AdjListTokenizers-1135"><a href="#AdjListTokenizers-1135"><span class="linenos">1135</span></a>                                <span class="p">),</span>
</span><span id="AdjListTokenizers-1136"><a href="#AdjListTokenizers-1136"><span class="linenos">1136</span></a>                            <span class="p">]</span>
</span><span id="AdjListTokenizers-1137"><a href="#AdjListTokenizers-1137"><span class="linenos">1137</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="AdjListTokenizers-1138"><a href="#AdjListTokenizers-1138"><span class="linenos">1138</span></a>                        <span class="p">],</span>
</span><span id="AdjListTokenizers-1139"><a href="#AdjListTokenizers-1139"><span class="linenos">1139</span></a>                    <span class="p">]</span>
</span><span id="AdjListTokenizers-1140"><a href="#AdjListTokenizers-1140"><span class="linenos">1140</span></a>                <span class="p">)</span>
</span><span id="AdjListTokenizers-1141"><a href="#AdjListTokenizers-1141"><span class="linenos">1141</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers-1142"><a href="#AdjListTokenizers-1142"><span class="linenos">1142</span></a>                <span class="c1"># If ungrouped</span>
</span><span id="AdjListTokenizers-1143"><a href="#AdjListTokenizers-1143"><span class="linenos">1143</span></a>                <span class="n">callable_permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="AdjListTokenizers-1144"><a href="#AdjListTokenizers-1144"><span class="linenos">1144</span></a>                <span class="n">callable_permutation</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">cxn_ord</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1145"><a href="#AdjListTokenizers-1145"><span class="linenos">1145</span></a>                <span class="n">tokenize_callables</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-1146"><a href="#AdjListTokenizers-1146"><span class="linenos">1146</span></a>                    <span class="n">tokenize_callables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">callable_permutation</span>
</span><span id="AdjListTokenizers-1147"><a href="#AdjListTokenizers-1147"><span class="linenos">1147</span></a>                <span class="p">]</span>
</span><span id="AdjListTokenizers-1148"><a href="#AdjListTokenizers-1148"><span class="linenos">1148</span></a>
</span><span id="AdjListTokenizers-1149"><a href="#AdjListTokenizers-1149"><span class="linenos">1149</span></a>                <span class="k">return</span> <span class="n">flatten</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1150"><a href="#AdjListTokenizers-1150"><span class="linenos">1150</span></a>                    <span class="p">[</span>
</span><span id="AdjListTokenizers-1151"><a href="#AdjListTokenizers-1151"><span class="linenos">1151</span></a>                        <span class="p">[</span>
</span><span id="AdjListTokenizers-1152"><a href="#AdjListTokenizers-1152"><span class="linenos">1152</span></a>                            <span class="p">[</span>
</span><span id="AdjListTokenizers-1153"><a href="#AdjListTokenizers-1153"><span class="linenos">1153</span></a>                                <span class="o">*</span><span class="p">[</span>
</span><span id="AdjListTokenizers-1154"><a href="#AdjListTokenizers-1154"><span class="linenos">1154</span></a>                                    <span class="n">tok_callable</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1155"><a href="#AdjListTokenizers-1155"><span class="linenos">1155</span></a>                                    <span class="k">for</span> <span class="n">tok_callable</span> <span class="ow">in</span> <span class="n">tokenize_callables</span>
</span><span id="AdjListTokenizers-1156"><a href="#AdjListTokenizers-1156"><span class="linenos">1156</span></a>                                <span class="p">],</span>
</span><span id="AdjListTokenizers-1157"><a href="#AdjListTokenizers-1157"><span class="linenos">1157</span></a>                                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1158"><a href="#AdjListTokenizers-1158"><span class="linenos">1158</span></a>                                    <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_INTRA</span><span class="p">,),</span> <span class="n">group_params</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span>
</span><span id="AdjListTokenizers-1159"><a href="#AdjListTokenizers-1159"><span class="linenos">1159</span></a>                                <span class="p">),</span>
</span><span id="AdjListTokenizers-1160"><a href="#AdjListTokenizers-1160"><span class="linenos">1160</span></a>                            <span class="p">]</span>
</span><span id="AdjListTokenizers-1161"><a href="#AdjListTokenizers-1161"><span class="linenos">1161</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="AdjListTokenizers-1162"><a href="#AdjListTokenizers-1162"><span class="linenos">1162</span></a>                        <span class="p">]</span>
</span><span id="AdjListTokenizers-1163"><a href="#AdjListTokenizers-1163"><span class="linenos">1163</span></a>                    <span class="p">]</span>
</span><span id="AdjListTokenizers-1164"><a href="#AdjListTokenizers-1164"><span class="linenos">1164</span></a>                <span class="p">)</span>
</span><span id="AdjListTokenizers-1165"><a href="#AdjListTokenizers-1165"><span class="linenos">1165</span></a>
</span><span id="AdjListTokenizers-1166"><a href="#AdjListTokenizers-1166"><span class="linenos">1166</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1167"><a href="#AdjListTokenizers-1167"><span class="linenos">1167</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="AdjListTokenizers-1168"><a href="#AdjListTokenizers-1168"><span class="linenos">1168</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="AdjListTokenizers-1169"><a href="#AdjListTokenizers-1169"><span class="linenos">1169</span></a>            <span class="c1"># Get the set of edges to be tokenized</span>
</span><span id="AdjListTokenizers-1170"><a href="#AdjListTokenizers-1170"><span class="linenos">1170</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_subset</span><span class="o">.</span><span class="n">_get_edges</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1171"><a href="#AdjListTokenizers-1171"><span class="linenos">1171</span></a>            <span class="c1"># Systematically permute the leading coord of each edge</span>
</span><span id="AdjListTokenizers-1172"><a href="#AdjListTokenizers-1172"><span class="linenos">1172</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_permuter</span><span class="o">.</span><span class="n">_permute</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1173"><a href="#AdjListTokenizers-1173"><span class="linenos">1173</span></a>            <span class="n">group_params</span><span class="p">:</span> <span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_GroupingTokenParams</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="AdjListTokenizers-1174"><a href="#AdjListTokenizers-1174"><span class="linenos">1174</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_token_params</span><span class="p">()</span>
</span><span id="AdjListTokenizers-1175"><a href="#AdjListTokenizers-1175"><span class="linenos">1175</span></a>            <span class="p">)</span>
</span><span id="AdjListTokenizers-1176"><a href="#AdjListTokenizers-1176"><span class="linenos">1176</span></a>            <span class="c1"># then, we need to group the edges</span>
</span><span id="AdjListTokenizers-1177"><a href="#AdjListTokenizers-1177"><span class="linenos">1177</span></a>            <span class="n">groups</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ConnectionArray</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_grouping</span><span class="o">.</span><span class="n">_group_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1178"><a href="#AdjListTokenizers-1178"><span class="linenos">1178</span></a>            <span class="c1"># shuffle the groups if specified</span>
</span><span id="AdjListTokenizers-1179"><a href="#AdjListTokenizers-1179"><span class="linenos">1179</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_d0</span><span class="p">:</span>
</span><span id="AdjListTokenizers-1180"><a href="#AdjListTokenizers-1180"><span class="linenos">1180</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="AdjListTokenizers-1181"><a href="#AdjListTokenizers-1181"><span class="linenos">1181</span></a>                    <span class="n">numpy_rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1182"><a href="#AdjListTokenizers-1182"><span class="linenos">1182</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="AdjListTokenizers-1183"><a href="#AdjListTokenizers-1183"><span class="linenos">1183</span></a>                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1184"><a href="#AdjListTokenizers-1184"><span class="linenos">1184</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers-1185"><a href="#AdjListTokenizers-1185"><span class="linenos">1185</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1186"><a href="#AdjListTokenizers-1186"><span class="linenos">1186</span></a>                        <span class="sa">f</span><span class="s2">&quot;`groups` is an unexpected type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span><span class="si">}</span><span class="s2">. Only types `list` and `np.ndarray` are currently supported.&quot;</span>
</span><span id="AdjListTokenizers-1187"><a href="#AdjListTokenizers-1187"><span class="linenos">1187</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers-1188"><a href="#AdjListTokenizers-1188"><span class="linenos">1188</span></a>            <span class="c1"># Tokenize each group with optional delimiters</span>
</span><span id="AdjListTokenizers-1189"><a href="#AdjListTokenizers-1189"><span class="linenos">1189</span></a>            <span class="n">tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1190"><a href="#AdjListTokenizers-1190"><span class="linenos">1190</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1191"><a href="#AdjListTokenizers-1191"><span class="linenos">1191</span></a>                    <span class="p">[</span>
</span><span id="AdjListTokenizers-1192"><a href="#AdjListTokenizers-1192"><span class="linenos">1192</span></a>                        <span class="p">[</span>
</span><span id="AdjListTokenizers-1193"><a href="#AdjListTokenizers-1193"><span class="linenos">1193</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1194"><a href="#AdjListTokenizers-1194"><span class="linenos">1194</span></a>                                <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span>
</span><span id="AdjListTokenizers-1195"><a href="#AdjListTokenizers-1195"><span class="linenos">1195</span></a>                            <span class="p">),</span>
</span><span id="AdjListTokenizers-1196"><a href="#AdjListTokenizers-1196"><span class="linenos">1196</span></a>                            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_tokenize_edge_grouping</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1197"><a href="#AdjListTokenizers-1197"><span class="linenos">1197</span></a>                                <span class="n">group</span><span class="p">,</span> <span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">,</span> <span class="n">group_params</span>
</span><span id="AdjListTokenizers-1198"><a href="#AdjListTokenizers-1198"><span class="linenos">1198</span></a>                            <span class="p">),</span>
</span><span id="AdjListTokenizers-1199"><a href="#AdjListTokenizers-1199"><span class="linenos">1199</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1200"><a href="#AdjListTokenizers-1200"><span class="linenos">1200</span></a>                                <span class="p">(</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJACENCY_ENDLINE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span>
</span><span id="AdjListTokenizers-1201"><a href="#AdjListTokenizers-1201"><span class="linenos">1201</span></a>                            <span class="p">),</span>
</span><span id="AdjListTokenizers-1202"><a href="#AdjListTokenizers-1202"><span class="linenos">1202</span></a>                        <span class="p">]</span>
</span><span id="AdjListTokenizers-1203"><a href="#AdjListTokenizers-1203"><span class="linenos">1203</span></a>                        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span>
</span><span id="AdjListTokenizers-1204"><a href="#AdjListTokenizers-1204"><span class="linenos">1204</span></a>                    <span class="p">]</span>
</span><span id="AdjListTokenizers-1205"><a href="#AdjListTokenizers-1205"><span class="linenos">1205</span></a>                <span class="p">)</span>
</span><span id="AdjListTokenizers-1206"><a href="#AdjListTokenizers-1206"><span class="linenos">1206</span></a>            <span class="p">)</span>
</span><span id="AdjListTokenizers-1207"><a href="#AdjListTokenizers-1207"><span class="linenos">1207</span></a>            <span class="k">return</span> <span class="n">tokens</span>
</span><span id="AdjListTokenizers-1208"><a href="#AdjListTokenizers-1208"><span class="linenos">1208</span></a>
</span><span id="AdjListTokenizers-1209"><a href="#AdjListTokenizers-1209"><span class="linenos">1209</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1210"><a href="#AdjListTokenizers-1210"><span class="linenos">1210</span></a>    <span class="k">class</span> <span class="nc">AdjListCoord</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers-1211"><a href="#AdjListTokenizers-1211"><span class="linenos">1211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1212"><a href="#AdjListTokenizers-1212"><span class="linenos">1212</span></a>
</span><span id="AdjListTokenizers-1213"><a href="#AdjListTokenizers-1213"><span class="linenos">1213</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1214"><a href="#AdjListTokenizers-1214"><span class="linenos">1214</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-1215"><a href="#AdjListTokenizers-1215"><span class="linenos">1215</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers-1216"><a href="#AdjListTokenizers-1216"><span class="linenos">1216</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers-1217"><a href="#AdjListTokenizers-1217"><span class="linenos">1217</span></a>
</span><span id="AdjListTokenizers-1218"><a href="#AdjListTokenizers-1218"><span class="linenos">1218</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1219"><a href="#AdjListTokenizers-1219"><span class="linenos">1219</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1220"><a href="#AdjListTokenizers-1220"><span class="linenos">1220</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1221"><a href="#AdjListTokenizers-1221"><span class="linenos">1221</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers-1222"><a href="#AdjListTokenizers-1222"><span class="linenos">1222</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1223"><a href="#AdjListTokenizers-1223"><span class="linenos">1223</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1224"><a href="#AdjListTokenizers-1224"><span class="linenos">1224</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1225"><a href="#AdjListTokenizers-1225"><span class="linenos">1225</span></a>        <span class="p">):</span>
</span><span id="AdjListTokenizers-1226"><a href="#AdjListTokenizers-1226"><span class="linenos">1226</span></a>            <span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers-1227"><a href="#AdjListTokenizers-1227"><span class="linenos">1227</span></a>            <span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers-1228"><a href="#AdjListTokenizers-1228"><span class="linenos">1228</span></a>                <span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1229"><a href="#AdjListTokenizers-1229"><span class="linenos">1229</span></a>                <span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1230"><a href="#AdjListTokenizers-1230"><span class="linenos">1230</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers-1231"><a href="#AdjListTokenizers-1231"><span class="linenos">1231</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-1232"><a href="#AdjListTokenizers-1232"><span class="linenos">1232</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-1233"><a href="#AdjListTokenizers-1233"><span class="linenos">1233</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers-1234"><a href="#AdjListTokenizers-1234"><span class="linenos">1234</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-1235"><a href="#AdjListTokenizers-1235"><span class="linenos">1235</span></a>            <span class="p">]</span>
</span><span id="AdjListTokenizers-1236"><a href="#AdjListTokenizers-1236"><span class="linenos">1236</span></a>
</span><span id="AdjListTokenizers-1237"><a href="#AdjListTokenizers-1237"><span class="linenos">1237</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers-1238"><a href="#AdjListTokenizers-1238"><span class="linenos">1238</span></a>    <span class="k">class</span> <span class="nc">AdjListCardinal</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers-1239"><a href="#AdjListTokenizers-1239"><span class="linenos">1239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</span>
</span><span id="AdjListTokenizers-1240"><a href="#AdjListTokenizers-1240"><span class="linenos">1240</span></a>
</span><span id="AdjListTokenizers-1241"><a href="#AdjListTokenizers-1241"><span class="linenos">1241</span></a><span class="sd">        # Parameters</span>
</span><span id="AdjListTokenizers-1242"><a href="#AdjListTokenizers-1242"><span class="linenos">1242</span></a><span class="sd">        - `coord_first`: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</span>
</span><span id="AdjListTokenizers-1243"><a href="#AdjListTokenizers-1243"><span class="linenos">1243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers-1244"><a href="#AdjListTokenizers-1244"><span class="linenos">1244</span></a>
</span><span id="AdjListTokenizers-1245"><a href="#AdjListTokenizers-1245"><span class="linenos">1245</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1246"><a href="#AdjListTokenizers-1246"><span class="linenos">1246</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">BothCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers-1247"><a href="#AdjListTokenizers-1247"><span class="linenos">1247</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers-1248"><a href="#AdjListTokenizers-1248"><span class="linenos">1248</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers-1249"><a href="#AdjListTokenizers-1249"><span class="linenos">1249</span></a>
</span><span id="AdjListTokenizers-1250"><a href="#AdjListTokenizers-1250"><span class="linenos">1250</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers-1251"><a href="#AdjListTokenizers-1251"><span class="linenos">1251</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1252"><a href="#AdjListTokenizers-1252"><span class="linenos">1252</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1253"><a href="#AdjListTokenizers-1253"><span class="linenos">1253</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers-1254"><a href="#AdjListTokenizers-1254"><span class="linenos">1254</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1255"><a href="#AdjListTokenizers-1255"><span class="linenos">1255</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1256"><a href="#AdjListTokenizers-1256"><span class="linenos">1256</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1257"><a href="#AdjListTokenizers-1257"><span class="linenos">1257</span></a>        <span class="p">):</span>
</span><span id="AdjListTokenizers-1258"><a href="#AdjListTokenizers-1258"><span class="linenos">1258</span></a>            <span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers-1259"><a href="#AdjListTokenizers-1259"><span class="linenos">1259</span></a>            <span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers-1260"><a href="#AdjListTokenizers-1260"><span class="linenos">1260</span></a>                <span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1261"><a href="#AdjListTokenizers-1261"><span class="linenos">1261</span></a>                <span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers-1262"><a href="#AdjListTokenizers-1262"><span class="linenos">1262</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers-1263"><a href="#AdjListTokenizers-1263"><span class="linenos">1263</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers-1264"><a href="#AdjListTokenizers-1264"><span class="linenos">1264</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-1265"><a href="#AdjListTokenizers-1265"><span class="linenos">1265</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers-1266"><a href="#AdjListTokenizers-1266"><span class="linenos">1266</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="AdjListTokenizers-1267"><a href="#AdjListTokenizers-1267"><span class="linenos">1267</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_AdjListTokenizer</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="AdjListTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;adj_list_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="AdjListTokenizers.AdjListCoord">
                            <input id="AdjListTokenizers.AdjListCoord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">AdjListTokenizers.AdjListCoord</span><wbr>(<span class="base"><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1208-L1234" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord-1209"><a href="#AdjListTokenizers.AdjListCoord-1209"><span class="linenos">1209</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord-1210"><a href="#AdjListTokenizers.AdjListCoord-1210"><span class="linenos">1210</span></a>    <span class="k">class</span> <span class="nc">AdjListCoord</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord-1211"><a href="#AdjListTokenizers.AdjListCoord-1211"><span class="linenos">1211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord-1212"><a href="#AdjListTokenizers.AdjListCoord-1212"><span class="linenos">1212</span></a>
</span><span id="AdjListTokenizers.AdjListCoord-1213"><a href="#AdjListTokenizers.AdjListCoord-1213"><span class="linenos">1213</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord-1214"><a href="#AdjListTokenizers.AdjListCoord-1214"><span class="linenos">1214</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">RandomCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers.AdjListCoord-1215"><a href="#AdjListTokenizers.AdjListCoord-1215"><span class="linenos">1215</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers.AdjListCoord-1216"><a href="#AdjListTokenizers.AdjListCoord-1216"><span class="linenos">1216</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord-1217"><a href="#AdjListTokenizers.AdjListCoord-1217"><span class="linenos">1217</span></a>
</span><span id="AdjListTokenizers.AdjListCoord-1218"><a href="#AdjListTokenizers.AdjListCoord-1218"><span class="linenos">1218</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord-1219"><a href="#AdjListTokenizers.AdjListCoord-1219"><span class="linenos">1219</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1220"><a href="#AdjListTokenizers.AdjListCoord-1220"><span class="linenos">1220</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1221"><a href="#AdjListTokenizers.AdjListCoord-1221"><span class="linenos">1221</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers.AdjListCoord-1222"><a href="#AdjListTokenizers.AdjListCoord-1222"><span class="linenos">1222</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1223"><a href="#AdjListTokenizers.AdjListCoord-1223"><span class="linenos">1223</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1224"><a href="#AdjListTokenizers.AdjListCoord-1224"><span class="linenos">1224</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1225"><a href="#AdjListTokenizers.AdjListCoord-1225"><span class="linenos">1225</span></a>        <span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord-1226"><a href="#AdjListTokenizers.AdjListCoord-1226"><span class="linenos">1226</span></a>            <span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers.AdjListCoord-1227"><a href="#AdjListTokenizers.AdjListCoord-1227"><span class="linenos">1227</span></a>            <span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCoord-1228"><a href="#AdjListTokenizers.AdjListCoord-1228"><span class="linenos">1228</span></a>                <span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1229"><a href="#AdjListTokenizers.AdjListCoord-1229"><span class="linenos">1229</span></a>                <span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord-1230"><a href="#AdjListTokenizers.AdjListCoord-1230"><span class="linenos">1230</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCoord-1231"><a href="#AdjListTokenizers.AdjListCoord-1231"><span class="linenos">1231</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCoord-1232"><a href="#AdjListTokenizers.AdjListCoord-1232"><span class="linenos">1232</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCoord-1233"><a href="#AdjListTokenizers.AdjListCoord-1233"><span class="linenos">1233</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers.AdjListCoord-1234"><a href="#AdjListTokenizers.AdjListCoord-1234"><span class="linenos">1234</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCoord-1235"><a href="#AdjListTokenizers.AdjListCoord-1235"><span class="linenos">1235</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Represents an edge group as tokens for the leading coord followed by coord tokens for the other group members.</p>
</div>


                            <div id="AdjListTokenizers.AdjListCoord.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">AdjListTokenizers.AdjListCoord</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">edge_grouping</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_subset</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.__init__"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.edge_permuter" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_permuter</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.EdgePermuters._EdgePermuter</span>        =
<span class="default_value"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords()</a></span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.edge_permuter"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.serialize" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCoord.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord.serialize-660"><a href="#AdjListTokenizers.AdjListCoord.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-661"><a href="#AdjListTokenizers.AdjListCoord.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-662"><a href="#AdjListTokenizers.AdjListCoord.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-663"><a href="#AdjListTokenizers.AdjListCoord.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-664"><a href="#AdjListTokenizers.AdjListCoord.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-665"><a href="#AdjListTokenizers.AdjListCoord.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-666"><a href="#AdjListTokenizers.AdjListCoord.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-667"><a href="#AdjListTokenizers.AdjListCoord.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-668"><a href="#AdjListTokenizers.AdjListCoord.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-669"><a href="#AdjListTokenizers.AdjListCoord.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-670"><a href="#AdjListTokenizers.AdjListCoord.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-671"><a href="#AdjListTokenizers.AdjListCoord.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-672"><a href="#AdjListTokenizers.AdjListCoord.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-673"><a href="#AdjListTokenizers.AdjListCoord.serialize-673"><span class="linenos">673</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-674"><a href="#AdjListTokenizers.AdjListCoord.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-675"><a href="#AdjListTokenizers.AdjListCoord.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-676"><a href="#AdjListTokenizers.AdjListCoord.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-677"><a href="#AdjListTokenizers.AdjListCoord.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-678"><a href="#AdjListTokenizers.AdjListCoord.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-679"><a href="#AdjListTokenizers.AdjListCoord.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-680"><a href="#AdjListTokenizers.AdjListCoord.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-681"><a href="#AdjListTokenizers.AdjListCoord.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-682"><a href="#AdjListTokenizers.AdjListCoord.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-683"><a href="#AdjListTokenizers.AdjListCoord.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-684"><a href="#AdjListTokenizers.AdjListCoord.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-685"><a href="#AdjListTokenizers.AdjListCoord.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-686"><a href="#AdjListTokenizers.AdjListCoord.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-687"><a href="#AdjListTokenizers.AdjListCoord.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-688"><a href="#AdjListTokenizers.AdjListCoord.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-689"><a href="#AdjListTokenizers.AdjListCoord.serialize-689"><span class="linenos">689</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-690"><a href="#AdjListTokenizers.AdjListCoord.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-691"><a href="#AdjListTokenizers.AdjListCoord.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-692"><a href="#AdjListTokenizers.AdjListCoord.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-693"><a href="#AdjListTokenizers.AdjListCoord.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-694"><a href="#AdjListTokenizers.AdjListCoord.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-695"><a href="#AdjListTokenizers.AdjListCoord.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-696"><a href="#AdjListTokenizers.AdjListCoord.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-697"><a href="#AdjListTokenizers.AdjListCoord.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-698"><a href="#AdjListTokenizers.AdjListCoord.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-699"><a href="#AdjListTokenizers.AdjListCoord.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-700"><a href="#AdjListTokenizers.AdjListCoord.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-701"><a href="#AdjListTokenizers.AdjListCoord.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-702"><a href="#AdjListTokenizers.AdjListCoord.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-703"><a href="#AdjListTokenizers.AdjListCoord.serialize-703"><span class="linenos">703</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-704"><a href="#AdjListTokenizers.AdjListCoord.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-705"><a href="#AdjListTokenizers.AdjListCoord.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-706"><a href="#AdjListTokenizers.AdjListCoord.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-707"><a href="#AdjListTokenizers.AdjListCoord.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-708"><a href="#AdjListTokenizers.AdjListCoord.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-709"><a href="#AdjListTokenizers.AdjListCoord.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-710"><a href="#AdjListTokenizers.AdjListCoord.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-711"><a href="#AdjListTokenizers.AdjListCoord.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-712"><a href="#AdjListTokenizers.AdjListCoord.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-713"><a href="#AdjListTokenizers.AdjListCoord.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-714"><a href="#AdjListTokenizers.AdjListCoord.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-715"><a href="#AdjListTokenizers.AdjListCoord.serialize-715"><span class="linenos">715</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.serialize-716"><a href="#AdjListTokenizers.AdjListCoord.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.load" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCoord.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord.load-723"><a href="#AdjListTokenizers.AdjListCoord.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-724"><a href="#AdjListTokenizers.AdjListCoord.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-725"><a href="#AdjListTokenizers.AdjListCoord.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-726"><a href="#AdjListTokenizers.AdjListCoord.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-727"><a href="#AdjListTokenizers.AdjListCoord.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-728"><a href="#AdjListTokenizers.AdjListCoord.load-728"><span class="linenos">728</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-729"><a href="#AdjListTokenizers.AdjListCoord.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-730"><a href="#AdjListTokenizers.AdjListCoord.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-731"><a href="#AdjListTokenizers.AdjListCoord.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-732"><a href="#AdjListTokenizers.AdjListCoord.load-732"><span class="linenos">732</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-733"><a href="#AdjListTokenizers.AdjListCoord.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-734"><a href="#AdjListTokenizers.AdjListCoord.load-734"><span class="linenos">734</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-735"><a href="#AdjListTokenizers.AdjListCoord.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-736"><a href="#AdjListTokenizers.AdjListCoord.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-737"><a href="#AdjListTokenizers.AdjListCoord.load-737"><span class="linenos">737</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-738"><a href="#AdjListTokenizers.AdjListCoord.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-739"><a href="#AdjListTokenizers.AdjListCoord.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-740"><a href="#AdjListTokenizers.AdjListCoord.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-741"><a href="#AdjListTokenizers.AdjListCoord.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-742"><a href="#AdjListTokenizers.AdjListCoord.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-743"><a href="#AdjListTokenizers.AdjListCoord.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-744"><a href="#AdjListTokenizers.AdjListCoord.load-744"><span class="linenos">744</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-745"><a href="#AdjListTokenizers.AdjListCoord.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-746"><a href="#AdjListTokenizers.AdjListCoord.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-747"><a href="#AdjListTokenizers.AdjListCoord.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-748"><a href="#AdjListTokenizers.AdjListCoord.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-749"><a href="#AdjListTokenizers.AdjListCoord.load-749"><span class="linenos">749</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-750"><a href="#AdjListTokenizers.AdjListCoord.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-751"><a href="#AdjListTokenizers.AdjListCoord.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-752"><a href="#AdjListTokenizers.AdjListCoord.load-752"><span class="linenos">752</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-753"><a href="#AdjListTokenizers.AdjListCoord.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-754"><a href="#AdjListTokenizers.AdjListCoord.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-755"><a href="#AdjListTokenizers.AdjListCoord.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-756"><a href="#AdjListTokenizers.AdjListCoord.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-757"><a href="#AdjListTokenizers.AdjListCoord.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-758"><a href="#AdjListTokenizers.AdjListCoord.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-759"><a href="#AdjListTokenizers.AdjListCoord.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-760"><a href="#AdjListTokenizers.AdjListCoord.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-761"><a href="#AdjListTokenizers.AdjListCoord.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-762"><a href="#AdjListTokenizers.AdjListCoord.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-763"><a href="#AdjListTokenizers.AdjListCoord.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-764"><a href="#AdjListTokenizers.AdjListCoord.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-765"><a href="#AdjListTokenizers.AdjListCoord.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-766"><a href="#AdjListTokenizers.AdjListCoord.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-767"><a href="#AdjListTokenizers.AdjListCoord.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-768"><a href="#AdjListTokenizers.AdjListCoord.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-769"><a href="#AdjListTokenizers.AdjListCoord.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-770"><a href="#AdjListTokenizers.AdjListCoord.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-771"><a href="#AdjListTokenizers.AdjListCoord.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-772"><a href="#AdjListTokenizers.AdjListCoord.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-773"><a href="#AdjListTokenizers.AdjListCoord.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-774"><a href="#AdjListTokenizers.AdjListCoord.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-775"><a href="#AdjListTokenizers.AdjListCoord.load-775"><span class="linenos">775</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-776"><a href="#AdjListTokenizers.AdjListCoord.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-777"><a href="#AdjListTokenizers.AdjListCoord.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-778"><a href="#AdjListTokenizers.AdjListCoord.load-778"><span class="linenos">778</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-779"><a href="#AdjListTokenizers.AdjListCoord.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-780"><a href="#AdjListTokenizers.AdjListCoord.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-781"><a href="#AdjListTokenizers.AdjListCoord.load-781"><span class="linenos">781</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-782"><a href="#AdjListTokenizers.AdjListCoord.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-783"><a href="#AdjListTokenizers.AdjListCoord.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-784"><a href="#AdjListTokenizers.AdjListCoord.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-785"><a href="#AdjListTokenizers.AdjListCoord.load-785"><span class="linenos">785</span></a>
</span><span id="AdjListTokenizers.AdjListCoord.load-786"><a href="#AdjListTokenizers.AdjListCoord.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="AdjListTokenizers.AdjListCoord.load-787"><a href="#AdjListTokenizers.AdjListCoord.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCoord.validate_fields_types" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCoord.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCoord.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCoord.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-271"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-272"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-273"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-274"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-275"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-276"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-277"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-278"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-279"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCoord.validate_fields_types-280"><a href="#AdjListTokenizers.AdjListCoord.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></dt>
                                <dd id="AdjListTokenizers.AdjListCoord.pre" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.pre">pre</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.post" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.post">post</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.shuffle_d0" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.shuffle_d0">shuffle_d0</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.edge_grouping" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_grouping">edge_grouping</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.edge_subset" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_subset">edge_subset</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.attribute_key" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.is_valid" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.is_valid">is_valid</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.to_tokens" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="AdjListTokenizers.AdjListCoord.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="AdjListTokenizers.AdjListCoord.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="AdjListTokenizers.AdjListCoord.validate_field_type" class="function">validate_field_type</dd>
                <dd id="AdjListTokenizers.AdjListCoord.diff" class="function">diff</dd>
                <dd id="AdjListTokenizers.AdjListCoord.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AdjListTokenizers.AdjListCardinal">
                            <input id="AdjListTokenizers.AdjListCardinal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">AdjListTokenizers.AdjListCardinal</span><wbr>(<span class="base"><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1236-L1266" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal-1237"><a href="#AdjListTokenizers.AdjListCardinal-1237"><span class="linenos">1237</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1238"><a href="#AdjListTokenizers.AdjListCardinal-1238"><span class="linenos">1238</span></a>    <span class="k">class</span> <span class="nc">AdjListCardinal</span><span class="p">(</span><span class="n">_AdjListTokenizer</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1239"><a href="#AdjListTokenizers.AdjListCardinal-1239"><span class="linenos">1239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1240"><a href="#AdjListTokenizers.AdjListCardinal-1240"><span class="linenos">1240</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal-1241"><a href="#AdjListTokenizers.AdjListCardinal-1241"><span class="linenos">1241</span></a><span class="sd">        # Parameters</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1242"><a href="#AdjListTokenizers.AdjListCardinal-1242"><span class="linenos">1242</span></a><span class="sd">        - `coord_first`: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1243"><a href="#AdjListTokenizers.AdjListCardinal-1243"><span class="linenos">1243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1244"><a href="#AdjListTokenizers.AdjListCardinal-1244"><span class="linenos">1244</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal-1245"><a href="#AdjListTokenizers.AdjListCardinal-1245"><span class="linenos">1245</span></a>        <span class="n">edge_permuter</span><span class="p">:</span> <span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1246"><a href="#AdjListTokenizers.AdjListCardinal-1246"><span class="linenos">1246</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">BothCoords</span><span class="p">(),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1247"><a href="#AdjListTokenizers.AdjListCardinal-1247"><span class="linenos">1247</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">EdgePermuters</span><span class="p">),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1248"><a href="#AdjListTokenizers.AdjListCardinal-1248"><span class="linenos">1248</span></a>        <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1249"><a href="#AdjListTokenizers.AdjListCardinal-1249"><span class="linenos">1249</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal-1250"><a href="#AdjListTokenizers.AdjListCardinal-1250"><span class="linenos">1250</span></a>        <span class="k">def</span> <span class="nf">_tokenization_callables</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1251"><a href="#AdjListTokenizers.AdjListCardinal-1251"><span class="linenos">1251</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1252"><a href="#AdjListTokenizers.AdjListCardinal-1252"><span class="linenos">1252</span></a>            <span class="n">edges</span><span class="p">:</span> <span class="n">ConnectionArray</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1253"><a href="#AdjListTokenizers.AdjListCardinal-1253"><span class="linenos">1253</span></a>            <span class="n">is_conn</span><span class="p">:</span> <span class="n">Bool</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">],</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1254"><a href="#AdjListTokenizers.AdjListCardinal-1254"><span class="linenos">1254</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1255"><a href="#AdjListTokenizers.AdjListCardinal-1255"><span class="linenos">1255</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1256"><a href="#AdjListTokenizers.AdjListCardinal-1256"><span class="linenos">1256</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1257"><a href="#AdjListTokenizers.AdjListCardinal-1257"><span class="linenos">1257</span></a>        <span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1258"><a href="#AdjListTokenizers.AdjListCardinal-1258"><span class="linenos">1258</span></a>            <span class="c1"># Map from `is_conn` to the tokens which represent connections and walls</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1259"><a href="#AdjListTokenizers.AdjListCardinal-1259"><span class="linenos">1259</span></a>            <span class="n">conn_token_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1260"><a href="#AdjListTokenizers.AdjListCardinal-1260"><span class="linenos">1260</span></a>                <span class="kc">True</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">CONNECTOR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1261"><a href="#AdjListTokenizers.AdjListCardinal-1261"><span class="linenos">1261</span></a>                <span class="kc">False</span><span class="p">:</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_WALL</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1262"><a href="#AdjListTokenizers.AdjListCardinal-1262"><span class="linenos">1262</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1263"><a href="#AdjListTokenizers.AdjListCardinal-1263"><span class="linenos">1263</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1264"><a href="#AdjListTokenizers.AdjListCardinal-1264"><span class="linenos">1264</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1265"><a href="#AdjListTokenizers.AdjListCardinal-1265"><span class="linenos">1265</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">conn_token_map</span><span class="p">[</span><span class="n">is_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1266"><a href="#AdjListTokenizers.AdjListCardinal-1266"><span class="linenos">1266</span></a>                <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="AdjListTokenizers.AdjListCardinal-1267"><a href="#AdjListTokenizers.AdjListCardinal-1267"><span class="linenos">1267</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Represents an edge group as coord tokens for the leading coord and cardinal tokens relative to the leading coord for the other group members.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>coord_first</code>: Whether the leading coord token(s) should come before or after the sequence of cardinal tokens.</li>
</ul>
</div>


                            <div id="AdjListTokenizers.AdjListCardinal.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">AdjListTokenizers.AdjListCardinal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">shuffle_d0</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">edge_grouping</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">EdgeGroupings</span><span class="o">.</span><span class="n">_EdgeGrouping</span> <span class="o">=</span> <span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_subset</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">EdgeSubsets</span><span class="o">.</span><span class="n">_EdgeSubset</span> <span class="o">=</span> <span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>,</span><span class="param">	<span class="n">edge_permuter</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">EdgePermuters</span><span class="o">.</span><span class="n">_EdgePermuter</span> <span class="o">=</span> <span class="n"><a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCardinal">AdjListTokenizers.AdjListCardinal</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#AdjListTokenizers.AdjListCardinal">AdjListTokenizers.AdjListCardinal</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.__init__"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.edge_permuter" class="classattr">
                                <div class="attr variable">
            <span class="name">edge_permuter</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.EdgePermuters._EdgePermuter</span>        =
<span class="default_value"><a href="#EdgePermuters.BothCoords">EdgePermuters.BothCoords()</a></span>

        
    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.edge_permuter"></a>
    
    

                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.serialize" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCardinal.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal.serialize-660"><a href="#AdjListTokenizers.AdjListCardinal.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-661"><a href="#AdjListTokenizers.AdjListCardinal.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-662"><a href="#AdjListTokenizers.AdjListCardinal.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-663"><a href="#AdjListTokenizers.AdjListCardinal.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-664"><a href="#AdjListTokenizers.AdjListCardinal.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-665"><a href="#AdjListTokenizers.AdjListCardinal.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-666"><a href="#AdjListTokenizers.AdjListCardinal.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-667"><a href="#AdjListTokenizers.AdjListCardinal.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-668"><a href="#AdjListTokenizers.AdjListCardinal.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-669"><a href="#AdjListTokenizers.AdjListCardinal.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-670"><a href="#AdjListTokenizers.AdjListCardinal.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-671"><a href="#AdjListTokenizers.AdjListCardinal.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-672"><a href="#AdjListTokenizers.AdjListCardinal.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-673"><a href="#AdjListTokenizers.AdjListCardinal.serialize-673"><span class="linenos">673</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-674"><a href="#AdjListTokenizers.AdjListCardinal.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-675"><a href="#AdjListTokenizers.AdjListCardinal.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-676"><a href="#AdjListTokenizers.AdjListCardinal.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-677"><a href="#AdjListTokenizers.AdjListCardinal.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-678"><a href="#AdjListTokenizers.AdjListCardinal.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-679"><a href="#AdjListTokenizers.AdjListCardinal.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-680"><a href="#AdjListTokenizers.AdjListCardinal.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-681"><a href="#AdjListTokenizers.AdjListCardinal.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-682"><a href="#AdjListTokenizers.AdjListCardinal.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-683"><a href="#AdjListTokenizers.AdjListCardinal.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-684"><a href="#AdjListTokenizers.AdjListCardinal.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-685"><a href="#AdjListTokenizers.AdjListCardinal.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-686"><a href="#AdjListTokenizers.AdjListCardinal.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-687"><a href="#AdjListTokenizers.AdjListCardinal.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-688"><a href="#AdjListTokenizers.AdjListCardinal.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-689"><a href="#AdjListTokenizers.AdjListCardinal.serialize-689"><span class="linenos">689</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-690"><a href="#AdjListTokenizers.AdjListCardinal.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-691"><a href="#AdjListTokenizers.AdjListCardinal.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-692"><a href="#AdjListTokenizers.AdjListCardinal.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-693"><a href="#AdjListTokenizers.AdjListCardinal.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-694"><a href="#AdjListTokenizers.AdjListCardinal.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-695"><a href="#AdjListTokenizers.AdjListCardinal.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-696"><a href="#AdjListTokenizers.AdjListCardinal.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-697"><a href="#AdjListTokenizers.AdjListCardinal.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-698"><a href="#AdjListTokenizers.AdjListCardinal.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-699"><a href="#AdjListTokenizers.AdjListCardinal.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-700"><a href="#AdjListTokenizers.AdjListCardinal.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-701"><a href="#AdjListTokenizers.AdjListCardinal.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-702"><a href="#AdjListTokenizers.AdjListCardinal.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-703"><a href="#AdjListTokenizers.AdjListCardinal.serialize-703"><span class="linenos">703</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-704"><a href="#AdjListTokenizers.AdjListCardinal.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-705"><a href="#AdjListTokenizers.AdjListCardinal.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-706"><a href="#AdjListTokenizers.AdjListCardinal.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-707"><a href="#AdjListTokenizers.AdjListCardinal.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-708"><a href="#AdjListTokenizers.AdjListCardinal.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-709"><a href="#AdjListTokenizers.AdjListCardinal.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-710"><a href="#AdjListTokenizers.AdjListCardinal.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-711"><a href="#AdjListTokenizers.AdjListCardinal.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-712"><a href="#AdjListTokenizers.AdjListCardinal.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-713"><a href="#AdjListTokenizers.AdjListCardinal.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-714"><a href="#AdjListTokenizers.AdjListCardinal.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-715"><a href="#AdjListTokenizers.AdjListCardinal.serialize-715"><span class="linenos">715</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.serialize-716"><a href="#AdjListTokenizers.AdjListCardinal.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.load" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCardinal.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal.load-723"><a href="#AdjListTokenizers.AdjListCardinal.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-724"><a href="#AdjListTokenizers.AdjListCardinal.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-725"><a href="#AdjListTokenizers.AdjListCardinal.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-726"><a href="#AdjListTokenizers.AdjListCardinal.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-727"><a href="#AdjListTokenizers.AdjListCardinal.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-728"><a href="#AdjListTokenizers.AdjListCardinal.load-728"><span class="linenos">728</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-729"><a href="#AdjListTokenizers.AdjListCardinal.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-730"><a href="#AdjListTokenizers.AdjListCardinal.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-731"><a href="#AdjListTokenizers.AdjListCardinal.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-732"><a href="#AdjListTokenizers.AdjListCardinal.load-732"><span class="linenos">732</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-733"><a href="#AdjListTokenizers.AdjListCardinal.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-734"><a href="#AdjListTokenizers.AdjListCardinal.load-734"><span class="linenos">734</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-735"><a href="#AdjListTokenizers.AdjListCardinal.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-736"><a href="#AdjListTokenizers.AdjListCardinal.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-737"><a href="#AdjListTokenizers.AdjListCardinal.load-737"><span class="linenos">737</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-738"><a href="#AdjListTokenizers.AdjListCardinal.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-739"><a href="#AdjListTokenizers.AdjListCardinal.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-740"><a href="#AdjListTokenizers.AdjListCardinal.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-741"><a href="#AdjListTokenizers.AdjListCardinal.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-742"><a href="#AdjListTokenizers.AdjListCardinal.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-743"><a href="#AdjListTokenizers.AdjListCardinal.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-744"><a href="#AdjListTokenizers.AdjListCardinal.load-744"><span class="linenos">744</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-745"><a href="#AdjListTokenizers.AdjListCardinal.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-746"><a href="#AdjListTokenizers.AdjListCardinal.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-747"><a href="#AdjListTokenizers.AdjListCardinal.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-748"><a href="#AdjListTokenizers.AdjListCardinal.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-749"><a href="#AdjListTokenizers.AdjListCardinal.load-749"><span class="linenos">749</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-750"><a href="#AdjListTokenizers.AdjListCardinal.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-751"><a href="#AdjListTokenizers.AdjListCardinal.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-752"><a href="#AdjListTokenizers.AdjListCardinal.load-752"><span class="linenos">752</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-753"><a href="#AdjListTokenizers.AdjListCardinal.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-754"><a href="#AdjListTokenizers.AdjListCardinal.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-755"><a href="#AdjListTokenizers.AdjListCardinal.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-756"><a href="#AdjListTokenizers.AdjListCardinal.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-757"><a href="#AdjListTokenizers.AdjListCardinal.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-758"><a href="#AdjListTokenizers.AdjListCardinal.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-759"><a href="#AdjListTokenizers.AdjListCardinal.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-760"><a href="#AdjListTokenizers.AdjListCardinal.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-761"><a href="#AdjListTokenizers.AdjListCardinal.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-762"><a href="#AdjListTokenizers.AdjListCardinal.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-763"><a href="#AdjListTokenizers.AdjListCardinal.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-764"><a href="#AdjListTokenizers.AdjListCardinal.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-765"><a href="#AdjListTokenizers.AdjListCardinal.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-766"><a href="#AdjListTokenizers.AdjListCardinal.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-767"><a href="#AdjListTokenizers.AdjListCardinal.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-768"><a href="#AdjListTokenizers.AdjListCardinal.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-769"><a href="#AdjListTokenizers.AdjListCardinal.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-770"><a href="#AdjListTokenizers.AdjListCardinal.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-771"><a href="#AdjListTokenizers.AdjListCardinal.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-772"><a href="#AdjListTokenizers.AdjListCardinal.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-773"><a href="#AdjListTokenizers.AdjListCardinal.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-774"><a href="#AdjListTokenizers.AdjListCardinal.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-775"><a href="#AdjListTokenizers.AdjListCardinal.load-775"><span class="linenos">775</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-776"><a href="#AdjListTokenizers.AdjListCardinal.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-777"><a href="#AdjListTokenizers.AdjListCardinal.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-778"><a href="#AdjListTokenizers.AdjListCardinal.load-778"><span class="linenos">778</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-779"><a href="#AdjListTokenizers.AdjListCardinal.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-780"><a href="#AdjListTokenizers.AdjListCardinal.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-781"><a href="#AdjListTokenizers.AdjListCardinal.load-781"><span class="linenos">781</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-782"><a href="#AdjListTokenizers.AdjListCardinal.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-783"><a href="#AdjListTokenizers.AdjListCardinal.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-784"><a href="#AdjListTokenizers.AdjListCardinal.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-785"><a href="#AdjListTokenizers.AdjListCardinal.load-785"><span class="linenos">785</span></a>
</span><span id="AdjListTokenizers.AdjListCardinal.load-786"><a href="#AdjListTokenizers.AdjListCardinal.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="AdjListTokenizers.AdjListCardinal.load-787"><a href="#AdjListTokenizers.AdjListCardinal.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="AdjListTokenizers.AdjListCardinal.validate_fields_types" class="classattr">
                                        <input id="AdjListTokenizers.AdjListCardinal.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="AdjListTokenizers.AdjListCardinal.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#AdjListTokenizers.AdjListCardinal.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-271"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-272"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-273"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-274"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-275"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-276"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-277"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-278"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-279"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="AdjListTokenizers.AdjListCardinal.validate_fields_types-280"><a href="#AdjListTokenizers.AdjListCardinal.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AdjListTokenizers._AdjListTokenizer">AdjListTokenizers._AdjListTokenizer</a></dt>
                                <dd id="AdjListTokenizers.AdjListCardinal.pre" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.pre">pre</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.post" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.post">post</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.shuffle_d0" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.shuffle_d0">shuffle_d0</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.edge_grouping" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_grouping">edge_grouping</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.edge_subset" class="variable"><a href="#AdjListTokenizers._AdjListTokenizer.edge_subset">edge_subset</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.attribute_key" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.is_valid" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.is_valid">is_valid</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.to_tokens" class="function"><a href="#AdjListTokenizers._AdjListTokenizer.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="AdjListTokenizers.AdjListCardinal.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="AdjListTokenizers.AdjListCardinal.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="AdjListTokenizers.AdjListCardinal.validate_field_type" class="function">validate_field_type</dd>
                <dd id="AdjListTokenizers.AdjListCardinal.diff" class="function">diff</dd>
                <dd id="AdjListTokenizers.AdjListCardinal.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TargetTokenizers">
                            <input id="TargetTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TargetTokenizers</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1269-L1320" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers-1270"><a href="#TargetTokenizers-1270"><span class="linenos">1270</span></a><span class="k">class</span> <span class="nc">TargetTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="TargetTokenizers-1271"><a href="#TargetTokenizers-1271"><span class="linenos">1271</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_TargetTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-1272"><a href="#TargetTokenizers-1272"><span class="linenos">1272</span></a>
</span><span id="TargetTokenizers-1273"><a href="#TargetTokenizers-1273"><span class="linenos">1273</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;target_tokenizer&quot;</span>
</span><span id="TargetTokenizers-1274"><a href="#TargetTokenizers-1274"><span class="linenos">1274</span></a>
</span><span id="TargetTokenizers-1275"><a href="#TargetTokenizers-1275"><span class="linenos">1275</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TargetTokenizers-1276"><a href="#TargetTokenizers-1276"><span class="linenos">1276</span></a>    <span class="k">class</span> <span class="nc">_TargetTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="TargetTokenizers-1277"><a href="#TargetTokenizers-1277"><span class="linenos">1277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze targets.&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-1278"><a href="#TargetTokenizers-1278"><span class="linenos">1278</span></a>
</span><span id="TargetTokenizers-1279"><a href="#TargetTokenizers-1279"><span class="linenos">1279</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="TargetTokenizers-1280"><a href="#TargetTokenizers-1280"><span class="linenos">1280</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="TargetTokenizers-1281"><a href="#TargetTokenizers-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers-1282"><a href="#TargetTokenizers-1282"><span class="linenos">1282</span></a>            <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers-1283"><a href="#TargetTokenizers-1283"><span class="linenos">1283</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers-1284"><a href="#TargetTokenizers-1284"><span class="linenos">1284</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers-1285"><a href="#TargetTokenizers-1285"><span class="linenos">1285</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens representing the target.&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-1286"><a href="#TargetTokenizers-1286"><span class="linenos">1286</span></a>            <span class="k">pass</span>
</span><span id="TargetTokenizers-1287"><a href="#TargetTokenizers-1287"><span class="linenos">1287</span></a>
</span><span id="TargetTokenizers-1288"><a href="#TargetTokenizers-1288"><span class="linenos">1288</span></a>        <span class="nd">@classmethod</span>
</span><span id="TargetTokenizers-1289"><a href="#TargetTokenizers-1289"><span class="linenos">1289</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="TargetTokenizers-1290"><a href="#TargetTokenizers-1290"><span class="linenos">1290</span></a>            <span class="k">return</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="TargetTokenizers-1291"><a href="#TargetTokenizers-1291"><span class="linenos">1291</span></a>
</span><span id="TargetTokenizers-1292"><a href="#TargetTokenizers-1292"><span class="linenos">1292</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TargetTokenizers-1293"><a href="#TargetTokenizers-1293"><span class="linenos">1293</span></a>    <span class="k">class</span> <span class="nc">Unlabeled</span><span class="p">(</span><span class="n">_TargetTokenizer</span><span class="p">):</span>
</span><span id="TargetTokenizers-1294"><a href="#TargetTokenizers-1294"><span class="linenos">1294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Targets are simply listed as coord tokens.</span>
</span><span id="TargetTokenizers-1295"><a href="#TargetTokenizers-1295"><span class="linenos">1295</span></a><span class="sd">        - `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="TargetTokenizers-1296"><a href="#TargetTokenizers-1296"><span class="linenos">1296</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TargetTokenizers-1297"><a href="#TargetTokenizers-1297"><span class="linenos">1297</span></a>
</span><span id="TargetTokenizers-1298"><a href="#TargetTokenizers-1298"><span class="linenos">1298</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="TargetTokenizers-1299"><a href="#TargetTokenizers-1299"><span class="linenos">1299</span></a>
</span><span id="TargetTokenizers-1300"><a href="#TargetTokenizers-1300"><span class="linenos">1300</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="TargetTokenizers-1301"><a href="#TargetTokenizers-1301"><span class="linenos">1301</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers-1302"><a href="#TargetTokenizers-1302"><span class="linenos">1302</span></a>            <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers-1303"><a href="#TargetTokenizers-1303"><span class="linenos">1303</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers-1304"><a href="#TargetTokenizers-1304"><span class="linenos">1304</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers-1305"><a href="#TargetTokenizers-1305"><span class="linenos">1305</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="TargetTokenizers-1306"><a href="#TargetTokenizers-1306"><span class="linenos">1306</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="TargetTokenizers-1307"><a href="#TargetTokenizers-1307"><span class="linenos">1307</span></a>                    <span class="p">[</span>
</span><span id="TargetTokenizers-1308"><a href="#TargetTokenizers-1308"><span class="linenos">1308</span></a>                        <span class="p">[</span>
</span><span id="TargetTokenizers-1309"><a href="#TargetTokenizers-1309"><span class="linenos">1309</span></a>                            <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="TargetTokenizers-1310"><a href="#TargetTokenizers-1310"><span class="linenos">1310</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="TargetTokenizers-1311"><a href="#TargetTokenizers-1311"><span class="linenos">1311</span></a>                                <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span>
</span><span id="TargetTokenizers-1312"><a href="#TargetTokenizers-1312"><span class="linenos">1312</span></a>                            <span class="p">),</span>
</span><span id="TargetTokenizers-1313"><a href="#TargetTokenizers-1313"><span class="linenos">1313</span></a>                        <span class="p">]</span>
</span><span id="TargetTokenizers-1314"><a href="#TargetTokenizers-1314"><span class="linenos">1314</span></a>                        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="TargetTokenizers-1315"><a href="#TargetTokenizers-1315"><span class="linenos">1315</span></a>                    <span class="p">]</span>
</span><span id="TargetTokenizers-1316"><a href="#TargetTokenizers-1316"><span class="linenos">1316</span></a>                <span class="p">)</span>
</span><span id="TargetTokenizers-1317"><a href="#TargetTokenizers-1317"><span class="linenos">1317</span></a>            <span class="p">)</span>
</span><span id="TargetTokenizers-1318"><a href="#TargetTokenizers-1318"><span class="linenos">1318</span></a>
</span><span id="TargetTokenizers-1319"><a href="#TargetTokenizers-1319"><span class="linenos">1319</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TargetTokenizers-1320"><a href="#TargetTokenizers-1320"><span class="linenos">1320</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="TargetTokenizers-1321"><a href="#TargetTokenizers-1321"><span class="linenos">1321</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_TargetTokenizer</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="TargetTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;target_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#TargetTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="TargetTokenizers.Unlabeled">
                            <input id="TargetTokenizers.Unlabeled-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">TargetTokenizers.Unlabeled</span><wbr>(<span class="base"><a href="#TargetTokenizers._TargetTokenizer">TargetTokenizers._TargetTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1291-L1320" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled-1292"><a href="#TargetTokenizers.Unlabeled-1292"><span class="linenos">1292</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-1293"><a href="#TargetTokenizers.Unlabeled-1293"><span class="linenos">1293</span></a>    <span class="k">class</span> <span class="nc">Unlabeled</span><span class="p">(</span><span class="n">_TargetTokenizer</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled-1294"><a href="#TargetTokenizers.Unlabeled-1294"><span class="linenos">1294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Targets are simply listed as coord tokens.</span>
</span><span id="TargetTokenizers.Unlabeled-1295"><a href="#TargetTokenizers.Unlabeled-1295"><span class="linenos">1295</span></a><span class="sd">        - `post`: Whether all coords include an integral following delimiter token</span>
</span><span id="TargetTokenizers.Unlabeled-1296"><a href="#TargetTokenizers.Unlabeled-1296"><span class="linenos">1296</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TargetTokenizers.Unlabeled-1297"><a href="#TargetTokenizers.Unlabeled-1297"><span class="linenos">1297</span></a>
</span><span id="TargetTokenizers.Unlabeled-1298"><a href="#TargetTokenizers.Unlabeled-1298"><span class="linenos">1298</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-1299"><a href="#TargetTokenizers.Unlabeled-1299"><span class="linenos">1299</span></a>
</span><span id="TargetTokenizers.Unlabeled-1300"><a href="#TargetTokenizers.Unlabeled-1300"><span class="linenos">1300</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-1301"><a href="#TargetTokenizers.Unlabeled-1301"><span class="linenos">1301</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled-1302"><a href="#TargetTokenizers.Unlabeled-1302"><span class="linenos">1302</span></a>            <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled-1303"><a href="#TargetTokenizers.Unlabeled-1303"><span class="linenos">1303</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled-1304"><a href="#TargetTokenizers.Unlabeled-1304"><span class="linenos">1304</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled-1305"><a href="#TargetTokenizers.Unlabeled-1305"><span class="linenos">1305</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-1306"><a href="#TargetTokenizers.Unlabeled-1306"><span class="linenos">1306</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-1307"><a href="#TargetTokenizers.Unlabeled-1307"><span class="linenos">1307</span></a>                    <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled-1308"><a href="#TargetTokenizers.Unlabeled-1308"><span class="linenos">1308</span></a>                        <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled-1309"><a href="#TargetTokenizers.Unlabeled-1309"><span class="linenos">1309</span></a>                            <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled-1310"><a href="#TargetTokenizers.Unlabeled-1310"><span class="linenos">1310</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled-1311"><a href="#TargetTokenizers.Unlabeled-1311"><span class="linenos">1311</span></a>                                <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span>
</span><span id="TargetTokenizers.Unlabeled-1312"><a href="#TargetTokenizers.Unlabeled-1312"><span class="linenos">1312</span></a>                            <span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled-1313"><a href="#TargetTokenizers.Unlabeled-1313"><span class="linenos">1313</span></a>                        <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled-1314"><a href="#TargetTokenizers.Unlabeled-1314"><span class="linenos">1314</span></a>                        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="TargetTokenizers.Unlabeled-1315"><a href="#TargetTokenizers.Unlabeled-1315"><span class="linenos">1315</span></a>                    <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled-1316"><a href="#TargetTokenizers.Unlabeled-1316"><span class="linenos">1316</span></a>                <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-1317"><a href="#TargetTokenizers.Unlabeled-1317"><span class="linenos">1317</span></a>            <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled-1318"><a href="#TargetTokenizers.Unlabeled-1318"><span class="linenos">1318</span></a>
</span><span id="TargetTokenizers.Unlabeled-1319"><a href="#TargetTokenizers.Unlabeled-1319"><span class="linenos">1319</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled-1320"><a href="#TargetTokenizers.Unlabeled-1320"><span class="linenos">1320</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="TargetTokenizers.Unlabeled-1321"><a href="#TargetTokenizers.Unlabeled-1321"><span class="linenos">1321</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Targets are simply listed as coord tokens.</p>

<ul>
<li><code><a href="#TargetTokenizers.Unlabeled.post">post</a></code>: Whether all coords include an integral following delimiter token</li>
</ul>
</div>


                            <div id="TargetTokenizers.Unlabeled.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TargetTokenizers.Unlabeled</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.__init__"></a>
    
    

                            </div>
                            <div id="TargetTokenizers.Unlabeled.post" class="classattr">
                                <div class="attr variable">
            <span class="name">post</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.post"></a>
    
    

                            </div>
                            <div id="TargetTokenizers.Unlabeled.to_tokens" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col&#39;</span><span class="p">]]</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1299-L1316" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.to_tokens-1300"><a href="#TargetTokenizers.Unlabeled.to_tokens-1300"><span class="linenos">1300</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1301"><a href="#TargetTokenizers.Unlabeled.to_tokens-1301"><span class="linenos">1301</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1302"><a href="#TargetTokenizers.Unlabeled.to_tokens-1302"><span class="linenos">1302</span></a>            <span class="n">targets</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Coord</span><span class="p">],</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1303"><a href="#TargetTokenizers.Unlabeled.to_tokens-1303"><span class="linenos">1303</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1304"><a href="#TargetTokenizers.Unlabeled.to_tokens-1304"><span class="linenos">1304</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1305"><a href="#TargetTokenizers.Unlabeled.to_tokens-1305"><span class="linenos">1305</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1306"><a href="#TargetTokenizers.Unlabeled.to_tokens-1306"><span class="linenos">1306</span></a>                <span class="n">flatten</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1307"><a href="#TargetTokenizers.Unlabeled.to_tokens-1307"><span class="linenos">1307</span></a>                    <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1308"><a href="#TargetTokenizers.Unlabeled.to_tokens-1308"><span class="linenos">1308</span></a>                        <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1309"><a href="#TargetTokenizers.Unlabeled.to_tokens-1309"><span class="linenos">1309</span></a>                            <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1310"><a href="#TargetTokenizers.Unlabeled.to_tokens-1310"><span class="linenos">1310</span></a>                            <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1311"><a href="#TargetTokenizers.Unlabeled.to_tokens-1311"><span class="linenos">1311</span></a>                                <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_POST</span><span class="p">],</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1312"><a href="#TargetTokenizers.Unlabeled.to_tokens-1312"><span class="linenos">1312</span></a>                            <span class="p">),</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1313"><a href="#TargetTokenizers.Unlabeled.to_tokens-1313"><span class="linenos">1313</span></a>                        <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1314"><a href="#TargetTokenizers.Unlabeled.to_tokens-1314"><span class="linenos">1314</span></a>                        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1315"><a href="#TargetTokenizers.Unlabeled.to_tokens-1315"><span class="linenos">1315</span></a>                    <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1316"><a href="#TargetTokenizers.Unlabeled.to_tokens-1316"><span class="linenos">1316</span></a>                <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.to_tokens-1317"><a href="#TargetTokenizers.Unlabeled.to_tokens-1317"><span class="linenos">1317</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns tokens representing the target.</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.is_valid" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1318-L1320" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.is_valid-1319"><a href="#TargetTokenizers.Unlabeled.is_valid-1319"><span class="linenos">1319</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.is_valid-1320"><a href="#TargetTokenizers.Unlabeled.is_valid-1320"><span class="linenos">1320</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="TargetTokenizers.Unlabeled.is_valid-1321"><a href="#TargetTokenizers.Unlabeled.is_valid-1321"><span class="linenos">1321</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.
Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code><a href="#MazeTokenizerModular.is_valid">MazeTokenizerModular.is_valid</a></code> calls <code><a href="#TargetTokenizers.Unlabeled.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.serialize" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.serialize-660"><a href="#TargetTokenizers.Unlabeled.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-661"><a href="#TargetTokenizers.Unlabeled.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-662"><a href="#TargetTokenizers.Unlabeled.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-663"><a href="#TargetTokenizers.Unlabeled.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-664"><a href="#TargetTokenizers.Unlabeled.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-665"><a href="#TargetTokenizers.Unlabeled.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-666"><a href="#TargetTokenizers.Unlabeled.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-667"><a href="#TargetTokenizers.Unlabeled.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-668"><a href="#TargetTokenizers.Unlabeled.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-669"><a href="#TargetTokenizers.Unlabeled.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-670"><a href="#TargetTokenizers.Unlabeled.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-671"><a href="#TargetTokenizers.Unlabeled.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-672"><a href="#TargetTokenizers.Unlabeled.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-673"><a href="#TargetTokenizers.Unlabeled.serialize-673"><span class="linenos">673</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-674"><a href="#TargetTokenizers.Unlabeled.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-675"><a href="#TargetTokenizers.Unlabeled.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-676"><a href="#TargetTokenizers.Unlabeled.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-677"><a href="#TargetTokenizers.Unlabeled.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-678"><a href="#TargetTokenizers.Unlabeled.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-679"><a href="#TargetTokenizers.Unlabeled.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-680"><a href="#TargetTokenizers.Unlabeled.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-681"><a href="#TargetTokenizers.Unlabeled.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-682"><a href="#TargetTokenizers.Unlabeled.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-683"><a href="#TargetTokenizers.Unlabeled.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-684"><a href="#TargetTokenizers.Unlabeled.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-685"><a href="#TargetTokenizers.Unlabeled.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-686"><a href="#TargetTokenizers.Unlabeled.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-687"><a href="#TargetTokenizers.Unlabeled.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-688"><a href="#TargetTokenizers.Unlabeled.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-689"><a href="#TargetTokenizers.Unlabeled.serialize-689"><span class="linenos">689</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-690"><a href="#TargetTokenizers.Unlabeled.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-691"><a href="#TargetTokenizers.Unlabeled.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-692"><a href="#TargetTokenizers.Unlabeled.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-693"><a href="#TargetTokenizers.Unlabeled.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-694"><a href="#TargetTokenizers.Unlabeled.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-695"><a href="#TargetTokenizers.Unlabeled.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-696"><a href="#TargetTokenizers.Unlabeled.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-697"><a href="#TargetTokenizers.Unlabeled.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-698"><a href="#TargetTokenizers.Unlabeled.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-699"><a href="#TargetTokenizers.Unlabeled.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-700"><a href="#TargetTokenizers.Unlabeled.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-701"><a href="#TargetTokenizers.Unlabeled.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-702"><a href="#TargetTokenizers.Unlabeled.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-703"><a href="#TargetTokenizers.Unlabeled.serialize-703"><span class="linenos">703</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-704"><a href="#TargetTokenizers.Unlabeled.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-705"><a href="#TargetTokenizers.Unlabeled.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-706"><a href="#TargetTokenizers.Unlabeled.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-707"><a href="#TargetTokenizers.Unlabeled.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-708"><a href="#TargetTokenizers.Unlabeled.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-709"><a href="#TargetTokenizers.Unlabeled.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-710"><a href="#TargetTokenizers.Unlabeled.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-711"><a href="#TargetTokenizers.Unlabeled.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-712"><a href="#TargetTokenizers.Unlabeled.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-713"><a href="#TargetTokenizers.Unlabeled.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-714"><a href="#TargetTokenizers.Unlabeled.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.serialize-715"><a href="#TargetTokenizers.Unlabeled.serialize-715"><span class="linenos">715</span></a>
</span><span id="TargetTokenizers.Unlabeled.serialize-716"><a href="#TargetTokenizers.Unlabeled.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.load" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.load-723"><a href="#TargetTokenizers.Unlabeled.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="TargetTokenizers.Unlabeled.load-724"><a href="#TargetTokenizers.Unlabeled.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="TargetTokenizers.Unlabeled.load-725"><a href="#TargetTokenizers.Unlabeled.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="TargetTokenizers.Unlabeled.load-726"><a href="#TargetTokenizers.Unlabeled.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-727"><a href="#TargetTokenizers.Unlabeled.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="TargetTokenizers.Unlabeled.load-728"><a href="#TargetTokenizers.Unlabeled.load-728"><span class="linenos">728</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-729"><a href="#TargetTokenizers.Unlabeled.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-730"><a href="#TargetTokenizers.Unlabeled.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="TargetTokenizers.Unlabeled.load-731"><a href="#TargetTokenizers.Unlabeled.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-732"><a href="#TargetTokenizers.Unlabeled.load-732"><span class="linenos">732</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-733"><a href="#TargetTokenizers.Unlabeled.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-734"><a href="#TargetTokenizers.Unlabeled.load-734"><span class="linenos">734</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-735"><a href="#TargetTokenizers.Unlabeled.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="TargetTokenizers.Unlabeled.load-736"><a href="#TargetTokenizers.Unlabeled.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.load-737"><a href="#TargetTokenizers.Unlabeled.load-737"><span class="linenos">737</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-738"><a href="#TargetTokenizers.Unlabeled.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="TargetTokenizers.Unlabeled.load-739"><a href="#TargetTokenizers.Unlabeled.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-740"><a href="#TargetTokenizers.Unlabeled.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="TargetTokenizers.Unlabeled.load-741"><a href="#TargetTokenizers.Unlabeled.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-742"><a href="#TargetTokenizers.Unlabeled.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="TargetTokenizers.Unlabeled.load-743"><a href="#TargetTokenizers.Unlabeled.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-744"><a href="#TargetTokenizers.Unlabeled.load-744"><span class="linenos">744</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-745"><a href="#TargetTokenizers.Unlabeled.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="TargetTokenizers.Unlabeled.load-746"><a href="#TargetTokenizers.Unlabeled.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-747"><a href="#TargetTokenizers.Unlabeled.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="TargetTokenizers.Unlabeled.load-748"><a href="#TargetTokenizers.Unlabeled.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="TargetTokenizers.Unlabeled.load-749"><a href="#TargetTokenizers.Unlabeled.load-749"><span class="linenos">749</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-750"><a href="#TargetTokenizers.Unlabeled.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="TargetTokenizers.Unlabeled.load-751"><a href="#TargetTokenizers.Unlabeled.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-752"><a href="#TargetTokenizers.Unlabeled.load-752"><span class="linenos">752</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-753"><a href="#TargetTokenizers.Unlabeled.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="TargetTokenizers.Unlabeled.load-754"><a href="#TargetTokenizers.Unlabeled.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-755"><a href="#TargetTokenizers.Unlabeled.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.load-756"><a href="#TargetTokenizers.Unlabeled.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-757"><a href="#TargetTokenizers.Unlabeled.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-758"><a href="#TargetTokenizers.Unlabeled.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="TargetTokenizers.Unlabeled.load-759"><a href="#TargetTokenizers.Unlabeled.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-760"><a href="#TargetTokenizers.Unlabeled.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-761"><a href="#TargetTokenizers.Unlabeled.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="TargetTokenizers.Unlabeled.load-762"><a href="#TargetTokenizers.Unlabeled.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-763"><a href="#TargetTokenizers.Unlabeled.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-764"><a href="#TargetTokenizers.Unlabeled.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-765"><a href="#TargetTokenizers.Unlabeled.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="TargetTokenizers.Unlabeled.load-766"><a href="#TargetTokenizers.Unlabeled.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="TargetTokenizers.Unlabeled.load-767"><a href="#TargetTokenizers.Unlabeled.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-768"><a href="#TargetTokenizers.Unlabeled.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-769"><a href="#TargetTokenizers.Unlabeled.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.load-770"><a href="#TargetTokenizers.Unlabeled.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.load-771"><a href="#TargetTokenizers.Unlabeled.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-772"><a href="#TargetTokenizers.Unlabeled.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-773"><a href="#TargetTokenizers.Unlabeled.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="TargetTokenizers.Unlabeled.load-774"><a href="#TargetTokenizers.Unlabeled.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="TargetTokenizers.Unlabeled.load-775"><a href="#TargetTokenizers.Unlabeled.load-775"><span class="linenos">775</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-776"><a href="#TargetTokenizers.Unlabeled.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="TargetTokenizers.Unlabeled.load-777"><a href="#TargetTokenizers.Unlabeled.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TargetTokenizers.Unlabeled.load-778"><a href="#TargetTokenizers.Unlabeled.load-778"><span class="linenos">778</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-779"><a href="#TargetTokenizers.Unlabeled.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="TargetTokenizers.Unlabeled.load-780"><a href="#TargetTokenizers.Unlabeled.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-781"><a href="#TargetTokenizers.Unlabeled.load-781"><span class="linenos">781</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-782"><a href="#TargetTokenizers.Unlabeled.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="TargetTokenizers.Unlabeled.load-783"><a href="#TargetTokenizers.Unlabeled.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.load-784"><a href="#TargetTokenizers.Unlabeled.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="TargetTokenizers.Unlabeled.load-785"><a href="#TargetTokenizers.Unlabeled.load-785"><span class="linenos">785</span></a>
</span><span id="TargetTokenizers.Unlabeled.load-786"><a href="#TargetTokenizers.Unlabeled.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="TargetTokenizers.Unlabeled.load-787"><a href="#TargetTokenizers.Unlabeled.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="TargetTokenizers.Unlabeled.validate_fields_types" class="classattr">
                                        <input id="TargetTokenizers.Unlabeled.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="TargetTokenizers.Unlabeled.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#TargetTokenizers.Unlabeled.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TargetTokenizers.Unlabeled.validate_fields_types-271"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-272"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-273"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-274"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-275"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-276"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-277"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-278"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-279"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="TargetTokenizers.Unlabeled.validate_fields_types-280"><a href="#TargetTokenizers.Unlabeled.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#TargetTokenizers._TargetTokenizer">TargetTokenizers._TargetTokenizer</a></dt>
                                <dd id="TargetTokenizers.Unlabeled.attribute_key" class="function"><a href="#TargetTokenizers._TargetTokenizer.attribute_key">attribute_key</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="TargetTokenizers.Unlabeled.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="TargetTokenizers.Unlabeled.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="TargetTokenizers.Unlabeled.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="TargetTokenizers.Unlabeled.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="TargetTokenizers.Unlabeled.validate_field_type" class="function">validate_field_type</dd>
                <dd id="TargetTokenizers.Unlabeled.diff" class="function">diff</dd>
                <dd id="TargetTokenizers.Unlabeled.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes">
                            <input id="StepSizes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StepSizes</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1323-L1416" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes-1324"><a href="#StepSizes-1324"><span class="linenos">1324</span></a><span class="k">class</span> <span class="nc">StepSizes</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="StepSizes-1325"><a href="#StepSizes-1325"><span class="linenos">1325</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_StepSize` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1326"><a href="#StepSizes-1326"><span class="linenos">1326</span></a>
</span><span id="StepSizes-1327"><a href="#StepSizes-1327"><span class="linenos">1327</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_size&quot;</span>
</span><span id="StepSizes-1328"><a href="#StepSizes-1328"><span class="linenos">1328</span></a>
</span><span id="StepSizes-1329"><a href="#StepSizes-1329"><span class="linenos">1329</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-1330"><a href="#StepSizes-1330"><span class="linenos">1330</span></a>    <span class="k">class</span> <span class="nc">_StepSize</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="StepSizes-1331"><a href="#StepSizes-1331"><span class="linenos">1331</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes-1332"><a href="#StepSizes-1332"><span class="linenos">1332</span></a><span class="sd">        Specifies which coords in `maze.solution` are used to represent the path.</span>
</span><span id="StepSizes-1333"><a href="#StepSizes-1333"><span class="linenos">1333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes-1334"><a href="#StepSizes-1334"><span class="linenos">1334</span></a>
</span><span id="StepSizes-1335"><a href="#StepSizes-1335"><span class="linenos">1335</span></a>        <span class="nd">@classmethod</span>
</span><span id="StepSizes-1336"><a href="#StepSizes-1336"><span class="linenos">1336</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="StepSizes-1337"><a href="#StepSizes-1337"><span class="linenos">1337</span></a>            <span class="k">return</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">key</span>
</span><span id="StepSizes-1338"><a href="#StepSizes-1338"><span class="linenos">1338</span></a>
</span><span id="StepSizes-1339"><a href="#StepSizes-1339"><span class="linenos">1339</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>  <span class="c1"># TODO: make this a static/class method, allowing ForksAndStraightaways to skip object construction at every call</span>
</span><span id="StepSizes-1340"><a href="#StepSizes-1340"><span class="linenos">1340</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-1341"><a href="#StepSizes-1341"><span class="linenos">1341</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1342"><a href="#StepSizes-1342"><span class="linenos">1342</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="StepSizes-1343"><a href="#StepSizes-1343"><span class="linenos">1343</span></a>                <span class="s2">&quot;Subclasses must implement `StepSize.step_indices.&quot;</span>
</span><span id="StepSizes-1344"><a href="#StepSizes-1344"><span class="linenos">1344</span></a>            <span class="p">)</span>
</span><span id="StepSizes-1345"><a href="#StepSizes-1345"><span class="linenos">1345</span></a>
</span><span id="StepSizes-1346"><a href="#StepSizes-1346"><span class="linenos">1346</span></a>        <span class="k">def</span> <span class="nf">step_start_end_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span id="StepSizes-1347"><a href="#StepSizes-1347"><span class="linenos">1347</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns steps as tuples of starting and ending positions for each step.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1348"><a href="#StepSizes-1348"><span class="linenos">1348</span></a>            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="StepSizes-1349"><a href="#StepSizes-1349"><span class="linenos">1349</span></a>            <span class="k">return</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</span><span id="StepSizes-1350"><a href="#StepSizes-1350"><span class="linenos">1350</span></a>
</span><span id="StepSizes-1351"><a href="#StepSizes-1351"><span class="linenos">1351</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes-1352"><a href="#StepSizes-1352"><span class="linenos">1352</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="StepSizes-1353"><a href="#StepSizes-1353"><span class="linenos">1353</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="StepSizes-1354"><a href="#StepSizes-1354"><span class="linenos">1354</span></a>
</span><span id="StepSizes-1355"><a href="#StepSizes-1355"><span class="linenos">1355</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-1356"><a href="#StepSizes-1356"><span class="linenos">1356</span></a>    <span class="k">class</span> <span class="nc">Singles</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-1357"><a href="#StepSizes-1357"><span class="linenos">1357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes-1358"><a href="#StepSizes-1358"><span class="linenos">1358</span></a><span class="sd">        Every coord in `maze.solution` is represented.</span>
</span><span id="StepSizes-1359"><a href="#StepSizes-1359"><span class="linenos">1359</span></a><span class="sd">        Legacy tokenizers all use this behavior.</span>
</span><span id="StepSizes-1360"><a href="#StepSizes-1360"><span class="linenos">1360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes-1361"><a href="#StepSizes-1361"><span class="linenos">1361</span></a>
</span><span id="StepSizes-1362"><a href="#StepSizes-1362"><span class="linenos">1362</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-1363"><a href="#StepSizes-1363"><span class="linenos">1363</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1364"><a href="#StepSizes-1364"><span class="linenos">1364</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="StepSizes-1365"><a href="#StepSizes-1365"><span class="linenos">1365</span></a>
</span><span id="StepSizes-1366"><a href="#StepSizes-1366"><span class="linenos">1366</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-1367"><a href="#StepSizes-1367"><span class="linenos">1367</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StepSizes-1368"><a href="#StepSizes-1368"><span class="linenos">1368</span></a>    <span class="k">class</span> <span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-1369"><a href="#StepSizes-1369"><span class="linenos">1369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes-1370"><a href="#StepSizes-1370"><span class="linenos">1370</span></a><span class="sd">        Only coords where the path turns are represented in the path.</span>
</span><span id="StepSizes-1371"><a href="#StepSizes-1371"><span class="linenos">1371</span></a><span class="sd">        I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="StepSizes-1372"><a href="#StepSizes-1372"><span class="linenos">1372</span></a><span class="sd">        specified by the coords at the turns.</span>
</span><span id="StepSizes-1373"><a href="#StepSizes-1373"><span class="linenos">1373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes-1374"><a href="#StepSizes-1374"><span class="linenos">1374</span></a>
</span><span id="StepSizes-1375"><a href="#StepSizes-1375"><span class="linenos">1375</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-1376"><a href="#StepSizes-1376"><span class="linenos">1376</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1377"><a href="#StepSizes-1377"><span class="linenos">1377</span></a>            <span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes-1378"><a href="#StepSizes-1378"><span class="linenos">1378</span></a>            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes-1379"><a href="#StepSizes-1379"><span class="linenos">1379</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="StepSizes-1380"><a href="#StepSizes-1380"><span class="linenos">1380</span></a>                <span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="StepSizes-1381"><a href="#StepSizes-1381"><span class="linenos">1381</span></a>                    <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="StepSizes-1382"><a href="#StepSizes-1382"><span class="linenos">1382</span></a>                    <span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes-1383"><a href="#StepSizes-1383"><span class="linenos">1383</span></a>            <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StepSizes-1384"><a href="#StepSizes-1384"><span class="linenos">1384</span></a>            <span class="k">return</span> <span class="n">indices</span>
</span><span id="StepSizes-1385"><a href="#StepSizes-1385"><span class="linenos">1385</span></a>
</span><span id="StepSizes-1386"><a href="#StepSizes-1386"><span class="linenos">1386</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-1387"><a href="#StepSizes-1387"><span class="linenos">1387</span></a>    <span class="k">class</span> <span class="nc">Forks</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-1388"><a href="#StepSizes-1388"><span class="linenos">1388</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes-1389"><a href="#StepSizes-1389"><span class="linenos">1389</span></a><span class="sd">        Only coords at forks, where the path has &gt;=2 options for the next step are included.</span>
</span><span id="StepSizes-1390"><a href="#StepSizes-1390"><span class="linenos">1390</span></a><span class="sd">        Excludes the option of backtracking.</span>
</span><span id="StepSizes-1391"><a href="#StepSizes-1391"><span class="linenos">1391</span></a><span class="sd">        The starting and ending coords are always included.</span>
</span><span id="StepSizes-1392"><a href="#StepSizes-1392"><span class="linenos">1392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes-1393"><a href="#StepSizes-1393"><span class="linenos">1393</span></a>
</span><span id="StepSizes-1394"><a href="#StepSizes-1394"><span class="linenos">1394</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-1395"><a href="#StepSizes-1395"><span class="linenos">1395</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1396"><a href="#StepSizes-1396"><span class="linenos">1396</span></a>            <span class="k">return</span> <span class="n">maze</span><span class="o">.</span><span class="n">get_solution_forking_points</span><span class="p">(</span><span class="n">always_include_endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes-1397"><a href="#StepSizes-1397"><span class="linenos">1397</span></a>
</span><span id="StepSizes-1398"><a href="#StepSizes-1398"><span class="linenos">1398</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes-1399"><a href="#StepSizes-1399"><span class="linenos">1399</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StepSizes-1400"><a href="#StepSizes-1400"><span class="linenos">1400</span></a>    <span class="k">class</span> <span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes-1401"><a href="#StepSizes-1401"><span class="linenos">1401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes-1402"><a href="#StepSizes-1402"><span class="linenos">1402</span></a><span class="sd">        Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="StepSizes-1403"><a href="#StepSizes-1403"><span class="linenos">1403</span></a><span class="sd">        See documentation for those classes for details.</span>
</span><span id="StepSizes-1404"><a href="#StepSizes-1404"><span class="linenos">1404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes-1405"><a href="#StepSizes-1405"><span class="linenos">1405</span></a>
</span><span id="StepSizes-1406"><a href="#StepSizes-1406"><span class="linenos">1406</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes-1407"><a href="#StepSizes-1407"><span class="linenos">1407</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes-1408"><a href="#StepSizes-1408"><span class="linenos">1408</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="StepSizes-1409"><a href="#StepSizes-1409"><span class="linenos">1409</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="StepSizes-1410"><a href="#StepSizes-1410"><span class="linenos">1410</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepSizes-1411"><a href="#StepSizes-1411"><span class="linenos">1411</span></a>                        <span class="p">(</span>
</span><span id="StepSizes-1412"><a href="#StepSizes-1412"><span class="linenos">1412</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes-1413"><a href="#StepSizes-1413"><span class="linenos">1413</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes-1414"><a href="#StepSizes-1414"><span class="linenos">1414</span></a>                        <span class="p">)</span>
</span><span id="StepSizes-1415"><a href="#StepSizes-1415"><span class="linenos">1415</span></a>                    <span class="p">)</span>
</span><span id="StepSizes-1416"><a href="#StepSizes-1416"><span class="linenos">1416</span></a>                <span class="p">)</span>
</span><span id="StepSizes-1417"><a href="#StepSizes-1417"><span class="linenos">1417</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_StepSize</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="StepSizes.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;step_size&#39;</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.key"></a>
    
    

                            </div>
                </section>
                <section id="StepSizes.Singles">
                            <input id="StepSizes.Singles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.Singles</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1354-L1363" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles-1355"><a href="#StepSizes.Singles-1355"><span class="linenos">1355</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.Singles-1356"><a href="#StepSizes.Singles-1356"><span class="linenos">1356</span></a>    <span class="k">class</span> <span class="nc">Singles</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Singles-1357"><a href="#StepSizes.Singles-1357"><span class="linenos">1357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles-1358"><a href="#StepSizes.Singles-1358"><span class="linenos">1358</span></a><span class="sd">        Every coord in `maze.solution` is represented.</span>
</span><span id="StepSizes.Singles-1359"><a href="#StepSizes.Singles-1359"><span class="linenos">1359</span></a><span class="sd">        Legacy tokenizers all use this behavior.</span>
</span><span id="StepSizes.Singles-1360"><a href="#StepSizes.Singles-1360"><span class="linenos">1360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles-1361"><a href="#StepSizes.Singles-1361"><span class="linenos">1361</span></a>
</span><span id="StepSizes.Singles-1362"><a href="#StepSizes.Singles-1362"><span class="linenos">1362</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Singles-1363"><a href="#StepSizes.Singles-1363"><span class="linenos">1363</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles-1364"><a href="#StepSizes.Singles-1364"><span class="linenos">1364</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Every coord in <code>maze.solution</code> is represented.
Legacy tokenizers all use this behavior.</p>
</div>


                            <div id="StepSizes.Singles.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.Singles</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Singles">StepSizes.Singles</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Singles">StepSizes.Singles</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.Singles.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.Singles.serialize" class="classattr">
                                        <input id="StepSizes.Singles.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles.serialize-660"><a href="#StepSizes.Singles.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.Singles.serialize-661"><a href="#StepSizes.Singles.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.Singles.serialize-662"><a href="#StepSizes.Singles.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.Singles.serialize-663"><a href="#StepSizes.Singles.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepSizes.Singles.serialize-664"><a href="#StepSizes.Singles.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.Singles.serialize-665"><a href="#StepSizes.Singles.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.Singles.serialize-666"><a href="#StepSizes.Singles.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.Singles.serialize-667"><a href="#StepSizes.Singles.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-668"><a href="#StepSizes.Singles.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-669"><a href="#StepSizes.Singles.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.Singles.serialize-670"><a href="#StepSizes.Singles.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.Singles.serialize-671"><a href="#StepSizes.Singles.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.Singles.serialize-672"><a href="#StepSizes.Singles.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-673"><a href="#StepSizes.Singles.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepSizes.Singles.serialize-674"><a href="#StepSizes.Singles.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.Singles.serialize-675"><a href="#StepSizes.Singles.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-676"><a href="#StepSizes.Singles.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-677"><a href="#StepSizes.Singles.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.Singles.serialize-678"><a href="#StepSizes.Singles.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-679"><a href="#StepSizes.Singles.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.Singles.serialize-680"><a href="#StepSizes.Singles.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-681"><a href="#StepSizes.Singles.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Singles.serialize-682"><a href="#StepSizes.Singles.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.Singles.serialize-683"><a href="#StepSizes.Singles.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-684"><a href="#StepSizes.Singles.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Singles.serialize-685"><a href="#StepSizes.Singles.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.Singles.serialize-686"><a href="#StepSizes.Singles.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.Singles.serialize-687"><a href="#StepSizes.Singles.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-688"><a href="#StepSizes.Singles.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-689"><a href="#StepSizes.Singles.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepSizes.Singles.serialize-690"><a href="#StepSizes.Singles.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.Singles.serialize-691"><a href="#StepSizes.Singles.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Singles.serialize-692"><a href="#StepSizes.Singles.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-693"><a href="#StepSizes.Singles.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-694"><a href="#StepSizes.Singles.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-695"><a href="#StepSizes.Singles.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.Singles.serialize-696"><a href="#StepSizes.Singles.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-697"><a href="#StepSizes.Singles.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-698"><a href="#StepSizes.Singles.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-699"><a href="#StepSizes.Singles.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Singles.serialize-700"><a href="#StepSizes.Singles.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.Singles.serialize-701"><a href="#StepSizes.Singles.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-702"><a href="#StepSizes.Singles.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepSizes.Singles.serialize-703"><a href="#StepSizes.Singles.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepSizes.Singles.serialize-704"><a href="#StepSizes.Singles.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.Singles.serialize-705"><a href="#StepSizes.Singles.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-706"><a href="#StepSizes.Singles.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.Singles.serialize-707"><a href="#StepSizes.Singles.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-708"><a href="#StepSizes.Singles.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Singles.serialize-709"><a href="#StepSizes.Singles.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Singles.serialize-710"><a href="#StepSizes.Singles.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.Singles.serialize-711"><a href="#StepSizes.Singles.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.serialize-712"><a href="#StepSizes.Singles.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.serialize-713"><a href="#StepSizes.Singles.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.serialize-714"><a href="#StepSizes.Singles.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Singles.serialize-715"><a href="#StepSizes.Singles.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepSizes.Singles.serialize-716"><a href="#StepSizes.Singles.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.Singles.load" class="classattr">
                                        <input id="StepSizes.Singles.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles.load-723"><a href="#StepSizes.Singles.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.Singles.load-724"><a href="#StepSizes.Singles.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.Singles.load-725"><a href="#StepSizes.Singles.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.Singles.load-726"><a href="#StepSizes.Singles.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Singles.load-727"><a href="#StepSizes.Singles.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.Singles.load-728"><a href="#StepSizes.Singles.load-728"><span class="linenos">728</span></a>
</span><span id="StepSizes.Singles.load-729"><a href="#StepSizes.Singles.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-730"><a href="#StepSizes.Singles.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.Singles.load-731"><a href="#StepSizes.Singles.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.load-732"><a href="#StepSizes.Singles.load-732"><span class="linenos">732</span></a>
</span><span id="StepSizes.Singles.load-733"><a href="#StepSizes.Singles.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-734"><a href="#StepSizes.Singles.load-734"><span class="linenos">734</span></a>
</span><span id="StepSizes.Singles.load-735"><a href="#StepSizes.Singles.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.Singles.load-736"><a href="#StepSizes.Singles.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.Singles.load-737"><a href="#StepSizes.Singles.load-737"><span class="linenos">737</span></a>
</span><span id="StepSizes.Singles.load-738"><a href="#StepSizes.Singles.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.Singles.load-739"><a href="#StepSizes.Singles.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Singles.load-740"><a href="#StepSizes.Singles.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.Singles.load-741"><a href="#StepSizes.Singles.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-742"><a href="#StepSizes.Singles.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.Singles.load-743"><a href="#StepSizes.Singles.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.Singles.load-744"><a href="#StepSizes.Singles.load-744"><span class="linenos">744</span></a>
</span><span id="StepSizes.Singles.load-745"><a href="#StepSizes.Singles.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.Singles.load-746"><a href="#StepSizes.Singles.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-747"><a href="#StepSizes.Singles.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.Singles.load-748"><a href="#StepSizes.Singles.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.Singles.load-749"><a href="#StepSizes.Singles.load-749"><span class="linenos">749</span></a>
</span><span id="StepSizes.Singles.load-750"><a href="#StepSizes.Singles.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.Singles.load-751"><a href="#StepSizes.Singles.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-752"><a href="#StepSizes.Singles.load-752"><span class="linenos">752</span></a>
</span><span id="StepSizes.Singles.load-753"><a href="#StepSizes.Singles.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.Singles.load-754"><a href="#StepSizes.Singles.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-755"><a href="#StepSizes.Singles.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.Singles.load-756"><a href="#StepSizes.Singles.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-757"><a href="#StepSizes.Singles.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-758"><a href="#StepSizes.Singles.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.Singles.load-759"><a href="#StepSizes.Singles.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-760"><a href="#StepSizes.Singles.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.Singles.load-761"><a href="#StepSizes.Singles.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.Singles.load-762"><a href="#StepSizes.Singles.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-763"><a href="#StepSizes.Singles.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-764"><a href="#StepSizes.Singles.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.Singles.load-765"><a href="#StepSizes.Singles.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.Singles.load-766"><a href="#StepSizes.Singles.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.Singles.load-767"><a href="#StepSizes.Singles.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-768"><a href="#StepSizes.Singles.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-769"><a href="#StepSizes.Singles.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.Singles.load-770"><a href="#StepSizes.Singles.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Singles.load-771"><a href="#StepSizes.Singles.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Singles.load-772"><a href="#StepSizes.Singles.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-773"><a href="#StepSizes.Singles.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.Singles.load-774"><a href="#StepSizes.Singles.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.Singles.load-775"><a href="#StepSizes.Singles.load-775"><span class="linenos">775</span></a>
</span><span id="StepSizes.Singles.load-776"><a href="#StepSizes.Singles.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.Singles.load-777"><a href="#StepSizes.Singles.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Singles.load-778"><a href="#StepSizes.Singles.load-778"><span class="linenos">778</span></a>
</span><span id="StepSizes.Singles.load-779"><a href="#StepSizes.Singles.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.Singles.load-780"><a href="#StepSizes.Singles.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-781"><a href="#StepSizes.Singles.load-781"><span class="linenos">781</span></a>
</span><span id="StepSizes.Singles.load-782"><a href="#StepSizes.Singles.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.Singles.load-783"><a href="#StepSizes.Singles.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.Singles.load-784"><a href="#StepSizes.Singles.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepSizes.Singles.load-785"><a href="#StepSizes.Singles.load-785"><span class="linenos">785</span></a>
</span><span id="StepSizes.Singles.load-786"><a href="#StepSizes.Singles.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.Singles.load-787"><a href="#StepSizes.Singles.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.Singles.validate_fields_types" class="classattr">
                                        <input id="StepSizes.Singles.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Singles.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Singles.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Singles.validate_fields_types-271"><a href="#StepSizes.Singles.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.Singles.validate_fields_types-272"><a href="#StepSizes.Singles.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.Singles.validate_fields_types-273"><a href="#StepSizes.Singles.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.Singles.validate_fields_types-274"><a href="#StepSizes.Singles.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.Singles.validate_fields_types-275"><a href="#StepSizes.Singles.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.Singles.validate_fields_types-276"><a href="#StepSizes.Singles.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.Singles.validate_fields_types-277"><a href="#StepSizes.Singles.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Singles.validate_fields_types-278"><a href="#StepSizes.Singles.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.Singles.validate_fields_types-279"><a href="#StepSizes.Singles.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.Singles.validate_fields_types-280"><a href="#StepSizes.Singles.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.Singles.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.Singles.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>
                <dd id="StepSizes.Singles.is_valid" class="function"><a href="#StepSizes._StepSize.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepSizes.Singles.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.Singles.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.Singles.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.Singles.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.Singles.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.Singles.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.Singles.diff" class="function">diff</dd>
                <dd id="StepSizes.Singles.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes.Straightaways">
                            <input id="StepSizes.Straightaways-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>
        <div class="decorator">@mark_as_unsupported(lambda self_: False)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.Straightaways</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1365-L1383" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways-1366"><a href="#StepSizes.Straightaways-1366"><span class="linenos">1366</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-1367"><a href="#StepSizes.Straightaways-1367"><span class="linenos">1367</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-1368"><a href="#StepSizes.Straightaways-1368"><span class="linenos">1368</span></a>    <span class="k">class</span> <span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways-1369"><a href="#StepSizes.Straightaways-1369"><span class="linenos">1369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways-1370"><a href="#StepSizes.Straightaways-1370"><span class="linenos">1370</span></a><span class="sd">        Only coords where the path turns are represented in the path.</span>
</span><span id="StepSizes.Straightaways-1371"><a href="#StepSizes.Straightaways-1371"><span class="linenos">1371</span></a><span class="sd">        I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="StepSizes.Straightaways-1372"><a href="#StepSizes.Straightaways-1372"><span class="linenos">1372</span></a><span class="sd">        specified by the coords at the turns.</span>
</span><span id="StepSizes.Straightaways-1373"><a href="#StepSizes.Straightaways-1373"><span class="linenos">1373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways-1374"><a href="#StepSizes.Straightaways-1374"><span class="linenos">1374</span></a>
</span><span id="StepSizes.Straightaways-1375"><a href="#StepSizes.Straightaways-1375"><span class="linenos">1375</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways-1376"><a href="#StepSizes.Straightaways-1376"><span class="linenos">1376</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways-1377"><a href="#StepSizes.Straightaways-1377"><span class="linenos">1377</span></a>            <span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways-1378"><a href="#StepSizes.Straightaways-1378"><span class="linenos">1378</span></a>            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways-1379"><a href="#StepSizes.Straightaways-1379"><span class="linenos">1379</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways-1380"><a href="#StepSizes.Straightaways-1380"><span class="linenos">1380</span></a>                <span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways-1381"><a href="#StepSizes.Straightaways-1381"><span class="linenos">1381</span></a>                    <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-1382"><a href="#StepSizes.Straightaways-1382"><span class="linenos">1382</span></a>                    <span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways-1383"><a href="#StepSizes.Straightaways-1383"><span class="linenos">1383</span></a>            <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways-1384"><a href="#StepSizes.Straightaways-1384"><span class="linenos">1384</span></a>            <span class="k">return</span> <span class="n">indices</span>
</span></pre></div>


            <div class="docstring"><p>Only coords where the path turns are represented in the path.
I.e., the path is represented as a sequence of straightaways,
specified by the coords at the turns.</p>
</div>


                            <div id="StepSizes.Straightaways.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.Straightaways</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Straightaways">StepSizes.Straightaways</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Straightaways">StepSizes.Straightaways</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.Straightaways.is_valid" class="classattr">
                                        <input id="StepSizes.Straightaways.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">self_</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1366-L1383" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.is_valid-1367"><a href="#StepSizes.Straightaways.is_valid-1367"><span class="linenos">1367</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.is_valid-1368"><a href="#StepSizes.Straightaways.is_valid-1368"><span class="linenos">1368</span></a>    <span class="k">class</span> <span class="nc">Straightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.is_valid-1369"><a href="#StepSizes.Straightaways.is_valid-1369"><span class="linenos">1369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways.is_valid-1370"><a href="#StepSizes.Straightaways.is_valid-1370"><span class="linenos">1370</span></a><span class="sd">        Only coords where the path turns are represented in the path.</span>
</span><span id="StepSizes.Straightaways.is_valid-1371"><a href="#StepSizes.Straightaways.is_valid-1371"><span class="linenos">1371</span></a><span class="sd">        I.e., the path is represented as a sequence of straightaways,</span>
</span><span id="StepSizes.Straightaways.is_valid-1372"><a href="#StepSizes.Straightaways.is_valid-1372"><span class="linenos">1372</span></a><span class="sd">        specified by the coords at the turns.</span>
</span><span id="StepSizes.Straightaways.is_valid-1373"><a href="#StepSizes.Straightaways.is_valid-1373"><span class="linenos">1373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways.is_valid-1374"><a href="#StepSizes.Straightaways.is_valid-1374"><span class="linenos">1374</span></a>
</span><span id="StepSizes.Straightaways.is_valid-1375"><a href="#StepSizes.Straightaways.is_valid-1375"><span class="linenos">1375</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways.is_valid-1376"><a href="#StepSizes.Straightaways.is_valid-1376"><span class="linenos">1376</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways.is_valid-1377"><a href="#StepSizes.Straightaways.is_valid-1377"><span class="linenos">1377</span></a>            <span class="n">last_turn_coord</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways.is_valid-1378"><a href="#StepSizes.Straightaways.is_valid-1378"><span class="linenos">1378</span></a>            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways.is_valid-1379"><a href="#StepSizes.Straightaways.is_valid-1379"><span class="linenos">1379</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.is_valid-1380"><a href="#StepSizes.Straightaways.is_valid-1380"><span class="linenos">1380</span></a>                <span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">last_turn_coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways.is_valid-1381"><a href="#StepSizes.Straightaways.is_valid-1381"><span class="linenos">1381</span></a>                    <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.is_valid-1382"><a href="#StepSizes.Straightaways.is_valid-1382"><span class="linenos">1382</span></a>                    <span class="n">last_turn_coord</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways.is_valid-1383"><a href="#StepSizes.Straightaways.is_valid-1383"><span class="linenos">1383</span></a>            <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.is_valid-1384"><a href="#StepSizes.Straightaways.is_valid-1384"><span class="linenos">1384</span></a>            <span class="k">return</span> <span class="n">indices</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.
Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#StepSizes.Straightaways.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#StepSizes.Straightaways.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#StepSizes.Straightaways.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code><a href="#MazeTokenizerModular.is_valid">MazeTokenizerModular.is_valid</a></code> calls <code><a href="#StepSizes.Straightaways.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="StepSizes.Straightaways.serialize" class="classattr">
                                        <input id="StepSizes.Straightaways.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.serialize-660"><a href="#StepSizes.Straightaways.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways.serialize-661"><a href="#StepSizes.Straightaways.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.Straightaways.serialize-662"><a href="#StepSizes.Straightaways.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-663"><a href="#StepSizes.Straightaways.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepSizes.Straightaways.serialize-664"><a href="#StepSizes.Straightaways.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.Straightaways.serialize-665"><a href="#StepSizes.Straightaways.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.Straightaways.serialize-666"><a href="#StepSizes.Straightaways.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.Straightaways.serialize-667"><a href="#StepSizes.Straightaways.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-668"><a href="#StepSizes.Straightaways.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-669"><a href="#StepSizes.Straightaways.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.Straightaways.serialize-670"><a href="#StepSizes.Straightaways.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.Straightaways.serialize-671"><a href="#StepSizes.Straightaways.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-672"><a href="#StepSizes.Straightaways.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-673"><a href="#StepSizes.Straightaways.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepSizes.Straightaways.serialize-674"><a href="#StepSizes.Straightaways.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.Straightaways.serialize-675"><a href="#StepSizes.Straightaways.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-676"><a href="#StepSizes.Straightaways.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-677"><a href="#StepSizes.Straightaways.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.Straightaways.serialize-678"><a href="#StepSizes.Straightaways.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-679"><a href="#StepSizes.Straightaways.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.Straightaways.serialize-680"><a href="#StepSizes.Straightaways.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-681"><a href="#StepSizes.Straightaways.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.serialize-682"><a href="#StepSizes.Straightaways.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.Straightaways.serialize-683"><a href="#StepSizes.Straightaways.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-684"><a href="#StepSizes.Straightaways.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.serialize-685"><a href="#StepSizes.Straightaways.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.Straightaways.serialize-686"><a href="#StepSizes.Straightaways.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.Straightaways.serialize-687"><a href="#StepSizes.Straightaways.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-688"><a href="#StepSizes.Straightaways.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-689"><a href="#StepSizes.Straightaways.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepSizes.Straightaways.serialize-690"><a href="#StepSizes.Straightaways.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.Straightaways.serialize-691"><a href="#StepSizes.Straightaways.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Straightaways.serialize-692"><a href="#StepSizes.Straightaways.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-693"><a href="#StepSizes.Straightaways.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-694"><a href="#StepSizes.Straightaways.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-695"><a href="#StepSizes.Straightaways.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.Straightaways.serialize-696"><a href="#StepSizes.Straightaways.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-697"><a href="#StepSizes.Straightaways.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-698"><a href="#StepSizes.Straightaways.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-699"><a href="#StepSizes.Straightaways.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.serialize-700"><a href="#StepSizes.Straightaways.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.Straightaways.serialize-701"><a href="#StepSizes.Straightaways.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-702"><a href="#StepSizes.Straightaways.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepSizes.Straightaways.serialize-703"><a href="#StepSizes.Straightaways.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepSizes.Straightaways.serialize-704"><a href="#StepSizes.Straightaways.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.Straightaways.serialize-705"><a href="#StepSizes.Straightaways.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-706"><a href="#StepSizes.Straightaways.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.serialize-707"><a href="#StepSizes.Straightaways.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-708"><a href="#StepSizes.Straightaways.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Straightaways.serialize-709"><a href="#StepSizes.Straightaways.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.serialize-710"><a href="#StepSizes.Straightaways.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.serialize-711"><a href="#StepSizes.Straightaways.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-712"><a href="#StepSizes.Straightaways.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-713"><a href="#StepSizes.Straightaways.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.serialize-714"><a href="#StepSizes.Straightaways.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Straightaways.serialize-715"><a href="#StepSizes.Straightaways.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepSizes.Straightaways.serialize-716"><a href="#StepSizes.Straightaways.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.Straightaways.load" class="classattr">
                                        <input id="StepSizes.Straightaways.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.load-723"><a href="#StepSizes.Straightaways.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.Straightaways.load-724"><a href="#StepSizes.Straightaways.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.Straightaways.load-725"><a href="#StepSizes.Straightaways.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.Straightaways.load-726"><a href="#StepSizes.Straightaways.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-727"><a href="#StepSizes.Straightaways.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.Straightaways.load-728"><a href="#StepSizes.Straightaways.load-728"><span class="linenos">728</span></a>
</span><span id="StepSizes.Straightaways.load-729"><a href="#StepSizes.Straightaways.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-730"><a href="#StepSizes.Straightaways.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.Straightaways.load-731"><a href="#StepSizes.Straightaways.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.load-732"><a href="#StepSizes.Straightaways.load-732"><span class="linenos">732</span></a>
</span><span id="StepSizes.Straightaways.load-733"><a href="#StepSizes.Straightaways.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-734"><a href="#StepSizes.Straightaways.load-734"><span class="linenos">734</span></a>
</span><span id="StepSizes.Straightaways.load-735"><a href="#StepSizes.Straightaways.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.Straightaways.load-736"><a href="#StepSizes.Straightaways.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.load-737"><a href="#StepSizes.Straightaways.load-737"><span class="linenos">737</span></a>
</span><span id="StepSizes.Straightaways.load-738"><a href="#StepSizes.Straightaways.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.Straightaways.load-739"><a href="#StepSizes.Straightaways.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-740"><a href="#StepSizes.Straightaways.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.Straightaways.load-741"><a href="#StepSizes.Straightaways.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-742"><a href="#StepSizes.Straightaways.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.Straightaways.load-743"><a href="#StepSizes.Straightaways.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.Straightaways.load-744"><a href="#StepSizes.Straightaways.load-744"><span class="linenos">744</span></a>
</span><span id="StepSizes.Straightaways.load-745"><a href="#StepSizes.Straightaways.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.Straightaways.load-746"><a href="#StepSizes.Straightaways.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-747"><a href="#StepSizes.Straightaways.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.Straightaways.load-748"><a href="#StepSizes.Straightaways.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.Straightaways.load-749"><a href="#StepSizes.Straightaways.load-749"><span class="linenos">749</span></a>
</span><span id="StepSizes.Straightaways.load-750"><a href="#StepSizes.Straightaways.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.Straightaways.load-751"><a href="#StepSizes.Straightaways.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-752"><a href="#StepSizes.Straightaways.load-752"><span class="linenos">752</span></a>
</span><span id="StepSizes.Straightaways.load-753"><a href="#StepSizes.Straightaways.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.Straightaways.load-754"><a href="#StepSizes.Straightaways.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-755"><a href="#StepSizes.Straightaways.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.Straightaways.load-756"><a href="#StepSizes.Straightaways.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-757"><a href="#StepSizes.Straightaways.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-758"><a href="#StepSizes.Straightaways.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.Straightaways.load-759"><a href="#StepSizes.Straightaways.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-760"><a href="#StepSizes.Straightaways.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-761"><a href="#StepSizes.Straightaways.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.Straightaways.load-762"><a href="#StepSizes.Straightaways.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-763"><a href="#StepSizes.Straightaways.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-764"><a href="#StepSizes.Straightaways.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-765"><a href="#StepSizes.Straightaways.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.Straightaways.load-766"><a href="#StepSizes.Straightaways.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.Straightaways.load-767"><a href="#StepSizes.Straightaways.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-768"><a href="#StepSizes.Straightaways.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-769"><a href="#StepSizes.Straightaways.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.load-770"><a href="#StepSizes.Straightaways.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Straightaways.load-771"><a href="#StepSizes.Straightaways.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-772"><a href="#StepSizes.Straightaways.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-773"><a href="#StepSizes.Straightaways.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.Straightaways.load-774"><a href="#StepSizes.Straightaways.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.Straightaways.load-775"><a href="#StepSizes.Straightaways.load-775"><span class="linenos">775</span></a>
</span><span id="StepSizes.Straightaways.load-776"><a href="#StepSizes.Straightaways.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.Straightaways.load-777"><a href="#StepSizes.Straightaways.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Straightaways.load-778"><a href="#StepSizes.Straightaways.load-778"><span class="linenos">778</span></a>
</span><span id="StepSizes.Straightaways.load-779"><a href="#StepSizes.Straightaways.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.Straightaways.load-780"><a href="#StepSizes.Straightaways.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-781"><a href="#StepSizes.Straightaways.load-781"><span class="linenos">781</span></a>
</span><span id="StepSizes.Straightaways.load-782"><a href="#StepSizes.Straightaways.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.Straightaways.load-783"><a href="#StepSizes.Straightaways.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.load-784"><a href="#StepSizes.Straightaways.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepSizes.Straightaways.load-785"><a href="#StepSizes.Straightaways.load-785"><span class="linenos">785</span></a>
</span><span id="StepSizes.Straightaways.load-786"><a href="#StepSizes.Straightaways.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.Straightaways.load-787"><a href="#StepSizes.Straightaways.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.Straightaways.validate_fields_types" class="classattr">
                                        <input id="StepSizes.Straightaways.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Straightaways.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Straightaways.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Straightaways.validate_fields_types-271"><a href="#StepSizes.Straightaways.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-272"><a href="#StepSizes.Straightaways.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-273"><a href="#StepSizes.Straightaways.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-274"><a href="#StepSizes.Straightaways.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-275"><a href="#StepSizes.Straightaways.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-276"><a href="#StepSizes.Straightaways.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-277"><a href="#StepSizes.Straightaways.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-278"><a href="#StepSizes.Straightaways.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-279"><a href="#StepSizes.Straightaways.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.Straightaways.validate_fields_types-280"><a href="#StepSizes.Straightaways.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.Straightaways.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.Straightaways.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepSizes.Straightaways.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.Straightaways.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.Straightaways.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.Straightaways.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.Straightaways.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.Straightaways.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.Straightaways.diff" class="function">diff</dd>
                <dd id="StepSizes.Straightaways.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes.Forks">
                            <input id="StepSizes.Forks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.Forks</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1385-L1395" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks-1386"><a href="#StepSizes.Forks-1386"><span class="linenos">1386</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.Forks-1387"><a href="#StepSizes.Forks-1387"><span class="linenos">1387</span></a>    <span class="k">class</span> <span class="nc">Forks</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.Forks-1388"><a href="#StepSizes.Forks-1388"><span class="linenos">1388</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks-1389"><a href="#StepSizes.Forks-1389"><span class="linenos">1389</span></a><span class="sd">        Only coords at forks, where the path has &gt;=2 options for the next step are included.</span>
</span><span id="StepSizes.Forks-1390"><a href="#StepSizes.Forks-1390"><span class="linenos">1390</span></a><span class="sd">        Excludes the option of backtracking.</span>
</span><span id="StepSizes.Forks-1391"><a href="#StepSizes.Forks-1391"><span class="linenos">1391</span></a><span class="sd">        The starting and ending coords are always included.</span>
</span><span id="StepSizes.Forks-1392"><a href="#StepSizes.Forks-1392"><span class="linenos">1392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks-1393"><a href="#StepSizes.Forks-1393"><span class="linenos">1393</span></a>
</span><span id="StepSizes.Forks-1394"><a href="#StepSizes.Forks-1394"><span class="linenos">1394</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.Forks-1395"><a href="#StepSizes.Forks-1395"><span class="linenos">1395</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks-1396"><a href="#StepSizes.Forks-1396"><span class="linenos">1396</span></a>            <span class="k">return</span> <span class="n">maze</span><span class="o">.</span><span class="n">get_solution_forking_points</span><span class="p">(</span><span class="n">always_include_endpoints</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Only coords at forks, where the path has &gt;=2 options for the next step are included.
Excludes the option of backtracking.
The starting and ending coords are always included.</p>
</div>


                            <div id="StepSizes.Forks.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.Forks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Forks">StepSizes.Forks</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.Forks">StepSizes.Forks</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.Forks.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.Forks.serialize" class="classattr">
                                        <input id="StepSizes.Forks.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks.serialize-660"><a href="#StepSizes.Forks.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.Forks.serialize-661"><a href="#StepSizes.Forks.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.Forks.serialize-662"><a href="#StepSizes.Forks.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.Forks.serialize-663"><a href="#StepSizes.Forks.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepSizes.Forks.serialize-664"><a href="#StepSizes.Forks.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.Forks.serialize-665"><a href="#StepSizes.Forks.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.Forks.serialize-666"><a href="#StepSizes.Forks.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.Forks.serialize-667"><a href="#StepSizes.Forks.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-668"><a href="#StepSizes.Forks.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-669"><a href="#StepSizes.Forks.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.Forks.serialize-670"><a href="#StepSizes.Forks.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.Forks.serialize-671"><a href="#StepSizes.Forks.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.Forks.serialize-672"><a href="#StepSizes.Forks.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-673"><a href="#StepSizes.Forks.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepSizes.Forks.serialize-674"><a href="#StepSizes.Forks.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.Forks.serialize-675"><a href="#StepSizes.Forks.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-676"><a href="#StepSizes.Forks.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-677"><a href="#StepSizes.Forks.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.Forks.serialize-678"><a href="#StepSizes.Forks.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-679"><a href="#StepSizes.Forks.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.Forks.serialize-680"><a href="#StepSizes.Forks.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-681"><a href="#StepSizes.Forks.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Forks.serialize-682"><a href="#StepSizes.Forks.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.Forks.serialize-683"><a href="#StepSizes.Forks.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-684"><a href="#StepSizes.Forks.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.Forks.serialize-685"><a href="#StepSizes.Forks.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.Forks.serialize-686"><a href="#StepSizes.Forks.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.Forks.serialize-687"><a href="#StepSizes.Forks.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-688"><a href="#StepSizes.Forks.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-689"><a href="#StepSizes.Forks.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepSizes.Forks.serialize-690"><a href="#StepSizes.Forks.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.Forks.serialize-691"><a href="#StepSizes.Forks.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Forks.serialize-692"><a href="#StepSizes.Forks.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-693"><a href="#StepSizes.Forks.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-694"><a href="#StepSizes.Forks.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-695"><a href="#StepSizes.Forks.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.Forks.serialize-696"><a href="#StepSizes.Forks.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-697"><a href="#StepSizes.Forks.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-698"><a href="#StepSizes.Forks.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-699"><a href="#StepSizes.Forks.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.Forks.serialize-700"><a href="#StepSizes.Forks.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.Forks.serialize-701"><a href="#StepSizes.Forks.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-702"><a href="#StepSizes.Forks.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepSizes.Forks.serialize-703"><a href="#StepSizes.Forks.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepSizes.Forks.serialize-704"><a href="#StepSizes.Forks.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.Forks.serialize-705"><a href="#StepSizes.Forks.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-706"><a href="#StepSizes.Forks.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.Forks.serialize-707"><a href="#StepSizes.Forks.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-708"><a href="#StepSizes.Forks.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Forks.serialize-709"><a href="#StepSizes.Forks.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Forks.serialize-710"><a href="#StepSizes.Forks.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.Forks.serialize-711"><a href="#StepSizes.Forks.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.serialize-712"><a href="#StepSizes.Forks.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.serialize-713"><a href="#StepSizes.Forks.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.serialize-714"><a href="#StepSizes.Forks.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.Forks.serialize-715"><a href="#StepSizes.Forks.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepSizes.Forks.serialize-716"><a href="#StepSizes.Forks.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.Forks.load" class="classattr">
                                        <input id="StepSizes.Forks.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks.load-723"><a href="#StepSizes.Forks.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.Forks.load-724"><a href="#StepSizes.Forks.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.Forks.load-725"><a href="#StepSizes.Forks.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.Forks.load-726"><a href="#StepSizes.Forks.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Forks.load-727"><a href="#StepSizes.Forks.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.Forks.load-728"><a href="#StepSizes.Forks.load-728"><span class="linenos">728</span></a>
</span><span id="StepSizes.Forks.load-729"><a href="#StepSizes.Forks.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-730"><a href="#StepSizes.Forks.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.Forks.load-731"><a href="#StepSizes.Forks.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.load-732"><a href="#StepSizes.Forks.load-732"><span class="linenos">732</span></a>
</span><span id="StepSizes.Forks.load-733"><a href="#StepSizes.Forks.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-734"><a href="#StepSizes.Forks.load-734"><span class="linenos">734</span></a>
</span><span id="StepSizes.Forks.load-735"><a href="#StepSizes.Forks.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.Forks.load-736"><a href="#StepSizes.Forks.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.Forks.load-737"><a href="#StepSizes.Forks.load-737"><span class="linenos">737</span></a>
</span><span id="StepSizes.Forks.load-738"><a href="#StepSizes.Forks.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.Forks.load-739"><a href="#StepSizes.Forks.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.Forks.load-740"><a href="#StepSizes.Forks.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.Forks.load-741"><a href="#StepSizes.Forks.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-742"><a href="#StepSizes.Forks.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.Forks.load-743"><a href="#StepSizes.Forks.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.Forks.load-744"><a href="#StepSizes.Forks.load-744"><span class="linenos">744</span></a>
</span><span id="StepSizes.Forks.load-745"><a href="#StepSizes.Forks.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.Forks.load-746"><a href="#StepSizes.Forks.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-747"><a href="#StepSizes.Forks.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.Forks.load-748"><a href="#StepSizes.Forks.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.Forks.load-749"><a href="#StepSizes.Forks.load-749"><span class="linenos">749</span></a>
</span><span id="StepSizes.Forks.load-750"><a href="#StepSizes.Forks.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.Forks.load-751"><a href="#StepSizes.Forks.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-752"><a href="#StepSizes.Forks.load-752"><span class="linenos">752</span></a>
</span><span id="StepSizes.Forks.load-753"><a href="#StepSizes.Forks.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.Forks.load-754"><a href="#StepSizes.Forks.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-755"><a href="#StepSizes.Forks.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.Forks.load-756"><a href="#StepSizes.Forks.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-757"><a href="#StepSizes.Forks.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-758"><a href="#StepSizes.Forks.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.Forks.load-759"><a href="#StepSizes.Forks.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-760"><a href="#StepSizes.Forks.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.Forks.load-761"><a href="#StepSizes.Forks.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.Forks.load-762"><a href="#StepSizes.Forks.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-763"><a href="#StepSizes.Forks.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-764"><a href="#StepSizes.Forks.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.Forks.load-765"><a href="#StepSizes.Forks.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.Forks.load-766"><a href="#StepSizes.Forks.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.Forks.load-767"><a href="#StepSizes.Forks.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-768"><a href="#StepSizes.Forks.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-769"><a href="#StepSizes.Forks.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.Forks.load-770"><a href="#StepSizes.Forks.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.Forks.load-771"><a href="#StepSizes.Forks.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.Forks.load-772"><a href="#StepSizes.Forks.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-773"><a href="#StepSizes.Forks.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.Forks.load-774"><a href="#StepSizes.Forks.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.Forks.load-775"><a href="#StepSizes.Forks.load-775"><span class="linenos">775</span></a>
</span><span id="StepSizes.Forks.load-776"><a href="#StepSizes.Forks.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.Forks.load-777"><a href="#StepSizes.Forks.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.Forks.load-778"><a href="#StepSizes.Forks.load-778"><span class="linenos">778</span></a>
</span><span id="StepSizes.Forks.load-779"><a href="#StepSizes.Forks.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.Forks.load-780"><a href="#StepSizes.Forks.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-781"><a href="#StepSizes.Forks.load-781"><span class="linenos">781</span></a>
</span><span id="StepSizes.Forks.load-782"><a href="#StepSizes.Forks.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.Forks.load-783"><a href="#StepSizes.Forks.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.Forks.load-784"><a href="#StepSizes.Forks.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepSizes.Forks.load-785"><a href="#StepSizes.Forks.load-785"><span class="linenos">785</span></a>
</span><span id="StepSizes.Forks.load-786"><a href="#StepSizes.Forks.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.Forks.load-787"><a href="#StepSizes.Forks.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.Forks.validate_fields_types" class="classattr">
                                        <input id="StepSizes.Forks.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.Forks.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.Forks.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.Forks.validate_fields_types-271"><a href="#StepSizes.Forks.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.Forks.validate_fields_types-272"><a href="#StepSizes.Forks.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.Forks.validate_fields_types-273"><a href="#StepSizes.Forks.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.Forks.validate_fields_types-274"><a href="#StepSizes.Forks.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.Forks.validate_fields_types-275"><a href="#StepSizes.Forks.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.Forks.validate_fields_types-276"><a href="#StepSizes.Forks.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.Forks.validate_fields_types-277"><a href="#StepSizes.Forks.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.Forks.validate_fields_types-278"><a href="#StepSizes.Forks.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.Forks.validate_fields_types-279"><a href="#StepSizes.Forks.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.Forks.validate_fields_types-280"><a href="#StepSizes.Forks.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.Forks.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.Forks.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>
                <dd id="StepSizes.Forks.is_valid" class="function"><a href="#StepSizes._StepSize.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepSizes.Forks.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.Forks.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.Forks.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.Forks.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.Forks.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.Forks.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.Forks.diff" class="function">diff</dd>
                <dd id="StepSizes.Forks.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepSizes.ForksAndStraightaways">
                            <input id="StepSizes.ForksAndStraightaways-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>
        <div class="decorator">@mark_as_unsupported(lambda self_: False)</div>

    <span class="def">class</span>
    <span class="name">StepSizes.ForksAndStraightaways</span><wbr>(<span class="base"><a href="#StepSizes._StepSize">StepSizes._StepSize</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1397-L1416" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways-1398"><a href="#StepSizes.ForksAndStraightaways-1398"><span class="linenos">1398</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-1399"><a href="#StepSizes.ForksAndStraightaways-1399"><span class="linenos">1399</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-1400"><a href="#StepSizes.ForksAndStraightaways-1400"><span class="linenos">1400</span></a>    <span class="k">class</span> <span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways-1401"><a href="#StepSizes.ForksAndStraightaways-1401"><span class="linenos">1401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways-1402"><a href="#StepSizes.ForksAndStraightaways-1402"><span class="linenos">1402</span></a><span class="sd">        Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="StepSizes.ForksAndStraightaways-1403"><a href="#StepSizes.ForksAndStraightaways-1403"><span class="linenos">1403</span></a><span class="sd">        See documentation for those classes for details.</span>
</span><span id="StepSizes.ForksAndStraightaways-1404"><a href="#StepSizes.ForksAndStraightaways-1404"><span class="linenos">1404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways-1405"><a href="#StepSizes.ForksAndStraightaways-1405"><span class="linenos">1405</span></a>
</span><span id="StepSizes.ForksAndStraightaways-1406"><a href="#StepSizes.ForksAndStraightaways-1406"><span class="linenos">1406</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways-1407"><a href="#StepSizes.ForksAndStraightaways-1407"><span class="linenos">1407</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways-1408"><a href="#StepSizes.ForksAndStraightaways-1408"><span class="linenos">1408</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-1409"><a href="#StepSizes.ForksAndStraightaways-1409"><span class="linenos">1409</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-1410"><a href="#StepSizes.ForksAndStraightaways-1410"><span class="linenos">1410</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-1411"><a href="#StepSizes.ForksAndStraightaways-1411"><span class="linenos">1411</span></a>                        <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways-1412"><a href="#StepSizes.ForksAndStraightaways-1412"><span class="linenos">1412</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-1413"><a href="#StepSizes.ForksAndStraightaways-1413"><span class="linenos">1413</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways-1414"><a href="#StepSizes.ForksAndStraightaways-1414"><span class="linenos">1414</span></a>                        <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-1415"><a href="#StepSizes.ForksAndStraightaways-1415"><span class="linenos">1415</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-1416"><a href="#StepSizes.ForksAndStraightaways-1416"><span class="linenos">1416</span></a>                <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways-1417"><a href="#StepSizes.ForksAndStraightaways-1417"><span class="linenos">1417</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Includes the union of the coords included by <code><a href="#StepSizes.Forks">Forks</a></code> and <code><a href="#StepSizes.Straightaways">Straightaways</a></code>.
See documentation for those classes for details.</p>
</div>


                            <div id="StepSizes.ForksAndStraightaways.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepSizes.ForksAndStraightaways</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.ForksAndStraightaways">StepSizes.ForksAndStraightaways</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepSizes.ForksAndStraightaways">StepSizes.ForksAndStraightaways</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.__init__"></a>
    
    

                            </div>
                            <div id="StepSizes.ForksAndStraightaways.is_valid" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">self_</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1398-L1416" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.is_valid-1399"><a href="#StepSizes.ForksAndStraightaways.is_valid-1399"><span class="linenos">1399</span></a>    <span class="nd">@mark_as_unsupported</span><span class="p">(</span><span class="k">lambda</span> <span class="n">self_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1400"><a href="#StepSizes.ForksAndStraightaways.is_valid-1400"><span class="linenos">1400</span></a>    <span class="k">class</span> <span class="nc">ForksAndStraightaways</span><span class="p">(</span><span class="n">_StepSize</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1401"><a href="#StepSizes.ForksAndStraightaways.is_valid-1401"><span class="linenos">1401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1402"><a href="#StepSizes.ForksAndStraightaways.is_valid-1402"><span class="linenos">1402</span></a><span class="sd">        Includes the union of the coords included by `Forks` and `Straightaways`.</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1403"><a href="#StepSizes.ForksAndStraightaways.is_valid-1403"><span class="linenos">1403</span></a><span class="sd">        See documentation for those classes for details.</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1404"><a href="#StepSizes.ForksAndStraightaways.is_valid-1404"><span class="linenos">1404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1405"><a href="#StepSizes.ForksAndStraightaways.is_valid-1405"><span class="linenos">1405</span></a>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1406"><a href="#StepSizes.ForksAndStraightaways.is_valid-1406"><span class="linenos">1406</span></a>        <span class="k">def</span> <span class="nf">_step_single_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1407"><a href="#StepSizes.ForksAndStraightaways.is_valid-1407"><span class="linenos">1407</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the indices of `maze.solution` corresponding to the steps to be tokenized.&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1408"><a href="#StepSizes.ForksAndStraightaways.is_valid-1408"><span class="linenos">1408</span></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1409"><a href="#StepSizes.ForksAndStraightaways.is_valid-1409"><span class="linenos">1409</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1410"><a href="#StepSizes.ForksAndStraightaways.is_valid-1410"><span class="linenos">1410</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1411"><a href="#StepSizes.ForksAndStraightaways.is_valid-1411"><span class="linenos">1411</span></a>                        <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1412"><a href="#StepSizes.ForksAndStraightaways.is_valid-1412"><span class="linenos">1412</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Straightaways</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1413"><a href="#StepSizes.ForksAndStraightaways.is_valid-1413"><span class="linenos">1413</span></a>                            <span class="n">StepSizes</span><span class="o">.</span><span class="n">Forks</span><span class="p">()</span><span class="o">.</span><span class="n">_step_single_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">),</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1414"><a href="#StepSizes.ForksAndStraightaways.is_valid-1414"><span class="linenos">1414</span></a>                        <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1415"><a href="#StepSizes.ForksAndStraightaways.is_valid-1415"><span class="linenos">1415</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1416"><a href="#StepSizes.ForksAndStraightaways.is_valid-1416"><span class="linenos">1416</span></a>                <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.is_valid-1417"><a href="#StepSizes.ForksAndStraightaways.is_valid-1417"><span class="linenos">1417</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.
Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code><a href="#MazeTokenizerModular.is_valid">MazeTokenizerModular.is_valid</a></code> calls <code><a href="#StepSizes.ForksAndStraightaways.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="StepSizes.ForksAndStraightaways.serialize" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.serialize-660"><a href="#StepSizes.ForksAndStraightaways.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-661"><a href="#StepSizes.ForksAndStraightaways.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-662"><a href="#StepSizes.ForksAndStraightaways.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-663"><a href="#StepSizes.ForksAndStraightaways.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-664"><a href="#StepSizes.ForksAndStraightaways.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-665"><a href="#StepSizes.ForksAndStraightaways.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-666"><a href="#StepSizes.ForksAndStraightaways.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-667"><a href="#StepSizes.ForksAndStraightaways.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-668"><a href="#StepSizes.ForksAndStraightaways.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-669"><a href="#StepSizes.ForksAndStraightaways.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-670"><a href="#StepSizes.ForksAndStraightaways.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-671"><a href="#StepSizes.ForksAndStraightaways.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-672"><a href="#StepSizes.ForksAndStraightaways.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-673"><a href="#StepSizes.ForksAndStraightaways.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-674"><a href="#StepSizes.ForksAndStraightaways.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-675"><a href="#StepSizes.ForksAndStraightaways.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-676"><a href="#StepSizes.ForksAndStraightaways.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-677"><a href="#StepSizes.ForksAndStraightaways.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-678"><a href="#StepSizes.ForksAndStraightaways.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-679"><a href="#StepSizes.ForksAndStraightaways.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-680"><a href="#StepSizes.ForksAndStraightaways.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-681"><a href="#StepSizes.ForksAndStraightaways.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-682"><a href="#StepSizes.ForksAndStraightaways.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-683"><a href="#StepSizes.ForksAndStraightaways.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-684"><a href="#StepSizes.ForksAndStraightaways.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-685"><a href="#StepSizes.ForksAndStraightaways.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-686"><a href="#StepSizes.ForksAndStraightaways.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-687"><a href="#StepSizes.ForksAndStraightaways.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-688"><a href="#StepSizes.ForksAndStraightaways.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-689"><a href="#StepSizes.ForksAndStraightaways.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-690"><a href="#StepSizes.ForksAndStraightaways.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-691"><a href="#StepSizes.ForksAndStraightaways.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-692"><a href="#StepSizes.ForksAndStraightaways.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-693"><a href="#StepSizes.ForksAndStraightaways.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-694"><a href="#StepSizes.ForksAndStraightaways.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-695"><a href="#StepSizes.ForksAndStraightaways.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-696"><a href="#StepSizes.ForksAndStraightaways.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-697"><a href="#StepSizes.ForksAndStraightaways.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-698"><a href="#StepSizes.ForksAndStraightaways.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-699"><a href="#StepSizes.ForksAndStraightaways.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-700"><a href="#StepSizes.ForksAndStraightaways.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-701"><a href="#StepSizes.ForksAndStraightaways.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-702"><a href="#StepSizes.ForksAndStraightaways.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-703"><a href="#StepSizes.ForksAndStraightaways.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-704"><a href="#StepSizes.ForksAndStraightaways.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-705"><a href="#StepSizes.ForksAndStraightaways.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-706"><a href="#StepSizes.ForksAndStraightaways.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-707"><a href="#StepSizes.ForksAndStraightaways.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-708"><a href="#StepSizes.ForksAndStraightaways.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-709"><a href="#StepSizes.ForksAndStraightaways.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-710"><a href="#StepSizes.ForksAndStraightaways.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-711"><a href="#StepSizes.ForksAndStraightaways.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-712"><a href="#StepSizes.ForksAndStraightaways.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-713"><a href="#StepSizes.ForksAndStraightaways.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-714"><a href="#StepSizes.ForksAndStraightaways.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.serialize-715"><a href="#StepSizes.ForksAndStraightaways.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepSizes.ForksAndStraightaways.serialize-716"><a href="#StepSizes.ForksAndStraightaways.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.ForksAndStraightaways.load" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.load-723"><a href="#StepSizes.ForksAndStraightaways.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepSizes.ForksAndStraightaways.load-724"><a href="#StepSizes.ForksAndStraightaways.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-725"><a href="#StepSizes.ForksAndStraightaways.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepSizes.ForksAndStraightaways.load-726"><a href="#StepSizes.ForksAndStraightaways.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-727"><a href="#StepSizes.ForksAndStraightaways.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepSizes.ForksAndStraightaways.load-728"><a href="#StepSizes.ForksAndStraightaways.load-728"><span class="linenos">728</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-729"><a href="#StepSizes.ForksAndStraightaways.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-730"><a href="#StepSizes.ForksAndStraightaways.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepSizes.ForksAndStraightaways.load-731"><a href="#StepSizes.ForksAndStraightaways.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-732"><a href="#StepSizes.ForksAndStraightaways.load-732"><span class="linenos">732</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-733"><a href="#StepSizes.ForksAndStraightaways.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-734"><a href="#StepSizes.ForksAndStraightaways.load-734"><span class="linenos">734</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-735"><a href="#StepSizes.ForksAndStraightaways.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepSizes.ForksAndStraightaways.load-736"><a href="#StepSizes.ForksAndStraightaways.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.load-737"><a href="#StepSizes.ForksAndStraightaways.load-737"><span class="linenos">737</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-738"><a href="#StepSizes.ForksAndStraightaways.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepSizes.ForksAndStraightaways.load-739"><a href="#StepSizes.ForksAndStraightaways.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-740"><a href="#StepSizes.ForksAndStraightaways.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepSizes.ForksAndStraightaways.load-741"><a href="#StepSizes.ForksAndStraightaways.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-742"><a href="#StepSizes.ForksAndStraightaways.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepSizes.ForksAndStraightaways.load-743"><a href="#StepSizes.ForksAndStraightaways.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-744"><a href="#StepSizes.ForksAndStraightaways.load-744"><span class="linenos">744</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-745"><a href="#StepSizes.ForksAndStraightaways.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepSizes.ForksAndStraightaways.load-746"><a href="#StepSizes.ForksAndStraightaways.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-747"><a href="#StepSizes.ForksAndStraightaways.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepSizes.ForksAndStraightaways.load-748"><a href="#StepSizes.ForksAndStraightaways.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepSizes.ForksAndStraightaways.load-749"><a href="#StepSizes.ForksAndStraightaways.load-749"><span class="linenos">749</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-750"><a href="#StepSizes.ForksAndStraightaways.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepSizes.ForksAndStraightaways.load-751"><a href="#StepSizes.ForksAndStraightaways.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-752"><a href="#StepSizes.ForksAndStraightaways.load-752"><span class="linenos">752</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-753"><a href="#StepSizes.ForksAndStraightaways.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepSizes.ForksAndStraightaways.load-754"><a href="#StepSizes.ForksAndStraightaways.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-755"><a href="#StepSizes.ForksAndStraightaways.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.load-756"><a href="#StepSizes.ForksAndStraightaways.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-757"><a href="#StepSizes.ForksAndStraightaways.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-758"><a href="#StepSizes.ForksAndStraightaways.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.load-759"><a href="#StepSizes.ForksAndStraightaways.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-760"><a href="#StepSizes.ForksAndStraightaways.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-761"><a href="#StepSizes.ForksAndStraightaways.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepSizes.ForksAndStraightaways.load-762"><a href="#StepSizes.ForksAndStraightaways.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-763"><a href="#StepSizes.ForksAndStraightaways.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-764"><a href="#StepSizes.ForksAndStraightaways.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-765"><a href="#StepSizes.ForksAndStraightaways.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepSizes.ForksAndStraightaways.load-766"><a href="#StepSizes.ForksAndStraightaways.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepSizes.ForksAndStraightaways.load-767"><a href="#StepSizes.ForksAndStraightaways.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-768"><a href="#StepSizes.ForksAndStraightaways.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-769"><a href="#StepSizes.ForksAndStraightaways.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.load-770"><a href="#StepSizes.ForksAndStraightaways.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.load-771"><a href="#StepSizes.ForksAndStraightaways.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-772"><a href="#StepSizes.ForksAndStraightaways.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-773"><a href="#StepSizes.ForksAndStraightaways.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepSizes.ForksAndStraightaways.load-774"><a href="#StepSizes.ForksAndStraightaways.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepSizes.ForksAndStraightaways.load-775"><a href="#StepSizes.ForksAndStraightaways.load-775"><span class="linenos">775</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-776"><a href="#StepSizes.ForksAndStraightaways.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepSizes.ForksAndStraightaways.load-777"><a href="#StepSizes.ForksAndStraightaways.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepSizes.ForksAndStraightaways.load-778"><a href="#StepSizes.ForksAndStraightaways.load-778"><span class="linenos">778</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-779"><a href="#StepSizes.ForksAndStraightaways.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepSizes.ForksAndStraightaways.load-780"><a href="#StepSizes.ForksAndStraightaways.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-781"><a href="#StepSizes.ForksAndStraightaways.load-781"><span class="linenos">781</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-782"><a href="#StepSizes.ForksAndStraightaways.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepSizes.ForksAndStraightaways.load-783"><a href="#StepSizes.ForksAndStraightaways.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.load-784"><a href="#StepSizes.ForksAndStraightaways.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepSizes.ForksAndStraightaways.load-785"><a href="#StepSizes.ForksAndStraightaways.load-785"><span class="linenos">785</span></a>
</span><span id="StepSizes.ForksAndStraightaways.load-786"><a href="#StepSizes.ForksAndStraightaways.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepSizes.ForksAndStraightaways.load-787"><a href="#StepSizes.ForksAndStraightaways.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepSizes.ForksAndStraightaways.validate_fields_types" class="classattr">
                                        <input id="StepSizes.ForksAndStraightaways.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepSizes.ForksAndStraightaways.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepSizes.ForksAndStraightaways.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-271"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-272"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-273"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-274"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-275"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-276"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-277"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-278"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-279"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepSizes.ForksAndStraightaways.validate_fields_types-280"><a href="#StepSizes.ForksAndStraightaways.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepSizes._StepSize">StepSizes._StepSize</a></dt>
                                <dd id="StepSizes.ForksAndStraightaways.attribute_key" class="function"><a href="#StepSizes._StepSize.attribute_key">attribute_key</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.step_start_end_indices" class="function"><a href="#StepSizes._StepSize.step_start_end_indices">step_start_end_indices</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepSizes.ForksAndStraightaways.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>
                <dd id="StepSizes.ForksAndStraightaways.to_tokens" class="function"><a href="#_TokenizerElement.to_tokens">to_tokens</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepSizes.ForksAndStraightaways.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepSizes.ForksAndStraightaways.diff" class="function">diff</dd>
                <dd id="StepSizes.ForksAndStraightaways.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers">
                            <input id="StepTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StepTokenizers</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1419-L1539" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers-1420"><a href="#StepTokenizers-1420"><span class="linenos">1420</span></a><span class="k">class</span> <span class="nc">StepTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="StepTokenizers-1421"><a href="#StepTokenizers-1421"><span class="linenos">1421</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_StepTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1422"><a href="#StepTokenizers-1422"><span class="linenos">1422</span></a>
</span><span id="StepTokenizers-1423"><a href="#StepTokenizers-1423"><span class="linenos">1423</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;step_tokenizers&quot;</span>
</span><span id="StepTokenizers-1424"><a href="#StepTokenizers-1424"><span class="linenos">1424</span></a>
</span><span id="StepTokenizers-1425"><a href="#StepTokenizers-1425"><span class="linenos">1425</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-1426"><a href="#StepTokenizers-1426"><span class="linenos">1426</span></a>    <span class="k">class</span> <span class="nc">_StepTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="StepTokenizers-1427"><a href="#StepTokenizers-1427"><span class="linenos">1427</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1428"><a href="#StepTokenizers-1428"><span class="linenos">1428</span></a><span class="sd">        Specifies how a single step (as specified by an instance of `_StepSize`) is tokenized.</span>
</span><span id="StepTokenizers-1429"><a href="#StepTokenizers-1429"><span class="linenos">1429</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1430"><a href="#StepTokenizers-1430"><span class="linenos">1430</span></a>
</span><span id="StepTokenizers-1431"><a href="#StepTokenizers-1431"><span class="linenos">1431</span></a>        <span class="nd">@classmethod</span>
</span><span id="StepTokenizers-1432"><a href="#StepTokenizers-1432"><span class="linenos">1432</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="StepTokenizers-1433"><a href="#StepTokenizers-1433"><span class="linenos">1433</span></a>            <span class="k">return</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="StepTokenizers-1434"><a href="#StepTokenizers-1434"><span class="linenos">1434</span></a>
</span><span id="StepTokenizers-1435"><a href="#StepTokenizers-1435"><span class="linenos">1435</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="StepTokenizers-1436"><a href="#StepTokenizers-1436"><span class="linenos">1436</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers-1437"><a href="#StepTokenizers-1437"><span class="linenos">1437</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-1438"><a href="#StepTokenizers-1438"><span class="linenos">1438</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-1439"><a href="#StepTokenizers-1439"><span class="linenos">1439</span></a>            <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-1440"><a href="#StepTokenizers-1440"><span class="linenos">1440</span></a>            <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-1441"><a href="#StepTokenizers-1441"><span class="linenos">1441</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="StepTokenizers-1442"><a href="#StepTokenizers-1442"><span class="linenos">1442</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-1443"><a href="#StepTokenizers-1443"><span class="linenos">1443</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Tokenizes a single step in the solution.</span>
</span><span id="StepTokenizers-1444"><a href="#StepTokenizers-1444"><span class="linenos">1444</span></a>
</span><span id="StepTokenizers-1445"><a href="#StepTokenizers-1445"><span class="linenos">1445</span></a><span class="sd">            # Parameters</span>
</span><span id="StepTokenizers-1446"><a href="#StepTokenizers-1446"><span class="linenos">1446</span></a><span class="sd">            - `maze`: Maze to be tokenized</span>
</span><span id="StepTokenizers-1447"><a href="#StepTokenizers-1447"><span class="linenos">1447</span></a><span class="sd">            - `start_index`: The index of the Coord in `maze.solution` at which the current step starts</span>
</span><span id="StepTokenizers-1448"><a href="#StepTokenizers-1448"><span class="linenos">1448</span></a><span class="sd">            - `end_index`: The index of the Coord in `maze.solution` at which the current step ends</span>
</span><span id="StepTokenizers-1449"><a href="#StepTokenizers-1449"><span class="linenos">1449</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1450"><a href="#StepTokenizers-1450"><span class="linenos">1450</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="StepTokenizers-1451"><a href="#StepTokenizers-1451"><span class="linenos">1451</span></a>                <span class="s2">&quot;Subclasses must implement `StepTokenizer.to_tokens.&quot;</span>
</span><span id="StepTokenizers-1452"><a href="#StepTokenizers-1452"><span class="linenos">1452</span></a>            <span class="p">)</span>
</span><span id="StepTokenizers-1453"><a href="#StepTokenizers-1453"><span class="linenos">1453</span></a>
</span><span id="StepTokenizers-1454"><a href="#StepTokenizers-1454"><span class="linenos">1454</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers-1455"><a href="#StepTokenizers-1455"><span class="linenos">1455</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="StepTokenizers-1456"><a href="#StepTokenizers-1456"><span class="linenos">1456</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="StepTokenizers-1457"><a href="#StepTokenizers-1457"><span class="linenos">1457</span></a>
</span><span id="StepTokenizers-1458"><a href="#StepTokenizers-1458"><span class="linenos">1458</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-1459"><a href="#StepTokenizers-1459"><span class="linenos">1459</span></a>    <span class="k">class</span> <span class="nc">Coord</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-1460"><a href="#StepTokenizers-1460"><span class="linenos">1460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1461"><a href="#StepTokenizers-1461"><span class="linenos">1461</span></a><span class="sd">        A direct tokenization of the end position coord represents the step.</span>
</span><span id="StepTokenizers-1462"><a href="#StepTokenizers-1462"><span class="linenos">1462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1463"><a href="#StepTokenizers-1463"><span class="linenos">1463</span></a>
</span><span id="StepTokenizers-1464"><a href="#StepTokenizers-1464"><span class="linenos">1464</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers-1465"><a href="#StepTokenizers-1465"><span class="linenos">1465</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers-1466"><a href="#StepTokenizers-1466"><span class="linenos">1466</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers-1467"><a href="#StepTokenizers-1467"><span class="linenos">1467</span></a>            <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-1468"><a href="#StepTokenizers-1468"><span class="linenos">1468</span></a>            <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers-1469"><a href="#StepTokenizers-1469"><span class="linenos">1469</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="StepTokenizers-1470"><a href="#StepTokenizers-1470"><span class="linenos">1470</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-1471"><a href="#StepTokenizers-1471"><span class="linenos">1471</span></a>            <span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span><span id="StepTokenizers-1472"><a href="#StepTokenizers-1472"><span class="linenos">1472</span></a>
</span><span id="StepTokenizers-1473"><a href="#StepTokenizers-1473"><span class="linenos">1473</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-1474"><a href="#StepTokenizers-1474"><span class="linenos">1474</span></a>    <span class="k">class</span> <span class="nc">Cardinal</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-1475"><a href="#StepTokenizers-1475"><span class="linenos">1475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1476"><a href="#StepTokenizers-1476"><span class="linenos">1476</span></a><span class="sd">        A step is tokenized with a cardinal direction token.</span>
</span><span id="StepTokenizers-1477"><a href="#StepTokenizers-1477"><span class="linenos">1477</span></a><span class="sd">        It is the direction of the step from the starting position along the solution.</span>
</span><span id="StepTokenizers-1478"><a href="#StepTokenizers-1478"><span class="linenos">1478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1479"><a href="#StepTokenizers-1479"><span class="linenos">1479</span></a>
</span><span id="StepTokenizers-1480"><a href="#StepTokenizers-1480"><span class="linenos">1480</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers-1481"><a href="#StepTokenizers-1481"><span class="linenos">1481</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers-1482"><a href="#StepTokenizers-1482"><span class="linenos">1482</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-1483"><a href="#StepTokenizers-1483"><span class="linenos">1483</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers-1484"><a href="#StepTokenizers-1484"><span class="linenos">1484</span></a>                <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="StepTokenizers-1485"><a href="#StepTokenizers-1485"><span class="linenos">1485</span></a>            <span class="p">]</span>
</span><span id="StepTokenizers-1486"><a href="#StepTokenizers-1486"><span class="linenos">1486</span></a>
</span><span id="StepTokenizers-1487"><a href="#StepTokenizers-1487"><span class="linenos">1487</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-1488"><a href="#StepTokenizers-1488"><span class="linenos">1488</span></a>    <span class="k">class</span> <span class="nc">Relative</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-1489"><a href="#StepTokenizers-1489"><span class="linenos">1489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</span>
</span><span id="StepTokenizers-1490"><a href="#StepTokenizers-1490"><span class="linenos">1490</span></a><span class="sd">        To simplify the indeterminacy, at the start of a solution the &quot;agent&quot; solving the maze is assumed to be facing NORTH.</span>
</span><span id="StepTokenizers-1491"><a href="#StepTokenizers-1491"><span class="linenos">1491</span></a><span class="sd">        Similarly to `Cardinal`, the direction is that of the step from the starting position.</span>
</span><span id="StepTokenizers-1492"><a href="#StepTokenizers-1492"><span class="linenos">1492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1493"><a href="#StepTokenizers-1493"><span class="linenos">1493</span></a>
</span><span id="StepTokenizers-1494"><a href="#StepTokenizers-1494"><span class="linenos">1494</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers-1495"><a href="#StepTokenizers-1495"><span class="linenos">1495</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers-1496"><a href="#StepTokenizers-1496"><span class="linenos">1496</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-1497"><a href="#StepTokenizers-1497"><span class="linenos">1497</span></a>            <span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StepTokenizers-1498"><a href="#StepTokenizers-1498"><span class="linenos">1498</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepTokenizers-1499"><a href="#StepTokenizers-1499"><span class="linenos">1499</span></a>                <span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StepTokenizers-1500"><a href="#StepTokenizers-1500"><span class="linenos">1500</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers-1501"><a href="#StepTokenizers-1501"><span class="linenos">1501</span></a>                    <span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers-1502"><a href="#StepTokenizers-1502"><span class="linenos">1502</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepTokenizers-1503"><a href="#StepTokenizers-1503"><span class="linenos">1503</span></a>                            <span class="p">(</span>
</span><span id="StepTokenizers-1504"><a href="#StepTokenizers-1504"><span class="linenos">1504</span></a>                                <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="StepTokenizers-1505"><a href="#StepTokenizers-1505"><span class="linenos">1505</span></a>                                <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers-1506"><a href="#StepTokenizers-1506"><span class="linenos">1506</span></a>                            <span class="p">),</span>
</span><span id="StepTokenizers-1507"><a href="#StepTokenizers-1507"><span class="linenos">1507</span></a>                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="StepTokenizers-1508"><a href="#StepTokenizers-1508"><span class="linenos">1508</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers-1509"><a href="#StepTokenizers-1509"><span class="linenos">1509</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers-1510"><a href="#StepTokenizers-1510"><span class="linenos">1510</span></a>                <span class="p">]</span>
</span><span id="StepTokenizers-1511"><a href="#StepTokenizers-1511"><span class="linenos">1511</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers-1512"><a href="#StepTokenizers-1512"><span class="linenos">1512</span></a>                <span class="n">get_relative_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="StepTokenizers-1513"><a href="#StepTokenizers-1513"><span class="linenos">1513</span></a>            <span class="p">]</span>
</span><span id="StepTokenizers-1514"><a href="#StepTokenizers-1514"><span class="linenos">1514</span></a>
</span><span id="StepTokenizers-1515"><a href="#StepTokenizers-1515"><span class="linenos">1515</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers-1516"><a href="#StepTokenizers-1516"><span class="linenos">1516</span></a>    <span class="k">class</span> <span class="nc">Distance</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers-1517"><a href="#StepTokenizers-1517"><span class="linenos">1517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1518"><a href="#StepTokenizers-1518"><span class="linenos">1518</span></a><span class="sd">        A count of the number of individual steps from the starting point to the end point.</span>
</span><span id="StepTokenizers-1519"><a href="#StepTokenizers-1519"><span class="linenos">1519</span></a><span class="sd">        Contains no information about directionality, only the distance traveled in the step.</span>
</span><span id="StepTokenizers-1520"><a href="#StepTokenizers-1520"><span class="linenos">1520</span></a><span class="sd">        `Distance` must be combined with at least one other `_StepTokenizer` in a `StepTokenizerPermutation`.</span>
</span><span id="StepTokenizers-1521"><a href="#StepTokenizers-1521"><span class="linenos">1521</span></a><span class="sd">        This constraint is enforced in `_PathTokenizer.is_valid`.</span>
</span><span id="StepTokenizers-1522"><a href="#StepTokenizers-1522"><span class="linenos">1522</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1523"><a href="#StepTokenizers-1523"><span class="linenos">1523</span></a>
</span><span id="StepTokenizers-1524"><a href="#StepTokenizers-1524"><span class="linenos">1524</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers-1525"><a href="#StepTokenizers-1525"><span class="linenos">1525</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers-1526"><a href="#StepTokenizers-1526"><span class="linenos">1526</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers-1527"><a href="#StepTokenizers-1527"><span class="linenos">1527</span></a>            <span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="StepTokenizers-1528"><a href="#StepTokenizers-1528"><span class="linenos">1528</span></a>            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span><span id="StepTokenizers-1529"><a href="#StepTokenizers-1529"><span class="linenos">1529</span></a>
</span><span id="StepTokenizers-1530"><a href="#StepTokenizers-1530"><span class="linenos">1530</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1531"><a href="#StepTokenizers-1531"><span class="linenos">1531</span></a><span class="sd">    `StepTokenizerPermutation`</span>
</span><span id="StepTokenizers-1532"><a href="#StepTokenizers-1532"><span class="linenos">1532</span></a><span class="sd">    A sequence of unique `_StepTokenizer`s.</span>
</span><span id="StepTokenizers-1533"><a href="#StepTokenizers-1533"><span class="linenos">1533</span></a><span class="sd">    This type exists mostly just for the clarity and convenience of `_PathTokenizer` code.</span>
</span><span id="StepTokenizers-1534"><a href="#StepTokenizers-1534"><span class="linenos">1534</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="StepTokenizers-1535"><a href="#StepTokenizers-1535"><span class="linenos">1535</span></a>    <span class="n">StepTokenizerPermutation</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="StepTokenizers-1536"><a href="#StepTokenizers-1536"><span class="linenos">1536</span></a>        <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-1537"><a href="#StepTokenizers-1537"><span class="linenos">1537</span></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-1538"><a href="#StepTokenizers-1538"><span class="linenos">1538</span></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-1539"><a href="#StepTokenizers-1539"><span class="linenos">1539</span></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">_StepTokenizer</span><span class="p">]</span>
</span><span id="StepTokenizers-1540"><a href="#StepTokenizers-1540"><span class="linenos">1540</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_StepTokenizer</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="StepTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;step_tokenizers&#39;</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.key"></a>
    
    

                            </div>
                            <div id="StepTokenizers.StepTokenizerPermutation" class="classattr">
                                <div class="attr variable">
            <span class="name">StepTokenizerPermutation</span><span class="annotation">: type</span>        =
<input id="StepTokenizers.StepTokenizerPermutation-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="StepTokenizers.StepTokenizerPermutation-view-value"></label><span class="default_value">tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer]</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.StepTokenizerPermutation"></a>
    
    

                            </div>
                </section>
                <section id="StepTokenizers.Coord">
                            <input id="StepTokenizers.Coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Coord</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1457-L1470" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord-1458"><a href="#StepTokenizers.Coord-1458"><span class="linenos">1458</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord-1459"><a href="#StepTokenizers.Coord-1459"><span class="linenos">1459</span></a>    <span class="k">class</span> <span class="nc">Coord</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord-1460"><a href="#StepTokenizers.Coord-1460"><span class="linenos">1460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Coord-1461"><a href="#StepTokenizers.Coord-1461"><span class="linenos">1461</span></a><span class="sd">        A direct tokenization of the end position coord represents the step.</span>
</span><span id="StepTokenizers.Coord-1462"><a href="#StepTokenizers.Coord-1462"><span class="linenos">1462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Coord-1463"><a href="#StepTokenizers.Coord-1463"><span class="linenos">1463</span></a>
</span><span id="StepTokenizers.Coord-1464"><a href="#StepTokenizers.Coord-1464"><span class="linenos">1464</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord-1465"><a href="#StepTokenizers.Coord-1465"><span class="linenos">1465</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-1466"><a href="#StepTokenizers.Coord-1466"><span class="linenos">1466</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-1467"><a href="#StepTokenizers.Coord-1467"><span class="linenos">1467</span></a>            <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-1468"><a href="#StepTokenizers.Coord-1468"><span class="linenos">1468</span></a>            <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-1469"><a href="#StepTokenizers.Coord-1469"><span class="linenos">1469</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord-1470"><a href="#StepTokenizers.Coord-1470"><span class="linenos">1470</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord-1471"><a href="#StepTokenizers.Coord-1471"><span class="linenos">1471</span></a>            <span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>A direct tokenization of the end position coord represents the step.</p>
</div>


                            <div id="StepTokenizers.Coord.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Coord</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Coord">StepTokenizers.Coord</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Coord">StepTokenizers.Coord</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Coord.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Coord.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1463-L1470" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.to_tokens-1464"><a href="#StepTokenizers.Coord.to_tokens-1464"><span class="linenos">1464</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.to_tokens-1465"><a href="#StepTokenizers.Coord.to_tokens-1465"><span class="linenos">1465</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-1466"><a href="#StepTokenizers.Coord.to_tokens-1466"><span class="linenos">1466</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-1467"><a href="#StepTokenizers.Coord.to_tokens-1467"><span class="linenos">1467</span></a>            <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-1468"><a href="#StepTokenizers.Coord.to_tokens-1468"><span class="linenos">1468</span></a>            <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-1469"><a href="#StepTokenizers.Coord.to_tokens-1469"><span class="linenos">1469</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.to_tokens-1470"><a href="#StepTokenizers.Coord.to_tokens-1470"><span class="linenos">1470</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord.to_tokens-1471"><a href="#StepTokenizers.Coord.to_tokens-1471"><span class="linenos">1471</span></a>            <span class="k">return</span> <span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">end_index</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Coord.serialize" class="classattr">
                                        <input id="StepTokenizers.Coord.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.serialize-660"><a href="#StepTokenizers.Coord.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord.serialize-661"><a href="#StepTokenizers.Coord.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Coord.serialize-662"><a href="#StepTokenizers.Coord.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-663"><a href="#StepTokenizers.Coord.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Coord.serialize-664"><a href="#StepTokenizers.Coord.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Coord.serialize-665"><a href="#StepTokenizers.Coord.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Coord.serialize-666"><a href="#StepTokenizers.Coord.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Coord.serialize-667"><a href="#StepTokenizers.Coord.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-668"><a href="#StepTokenizers.Coord.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-669"><a href="#StepTokenizers.Coord.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Coord.serialize-670"><a href="#StepTokenizers.Coord.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Coord.serialize-671"><a href="#StepTokenizers.Coord.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-672"><a href="#StepTokenizers.Coord.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-673"><a href="#StepTokenizers.Coord.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepTokenizers.Coord.serialize-674"><a href="#StepTokenizers.Coord.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Coord.serialize-675"><a href="#StepTokenizers.Coord.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-676"><a href="#StepTokenizers.Coord.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-677"><a href="#StepTokenizers.Coord.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Coord.serialize-678"><a href="#StepTokenizers.Coord.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-679"><a href="#StepTokenizers.Coord.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Coord.serialize-680"><a href="#StepTokenizers.Coord.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-681"><a href="#StepTokenizers.Coord.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.serialize-682"><a href="#StepTokenizers.Coord.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Coord.serialize-683"><a href="#StepTokenizers.Coord.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-684"><a href="#StepTokenizers.Coord.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.serialize-685"><a href="#StepTokenizers.Coord.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Coord.serialize-686"><a href="#StepTokenizers.Coord.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Coord.serialize-687"><a href="#StepTokenizers.Coord.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-688"><a href="#StepTokenizers.Coord.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-689"><a href="#StepTokenizers.Coord.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepTokenizers.Coord.serialize-690"><a href="#StepTokenizers.Coord.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Coord.serialize-691"><a href="#StepTokenizers.Coord.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Coord.serialize-692"><a href="#StepTokenizers.Coord.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-693"><a href="#StepTokenizers.Coord.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-694"><a href="#StepTokenizers.Coord.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-695"><a href="#StepTokenizers.Coord.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Coord.serialize-696"><a href="#StepTokenizers.Coord.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-697"><a href="#StepTokenizers.Coord.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-698"><a href="#StepTokenizers.Coord.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-699"><a href="#StepTokenizers.Coord.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.serialize-700"><a href="#StepTokenizers.Coord.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Coord.serialize-701"><a href="#StepTokenizers.Coord.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-702"><a href="#StepTokenizers.Coord.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepTokenizers.Coord.serialize-703"><a href="#StepTokenizers.Coord.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepTokenizers.Coord.serialize-704"><a href="#StepTokenizers.Coord.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Coord.serialize-705"><a href="#StepTokenizers.Coord.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-706"><a href="#StepTokenizers.Coord.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.serialize-707"><a href="#StepTokenizers.Coord.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-708"><a href="#StepTokenizers.Coord.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Coord.serialize-709"><a href="#StepTokenizers.Coord.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.serialize-710"><a href="#StepTokenizers.Coord.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.serialize-711"><a href="#StepTokenizers.Coord.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-712"><a href="#StepTokenizers.Coord.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-713"><a href="#StepTokenizers.Coord.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.serialize-714"><a href="#StepTokenizers.Coord.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Coord.serialize-715"><a href="#StepTokenizers.Coord.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepTokenizers.Coord.serialize-716"><a href="#StepTokenizers.Coord.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Coord.load" class="classattr">
                                        <input id="StepTokenizers.Coord.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.load-723"><a href="#StepTokenizers.Coord.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Coord.load-724"><a href="#StepTokenizers.Coord.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Coord.load-725"><a href="#StepTokenizers.Coord.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Coord.load-726"><a href="#StepTokenizers.Coord.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-727"><a href="#StepTokenizers.Coord.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Coord.load-728"><a href="#StepTokenizers.Coord.load-728"><span class="linenos">728</span></a>
</span><span id="StepTokenizers.Coord.load-729"><a href="#StepTokenizers.Coord.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-730"><a href="#StepTokenizers.Coord.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Coord.load-731"><a href="#StepTokenizers.Coord.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.load-732"><a href="#StepTokenizers.Coord.load-732"><span class="linenos">732</span></a>
</span><span id="StepTokenizers.Coord.load-733"><a href="#StepTokenizers.Coord.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-734"><a href="#StepTokenizers.Coord.load-734"><span class="linenos">734</span></a>
</span><span id="StepTokenizers.Coord.load-735"><a href="#StepTokenizers.Coord.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Coord.load-736"><a href="#StepTokenizers.Coord.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.load-737"><a href="#StepTokenizers.Coord.load-737"><span class="linenos">737</span></a>
</span><span id="StepTokenizers.Coord.load-738"><a href="#StepTokenizers.Coord.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Coord.load-739"><a href="#StepTokenizers.Coord.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-740"><a href="#StepTokenizers.Coord.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Coord.load-741"><a href="#StepTokenizers.Coord.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-742"><a href="#StepTokenizers.Coord.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Coord.load-743"><a href="#StepTokenizers.Coord.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Coord.load-744"><a href="#StepTokenizers.Coord.load-744"><span class="linenos">744</span></a>
</span><span id="StepTokenizers.Coord.load-745"><a href="#StepTokenizers.Coord.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Coord.load-746"><a href="#StepTokenizers.Coord.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-747"><a href="#StepTokenizers.Coord.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Coord.load-748"><a href="#StepTokenizers.Coord.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Coord.load-749"><a href="#StepTokenizers.Coord.load-749"><span class="linenos">749</span></a>
</span><span id="StepTokenizers.Coord.load-750"><a href="#StepTokenizers.Coord.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Coord.load-751"><a href="#StepTokenizers.Coord.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-752"><a href="#StepTokenizers.Coord.load-752"><span class="linenos">752</span></a>
</span><span id="StepTokenizers.Coord.load-753"><a href="#StepTokenizers.Coord.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Coord.load-754"><a href="#StepTokenizers.Coord.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-755"><a href="#StepTokenizers.Coord.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Coord.load-756"><a href="#StepTokenizers.Coord.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-757"><a href="#StepTokenizers.Coord.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-758"><a href="#StepTokenizers.Coord.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Coord.load-759"><a href="#StepTokenizers.Coord.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-760"><a href="#StepTokenizers.Coord.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-761"><a href="#StepTokenizers.Coord.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Coord.load-762"><a href="#StepTokenizers.Coord.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-763"><a href="#StepTokenizers.Coord.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-764"><a href="#StepTokenizers.Coord.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-765"><a href="#StepTokenizers.Coord.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Coord.load-766"><a href="#StepTokenizers.Coord.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Coord.load-767"><a href="#StepTokenizers.Coord.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-768"><a href="#StepTokenizers.Coord.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-769"><a href="#StepTokenizers.Coord.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.load-770"><a href="#StepTokenizers.Coord.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Coord.load-771"><a href="#StepTokenizers.Coord.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-772"><a href="#StepTokenizers.Coord.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-773"><a href="#StepTokenizers.Coord.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Coord.load-774"><a href="#StepTokenizers.Coord.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Coord.load-775"><a href="#StepTokenizers.Coord.load-775"><span class="linenos">775</span></a>
</span><span id="StepTokenizers.Coord.load-776"><a href="#StepTokenizers.Coord.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Coord.load-777"><a href="#StepTokenizers.Coord.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Coord.load-778"><a href="#StepTokenizers.Coord.load-778"><span class="linenos">778</span></a>
</span><span id="StepTokenizers.Coord.load-779"><a href="#StepTokenizers.Coord.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Coord.load-780"><a href="#StepTokenizers.Coord.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-781"><a href="#StepTokenizers.Coord.load-781"><span class="linenos">781</span></a>
</span><span id="StepTokenizers.Coord.load-782"><a href="#StepTokenizers.Coord.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Coord.load-783"><a href="#StepTokenizers.Coord.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.load-784"><a href="#StepTokenizers.Coord.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepTokenizers.Coord.load-785"><a href="#StepTokenizers.Coord.load-785"><span class="linenos">785</span></a>
</span><span id="StepTokenizers.Coord.load-786"><a href="#StepTokenizers.Coord.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Coord.load-787"><a href="#StepTokenizers.Coord.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Coord.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Coord.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Coord.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Coord.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Coord.validate_fields_types-271"><a href="#StepTokenizers.Coord.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-272"><a href="#StepTokenizers.Coord.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-273"><a href="#StepTokenizers.Coord.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-274"><a href="#StepTokenizers.Coord.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-275"><a href="#StepTokenizers.Coord.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-276"><a href="#StepTokenizers.Coord.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-277"><a href="#StepTokenizers.Coord.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-278"><a href="#StepTokenizers.Coord.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-279"><a href="#StepTokenizers.Coord.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Coord.validate_fields_types-280"><a href="#StepTokenizers.Coord.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Coord.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Coord.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Coord.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Coord.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Coord.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Coord.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Coord.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Coord.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Coord.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers.Cardinal">
                            <input id="StepTokenizers.Cardinal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Cardinal</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1472-L1484" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal-1473"><a href="#StepTokenizers.Cardinal-1473"><span class="linenos">1473</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal-1474"><a href="#StepTokenizers.Cardinal-1474"><span class="linenos">1474</span></a>    <span class="k">class</span> <span class="nc">Cardinal</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal-1475"><a href="#StepTokenizers.Cardinal-1475"><span class="linenos">1475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Cardinal-1476"><a href="#StepTokenizers.Cardinal-1476"><span class="linenos">1476</span></a><span class="sd">        A step is tokenized with a cardinal direction token.</span>
</span><span id="StepTokenizers.Cardinal-1477"><a href="#StepTokenizers.Cardinal-1477"><span class="linenos">1477</span></a><span class="sd">        It is the direction of the step from the starting position along the solution.</span>
</span><span id="StepTokenizers.Cardinal-1478"><a href="#StepTokenizers.Cardinal-1478"><span class="linenos">1478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Cardinal-1479"><a href="#StepTokenizers.Cardinal-1479"><span class="linenos">1479</span></a>
</span><span id="StepTokenizers.Cardinal-1480"><a href="#StepTokenizers.Cardinal-1480"><span class="linenos">1480</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal-1481"><a href="#StepTokenizers.Cardinal-1481"><span class="linenos">1481</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers.Cardinal-1482"><a href="#StepTokenizers.Cardinal-1482"><span class="linenos">1482</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal-1483"><a href="#StepTokenizers.Cardinal-1483"><span class="linenos">1483</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal-1484"><a href="#StepTokenizers.Cardinal-1484"><span class="linenos">1484</span></a>                <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="StepTokenizers.Cardinal-1485"><a href="#StepTokenizers.Cardinal-1485"><span class="linenos">1485</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>A step is tokenized with a cardinal direction token.
It is the direction of the step from the starting position along the solution.</p>
</div>


                            <div id="StepTokenizers.Cardinal.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Cardinal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Cardinal">StepTokenizers.Cardinal</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Cardinal">StepTokenizers.Cardinal</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Cardinal.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Cardinal.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1479-L1484" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.to_tokens-1480"><a href="#StepTokenizers.Cardinal.to_tokens-1480"><span class="linenos">1480</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-1481"><a href="#StepTokenizers.Cardinal.to_tokens-1481"><span class="linenos">1481</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-1482"><a href="#StepTokenizers.Cardinal.to_tokens-1482"><span class="linenos">1482</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-1483"><a href="#StepTokenizers.Cardinal.to_tokens-1483"><span class="linenos">1483</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-1484"><a href="#StepTokenizers.Cardinal.to_tokens-1484"><span class="linenos">1484</span></a>                <span class="n">get_cardinal_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="StepTokenizers.Cardinal.to_tokens-1485"><a href="#StepTokenizers.Cardinal.to_tokens-1485"><span class="linenos">1485</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Cardinal.serialize" class="classattr">
                                        <input id="StepTokenizers.Cardinal.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.serialize-660"><a href="#StepTokenizers.Cardinal.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal.serialize-661"><a href="#StepTokenizers.Cardinal.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Cardinal.serialize-662"><a href="#StepTokenizers.Cardinal.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-663"><a href="#StepTokenizers.Cardinal.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Cardinal.serialize-664"><a href="#StepTokenizers.Cardinal.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Cardinal.serialize-665"><a href="#StepTokenizers.Cardinal.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Cardinal.serialize-666"><a href="#StepTokenizers.Cardinal.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Cardinal.serialize-667"><a href="#StepTokenizers.Cardinal.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-668"><a href="#StepTokenizers.Cardinal.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-669"><a href="#StepTokenizers.Cardinal.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-670"><a href="#StepTokenizers.Cardinal.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-671"><a href="#StepTokenizers.Cardinal.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-672"><a href="#StepTokenizers.Cardinal.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-673"><a href="#StepTokenizers.Cardinal.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-674"><a href="#StepTokenizers.Cardinal.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Cardinal.serialize-675"><a href="#StepTokenizers.Cardinal.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-676"><a href="#StepTokenizers.Cardinal.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-677"><a href="#StepTokenizers.Cardinal.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Cardinal.serialize-678"><a href="#StepTokenizers.Cardinal.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-679"><a href="#StepTokenizers.Cardinal.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Cardinal.serialize-680"><a href="#StepTokenizers.Cardinal.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-681"><a href="#StepTokenizers.Cardinal.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.serialize-682"><a href="#StepTokenizers.Cardinal.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Cardinal.serialize-683"><a href="#StepTokenizers.Cardinal.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-684"><a href="#StepTokenizers.Cardinal.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.serialize-685"><a href="#StepTokenizers.Cardinal.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Cardinal.serialize-686"><a href="#StepTokenizers.Cardinal.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Cardinal.serialize-687"><a href="#StepTokenizers.Cardinal.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-688"><a href="#StepTokenizers.Cardinal.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-689"><a href="#StepTokenizers.Cardinal.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-690"><a href="#StepTokenizers.Cardinal.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Cardinal.serialize-691"><a href="#StepTokenizers.Cardinal.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Cardinal.serialize-692"><a href="#StepTokenizers.Cardinal.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-693"><a href="#StepTokenizers.Cardinal.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-694"><a href="#StepTokenizers.Cardinal.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-695"><a href="#StepTokenizers.Cardinal.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Cardinal.serialize-696"><a href="#StepTokenizers.Cardinal.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-697"><a href="#StepTokenizers.Cardinal.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-698"><a href="#StepTokenizers.Cardinal.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-699"><a href="#StepTokenizers.Cardinal.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.serialize-700"><a href="#StepTokenizers.Cardinal.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Cardinal.serialize-701"><a href="#StepTokenizers.Cardinal.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-702"><a href="#StepTokenizers.Cardinal.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepTokenizers.Cardinal.serialize-703"><a href="#StepTokenizers.Cardinal.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-704"><a href="#StepTokenizers.Cardinal.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Cardinal.serialize-705"><a href="#StepTokenizers.Cardinal.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-706"><a href="#StepTokenizers.Cardinal.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.serialize-707"><a href="#StepTokenizers.Cardinal.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-708"><a href="#StepTokenizers.Cardinal.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Cardinal.serialize-709"><a href="#StepTokenizers.Cardinal.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.serialize-710"><a href="#StepTokenizers.Cardinal.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.serialize-711"><a href="#StepTokenizers.Cardinal.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-712"><a href="#StepTokenizers.Cardinal.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-713"><a href="#StepTokenizers.Cardinal.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.serialize-714"><a href="#StepTokenizers.Cardinal.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.serialize-715"><a href="#StepTokenizers.Cardinal.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepTokenizers.Cardinal.serialize-716"><a href="#StepTokenizers.Cardinal.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Cardinal.load" class="classattr">
                                        <input id="StepTokenizers.Cardinal.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.load-723"><a href="#StepTokenizers.Cardinal.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Cardinal.load-724"><a href="#StepTokenizers.Cardinal.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Cardinal.load-725"><a href="#StepTokenizers.Cardinal.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Cardinal.load-726"><a href="#StepTokenizers.Cardinal.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-727"><a href="#StepTokenizers.Cardinal.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Cardinal.load-728"><a href="#StepTokenizers.Cardinal.load-728"><span class="linenos">728</span></a>
</span><span id="StepTokenizers.Cardinal.load-729"><a href="#StepTokenizers.Cardinal.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-730"><a href="#StepTokenizers.Cardinal.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Cardinal.load-731"><a href="#StepTokenizers.Cardinal.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-732"><a href="#StepTokenizers.Cardinal.load-732"><span class="linenos">732</span></a>
</span><span id="StepTokenizers.Cardinal.load-733"><a href="#StepTokenizers.Cardinal.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-734"><a href="#StepTokenizers.Cardinal.load-734"><span class="linenos">734</span></a>
</span><span id="StepTokenizers.Cardinal.load-735"><a href="#StepTokenizers.Cardinal.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Cardinal.load-736"><a href="#StepTokenizers.Cardinal.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.load-737"><a href="#StepTokenizers.Cardinal.load-737"><span class="linenos">737</span></a>
</span><span id="StepTokenizers.Cardinal.load-738"><a href="#StepTokenizers.Cardinal.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Cardinal.load-739"><a href="#StepTokenizers.Cardinal.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-740"><a href="#StepTokenizers.Cardinal.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Cardinal.load-741"><a href="#StepTokenizers.Cardinal.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-742"><a href="#StepTokenizers.Cardinal.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Cardinal.load-743"><a href="#StepTokenizers.Cardinal.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-744"><a href="#StepTokenizers.Cardinal.load-744"><span class="linenos">744</span></a>
</span><span id="StepTokenizers.Cardinal.load-745"><a href="#StepTokenizers.Cardinal.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Cardinal.load-746"><a href="#StepTokenizers.Cardinal.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-747"><a href="#StepTokenizers.Cardinal.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Cardinal.load-748"><a href="#StepTokenizers.Cardinal.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Cardinal.load-749"><a href="#StepTokenizers.Cardinal.load-749"><span class="linenos">749</span></a>
</span><span id="StepTokenizers.Cardinal.load-750"><a href="#StepTokenizers.Cardinal.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Cardinal.load-751"><a href="#StepTokenizers.Cardinal.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-752"><a href="#StepTokenizers.Cardinal.load-752"><span class="linenos">752</span></a>
</span><span id="StepTokenizers.Cardinal.load-753"><a href="#StepTokenizers.Cardinal.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Cardinal.load-754"><a href="#StepTokenizers.Cardinal.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-755"><a href="#StepTokenizers.Cardinal.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Cardinal.load-756"><a href="#StepTokenizers.Cardinal.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-757"><a href="#StepTokenizers.Cardinal.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-758"><a href="#StepTokenizers.Cardinal.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Cardinal.load-759"><a href="#StepTokenizers.Cardinal.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-760"><a href="#StepTokenizers.Cardinal.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-761"><a href="#StepTokenizers.Cardinal.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Cardinal.load-762"><a href="#StepTokenizers.Cardinal.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-763"><a href="#StepTokenizers.Cardinal.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-764"><a href="#StepTokenizers.Cardinal.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-765"><a href="#StepTokenizers.Cardinal.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Cardinal.load-766"><a href="#StepTokenizers.Cardinal.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Cardinal.load-767"><a href="#StepTokenizers.Cardinal.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-768"><a href="#StepTokenizers.Cardinal.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-769"><a href="#StepTokenizers.Cardinal.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.load-770"><a href="#StepTokenizers.Cardinal.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Cardinal.load-771"><a href="#StepTokenizers.Cardinal.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-772"><a href="#StepTokenizers.Cardinal.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-773"><a href="#StepTokenizers.Cardinal.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Cardinal.load-774"><a href="#StepTokenizers.Cardinal.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Cardinal.load-775"><a href="#StepTokenizers.Cardinal.load-775"><span class="linenos">775</span></a>
</span><span id="StepTokenizers.Cardinal.load-776"><a href="#StepTokenizers.Cardinal.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Cardinal.load-777"><a href="#StepTokenizers.Cardinal.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Cardinal.load-778"><a href="#StepTokenizers.Cardinal.load-778"><span class="linenos">778</span></a>
</span><span id="StepTokenizers.Cardinal.load-779"><a href="#StepTokenizers.Cardinal.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Cardinal.load-780"><a href="#StepTokenizers.Cardinal.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-781"><a href="#StepTokenizers.Cardinal.load-781"><span class="linenos">781</span></a>
</span><span id="StepTokenizers.Cardinal.load-782"><a href="#StepTokenizers.Cardinal.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Cardinal.load-783"><a href="#StepTokenizers.Cardinal.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.load-784"><a href="#StepTokenizers.Cardinal.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepTokenizers.Cardinal.load-785"><a href="#StepTokenizers.Cardinal.load-785"><span class="linenos">785</span></a>
</span><span id="StepTokenizers.Cardinal.load-786"><a href="#StepTokenizers.Cardinal.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Cardinal.load-787"><a href="#StepTokenizers.Cardinal.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Cardinal.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Cardinal.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Cardinal.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Cardinal.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Cardinal.validate_fields_types-271"><a href="#StepTokenizers.Cardinal.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-272"><a href="#StepTokenizers.Cardinal.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-273"><a href="#StepTokenizers.Cardinal.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-274"><a href="#StepTokenizers.Cardinal.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-275"><a href="#StepTokenizers.Cardinal.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-276"><a href="#StepTokenizers.Cardinal.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-277"><a href="#StepTokenizers.Cardinal.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-278"><a href="#StepTokenizers.Cardinal.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-279"><a href="#StepTokenizers.Cardinal.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Cardinal.validate_fields_types-280"><a href="#StepTokenizers.Cardinal.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Cardinal.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Cardinal.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Cardinal.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Cardinal.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Cardinal.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Cardinal.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Cardinal.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Cardinal.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Cardinal.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers.Relative">
                            <input id="StepTokenizers.Relative-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Relative</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1486-L1512" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative-1487"><a href="#StepTokenizers.Relative-1487"><span class="linenos">1487</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative-1488"><a href="#StepTokenizers.Relative-1488"><span class="linenos">1488</span></a>    <span class="k">class</span> <span class="nc">Relative</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative-1489"><a href="#StepTokenizers.Relative-1489"><span class="linenos">1489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).</span>
</span><span id="StepTokenizers.Relative-1490"><a href="#StepTokenizers.Relative-1490"><span class="linenos">1490</span></a><span class="sd">        To simplify the indeterminacy, at the start of a solution the &quot;agent&quot; solving the maze is assumed to be facing NORTH.</span>
</span><span id="StepTokenizers.Relative-1491"><a href="#StepTokenizers.Relative-1491"><span class="linenos">1491</span></a><span class="sd">        Similarly to `Cardinal`, the direction is that of the step from the starting position.</span>
</span><span id="StepTokenizers.Relative-1492"><a href="#StepTokenizers.Relative-1492"><span class="linenos">1492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Relative-1493"><a href="#StepTokenizers.Relative-1493"><span class="linenos">1493</span></a>
</span><span id="StepTokenizers.Relative-1494"><a href="#StepTokenizers.Relative-1494"><span class="linenos">1494</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative-1495"><a href="#StepTokenizers.Relative-1495"><span class="linenos">1495</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers.Relative-1496"><a href="#StepTokenizers.Relative-1496"><span class="linenos">1496</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative-1497"><a href="#StepTokenizers.Relative-1497"><span class="linenos">1497</span></a>            <span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative-1498"><a href="#StepTokenizers.Relative-1498"><span class="linenos">1498</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepTokenizers.Relative-1499"><a href="#StepTokenizers.Relative-1499"><span class="linenos">1499</span></a>                <span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StepTokenizers.Relative-1500"><a href="#StepTokenizers.Relative-1500"><span class="linenos">1500</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative-1501"><a href="#StepTokenizers.Relative-1501"><span class="linenos">1501</span></a>                    <span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative-1502"><a href="#StepTokenizers.Relative-1502"><span class="linenos">1502</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative-1503"><a href="#StepTokenizers.Relative-1503"><span class="linenos">1503</span></a>                            <span class="p">(</span>
</span><span id="StepTokenizers.Relative-1504"><a href="#StepTokenizers.Relative-1504"><span class="linenos">1504</span></a>                                <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="StepTokenizers.Relative-1505"><a href="#StepTokenizers.Relative-1505"><span class="linenos">1505</span></a>                                <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers.Relative-1506"><a href="#StepTokenizers.Relative-1506"><span class="linenos">1506</span></a>                            <span class="p">),</span>
</span><span id="StepTokenizers.Relative-1507"><a href="#StepTokenizers.Relative-1507"><span class="linenos">1507</span></a>                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative-1508"><a href="#StepTokenizers.Relative-1508"><span class="linenos">1508</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers.Relative-1509"><a href="#StepTokenizers.Relative-1509"><span class="linenos">1509</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative-1510"><a href="#StepTokenizers.Relative-1510"><span class="linenos">1510</span></a>                <span class="p">]</span>
</span><span id="StepTokenizers.Relative-1511"><a href="#StepTokenizers.Relative-1511"><span class="linenos">1511</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative-1512"><a href="#StepTokenizers.Relative-1512"><span class="linenos">1512</span></a>                <span class="n">get_relative_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="StepTokenizers.Relative-1513"><a href="#StepTokenizers.Relative-1513"><span class="linenos">1513</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a solution step using relative first-person directions (right, left, forward, etc.).
To simplify the indeterminacy, at the start of a solution the "agent" solving the maze is assumed to be facing NORTH.
Similarly to <code><a href="#StepTokenizers.Cardinal">Cardinal</a></code>, the direction is that of the step from the starting position.</p>
</div>


                            <div id="StepTokenizers.Relative.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Relative</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Relative">StepTokenizers.Relative</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Relative">StepTokenizers.Relative</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Relative.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Relative.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1493-L1512" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.to_tokens-1494"><a href="#StepTokenizers.Relative.to_tokens-1494"><span class="linenos">1494</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-1495"><a href="#StepTokenizers.Relative.to_tokens-1495"><span class="linenos">1495</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers.Relative.to_tokens-1496"><a href="#StepTokenizers.Relative.to_tokens-1496"><span class="linenos">1496</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative.to_tokens-1497"><a href="#StepTokenizers.Relative.to_tokens-1497"><span class="linenos">1497</span></a>            <span class="k">if</span> <span class="n">start_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.to_tokens-1498"><a href="#StepTokenizers.Relative.to_tokens-1498"><span class="linenos">1498</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="StepTokenizers.Relative.to_tokens-1499"><a href="#StepTokenizers.Relative.to_tokens-1499"><span class="linenos">1499</span></a>                <span class="n">previous</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StepTokenizers.Relative.to_tokens-1500"><a href="#StepTokenizers.Relative.to_tokens-1500"><span class="linenos">1500</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative.to_tokens-1501"><a href="#StepTokenizers.Relative.to_tokens-1501"><span class="linenos">1501</span></a>                    <span class="n">get_relative_direction</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-1502"><a href="#StepTokenizers.Relative.to_tokens-1502"><span class="linenos">1502</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-1503"><a href="#StepTokenizers.Relative.to_tokens-1503"><span class="linenos">1503</span></a>                            <span class="p">(</span>
</span><span id="StepTokenizers.Relative.to_tokens-1504"><a href="#StepTokenizers.Relative.to_tokens-1504"><span class="linenos">1504</span></a>                                <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-1505"><a href="#StepTokenizers.Relative.to_tokens-1505"><span class="linenos">1505</span></a>                                <span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
</span><span id="StepTokenizers.Relative.to_tokens-1506"><a href="#StepTokenizers.Relative.to_tokens-1506"><span class="linenos">1506</span></a>                            <span class="p">),</span>
</span><span id="StepTokenizers.Relative.to_tokens-1507"><a href="#StepTokenizers.Relative.to_tokens-1507"><span class="linenos">1507</span></a>                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.to_tokens-1508"><a href="#StepTokenizers.Relative.to_tokens-1508"><span class="linenos">1508</span></a>                        <span class="p">)</span>
</span><span id="StepTokenizers.Relative.to_tokens-1509"><a href="#StepTokenizers.Relative.to_tokens-1509"><span class="linenos">1509</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.to_tokens-1510"><a href="#StepTokenizers.Relative.to_tokens-1510"><span class="linenos">1510</span></a>                <span class="p">]</span>
</span><span id="StepTokenizers.Relative.to_tokens-1511"><a href="#StepTokenizers.Relative.to_tokens-1511"><span class="linenos">1511</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="StepTokenizers.Relative.to_tokens-1512"><a href="#StepTokenizers.Relative.to_tokens-1512"><span class="linenos">1512</span></a>                <span class="n">get_relative_direction</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="n">start_index</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">start_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
</span><span id="StepTokenizers.Relative.to_tokens-1513"><a href="#StepTokenizers.Relative.to_tokens-1513"><span class="linenos">1513</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Relative.serialize" class="classattr">
                                        <input id="StepTokenizers.Relative.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.serialize-660"><a href="#StepTokenizers.Relative.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative.serialize-661"><a href="#StepTokenizers.Relative.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Relative.serialize-662"><a href="#StepTokenizers.Relative.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-663"><a href="#StepTokenizers.Relative.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Relative.serialize-664"><a href="#StepTokenizers.Relative.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Relative.serialize-665"><a href="#StepTokenizers.Relative.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Relative.serialize-666"><a href="#StepTokenizers.Relative.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Relative.serialize-667"><a href="#StepTokenizers.Relative.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-668"><a href="#StepTokenizers.Relative.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-669"><a href="#StepTokenizers.Relative.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Relative.serialize-670"><a href="#StepTokenizers.Relative.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Relative.serialize-671"><a href="#StepTokenizers.Relative.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-672"><a href="#StepTokenizers.Relative.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-673"><a href="#StepTokenizers.Relative.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepTokenizers.Relative.serialize-674"><a href="#StepTokenizers.Relative.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Relative.serialize-675"><a href="#StepTokenizers.Relative.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-676"><a href="#StepTokenizers.Relative.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-677"><a href="#StepTokenizers.Relative.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Relative.serialize-678"><a href="#StepTokenizers.Relative.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-679"><a href="#StepTokenizers.Relative.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Relative.serialize-680"><a href="#StepTokenizers.Relative.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-681"><a href="#StepTokenizers.Relative.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.serialize-682"><a href="#StepTokenizers.Relative.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Relative.serialize-683"><a href="#StepTokenizers.Relative.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-684"><a href="#StepTokenizers.Relative.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.serialize-685"><a href="#StepTokenizers.Relative.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Relative.serialize-686"><a href="#StepTokenizers.Relative.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Relative.serialize-687"><a href="#StepTokenizers.Relative.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-688"><a href="#StepTokenizers.Relative.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-689"><a href="#StepTokenizers.Relative.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepTokenizers.Relative.serialize-690"><a href="#StepTokenizers.Relative.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Relative.serialize-691"><a href="#StepTokenizers.Relative.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Relative.serialize-692"><a href="#StepTokenizers.Relative.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-693"><a href="#StepTokenizers.Relative.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-694"><a href="#StepTokenizers.Relative.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-695"><a href="#StepTokenizers.Relative.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Relative.serialize-696"><a href="#StepTokenizers.Relative.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-697"><a href="#StepTokenizers.Relative.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-698"><a href="#StepTokenizers.Relative.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-699"><a href="#StepTokenizers.Relative.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.serialize-700"><a href="#StepTokenizers.Relative.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Relative.serialize-701"><a href="#StepTokenizers.Relative.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-702"><a href="#StepTokenizers.Relative.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepTokenizers.Relative.serialize-703"><a href="#StepTokenizers.Relative.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepTokenizers.Relative.serialize-704"><a href="#StepTokenizers.Relative.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Relative.serialize-705"><a href="#StepTokenizers.Relative.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-706"><a href="#StepTokenizers.Relative.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.serialize-707"><a href="#StepTokenizers.Relative.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-708"><a href="#StepTokenizers.Relative.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Relative.serialize-709"><a href="#StepTokenizers.Relative.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.serialize-710"><a href="#StepTokenizers.Relative.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.serialize-711"><a href="#StepTokenizers.Relative.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-712"><a href="#StepTokenizers.Relative.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-713"><a href="#StepTokenizers.Relative.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.serialize-714"><a href="#StepTokenizers.Relative.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Relative.serialize-715"><a href="#StepTokenizers.Relative.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepTokenizers.Relative.serialize-716"><a href="#StepTokenizers.Relative.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Relative.load" class="classattr">
                                        <input id="StepTokenizers.Relative.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.load-723"><a href="#StepTokenizers.Relative.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Relative.load-724"><a href="#StepTokenizers.Relative.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Relative.load-725"><a href="#StepTokenizers.Relative.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Relative.load-726"><a href="#StepTokenizers.Relative.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-727"><a href="#StepTokenizers.Relative.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Relative.load-728"><a href="#StepTokenizers.Relative.load-728"><span class="linenos">728</span></a>
</span><span id="StepTokenizers.Relative.load-729"><a href="#StepTokenizers.Relative.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-730"><a href="#StepTokenizers.Relative.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Relative.load-731"><a href="#StepTokenizers.Relative.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.load-732"><a href="#StepTokenizers.Relative.load-732"><span class="linenos">732</span></a>
</span><span id="StepTokenizers.Relative.load-733"><a href="#StepTokenizers.Relative.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-734"><a href="#StepTokenizers.Relative.load-734"><span class="linenos">734</span></a>
</span><span id="StepTokenizers.Relative.load-735"><a href="#StepTokenizers.Relative.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Relative.load-736"><a href="#StepTokenizers.Relative.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.load-737"><a href="#StepTokenizers.Relative.load-737"><span class="linenos">737</span></a>
</span><span id="StepTokenizers.Relative.load-738"><a href="#StepTokenizers.Relative.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Relative.load-739"><a href="#StepTokenizers.Relative.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-740"><a href="#StepTokenizers.Relative.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Relative.load-741"><a href="#StepTokenizers.Relative.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-742"><a href="#StepTokenizers.Relative.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Relative.load-743"><a href="#StepTokenizers.Relative.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Relative.load-744"><a href="#StepTokenizers.Relative.load-744"><span class="linenos">744</span></a>
</span><span id="StepTokenizers.Relative.load-745"><a href="#StepTokenizers.Relative.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Relative.load-746"><a href="#StepTokenizers.Relative.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-747"><a href="#StepTokenizers.Relative.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Relative.load-748"><a href="#StepTokenizers.Relative.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Relative.load-749"><a href="#StepTokenizers.Relative.load-749"><span class="linenos">749</span></a>
</span><span id="StepTokenizers.Relative.load-750"><a href="#StepTokenizers.Relative.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Relative.load-751"><a href="#StepTokenizers.Relative.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-752"><a href="#StepTokenizers.Relative.load-752"><span class="linenos">752</span></a>
</span><span id="StepTokenizers.Relative.load-753"><a href="#StepTokenizers.Relative.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Relative.load-754"><a href="#StepTokenizers.Relative.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-755"><a href="#StepTokenizers.Relative.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Relative.load-756"><a href="#StepTokenizers.Relative.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-757"><a href="#StepTokenizers.Relative.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-758"><a href="#StepTokenizers.Relative.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Relative.load-759"><a href="#StepTokenizers.Relative.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-760"><a href="#StepTokenizers.Relative.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-761"><a href="#StepTokenizers.Relative.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Relative.load-762"><a href="#StepTokenizers.Relative.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-763"><a href="#StepTokenizers.Relative.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-764"><a href="#StepTokenizers.Relative.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-765"><a href="#StepTokenizers.Relative.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Relative.load-766"><a href="#StepTokenizers.Relative.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Relative.load-767"><a href="#StepTokenizers.Relative.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-768"><a href="#StepTokenizers.Relative.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-769"><a href="#StepTokenizers.Relative.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.load-770"><a href="#StepTokenizers.Relative.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Relative.load-771"><a href="#StepTokenizers.Relative.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-772"><a href="#StepTokenizers.Relative.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-773"><a href="#StepTokenizers.Relative.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Relative.load-774"><a href="#StepTokenizers.Relative.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Relative.load-775"><a href="#StepTokenizers.Relative.load-775"><span class="linenos">775</span></a>
</span><span id="StepTokenizers.Relative.load-776"><a href="#StepTokenizers.Relative.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Relative.load-777"><a href="#StepTokenizers.Relative.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Relative.load-778"><a href="#StepTokenizers.Relative.load-778"><span class="linenos">778</span></a>
</span><span id="StepTokenizers.Relative.load-779"><a href="#StepTokenizers.Relative.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Relative.load-780"><a href="#StepTokenizers.Relative.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-781"><a href="#StepTokenizers.Relative.load-781"><span class="linenos">781</span></a>
</span><span id="StepTokenizers.Relative.load-782"><a href="#StepTokenizers.Relative.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Relative.load-783"><a href="#StepTokenizers.Relative.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.load-784"><a href="#StepTokenizers.Relative.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepTokenizers.Relative.load-785"><a href="#StepTokenizers.Relative.load-785"><span class="linenos">785</span></a>
</span><span id="StepTokenizers.Relative.load-786"><a href="#StepTokenizers.Relative.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Relative.load-787"><a href="#StepTokenizers.Relative.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Relative.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Relative.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Relative.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Relative.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Relative.validate_fields_types-271"><a href="#StepTokenizers.Relative.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-272"><a href="#StepTokenizers.Relative.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-273"><a href="#StepTokenizers.Relative.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-274"><a href="#StepTokenizers.Relative.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-275"><a href="#StepTokenizers.Relative.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-276"><a href="#StepTokenizers.Relative.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-277"><a href="#StepTokenizers.Relative.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-278"><a href="#StepTokenizers.Relative.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-279"><a href="#StepTokenizers.Relative.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Relative.validate_fields_types-280"><a href="#StepTokenizers.Relative.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Relative.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Relative.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Relative.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Relative.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Relative.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Relative.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Relative.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Relative.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Relative.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StepTokenizers.Distance">
                            <input id="StepTokenizers.Distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">StepTokenizers.Distance</span><wbr>(<span class="base"><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1514-L1527" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance-1515"><a href="#StepTokenizers.Distance-1515"><span class="linenos">1515</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance-1516"><a href="#StepTokenizers.Distance-1516"><span class="linenos">1516</span></a>    <span class="k">class</span> <span class="nc">Distance</span><span class="p">(</span><span class="n">_StepTokenizer</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance-1517"><a href="#StepTokenizers.Distance-1517"><span class="linenos">1517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Distance-1518"><a href="#StepTokenizers.Distance-1518"><span class="linenos">1518</span></a><span class="sd">        A count of the number of individual steps from the starting point to the end point.</span>
</span><span id="StepTokenizers.Distance-1519"><a href="#StepTokenizers.Distance-1519"><span class="linenos">1519</span></a><span class="sd">        Contains no information about directionality, only the distance traveled in the step.</span>
</span><span id="StepTokenizers.Distance-1520"><a href="#StepTokenizers.Distance-1520"><span class="linenos">1520</span></a><span class="sd">        `Distance` must be combined with at least one other `_StepTokenizer` in a `StepTokenizerPermutation`.</span>
</span><span id="StepTokenizers.Distance-1521"><a href="#StepTokenizers.Distance-1521"><span class="linenos">1521</span></a><span class="sd">        This constraint is enforced in `_PathTokenizer.is_valid`.</span>
</span><span id="StepTokenizers.Distance-1522"><a href="#StepTokenizers.Distance-1522"><span class="linenos">1522</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Distance-1523"><a href="#StepTokenizers.Distance-1523"><span class="linenos">1523</span></a>
</span><span id="StepTokenizers.Distance-1524"><a href="#StepTokenizers.Distance-1524"><span class="linenos">1524</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance-1525"><a href="#StepTokenizers.Distance-1525"><span class="linenos">1525</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers.Distance-1526"><a href="#StepTokenizers.Distance-1526"><span class="linenos">1526</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance-1527"><a href="#StepTokenizers.Distance-1527"><span class="linenos">1527</span></a>            <span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="StepTokenizers.Distance-1528"><a href="#StepTokenizers.Distance-1528"><span class="linenos">1528</span></a>            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>A count of the number of individual steps from the starting point to the end point.
Contains no information about directionality, only the distance traveled in the step.
<code><a href="#StepTokenizers.Distance">Distance</a></code> must be combined with at least one other <code>_StepTokenizer</code> in a <code><a href="#StepTokenizers.StepTokenizerPermutation">StepTokenizerPermutation</a></code>.
This constraint is enforced in <code>_PathTokenizer.is_valid</code>.</p>
</div>


                            <div id="StepTokenizers.Distance.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">StepTokenizers.Distance</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Distance">StepTokenizers.Distance</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#StepTokenizers.Distance">StepTokenizers.Distance</a>&#39;&gt;&quot;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.__init__"></a>
    
    

                            </div>
                            <div id="StepTokenizers.Distance.to_tokens" class="classattr">
                                        <input id="StepTokenizers.Distance.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1523-L1527" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.to_tokens-1524"><a href="#StepTokenizers.Distance.to_tokens-1524"><span class="linenos">1524</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.to_tokens-1525"><a href="#StepTokenizers.Distance.to_tokens-1525"><span class="linenos">1525</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="StepTokenizers.Distance.to_tokens-1526"><a href="#StepTokenizers.Distance.to_tokens-1526"><span class="linenos">1526</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance.to_tokens-1527"><a href="#StepTokenizers.Distance.to_tokens-1527"><span class="linenos">1527</span></a>            <span class="n">d</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span>
</span><span id="StepTokenizers.Distance.to_tokens-1528"><a href="#StepTokenizers.Distance.to_tokens-1528"><span class="linenos">1528</span></a>            <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">VOCAB</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;I_</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizes a single step in the solution.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>maze</code>: Maze to be tokenized</li>
<li><code>start_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step starts</li>
<li><code>end_index</code>: The index of the Coord in <code>maze.solution</code> at which the current step ends</li>
</ul>
</div>


                            </div>
                            <div id="StepTokenizers.Distance.serialize" class="classattr">
                                        <input id="StepTokenizers.Distance.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.serialize-660"><a href="#StepTokenizers.Distance.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance.serialize-661"><a href="#StepTokenizers.Distance.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="StepTokenizers.Distance.serialize-662"><a href="#StepTokenizers.Distance.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-663"><a href="#StepTokenizers.Distance.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="StepTokenizers.Distance.serialize-664"><a href="#StepTokenizers.Distance.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="StepTokenizers.Distance.serialize-665"><a href="#StepTokenizers.Distance.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="StepTokenizers.Distance.serialize-666"><a href="#StepTokenizers.Distance.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="StepTokenizers.Distance.serialize-667"><a href="#StepTokenizers.Distance.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-668"><a href="#StepTokenizers.Distance.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-669"><a href="#StepTokenizers.Distance.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="StepTokenizers.Distance.serialize-670"><a href="#StepTokenizers.Distance.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="StepTokenizers.Distance.serialize-671"><a href="#StepTokenizers.Distance.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-672"><a href="#StepTokenizers.Distance.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-673"><a href="#StepTokenizers.Distance.serialize-673"><span class="linenos">673</span></a>
</span><span id="StepTokenizers.Distance.serialize-674"><a href="#StepTokenizers.Distance.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="StepTokenizers.Distance.serialize-675"><a href="#StepTokenizers.Distance.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-676"><a href="#StepTokenizers.Distance.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-677"><a href="#StepTokenizers.Distance.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="StepTokenizers.Distance.serialize-678"><a href="#StepTokenizers.Distance.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-679"><a href="#StepTokenizers.Distance.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="StepTokenizers.Distance.serialize-680"><a href="#StepTokenizers.Distance.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-681"><a href="#StepTokenizers.Distance.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.serialize-682"><a href="#StepTokenizers.Distance.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="StepTokenizers.Distance.serialize-683"><a href="#StepTokenizers.Distance.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-684"><a href="#StepTokenizers.Distance.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.serialize-685"><a href="#StepTokenizers.Distance.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="StepTokenizers.Distance.serialize-686"><a href="#StepTokenizers.Distance.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="StepTokenizers.Distance.serialize-687"><a href="#StepTokenizers.Distance.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-688"><a href="#StepTokenizers.Distance.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-689"><a href="#StepTokenizers.Distance.serialize-689"><span class="linenos">689</span></a>
</span><span id="StepTokenizers.Distance.serialize-690"><a href="#StepTokenizers.Distance.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="StepTokenizers.Distance.serialize-691"><a href="#StepTokenizers.Distance.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Distance.serialize-692"><a href="#StepTokenizers.Distance.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-693"><a href="#StepTokenizers.Distance.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-694"><a href="#StepTokenizers.Distance.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-695"><a href="#StepTokenizers.Distance.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="StepTokenizers.Distance.serialize-696"><a href="#StepTokenizers.Distance.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-697"><a href="#StepTokenizers.Distance.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-698"><a href="#StepTokenizers.Distance.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-699"><a href="#StepTokenizers.Distance.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.serialize-700"><a href="#StepTokenizers.Distance.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="StepTokenizers.Distance.serialize-701"><a href="#StepTokenizers.Distance.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-702"><a href="#StepTokenizers.Distance.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="StepTokenizers.Distance.serialize-703"><a href="#StepTokenizers.Distance.serialize-703"><span class="linenos">703</span></a>
</span><span id="StepTokenizers.Distance.serialize-704"><a href="#StepTokenizers.Distance.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="StepTokenizers.Distance.serialize-705"><a href="#StepTokenizers.Distance.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-706"><a href="#StepTokenizers.Distance.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.serialize-707"><a href="#StepTokenizers.Distance.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-708"><a href="#StepTokenizers.Distance.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Distance.serialize-709"><a href="#StepTokenizers.Distance.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.serialize-710"><a href="#StepTokenizers.Distance.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.serialize-711"><a href="#StepTokenizers.Distance.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-712"><a href="#StepTokenizers.Distance.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-713"><a href="#StepTokenizers.Distance.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.serialize-714"><a href="#StepTokenizers.Distance.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="StepTokenizers.Distance.serialize-715"><a href="#StepTokenizers.Distance.serialize-715"><span class="linenos">715</span></a>
</span><span id="StepTokenizers.Distance.serialize-716"><a href="#StepTokenizers.Distance.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Distance.load" class="classattr">
                                        <input id="StepTokenizers.Distance.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.load-723"><a href="#StepTokenizers.Distance.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="StepTokenizers.Distance.load-724"><a href="#StepTokenizers.Distance.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="StepTokenizers.Distance.load-725"><a href="#StepTokenizers.Distance.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="StepTokenizers.Distance.load-726"><a href="#StepTokenizers.Distance.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-727"><a href="#StepTokenizers.Distance.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="StepTokenizers.Distance.load-728"><a href="#StepTokenizers.Distance.load-728"><span class="linenos">728</span></a>
</span><span id="StepTokenizers.Distance.load-729"><a href="#StepTokenizers.Distance.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-730"><a href="#StepTokenizers.Distance.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="StepTokenizers.Distance.load-731"><a href="#StepTokenizers.Distance.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.load-732"><a href="#StepTokenizers.Distance.load-732"><span class="linenos">732</span></a>
</span><span id="StepTokenizers.Distance.load-733"><a href="#StepTokenizers.Distance.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-734"><a href="#StepTokenizers.Distance.load-734"><span class="linenos">734</span></a>
</span><span id="StepTokenizers.Distance.load-735"><a href="#StepTokenizers.Distance.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="StepTokenizers.Distance.load-736"><a href="#StepTokenizers.Distance.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.load-737"><a href="#StepTokenizers.Distance.load-737"><span class="linenos">737</span></a>
</span><span id="StepTokenizers.Distance.load-738"><a href="#StepTokenizers.Distance.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="StepTokenizers.Distance.load-739"><a href="#StepTokenizers.Distance.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-740"><a href="#StepTokenizers.Distance.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="StepTokenizers.Distance.load-741"><a href="#StepTokenizers.Distance.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-742"><a href="#StepTokenizers.Distance.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="StepTokenizers.Distance.load-743"><a href="#StepTokenizers.Distance.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="StepTokenizers.Distance.load-744"><a href="#StepTokenizers.Distance.load-744"><span class="linenos">744</span></a>
</span><span id="StepTokenizers.Distance.load-745"><a href="#StepTokenizers.Distance.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="StepTokenizers.Distance.load-746"><a href="#StepTokenizers.Distance.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-747"><a href="#StepTokenizers.Distance.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="StepTokenizers.Distance.load-748"><a href="#StepTokenizers.Distance.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="StepTokenizers.Distance.load-749"><a href="#StepTokenizers.Distance.load-749"><span class="linenos">749</span></a>
</span><span id="StepTokenizers.Distance.load-750"><a href="#StepTokenizers.Distance.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="StepTokenizers.Distance.load-751"><a href="#StepTokenizers.Distance.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-752"><a href="#StepTokenizers.Distance.load-752"><span class="linenos">752</span></a>
</span><span id="StepTokenizers.Distance.load-753"><a href="#StepTokenizers.Distance.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="StepTokenizers.Distance.load-754"><a href="#StepTokenizers.Distance.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-755"><a href="#StepTokenizers.Distance.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="StepTokenizers.Distance.load-756"><a href="#StepTokenizers.Distance.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-757"><a href="#StepTokenizers.Distance.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-758"><a href="#StepTokenizers.Distance.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="StepTokenizers.Distance.load-759"><a href="#StepTokenizers.Distance.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-760"><a href="#StepTokenizers.Distance.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-761"><a href="#StepTokenizers.Distance.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="StepTokenizers.Distance.load-762"><a href="#StepTokenizers.Distance.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-763"><a href="#StepTokenizers.Distance.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-764"><a href="#StepTokenizers.Distance.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-765"><a href="#StepTokenizers.Distance.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="StepTokenizers.Distance.load-766"><a href="#StepTokenizers.Distance.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StepTokenizers.Distance.load-767"><a href="#StepTokenizers.Distance.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-768"><a href="#StepTokenizers.Distance.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-769"><a href="#StepTokenizers.Distance.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.load-770"><a href="#StepTokenizers.Distance.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="StepTokenizers.Distance.load-771"><a href="#StepTokenizers.Distance.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-772"><a href="#StepTokenizers.Distance.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-773"><a href="#StepTokenizers.Distance.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="StepTokenizers.Distance.load-774"><a href="#StepTokenizers.Distance.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="StepTokenizers.Distance.load-775"><a href="#StepTokenizers.Distance.load-775"><span class="linenos">775</span></a>
</span><span id="StepTokenizers.Distance.load-776"><a href="#StepTokenizers.Distance.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="StepTokenizers.Distance.load-777"><a href="#StepTokenizers.Distance.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StepTokenizers.Distance.load-778"><a href="#StepTokenizers.Distance.load-778"><span class="linenos">778</span></a>
</span><span id="StepTokenizers.Distance.load-779"><a href="#StepTokenizers.Distance.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="StepTokenizers.Distance.load-780"><a href="#StepTokenizers.Distance.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-781"><a href="#StepTokenizers.Distance.load-781"><span class="linenos">781</span></a>
</span><span id="StepTokenizers.Distance.load-782"><a href="#StepTokenizers.Distance.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="StepTokenizers.Distance.load-783"><a href="#StepTokenizers.Distance.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.load-784"><a href="#StepTokenizers.Distance.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="StepTokenizers.Distance.load-785"><a href="#StepTokenizers.Distance.load-785"><span class="linenos">785</span></a>
</span><span id="StepTokenizers.Distance.load-786"><a href="#StepTokenizers.Distance.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="StepTokenizers.Distance.load-787"><a href="#StepTokenizers.Distance.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="StepTokenizers.Distance.validate_fields_types" class="classattr">
                                        <input id="StepTokenizers.Distance.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="StepTokenizers.Distance.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#StepTokenizers.Distance.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StepTokenizers.Distance.validate_fields_types-271"><a href="#StepTokenizers.Distance.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-272"><a href="#StepTokenizers.Distance.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-273"><a href="#StepTokenizers.Distance.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-274"><a href="#StepTokenizers.Distance.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-275"><a href="#StepTokenizers.Distance.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-276"><a href="#StepTokenizers.Distance.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-277"><a href="#StepTokenizers.Distance.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-278"><a href="#StepTokenizers.Distance.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-279"><a href="#StepTokenizers.Distance.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="StepTokenizers.Distance.validate_fields_types-280"><a href="#StepTokenizers.Distance.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#StepTokenizers._StepTokenizer">StepTokenizers._StepTokenizer</a></dt>
                                <dd id="StepTokenizers.Distance.attribute_key" class="function"><a href="#StepTokenizers._StepTokenizer.attribute_key">attribute_key</a></dd>
                <dd id="StepTokenizers.Distance.is_valid" class="function"><a href="#StepTokenizers._StepTokenizer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="StepTokenizers.Distance.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="StepTokenizers.Distance.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="StepTokenizers.Distance.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="StepTokenizers.Distance.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="StepTokenizers.Distance.validate_field_type" class="function">validate_field_type</dd>
                <dd id="StepTokenizers.Distance.diff" class="function">diff</dd>
                <dd id="StepTokenizers.Distance.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PathTokenizers">
                            <input id="PathTokenizers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PathTokenizers</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1542-L1664" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers-1543"><a href="#PathTokenizers-1543"><span class="linenos">1543</span></a><span class="k">class</span> <span class="nc">PathTokenizers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="PathTokenizers-1544"><a href="#PathTokenizers-1544"><span class="linenos">1544</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_PathTokenizer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1545"><a href="#PathTokenizers-1545"><span class="linenos">1545</span></a>
</span><span id="PathTokenizers-1546"><a href="#PathTokenizers-1546"><span class="linenos">1546</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;path_tokenizer&quot;</span>
</span><span id="PathTokenizers-1547"><a href="#PathTokenizers-1547"><span class="linenos">1547</span></a>
</span><span id="PathTokenizers-1548"><a href="#PathTokenizers-1548"><span class="linenos">1548</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PathTokenizers-1549"><a href="#PathTokenizers-1549"><span class="linenos">1549</span></a>    <span class="k">class</span> <span class="nc">_PathTokenizer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PathTokenizers-1550"><a href="#PathTokenizers-1550"><span class="linenos">1550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Superclass of tokenizers for maze solution paths.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1551"><a href="#PathTokenizers-1551"><span class="linenos">1551</span></a>
</span><span id="PathTokenizers-1552"><a href="#PathTokenizers-1552"><span class="linenos">1552</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="PathTokenizers-1553"><a href="#PathTokenizers-1553"><span class="linenos">1553</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-1554"><a href="#PathTokenizers-1554"><span class="linenos">1554</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers-1555"><a href="#PathTokenizers-1555"><span class="linenos">1555</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1556"><a href="#PathTokenizers-1556"><span class="linenos">1556</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens representing the solution path.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1557"><a href="#PathTokenizers-1557"><span class="linenos">1557</span></a>            <span class="k">pass</span>
</span><span id="PathTokenizers-1558"><a href="#PathTokenizers-1558"><span class="linenos">1558</span></a>
</span><span id="PathTokenizers-1559"><a href="#PathTokenizers-1559"><span class="linenos">1559</span></a>        <span class="nd">@classmethod</span>
</span><span id="PathTokenizers-1560"><a href="#PathTokenizers-1560"><span class="linenos">1560</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PathTokenizers-1561"><a href="#PathTokenizers-1561"><span class="linenos">1561</span></a>            <span class="k">return</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">key</span>
</span><span id="PathTokenizers-1562"><a href="#PathTokenizers-1562"><span class="linenos">1562</span></a>
</span><span id="PathTokenizers-1563"><a href="#PathTokenizers-1563"><span class="linenos">1563</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PathTokenizers-1564"><a href="#PathTokenizers-1564"><span class="linenos">1564</span></a>    <span class="k">class</span> <span class="nc">StepSequence</span><span class="p">(</span><span class="n">_PathTokenizer</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PathTokenizers-1565"><a href="#PathTokenizers-1565"><span class="linenos">1565</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any `PathTokenizer` where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</span>
</span><span id="PathTokenizers-1566"><a href="#PathTokenizers-1566"><span class="linenos">1566</span></a><span class="sd">        Allows for a sequence of leading and trailing tokens which don&#39;t fit the step pattern.</span>
</span><span id="PathTokenizers-1567"><a href="#PathTokenizers-1567"><span class="linenos">1567</span></a>
</span><span id="PathTokenizers-1568"><a href="#PathTokenizers-1568"><span class="linenos">1568</span></a><span class="sd">        # Parameters</span>
</span><span id="PathTokenizers-1569"><a href="#PathTokenizers-1569"><span class="linenos">1569</span></a><span class="sd">        - `step_size`: Selects the size of a single step in the sequence</span>
</span><span id="PathTokenizers-1570"><a href="#PathTokenizers-1570"><span class="linenos">1570</span></a><span class="sd">        - `step_tokenizers`: Selects the combination and permutation of tokens</span>
</span><span id="PathTokenizers-1571"><a href="#PathTokenizers-1571"><span class="linenos">1571</span></a><span class="sd">        - `pre`: Whether all steps include an integral preceding delimiter token</span>
</span><span id="PathTokenizers-1572"><a href="#PathTokenizers-1572"><span class="linenos">1572</span></a><span class="sd">        - `intra`: Whether all steps include a delimiter token after each individual `_StepTokenizer` tokenization.</span>
</span><span id="PathTokenizers-1573"><a href="#PathTokenizers-1573"><span class="linenos">1573</span></a><span class="sd">        - `post`: Whether all steps include an integral following delimiter token</span>
</span><span id="PathTokenizers-1574"><a href="#PathTokenizers-1574"><span class="linenos">1574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1575"><a href="#PathTokenizers-1575"><span class="linenos">1575</span></a>
</span><span id="PathTokenizers-1576"><a href="#PathTokenizers-1576"><span class="linenos">1576</span></a>        <span class="n">step_size</span><span class="p">:</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers-1577"><a href="#PathTokenizers-1577"><span class="linenos">1577</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">Singles</span><span class="p">(),</span>
</span><span id="PathTokenizers-1578"><a href="#PathTokenizers-1578"><span class="linenos">1578</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">StepSizes</span><span class="p">),</span>
</span><span id="PathTokenizers-1579"><a href="#PathTokenizers-1579"><span class="linenos">1579</span></a>        <span class="p">)</span>
</span><span id="PathTokenizers-1580"><a href="#PathTokenizers-1580"><span class="linenos">1580</span></a>        <span class="n">step_tokenizers</span><span class="p">:</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">StepTokenizerPermutation</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers-1581"><a href="#PathTokenizers-1581"><span class="linenos">1581</span></a>            <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">(),),</span>
</span><span id="PathTokenizers-1582"><a href="#PathTokenizers-1582"><span class="linenos">1582</span></a>            <span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
</span><span id="PathTokenizers-1583"><a href="#PathTokenizers-1583"><span class="linenos">1583</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span>
</span><span id="PathTokenizers-1584"><a href="#PathTokenizers-1584"><span class="linenos">1584</span></a>        <span class="p">)</span>
</span><span id="PathTokenizers-1585"><a href="#PathTokenizers-1585"><span class="linenos">1585</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers-1586"><a href="#PathTokenizers-1586"><span class="linenos">1586</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers-1587"><a href="#PathTokenizers-1587"><span class="linenos">1587</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers-1588"><a href="#PathTokenizers-1588"><span class="linenos">1588</span></a>
</span><span id="PathTokenizers-1589"><a href="#PathTokenizers-1589"><span class="linenos">1589</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-1590"><a href="#PathTokenizers-1590"><span class="linenos">1590</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers-1591"><a href="#PathTokenizers-1591"><span class="linenos">1591</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1592"><a href="#PathTokenizers-1592"><span class="linenos">1592</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers-1593"><a href="#PathTokenizers-1593"><span class="linenos">1593</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers-1594"><a href="#PathTokenizers-1594"><span class="linenos">1594</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="PathTokenizers-1595"><a href="#PathTokenizers-1595"><span class="linenos">1595</span></a>                    <span class="p">[</span>
</span><span id="PathTokenizers-1596"><a href="#PathTokenizers-1596"><span class="linenos">1596</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers-1597"><a href="#PathTokenizers-1597"><span class="linenos">1597</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PathTokenizers-1598"><a href="#PathTokenizers-1598"><span class="linenos">1598</span></a>                    <span class="p">]</span>
</span><span id="PathTokenizers-1599"><a href="#PathTokenizers-1599"><span class="linenos">1599</span></a>                <span class="p">),</span>
</span><span id="PathTokenizers-1600"><a href="#PathTokenizers-1600"><span class="linenos">1600</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers-1601"><a href="#PathTokenizers-1601"><span class="linenos">1601</span></a>            <span class="p">]</span>
</span><span id="PathTokenizers-1602"><a href="#PathTokenizers-1602"><span class="linenos">1602</span></a>
</span><span id="PathTokenizers-1603"><a href="#PathTokenizers-1603"><span class="linenos">1603</span></a>        <span class="k">def</span> <span class="nf">_single_step_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-1604"><a href="#PathTokenizers-1604"><span class="linenos">1604</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers-1605"><a href="#PathTokenizers-1605"><span class="linenos">1605</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers-1606"><a href="#PathTokenizers-1606"><span class="linenos">1606</span></a>            <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers-1607"><a href="#PathTokenizers-1607"><span class="linenos">1607</span></a>            <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers-1608"><a href="#PathTokenizers-1608"><span class="linenos">1608</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers-1609"><a href="#PathTokenizers-1609"><span class="linenos">1609</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1610"><a href="#PathTokenizers-1610"><span class="linenos">1610</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the token sequence representing a single step along the path.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1611"><a href="#PathTokenizers-1611"><span class="linenos">1611</span></a>            <span class="n">step_rep_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers-1612"><a href="#PathTokenizers-1612"><span class="linenos">1612</span></a>                <span class="n">step_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers-1613"><a href="#PathTokenizers-1613"><span class="linenos">1613</span></a>                <span class="k">for</span> <span class="n">step_tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span>
</span><span id="PathTokenizers-1614"><a href="#PathTokenizers-1614"><span class="linenos">1614</span></a>            <span class="p">]</span>
</span><span id="PathTokenizers-1615"><a href="#PathTokenizers-1615"><span class="linenos">1615</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">:</span>
</span><span id="PathTokenizers-1616"><a href="#PathTokenizers-1616"><span class="linenos">1616</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="PathTokenizers-1617"><a href="#PathTokenizers-1617"><span class="linenos">1617</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="PathTokenizers-1618"><a href="#PathTokenizers-1618"><span class="linenos">1618</span></a>                <span class="p">)</span>
</span><span id="PathTokenizers-1619"><a href="#PathTokenizers-1619"><span class="linenos">1619</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_rep_tokens</span>
</span><span id="PathTokenizers-1620"><a href="#PathTokenizers-1620"><span class="linenos">1620</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="PathTokenizers-1621"><a href="#PathTokenizers-1621"><span class="linenos">1621</span></a>                    <span class="n">step_rep_tokens</span>
</span><span id="PathTokenizers-1622"><a href="#PathTokenizers-1622"><span class="linenos">1622</span></a>                <span class="p">)</span>
</span><span id="PathTokenizers-1623"><a href="#PathTokenizers-1623"><span class="linenos">1623</span></a>                <span class="n">step_rep_tokens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens_and_intra</span><span class="p">))</span>
</span><span id="PathTokenizers-1624"><a href="#PathTokenizers-1624"><span class="linenos">1624</span></a>            <span class="n">all_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers-1625"><a href="#PathTokenizers-1625"><span class="linenos">1625</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-1626"><a href="#PathTokenizers-1626"><span class="linenos">1626</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">),</span>
</span><span id="PathTokenizers-1627"><a href="#PathTokenizers-1627"><span class="linenos">1627</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_POST</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-1628"><a href="#PathTokenizers-1628"><span class="linenos">1628</span></a>            <span class="p">]</span>
</span><span id="PathTokenizers-1629"><a href="#PathTokenizers-1629"><span class="linenos">1629</span></a>            <span class="k">return</span> <span class="n">all_tokens</span>
</span><span id="PathTokenizers-1630"><a href="#PathTokenizers-1630"><span class="linenos">1630</span></a>
</span><span id="PathTokenizers-1631"><a href="#PathTokenizers-1631"><span class="linenos">1631</span></a>        <span class="k">def</span> <span class="nf">_leading_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-1632"><a href="#PathTokenizers-1632"><span class="linenos">1632</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers-1633"><a href="#PathTokenizers-1633"><span class="linenos">1633</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1634"><a href="#PathTokenizers-1634"><span class="linenos">1634</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens preceding those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers-1635"><a href="#PathTokenizers-1635"><span class="linenos">1635</span></a><span class="sd">            Since the for loop in `to_tokens` iterates `len(path)-1` times, a fencepost problem exists with `StepTokenizers.Coord`.</span>
</span><span id="PathTokenizers-1636"><a href="#PathTokenizers-1636"><span class="linenos">1636</span></a><span class="sd">            &lt;PATH_START&gt; should NOT be included.</span>
</span><span id="PathTokenizers-1637"><a href="#PathTokenizers-1637"><span class="linenos">1637</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1638"><a href="#PathTokenizers-1638"><span class="linenos">1638</span></a>            <span class="k">if</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">:</span>
</span><span id="PathTokenizers-1639"><a href="#PathTokenizers-1639"><span class="linenos">1639</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers-1640"><a href="#PathTokenizers-1640"><span class="linenos">1640</span></a>                    <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-1641"><a href="#PathTokenizers-1641"><span class="linenos">1641</span></a>                    <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]),</span>
</span><span id="PathTokenizers-1642"><a href="#PathTokenizers-1642"><span class="linenos">1642</span></a>                    <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers-1643"><a href="#PathTokenizers-1643"><span class="linenos">1643</span></a>                <span class="p">]</span>
</span><span id="PathTokenizers-1644"><a href="#PathTokenizers-1644"><span class="linenos">1644</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers-1645"><a href="#PathTokenizers-1645"><span class="linenos">1645</span></a>
</span><span id="PathTokenizers-1646"><a href="#PathTokenizers-1646"><span class="linenos">1646</span></a>        <span class="k">def</span> <span class="nf">_trailing_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers-1647"><a href="#PathTokenizers-1647"><span class="linenos">1647</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers-1648"><a href="#PathTokenizers-1648"><span class="linenos">1648</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers-1649"><a href="#PathTokenizers-1649"><span class="linenos">1649</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens following those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers-1650"><a href="#PathTokenizers-1650"><span class="linenos">1650</span></a><span class="sd">            &lt;PATH_END&gt; should NOT be included.</span>
</span><span id="PathTokenizers-1651"><a href="#PathTokenizers-1651"><span class="linenos">1651</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PathTokenizers-1652"><a href="#PathTokenizers-1652"><span class="linenos">1652</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers-1653"><a href="#PathTokenizers-1653"><span class="linenos">1653</span></a>
</span><span id="PathTokenizers-1654"><a href="#PathTokenizers-1654"><span class="linenos">1654</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PathTokenizers-1655"><a href="#PathTokenizers-1655"><span class="linenos">1655</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="PathTokenizers-1656"><a href="#PathTokenizers-1656"><span class="linenos">1656</span></a>                <span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="PathTokenizers-1657"><a href="#PathTokenizers-1657"><span class="linenos">1657</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PathTokenizers-1658"><a href="#PathTokenizers-1658"><span class="linenos">1658</span></a>
</span><span id="PathTokenizers-1659"><a href="#PathTokenizers-1659"><span class="linenos">1659</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers-1660"><a href="#PathTokenizers-1660"><span class="linenos">1660</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span>
</span><span id="PathTokenizers-1661"><a href="#PathTokenizers-1661"><span class="linenos">1661</span></a>            <span class="p">):</span>
</span><span id="PathTokenizers-1662"><a href="#PathTokenizers-1662"><span class="linenos">1662</span></a>                <span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="PathTokenizers-1663"><a href="#PathTokenizers-1663"><span class="linenos">1663</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PathTokenizers-1664"><a href="#PathTokenizers-1664"><span class="linenos">1664</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers-1665"><a href="#PathTokenizers-1665"><span class="linenos">1665</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_PathTokenizer</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="PathTokenizers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;path_tokenizer&#39;</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.key"></a>
    
    

                            </div>
                </section>
                <section id="PathTokenizers.StepSequence">
                            <input id="PathTokenizers.StepSequence-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">PathTokenizers.StepSequence</span><wbr>(<span class="base"><a href="#PathTokenizers._PathTokenizer">PathTokenizers._PathTokenizer</a></span>, <span class="base">abc.ABC</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1562-L1664" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence-1563"><a href="#PathTokenizers.StepSequence-1563"><span class="linenos">1563</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1564"><a href="#PathTokenizers.StepSequence-1564"><span class="linenos">1564</span></a>    <span class="k">class</span> <span class="nc">StepSequence</span><span class="p">(</span><span class="n">_PathTokenizer</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence-1565"><a href="#PathTokenizers.StepSequence-1565"><span class="linenos">1565</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any `PathTokenizer` where the tokenization may be assembled from token subsequences, each of which represents a step along the path.</span>
</span><span id="PathTokenizers.StepSequence-1566"><a href="#PathTokenizers.StepSequence-1566"><span class="linenos">1566</span></a><span class="sd">        Allows for a sequence of leading and trailing tokens which don&#39;t fit the step pattern.</span>
</span><span id="PathTokenizers.StepSequence-1567"><a href="#PathTokenizers.StepSequence-1567"><span class="linenos">1567</span></a>
</span><span id="PathTokenizers.StepSequence-1568"><a href="#PathTokenizers.StepSequence-1568"><span class="linenos">1568</span></a><span class="sd">        # Parameters</span>
</span><span id="PathTokenizers.StepSequence-1569"><a href="#PathTokenizers.StepSequence-1569"><span class="linenos">1569</span></a><span class="sd">        - `step_size`: Selects the size of a single step in the sequence</span>
</span><span id="PathTokenizers.StepSequence-1570"><a href="#PathTokenizers.StepSequence-1570"><span class="linenos">1570</span></a><span class="sd">        - `step_tokenizers`: Selects the combination and permutation of tokens</span>
</span><span id="PathTokenizers.StepSequence-1571"><a href="#PathTokenizers.StepSequence-1571"><span class="linenos">1571</span></a><span class="sd">        - `pre`: Whether all steps include an integral preceding delimiter token</span>
</span><span id="PathTokenizers.StepSequence-1572"><a href="#PathTokenizers.StepSequence-1572"><span class="linenos">1572</span></a><span class="sd">        - `intra`: Whether all steps include a delimiter token after each individual `_StepTokenizer` tokenization.</span>
</span><span id="PathTokenizers.StepSequence-1573"><a href="#PathTokenizers.StepSequence-1573"><span class="linenos">1573</span></a><span class="sd">        - `post`: Whether all steps include an integral following delimiter token</span>
</span><span id="PathTokenizers.StepSequence-1574"><a href="#PathTokenizers.StepSequence-1574"><span class="linenos">1574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-1575"><a href="#PathTokenizers.StepSequence-1575"><span class="linenos">1575</span></a>
</span><span id="PathTokenizers.StepSequence-1576"><a href="#PathTokenizers.StepSequence-1576"><span class="linenos">1576</span></a>        <span class="n">step_size</span><span class="p">:</span> <span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1577"><a href="#PathTokenizers.StepSequence-1577"><span class="linenos">1577</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">Singles</span><span class="p">(),</span>
</span><span id="PathTokenizers.StepSequence-1578"><a href="#PathTokenizers.StepSequence-1578"><span class="linenos">1578</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">StepSizes</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1579"><a href="#PathTokenizers.StepSequence-1579"><span class="linenos">1579</span></a>        <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1580"><a href="#PathTokenizers.StepSequence-1580"><span class="linenos">1580</span></a>        <span class="n">step_tokenizers</span><span class="p">:</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">StepTokenizerPermutation</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1581"><a href="#PathTokenizers.StepSequence-1581"><span class="linenos">1581</span></a>            <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">(),),</span>
</span><span id="PathTokenizers.StepSequence-1582"><a href="#PathTokenizers.StepSequence-1582"><span class="linenos">1582</span></a>            <span class="n">serialization_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
</span><span id="PathTokenizers.StepSequence-1583"><a href="#PathTokenizers.StepSequence-1583"><span class="linenos">1583</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">key</span><span class="p">]),</span>
</span><span id="PathTokenizers.StepSequence-1584"><a href="#PathTokenizers.StepSequence-1584"><span class="linenos">1584</span></a>        <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1585"><a href="#PathTokenizers.StepSequence-1585"><span class="linenos">1585</span></a>        <span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1586"><a href="#PathTokenizers.StepSequence-1586"><span class="linenos">1586</span></a>        <span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1587"><a href="#PathTokenizers.StepSequence-1587"><span class="linenos">1587</span></a>        <span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1588"><a href="#PathTokenizers.StepSequence-1588"><span class="linenos">1588</span></a>
</span><span id="PathTokenizers.StepSequence-1589"><a href="#PathTokenizers.StepSequence-1589"><span class="linenos">1589</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1590"><a href="#PathTokenizers.StepSequence-1590"><span class="linenos">1590</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers.StepSequence-1591"><a href="#PathTokenizers.StepSequence-1591"><span class="linenos">1591</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-1592"><a href="#PathTokenizers.StepSequence-1592"><span class="linenos">1592</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-1593"><a href="#PathTokenizers.StepSequence-1593"><span class="linenos">1593</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1594"><a href="#PathTokenizers.StepSequence-1594"><span class="linenos">1594</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1595"><a href="#PathTokenizers.StepSequence-1595"><span class="linenos">1595</span></a>                    <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-1596"><a href="#PathTokenizers.StepSequence-1596"><span class="linenos">1596</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1597"><a href="#PathTokenizers.StepSequence-1597"><span class="linenos">1597</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1598"><a href="#PathTokenizers.StepSequence-1598"><span class="linenos">1598</span></a>                    <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-1599"><a href="#PathTokenizers.StepSequence-1599"><span class="linenos">1599</span></a>                <span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1600"><a href="#PathTokenizers.StepSequence-1600"><span class="linenos">1600</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1601"><a href="#PathTokenizers.StepSequence-1601"><span class="linenos">1601</span></a>            <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-1602"><a href="#PathTokenizers.StepSequence-1602"><span class="linenos">1602</span></a>
</span><span id="PathTokenizers.StepSequence-1603"><a href="#PathTokenizers.StepSequence-1603"><span class="linenos">1603</span></a>        <span class="k">def</span> <span class="nf">_single_step_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1604"><a href="#PathTokenizers.StepSequence-1604"><span class="linenos">1604</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1605"><a href="#PathTokenizers.StepSequence-1605"><span class="linenos">1605</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1606"><a href="#PathTokenizers.StepSequence-1606"><span class="linenos">1606</span></a>            <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1607"><a href="#PathTokenizers.StepSequence-1607"><span class="linenos">1607</span></a>            <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1608"><a href="#PathTokenizers.StepSequence-1608"><span class="linenos">1608</span></a>            <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence-1609"><a href="#PathTokenizers.StepSequence-1609"><span class="linenos">1609</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-1610"><a href="#PathTokenizers.StepSequence-1610"><span class="linenos">1610</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns the token sequence representing a single step along the path.&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-1611"><a href="#PathTokenizers.StepSequence-1611"><span class="linenos">1611</span></a>            <span class="n">step_rep_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-1612"><a href="#PathTokenizers.StepSequence-1612"><span class="linenos">1612</span></a>                <span class="n">step_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1613"><a href="#PathTokenizers.StepSequence-1613"><span class="linenos">1613</span></a>                <span class="k">for</span> <span class="n">step_tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span>
</span><span id="PathTokenizers.StepSequence-1614"><a href="#PathTokenizers.StepSequence-1614"><span class="linenos">1614</span></a>            <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-1615"><a href="#PathTokenizers.StepSequence-1615"><span class="linenos">1615</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intra</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1616"><a href="#PathTokenizers.StepSequence-1616"><span class="linenos">1616</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1617"><a href="#PathTokenizers.StepSequence-1617"><span class="linenos">1617</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="PathTokenizers.StepSequence-1618"><a href="#PathTokenizers.StepSequence-1618"><span class="linenos">1618</span></a>                <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1619"><a href="#PathTokenizers.StepSequence-1619"><span class="linenos">1619</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_rep_tokens</span>
</span><span id="PathTokenizers.StepSequence-1620"><a href="#PathTokenizers.StepSequence-1620"><span class="linenos">1620</span></a>                <span class="n">step_rep_tokens_and_intra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1621"><a href="#PathTokenizers.StepSequence-1621"><span class="linenos">1621</span></a>                    <span class="n">step_rep_tokens</span>
</span><span id="PathTokenizers.StepSequence-1622"><a href="#PathTokenizers.StepSequence-1622"><span class="linenos">1622</span></a>                <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence-1623"><a href="#PathTokenizers.StepSequence-1623"><span class="linenos">1623</span></a>                <span class="n">step_rep_tokens</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens_and_intra</span><span class="p">))</span>
</span><span id="PathTokenizers.StepSequence-1624"><a href="#PathTokenizers.StepSequence-1624"><span class="linenos">1624</span></a>            <span class="n">all_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-1625"><a href="#PathTokenizers.StepSequence-1625"><span class="linenos">1625</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1626"><a href="#PathTokenizers.StepSequence-1626"><span class="linenos">1626</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span><span class="n">step_rep_tokens</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1627"><a href="#PathTokenizers.StepSequence-1627"><span class="linenos">1627</span></a>                <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_POST</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1628"><a href="#PathTokenizers.StepSequence-1628"><span class="linenos">1628</span></a>            <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-1629"><a href="#PathTokenizers.StepSequence-1629"><span class="linenos">1629</span></a>            <span class="k">return</span> <span class="n">all_tokens</span>
</span><span id="PathTokenizers.StepSequence-1630"><a href="#PathTokenizers.StepSequence-1630"><span class="linenos">1630</span></a>
</span><span id="PathTokenizers.StepSequence-1631"><a href="#PathTokenizers.StepSequence-1631"><span class="linenos">1631</span></a>        <span class="k">def</span> <span class="nf">_leading_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1632"><a href="#PathTokenizers.StepSequence-1632"><span class="linenos">1632</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers.StepSequence-1633"><a href="#PathTokenizers.StepSequence-1633"><span class="linenos">1633</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-1634"><a href="#PathTokenizers.StepSequence-1634"><span class="linenos">1634</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens preceding those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers.StepSequence-1635"><a href="#PathTokenizers.StepSequence-1635"><span class="linenos">1635</span></a><span class="sd">            Since the for loop in `to_tokens` iterates `len(path)-1` times, a fencepost problem exists with `StepTokenizers.Coord`.</span>
</span><span id="PathTokenizers.StepSequence-1636"><a href="#PathTokenizers.StepSequence-1636"><span class="linenos">1636</span></a><span class="sd">            &lt;PATH_START&gt; should NOT be included.</span>
</span><span id="PathTokenizers.StepSequence-1637"><a href="#PathTokenizers.StepSequence-1637"><span class="linenos">1637</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-1638"><a href="#PathTokenizers.StepSequence-1638"><span class="linenos">1638</span></a>            <span class="k">if</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Coord</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1639"><a href="#PathTokenizers.StepSequence-1639"><span class="linenos">1639</span></a>                <span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence-1640"><a href="#PathTokenizers.StepSequence-1640"><span class="linenos">1640</span></a>                    <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_PRE</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pre&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1641"><a href="#PathTokenizers.StepSequence-1641"><span class="linenos">1641</span></a>                    <span class="o">*</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]),</span>
</span><span id="PathTokenizers.StepSequence-1642"><a href="#PathTokenizers.StepSequence-1642"><span class="linenos">1642</span></a>                    <span class="o">*</span><span class="n">empty_sequence_if_attr_false</span><span class="p">((</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_INTRA</span><span class="p">,),</span> <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;intra&quot;</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence-1643"><a href="#PathTokenizers.StepSequence-1643"><span class="linenos">1643</span></a>                <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence-1644"><a href="#PathTokenizers.StepSequence-1644"><span class="linenos">1644</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers.StepSequence-1645"><a href="#PathTokenizers.StepSequence-1645"><span class="linenos">1645</span></a>
</span><span id="PathTokenizers.StepSequence-1646"><a href="#PathTokenizers.StepSequence-1646"><span class="linenos">1646</span></a>        <span class="k">def</span> <span class="nf">_trailing_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1647"><a href="#PathTokenizers.StepSequence-1647"><span class="linenos">1647</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Coord</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers.StepSequence-1648"><a href="#PathTokenizers.StepSequence-1648"><span class="linenos">1648</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence-1649"><a href="#PathTokenizers.StepSequence-1649"><span class="linenos">1649</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns tokens following those from the sequence from `_single_step_tokens`.</span>
</span><span id="PathTokenizers.StepSequence-1650"><a href="#PathTokenizers.StepSequence-1650"><span class="linenos">1650</span></a><span class="sd">            &lt;PATH_END&gt; should NOT be included.</span>
</span><span id="PathTokenizers.StepSequence-1651"><a href="#PathTokenizers.StepSequence-1651"><span class="linenos">1651</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence-1652"><a href="#PathTokenizers.StepSequence-1652"><span class="linenos">1652</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="PathTokenizers.StepSequence-1653"><a href="#PathTokenizers.StepSequence-1653"><span class="linenos">1653</span></a>
</span><span id="PathTokenizers.StepSequence-1654"><a href="#PathTokenizers.StepSequence-1654"><span class="linenos">1654</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1655"><a href="#PathTokenizers.StepSequence-1655"><span class="linenos">1655</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence-1656"><a href="#PathTokenizers.StepSequence-1656"><span class="linenos">1656</span></a>                <span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="PathTokenizers.StepSequence-1657"><a href="#PathTokenizers.StepSequence-1657"><span class="linenos">1657</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence-1658"><a href="#PathTokenizers.StepSequence-1658"><span class="linenos">1658</span></a>
</span><span id="PathTokenizers.StepSequence-1659"><a href="#PathTokenizers.StepSequence-1659"><span class="linenos">1659</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence-1660"><a href="#PathTokenizers.StepSequence-1660"><span class="linenos">1660</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span>
</span><span id="PathTokenizers.StepSequence-1661"><a href="#PathTokenizers.StepSequence-1661"><span class="linenos">1661</span></a>            <span class="p">):</span>
</span><span id="PathTokenizers.StepSequence-1662"><a href="#PathTokenizers.StepSequence-1662"><span class="linenos">1662</span></a>                <span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="PathTokenizers.StepSequence-1663"><a href="#PathTokenizers.StepSequence-1663"><span class="linenos">1663</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence-1664"><a href="#PathTokenizers.StepSequence-1664"><span class="linenos">1664</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence-1665"><a href="#PathTokenizers.StepSequence-1665"><span class="linenos">1665</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Any <code>PathTokenizer</code> where the tokenization may be assembled from token subsequences, each of which represents a step along the path.
Allows for a sequence of leading and trailing tokens which don't fit the step pattern.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#PathTokenizers.StepSequence.step_size">step_size</a></code>: Selects the size of a single step in the sequence</li>
<li><code><a href="#PathTokenizers.StepSequence.step_tokenizers">step_tokenizers</a></code>: Selects the combination and permutation of tokens</li>
<li><code><a href="#PathTokenizers.StepSequence.pre">pre</a></code>: Whether all steps include an integral preceding delimiter token</li>
<li><code><a href="#PathTokenizers.StepSequence.intra">intra</a></code>: Whether all steps include a delimiter token after each individual <code>_StepTokenizer</code> tokenization.</li>
<li><code><a href="#PathTokenizers.StepSequence.post">post</a></code>: Whether all steps include an integral following delimiter token</li>
</ul>
</div>


                            <div id="PathTokenizers.StepSequence.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PathTokenizers.StepSequence</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">step_size</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepSizes</span><span class="o">.</span><span class="n">_StepSize</span> <span class="o">=</span> <span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">step_tokenizers</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">,</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">StepTokenizers</span><span class="o">.</span><span class="n">_StepTokenizer</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),)</span>,</span><span class="param">	<span class="n">pre</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">intra</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">post</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.__init__"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.step_size" class="classattr">
                                <div class="attr variable">
            <span class="name">step_size</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.StepSizes._StepSize</span>        =
<span class="default_value"><a href="#StepSizes.Singles">StepSizes.Singles()</a></span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.step_size"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.step_tokenizers" class="classattr">
                                <div class="attr variable">
            <span class="name">step_tokenizers</span><span class="annotation">: tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer] | tuple[maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer, maze_dataset.tokenization.maze_tokenizer.StepTokenizers._StepTokenizer]</span>        =
<span class="default_value">(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,)</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.step_tokenizers"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.pre" class="classattr">
                                <div class="attr variable">
            <span class="name">pre</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.pre"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.intra" class="classattr">
                                <div class="attr variable">
            <span class="name">intra</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.intra"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.post" class="classattr">
                                <div class="attr variable">
            <span class="name">post</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.post"></a>
    
    

                            </div>
                            <div id="PathTokenizers.StepSequence.to_tokens" class="classattr">
                                        <input id="PathTokenizers.StepSequence.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../maze_dataset.html#SolvedMaze">maze_dataset.SolvedMaze</a></span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1588-L1600" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.to_tokens-1589"><a href="#PathTokenizers.StepSequence.to_tokens-1589"><span class="linenos">1589</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1590"><a href="#PathTokenizers.StepSequence.to_tokens-1590"><span class="linenos">1590</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">:</span> <span class="n">SolvedMaze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1591"><a href="#PathTokenizers.StepSequence.to_tokens-1591"><span class="linenos">1591</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1592"><a href="#PathTokenizers.StepSequence.to_tokens-1592"><span class="linenos">1592</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1593"><a href="#PathTokenizers.StepSequence.to_tokens-1593"><span class="linenos">1593</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_leading_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1594"><a href="#PathTokenizers.StepSequence.to_tokens-1594"><span class="linenos">1594</span></a>                <span class="o">*</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1595"><a href="#PathTokenizers.StepSequence.to_tokens-1595"><span class="linenos">1595</span></a>                    <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1596"><a href="#PathTokenizers.StepSequence.to_tokens-1596"><span class="linenos">1596</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_single_step_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1597"><a href="#PathTokenizers.StepSequence.to_tokens-1597"><span class="linenos">1597</span></a>                        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="o">.</span><span class="n">step_start_end_indices</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1598"><a href="#PathTokenizers.StepSequence.to_tokens-1598"><span class="linenos">1598</span></a>                    <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1599"><a href="#PathTokenizers.StepSequence.to_tokens-1599"><span class="linenos">1599</span></a>                <span class="p">),</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1600"><a href="#PathTokenizers.StepSequence.to_tokens-1600"><span class="linenos">1600</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_trailing_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="p">),</span>
</span><span id="PathTokenizers.StepSequence.to_tokens-1601"><a href="#PathTokenizers.StepSequence.to_tokens-1601"><span class="linenos">1601</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns tokens representing the solution path.</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.is_valid" class="classattr">
                                        <input id="PathTokenizers.StepSequence.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1653-L1664" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.is_valid-1654"><a href="#PathTokenizers.StepSequence.is_valid-1654"><span class="linenos">1654</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1655"><a href="#PathTokenizers.StepSequence.is_valid-1655"><span class="linenos">1655</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1656"><a href="#PathTokenizers.StepSequence.is_valid-1656"><span class="linenos">1656</span></a>                <span class="c1"># Uninteresting: repeated elements are not useful</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1657"><a href="#PathTokenizers.StepSequence.is_valid-1657"><span class="linenos">1657</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1658"><a href="#PathTokenizers.StepSequence.is_valid-1658"><span class="linenos">1658</span></a>
</span><span id="PathTokenizers.StepSequence.is_valid-1659"><a href="#PathTokenizers.StepSequence.is_valid-1659"><span class="linenos">1659</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1660"><a href="#PathTokenizers.StepSequence.is_valid-1660"><span class="linenos">1660</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">step_tokenizers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">StepTokenizers</span><span class="o">.</span><span class="n">Distance</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1661"><a href="#PathTokenizers.StepSequence.is_valid-1661"><span class="linenos">1661</span></a>            <span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1662"><a href="#PathTokenizers.StepSequence.is_valid-1662"><span class="linenos">1662</span></a>                <span class="c1"># Untrainable: `Distance` alone cannot encode a path. &gt;=1 `StepTokenizer` which indicates direction/location is required.</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1663"><a href="#PathTokenizers.StepSequence.is_valid-1663"><span class="linenos">1663</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1664"><a href="#PathTokenizers.StepSequence.is_valid-1664"><span class="linenos">1664</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.is_valid-1665"><a href="#PathTokenizers.StepSequence.is_valid-1665"><span class="linenos">1665</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> contains data members capable of producing an overall valid <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.
Some <code>_TokenizerElement</code> instances may be created which are not useful despite obeying data member type hints.
<code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> allows for more precise detection of invalid <code>_TokenizerElement</code>s beyond type hinting alone.
If type hints are sufficient to constrain the possible instances of some subclass, then this method may simply <code>return True</code> for that subclass.</p>

<h1 id="types-of-invalidity">Types of Invalidity</h1>

<p>In nontrivial implementations of this method, each conditional clause should contain a comment classifying the reason for invalidity and one of the types below.
Invalidity types, in ascending order of invalidity:</p>

<ul>
<li>Uninteresting: These tokenizers might be used to train functional models, but the schemes are not interesting to study.
E.g., <code>_TokenizerElement</code>s which are strictly worse than some alternative.</li>
<li>Duplicate: These tokenizers have identical tokenization behavior as some other valid tokenizers.</li>
<li>Untrainable: Training functional models using these tokenizers would be (nearly) impossible.</li>
<li>Erroneous: These tokenizers might raise exceptions during use.</li>
</ul>

<h1 id="development">Development</h1>

<p><code>is_invalid</code> is implemented to always return <code>True</code> in some abstract classes where all currently possible subclass instances are valid.
When adding new subclasses or data members, the developer should check if any such blanket statement of validity still holds and update it as neccesary.</p>

<h2 id="nesting">Nesting</h2>

<p>In general, when implementing this method, there is no need to recursively call <code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> on nested <code>_TokenizerElement</code>s contained in the class.
In other words, failures of <code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> need not bubble up to the top of the nested <code>_TokenizerElement</code> tree.
<code><a href="#MazeTokenizerModular.is_valid">MazeTokenizerModular.is_valid</a></code> calls <code><a href="#PathTokenizers.StepSequence.is_valid">is_valid</a></code> on each of its <code>_TokenizerElement</code>s individually, so failure at any level will be detected.</p>

<h2 id="types-of-invalidity-2">Types of Invalidity</h2>

<p>If it's judged to be useful, the types of invalidity could be implemented with an Enum or similar rather than only living in comments.
This could be used to create more or less stringent filters on the valid <code>_TokenizerElement</code> instances.</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.serialize" class="classattr">
                                        <input id="PathTokenizers.StepSequence.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.serialize-660"><a href="#PathTokenizers.StepSequence.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence.serialize-661"><a href="#PathTokenizers.StepSequence.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PathTokenizers.StepSequence.serialize-662"><a href="#PathTokenizers.StepSequence.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-663"><a href="#PathTokenizers.StepSequence.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="PathTokenizers.StepSequence.serialize-664"><a href="#PathTokenizers.StepSequence.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="PathTokenizers.StepSequence.serialize-665"><a href="#PathTokenizers.StepSequence.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="PathTokenizers.StepSequence.serialize-666"><a href="#PathTokenizers.StepSequence.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="PathTokenizers.StepSequence.serialize-667"><a href="#PathTokenizers.StepSequence.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-668"><a href="#PathTokenizers.StepSequence.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-669"><a href="#PathTokenizers.StepSequence.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-670"><a href="#PathTokenizers.StepSequence.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-671"><a href="#PathTokenizers.StepSequence.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-672"><a href="#PathTokenizers.StepSequence.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-673"><a href="#PathTokenizers.StepSequence.serialize-673"><span class="linenos">673</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-674"><a href="#PathTokenizers.StepSequence.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="PathTokenizers.StepSequence.serialize-675"><a href="#PathTokenizers.StepSequence.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-676"><a href="#PathTokenizers.StepSequence.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-677"><a href="#PathTokenizers.StepSequence.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="PathTokenizers.StepSequence.serialize-678"><a href="#PathTokenizers.StepSequence.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-679"><a href="#PathTokenizers.StepSequence.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="PathTokenizers.StepSequence.serialize-680"><a href="#PathTokenizers.StepSequence.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-681"><a href="#PathTokenizers.StepSequence.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.serialize-682"><a href="#PathTokenizers.StepSequence.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="PathTokenizers.StepSequence.serialize-683"><a href="#PathTokenizers.StepSequence.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-684"><a href="#PathTokenizers.StepSequence.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.serialize-685"><a href="#PathTokenizers.StepSequence.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="PathTokenizers.StepSequence.serialize-686"><a href="#PathTokenizers.StepSequence.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="PathTokenizers.StepSequence.serialize-687"><a href="#PathTokenizers.StepSequence.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-688"><a href="#PathTokenizers.StepSequence.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-689"><a href="#PathTokenizers.StepSequence.serialize-689"><span class="linenos">689</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-690"><a href="#PathTokenizers.StepSequence.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="PathTokenizers.StepSequence.serialize-691"><a href="#PathTokenizers.StepSequence.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PathTokenizers.StepSequence.serialize-692"><a href="#PathTokenizers.StepSequence.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-693"><a href="#PathTokenizers.StepSequence.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-694"><a href="#PathTokenizers.StepSequence.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-695"><a href="#PathTokenizers.StepSequence.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="PathTokenizers.StepSequence.serialize-696"><a href="#PathTokenizers.StepSequence.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-697"><a href="#PathTokenizers.StepSequence.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-698"><a href="#PathTokenizers.StepSequence.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-699"><a href="#PathTokenizers.StepSequence.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.serialize-700"><a href="#PathTokenizers.StepSequence.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="PathTokenizers.StepSequence.serialize-701"><a href="#PathTokenizers.StepSequence.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-702"><a href="#PathTokenizers.StepSequence.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="PathTokenizers.StepSequence.serialize-703"><a href="#PathTokenizers.StepSequence.serialize-703"><span class="linenos">703</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-704"><a href="#PathTokenizers.StepSequence.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="PathTokenizers.StepSequence.serialize-705"><a href="#PathTokenizers.StepSequence.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-706"><a href="#PathTokenizers.StepSequence.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.serialize-707"><a href="#PathTokenizers.StepSequence.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-708"><a href="#PathTokenizers.StepSequence.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PathTokenizers.StepSequence.serialize-709"><a href="#PathTokenizers.StepSequence.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.serialize-710"><a href="#PathTokenizers.StepSequence.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.serialize-711"><a href="#PathTokenizers.StepSequence.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-712"><a href="#PathTokenizers.StepSequence.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-713"><a href="#PathTokenizers.StepSequence.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.serialize-714"><a href="#PathTokenizers.StepSequence.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.serialize-715"><a href="#PathTokenizers.StepSequence.serialize-715"><span class="linenos">715</span></a>
</span><span id="PathTokenizers.StepSequence.serialize-716"><a href="#PathTokenizers.StepSequence.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.load" class="classattr">
                                        <input id="PathTokenizers.StepSequence.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.load-723"><a href="#PathTokenizers.StepSequence.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="PathTokenizers.StepSequence.load-724"><a href="#PathTokenizers.StepSequence.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="PathTokenizers.StepSequence.load-725"><a href="#PathTokenizers.StepSequence.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="PathTokenizers.StepSequence.load-726"><a href="#PathTokenizers.StepSequence.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-727"><a href="#PathTokenizers.StepSequence.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="PathTokenizers.StepSequence.load-728"><a href="#PathTokenizers.StepSequence.load-728"><span class="linenos">728</span></a>
</span><span id="PathTokenizers.StepSequence.load-729"><a href="#PathTokenizers.StepSequence.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-730"><a href="#PathTokenizers.StepSequence.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="PathTokenizers.StepSequence.load-731"><a href="#PathTokenizers.StepSequence.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-732"><a href="#PathTokenizers.StepSequence.load-732"><span class="linenos">732</span></a>
</span><span id="PathTokenizers.StepSequence.load-733"><a href="#PathTokenizers.StepSequence.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-734"><a href="#PathTokenizers.StepSequence.load-734"><span class="linenos">734</span></a>
</span><span id="PathTokenizers.StepSequence.load-735"><a href="#PathTokenizers.StepSequence.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="PathTokenizers.StepSequence.load-736"><a href="#PathTokenizers.StepSequence.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.load-737"><a href="#PathTokenizers.StepSequence.load-737"><span class="linenos">737</span></a>
</span><span id="PathTokenizers.StepSequence.load-738"><a href="#PathTokenizers.StepSequence.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="PathTokenizers.StepSequence.load-739"><a href="#PathTokenizers.StepSequence.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-740"><a href="#PathTokenizers.StepSequence.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="PathTokenizers.StepSequence.load-741"><a href="#PathTokenizers.StepSequence.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-742"><a href="#PathTokenizers.StepSequence.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="PathTokenizers.StepSequence.load-743"><a href="#PathTokenizers.StepSequence.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-744"><a href="#PathTokenizers.StepSequence.load-744"><span class="linenos">744</span></a>
</span><span id="PathTokenizers.StepSequence.load-745"><a href="#PathTokenizers.StepSequence.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="PathTokenizers.StepSequence.load-746"><a href="#PathTokenizers.StepSequence.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-747"><a href="#PathTokenizers.StepSequence.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="PathTokenizers.StepSequence.load-748"><a href="#PathTokenizers.StepSequence.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="PathTokenizers.StepSequence.load-749"><a href="#PathTokenizers.StepSequence.load-749"><span class="linenos">749</span></a>
</span><span id="PathTokenizers.StepSequence.load-750"><a href="#PathTokenizers.StepSequence.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="PathTokenizers.StepSequence.load-751"><a href="#PathTokenizers.StepSequence.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-752"><a href="#PathTokenizers.StepSequence.load-752"><span class="linenos">752</span></a>
</span><span id="PathTokenizers.StepSequence.load-753"><a href="#PathTokenizers.StepSequence.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="PathTokenizers.StepSequence.load-754"><a href="#PathTokenizers.StepSequence.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-755"><a href="#PathTokenizers.StepSequence.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="PathTokenizers.StepSequence.load-756"><a href="#PathTokenizers.StepSequence.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-757"><a href="#PathTokenizers.StepSequence.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-758"><a href="#PathTokenizers.StepSequence.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="PathTokenizers.StepSequence.load-759"><a href="#PathTokenizers.StepSequence.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-760"><a href="#PathTokenizers.StepSequence.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-761"><a href="#PathTokenizers.StepSequence.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PathTokenizers.StepSequence.load-762"><a href="#PathTokenizers.StepSequence.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-763"><a href="#PathTokenizers.StepSequence.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-764"><a href="#PathTokenizers.StepSequence.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-765"><a href="#PathTokenizers.StepSequence.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="PathTokenizers.StepSequence.load-766"><a href="#PathTokenizers.StepSequence.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PathTokenizers.StepSequence.load-767"><a href="#PathTokenizers.StepSequence.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-768"><a href="#PathTokenizers.StepSequence.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-769"><a href="#PathTokenizers.StepSequence.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.load-770"><a href="#PathTokenizers.StepSequence.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PathTokenizers.StepSequence.load-771"><a href="#PathTokenizers.StepSequence.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-772"><a href="#PathTokenizers.StepSequence.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-773"><a href="#PathTokenizers.StepSequence.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="PathTokenizers.StepSequence.load-774"><a href="#PathTokenizers.StepSequence.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="PathTokenizers.StepSequence.load-775"><a href="#PathTokenizers.StepSequence.load-775"><span class="linenos">775</span></a>
</span><span id="PathTokenizers.StepSequence.load-776"><a href="#PathTokenizers.StepSequence.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="PathTokenizers.StepSequence.load-777"><a href="#PathTokenizers.StepSequence.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PathTokenizers.StepSequence.load-778"><a href="#PathTokenizers.StepSequence.load-778"><span class="linenos">778</span></a>
</span><span id="PathTokenizers.StepSequence.load-779"><a href="#PathTokenizers.StepSequence.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="PathTokenizers.StepSequence.load-780"><a href="#PathTokenizers.StepSequence.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-781"><a href="#PathTokenizers.StepSequence.load-781"><span class="linenos">781</span></a>
</span><span id="PathTokenizers.StepSequence.load-782"><a href="#PathTokenizers.StepSequence.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="PathTokenizers.StepSequence.load-783"><a href="#PathTokenizers.StepSequence.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.load-784"><a href="#PathTokenizers.StepSequence.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="PathTokenizers.StepSequence.load-785"><a href="#PathTokenizers.StepSequence.load-785"><span class="linenos">785</span></a>
</span><span id="PathTokenizers.StepSequence.load-786"><a href="#PathTokenizers.StepSequence.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="PathTokenizers.StepSequence.load-787"><a href="#PathTokenizers.StepSequence.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="PathTokenizers.StepSequence.validate_fields_types" class="classattr">
                                        <input id="PathTokenizers.StepSequence.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PathTokenizers.StepSequence.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PathTokenizers.StepSequence.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PathTokenizers.StepSequence.validate_fields_types-271"><a href="#PathTokenizers.StepSequence.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-272"><a href="#PathTokenizers.StepSequence.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-273"><a href="#PathTokenizers.StepSequence.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-274"><a href="#PathTokenizers.StepSequence.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-275"><a href="#PathTokenizers.StepSequence.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-276"><a href="#PathTokenizers.StepSequence.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-277"><a href="#PathTokenizers.StepSequence.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-278"><a href="#PathTokenizers.StepSequence.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-279"><a href="#PathTokenizers.StepSequence.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="PathTokenizers.StepSequence.validate_fields_types-280"><a href="#PathTokenizers.StepSequence.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PathTokenizers._PathTokenizer">PathTokenizers._PathTokenizer</a></dt>
                                <dd id="PathTokenizers.StepSequence.attribute_key" class="function"><a href="#PathTokenizers._PathTokenizer.attribute_key">attribute_key</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="PathTokenizers.StepSequence.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="PathTokenizers.StepSequence.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="PathTokenizers.StepSequence.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="PathTokenizers.StepSequence.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="PathTokenizers.StepSequence.validate_field_type" class="function">validate_field_type</dd>
                <dd id="PathTokenizers.StepSequence.diff" class="function">diff</dd>
                <dd id="PathTokenizers.StepSequence.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PromptSequencers">
                            <input id="PromptSequencers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PromptSequencers</span><wbr>(<span class="base"><a href="#__TokenizerElementNamespace">__TokenizerElementNamespace</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1667-L1900" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers-1668"><a href="#PromptSequencers-1668"><span class="linenos">1668</span></a><span class="k">class</span> <span class="nc">PromptSequencers</span><span class="p">(</span><span class="n">__TokenizerElementNamespace</span><span class="p">):</span>
</span><span id="PromptSequencers-1669"><a href="#PromptSequencers-1669"><span class="linenos">1669</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Namespace for `_PromptSequencer` subclass hierarchy used by `MazeTokenizerModular`.&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1670"><a href="#PromptSequencers-1670"><span class="linenos">1670</span></a>
</span><span id="PromptSequencers-1671"><a href="#PromptSequencers-1671"><span class="linenos">1671</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;prompt_sequencer&quot;</span>
</span><span id="PromptSequencers-1672"><a href="#PromptSequencers-1672"><span class="linenos">1672</span></a>
</span><span id="PromptSequencers-1673"><a href="#PromptSequencers-1673"><span class="linenos">1673</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers-1674"><a href="#PromptSequencers-1674"><span class="linenos">1674</span></a>    <span class="k">class</span> <span class="nc">_PromptSequencer</span><span class="p">(</span><span class="n">_TokenizerElement</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="PromptSequencers-1675"><a href="#PromptSequencers-1675"><span class="linenos">1675</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1676"><a href="#PromptSequencers-1676"><span class="linenos">1676</span></a><span class="sd">        Sequences token regions into a complete maze tokenization.</span>
</span><span id="PromptSequencers-1677"><a href="#PromptSequencers-1677"><span class="linenos">1677</span></a>
</span><span id="PromptSequencers-1678"><a href="#PromptSequencers-1678"><span class="linenos">1678</span></a><span class="sd">        # Parameters</span>
</span><span id="PromptSequencers-1679"><a href="#PromptSequencers-1679"><span class="linenos">1679</span></a><span class="sd">        - `coord_tokenizer`: Tokenizer element which tokenizes a single `Coord` aka maze position.</span>
</span><span id="PromptSequencers-1680"><a href="#PromptSequencers-1680"><span class="linenos">1680</span></a><span class="sd">        - `adj_list_tokenizer`: Tokenizer element which tokenizes the adjacency list of a `LatticeMaze`.</span>
</span><span id="PromptSequencers-1681"><a href="#PromptSequencers-1681"><span class="linenos">1681</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if needed in other `TokenizerElement`s.</span>
</span><span id="PromptSequencers-1682"><a href="#PromptSequencers-1682"><span class="linenos">1682</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1683"><a href="#PromptSequencers-1683"><span class="linenos">1683</span></a>
</span><span id="PromptSequencers-1684"><a href="#PromptSequencers-1684"><span class="linenos">1684</span></a>        <span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1685"><a href="#PromptSequencers-1685"><span class="linenos">1685</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">(),</span>
</span><span id="PromptSequencers-1686"><a href="#PromptSequencers-1686"><span class="linenos">1686</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">CoordTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1687"><a href="#PromptSequencers-1687"><span class="linenos">1687</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers-1688"><a href="#PromptSequencers-1688"><span class="linenos">1688</span></a>        <span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1689"><a href="#PromptSequencers-1689"><span class="linenos">1689</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">AdjListCoord</span><span class="p">(),</span>
</span><span id="PromptSequencers-1690"><a href="#PromptSequencers-1690"><span class="linenos">1690</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">AdjListTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1691"><a href="#PromptSequencers-1691"><span class="linenos">1691</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers-1692"><a href="#PromptSequencers-1692"><span class="linenos">1692</span></a>
</span><span id="PromptSequencers-1693"><a href="#PromptSequencers-1693"><span class="linenos">1693</span></a>        <span class="nd">@classmethod</span>
</span><span id="PromptSequencers-1694"><a href="#PromptSequencers-1694"><span class="linenos">1694</span></a>        <span class="k">def</span> <span class="nf">attribute_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PromptSequencers-1695"><a href="#PromptSequencers-1695"><span class="linenos">1695</span></a>            <span class="k">return</span> <span class="n">PromptSequencers</span><span class="o">.</span><span class="n">key</span>
</span><span id="PromptSequencers-1696"><a href="#PromptSequencers-1696"><span class="linenos">1696</span></a>
</span><span id="PromptSequencers-1697"><a href="#PromptSequencers-1697"><span class="linenos">1697</span></a>        <span class="nd">@staticmethod</span>
</span><span id="PromptSequencers-1698"><a href="#PromptSequencers-1698"><span class="linenos">1698</span></a>        <span class="k">def</span> <span class="nf">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="PromptSequencers-1699"><a href="#PromptSequencers-1699"><span class="linenos">1699</span></a>            <span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">is_untargeted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">is_unsolved</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PromptSequencers-1700"><a href="#PromptSequencers-1700"><span class="linenos">1700</span></a>        <span class="p">):</span>
</span><span id="PromptSequencers-1701"><a href="#PromptSequencers-1701"><span class="linenos">1701</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Trims a full `SolvedMaze` prompt if the maze data reflects an unsolved or untargeted maze.</span>
</span><span id="PromptSequencers-1702"><a href="#PromptSequencers-1702"><span class="linenos">1702</span></a>
</span><span id="PromptSequencers-1703"><a href="#PromptSequencers-1703"><span class="linenos">1703</span></a><span class="sd">            # Development</span>
</span><span id="PromptSequencers-1704"><a href="#PromptSequencers-1704"><span class="linenos">1704</span></a><span class="sd">            This implementation should function for `AOTP`, `AOP`, and other concrete classes using any subsequence of AOTP.</span>
</span><span id="PromptSequencers-1705"><a href="#PromptSequencers-1705"><span class="linenos">1705</span></a><span class="sd">            It is not located in `token_utils.py` because it may need to be overridden in more exotic `PromptSequencer` subclasses.</span>
</span><span id="PromptSequencers-1706"><a href="#PromptSequencers-1706"><span class="linenos">1706</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1707"><a href="#PromptSequencers-1707"><span class="linenos">1707</span></a>            <span class="k">if</span> <span class="n">is_untargeted</span><span class="p">:</span>
</span><span id="PromptSequencers-1708"><a href="#PromptSequencers-1708"><span class="linenos">1708</span></a>                <span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="PromptSequencers-1709"><a href="#PromptSequencers-1709"><span class="linenos">1709</span></a>                    <span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1710"><a href="#PromptSequencers-1710"><span class="linenos">1710</span></a>                    <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1711"><a href="#PromptSequencers-1711"><span class="linenos">1711</span></a>                    <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1712"><a href="#PromptSequencers-1712"><span class="linenos">1712</span></a>                    <span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1713"><a href="#PromptSequencers-1713"><span class="linenos">1713</span></a>                    <span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1714"><a href="#PromptSequencers-1714"><span class="linenos">1714</span></a>                <span class="p">)</span>
</span><span id="PromptSequencers-1715"><a href="#PromptSequencers-1715"><span class="linenos">1715</span></a>            <span class="k">if</span> <span class="n">is_unsolved</span><span class="p">:</span>
</span><span id="PromptSequencers-1716"><a href="#PromptSequencers-1716"><span class="linenos">1716</span></a>                <span class="k">if</span> <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span> <span class="ow">in</span> <span class="n">untrimmed</span><span class="p">:</span>
</span><span id="PromptSequencers-1717"><a href="#PromptSequencers-1717"><span class="linenos">1717</span></a>                    <span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="PromptSequencers-1718"><a href="#PromptSequencers-1718"><span class="linenos">1718</span></a>                        <span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1719"><a href="#PromptSequencers-1719"><span class="linenos">1719</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1720"><a href="#PromptSequencers-1720"><span class="linenos">1720</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1721"><a href="#PromptSequencers-1721"><span class="linenos">1721</span></a>                        <span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1722"><a href="#PromptSequencers-1722"><span class="linenos">1722</span></a>                        <span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1723"><a href="#PromptSequencers-1723"><span class="linenos">1723</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers-1724"><a href="#PromptSequencers-1724"><span class="linenos">1724</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers-1725"><a href="#PromptSequencers-1725"><span class="linenos">1725</span></a>                    <span class="k">return</span> <span class="n">tokens_between</span><span class="p">(</span>
</span><span id="PromptSequencers-1726"><a href="#PromptSequencers-1726"><span class="linenos">1726</span></a>                        <span class="n">untrimmed</span><span class="p">,</span>
</span><span id="PromptSequencers-1727"><a href="#PromptSequencers-1727"><span class="linenos">1727</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1728"><a href="#PromptSequencers-1728"><span class="linenos">1728</span></a>                        <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1729"><a href="#PromptSequencers-1729"><span class="linenos">1729</span></a>                        <span class="n">include_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1730"><a href="#PromptSequencers-1730"><span class="linenos">1730</span></a>                        <span class="n">include_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PromptSequencers-1731"><a href="#PromptSequencers-1731"><span class="linenos">1731</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers-1732"><a href="#PromptSequencers-1732"><span class="linenos">1732</span></a>            <span class="k">return</span> <span class="n">untrimmed</span>
</span><span id="PromptSequencers-1733"><a href="#PromptSequencers-1733"><span class="linenos">1733</span></a>
</span><span id="PromptSequencers-1734"><a href="#PromptSequencers-1734"><span class="linenos">1734</span></a>        <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1735"><a href="#PromptSequencers-1735"><span class="linenos">1735</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1736"><a href="#PromptSequencers-1736"><span class="linenos">1736</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="PromptSequencers-1737"><a href="#PromptSequencers-1737"><span class="linenos">1737</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="PromptSequencers-1738"><a href="#PromptSequencers-1738"><span class="linenos">1738</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="PromptSequencers-1739"><a href="#PromptSequencers-1739"><span class="linenos">1739</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1740"><a href="#PromptSequencers-1740"><span class="linenos">1740</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns a complete list of tokens for a given set of maze elements.&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1741"><a href="#PromptSequencers-1741"><span class="linenos">1741</span></a>            <span class="n">untrimmed</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1742"><a href="#PromptSequencers-1742"><span class="linenos">1742</span></a>                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_prompt_regions</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="PromptSequencers-1743"><a href="#PromptSequencers-1743"><span class="linenos">1743</span></a>            <span class="p">)</span>
</span><span id="PromptSequencers-1744"><a href="#PromptSequencers-1744"><span class="linenos">1744</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trim_if_unsolved_maze</span><span class="p">(</span>
</span><span id="PromptSequencers-1745"><a href="#PromptSequencers-1745"><span class="linenos">1745</span></a>                <span class="n">untrimmed</span><span class="p">,</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">),</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1746"><a href="#PromptSequencers-1746"><span class="linenos">1746</span></a>            <span class="p">)</span>
</span><span id="PromptSequencers-1747"><a href="#PromptSequencers-1747"><span class="linenos">1747</span></a>
</span><span id="PromptSequencers-1748"><a href="#PromptSequencers-1748"><span class="linenos">1748</span></a>        <span class="k">def</span> <span class="nf">_get_prompt_regions</span><span class="p">(</span>
</span><span id="PromptSequencers-1749"><a href="#PromptSequencers-1749"><span class="linenos">1749</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1750"><a href="#PromptSequencers-1750"><span class="linenos">1750</span></a>            <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="PromptSequencers-1751"><a href="#PromptSequencers-1751"><span class="linenos">1751</span></a>            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="PromptSequencers-1752"><a href="#PromptSequencers-1752"><span class="linenos">1752</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="PromptSequencers-1753"><a href="#PromptSequencers-1753"><span class="linenos">1753</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="PromptSequencers-1754"><a href="#PromptSequencers-1754"><span class="linenos">1754</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Gets the prompt regions of a maze in a fixed sequence.</span>
</span><span id="PromptSequencers-1755"><a href="#PromptSequencers-1755"><span class="linenos">1755</span></a>
</span><span id="PromptSequencers-1756"><a href="#PromptSequencers-1756"><span class="linenos">1756</span></a><span class="sd">            This method is NOT responsible for including/excluding any prompt regions.</span>
</span><span id="PromptSequencers-1757"><a href="#PromptSequencers-1757"><span class="linenos">1757</span></a><span class="sd">            Always return according to the API described under Returns.</span>
</span><span id="PromptSequencers-1758"><a href="#PromptSequencers-1758"><span class="linenos">1758</span></a><span class="sd">            This implementation is expected to be suitable for most `PromptSequencer` subclasses.</span>
</span><span id="PromptSequencers-1759"><a href="#PromptSequencers-1759"><span class="linenos">1759</span></a><span class="sd">            Subclasses may override this method if needed for special behavior.</span>
</span><span id="PromptSequencers-1760"><a href="#PromptSequencers-1760"><span class="linenos">1760</span></a>
</span><span id="PromptSequencers-1761"><a href="#PromptSequencers-1761"><span class="linenos">1761</span></a><span class="sd">            # Returns</span>
</span><span id="PromptSequencers-1762"><a href="#PromptSequencers-1762"><span class="linenos">1762</span></a><span class="sd">            - [0]: list[str] Adjacency list tokens</span>
</span><span id="PromptSequencers-1763"><a href="#PromptSequencers-1763"><span class="linenos">1763</span></a><span class="sd">            - [1]: list[str] Origin tokens</span>
</span><span id="PromptSequencers-1764"><a href="#PromptSequencers-1764"><span class="linenos">1764</span></a><span class="sd">            - [2]: list[str] Target tokens</span>
</span><span id="PromptSequencers-1765"><a href="#PromptSequencers-1765"><span class="linenos">1765</span></a><span class="sd">            - [3]: list[str] Path tokens</span>
</span><span id="PromptSequencers-1766"><a href="#PromptSequencers-1766"><span class="linenos">1766</span></a>
</span><span id="PromptSequencers-1767"><a href="#PromptSequencers-1767"><span class="linenos">1767</span></a><span class="sd">            # `None`-valued Args</span>
</span><span id="PromptSequencers-1768"><a href="#PromptSequencers-1768"><span class="linenos">1768</span></a><span class="sd">            If one or more of `origin`, `target`, or `path` are `None`, that indicates that an unsolved or untargeted maze is being tokenized.</span>
</span><span id="PromptSequencers-1769"><a href="#PromptSequencers-1769"><span class="linenos">1769</span></a><span class="sd">            To ensure unpackability in `_sequence_tokens`, these `None` values are substituted for empty iterables.</span>
</span><span id="PromptSequencers-1770"><a href="#PromptSequencers-1770"><span class="linenos">1770</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1771"><a href="#PromptSequencers-1771"><span class="linenos">1771</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="n">Coord</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;start_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers-1772"><a href="#PromptSequencers-1772"><span class="linenos">1772</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coord</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PromptSequencers-1773"><a href="#PromptSequencers-1773"><span class="linenos">1773</span></a>                <span class="nb">getattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;end_pos&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers-1774"><a href="#PromptSequencers-1774"><span class="linenos">1774</span></a>            <span class="p">]</span>  <span class="c1"># TargetTokenizer requires target: Sequence[Coord]</span>
</span><span id="PromptSequencers-1775"><a href="#PromptSequencers-1775"><span class="linenos">1775</span></a>
</span><span id="PromptSequencers-1776"><a href="#PromptSequencers-1776"><span class="linenos">1776</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers-1777"><a href="#PromptSequencers-1777"><span class="linenos">1777</span></a>                <span class="p">(</span>
</span><span id="PromptSequencers-1778"><a href="#PromptSequencers-1778"><span class="linenos">1778</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">adj_list_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1779"><a href="#PromptSequencers-1779"><span class="linenos">1779</span></a>                        <span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span>
</span><span id="PromptSequencers-1780"><a href="#PromptSequencers-1780"><span class="linenos">1780</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers-1781"><a href="#PromptSequencers-1781"><span class="linenos">1781</span></a>                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;adj_list_tokenizer&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1782"><a href="#PromptSequencers-1782"><span class="linenos">1782</span></a>                    <span class="k">else</span> <span class="p">[]</span>
</span><span id="PromptSequencers-1783"><a href="#PromptSequencers-1783"><span class="linenos">1783</span></a>                <span class="p">),</span>
</span><span id="PromptSequencers-1784"><a href="#PromptSequencers-1784"><span class="linenos">1784</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
</span><span id="PromptSequencers-1785"><a href="#PromptSequencers-1785"><span class="linenos">1785</span></a>                <span class="p">(</span>
</span><span id="PromptSequencers-1786"><a href="#PromptSequencers-1786"><span class="linenos">1786</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1787"><a href="#PromptSequencers-1787"><span class="linenos">1787</span></a>                        <span class="n">target</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span>
</span><span id="PromptSequencers-1788"><a href="#PromptSequencers-1788"><span class="linenos">1788</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers-1789"><a href="#PromptSequencers-1789"><span class="linenos">1789</span></a>                    <span class="k">if</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;target_tokenizer&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1790"><a href="#PromptSequencers-1790"><span class="linenos">1790</span></a>                    <span class="k">else</span> <span class="p">[]</span>
</span><span id="PromptSequencers-1791"><a href="#PromptSequencers-1791"><span class="linenos">1791</span></a>                <span class="p">),</span>
</span><span id="PromptSequencers-1792"><a href="#PromptSequencers-1792"><span class="linenos">1792</span></a>                <span class="p">(</span>
</span><span id="PromptSequencers-1793"><a href="#PromptSequencers-1793"><span class="linenos">1793</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">path_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1794"><a href="#PromptSequencers-1794"><span class="linenos">1794</span></a>                        <span class="n">maze</span><span class="p">,</span> <span class="n">coord_tokenizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_tokenizer</span>
</span><span id="PromptSequencers-1795"><a href="#PromptSequencers-1795"><span class="linenos">1795</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers-1796"><a href="#PromptSequencers-1796"><span class="linenos">1796</span></a>                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="s2">&quot;solution&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;path_tokenizer&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers-1797"><a href="#PromptSequencers-1797"><span class="linenos">1797</span></a>                    <span class="k">else</span> <span class="p">[]</span>
</span><span id="PromptSequencers-1798"><a href="#PromptSequencers-1798"><span class="linenos">1798</span></a>                <span class="p">),</span>
</span><span id="PromptSequencers-1799"><a href="#PromptSequencers-1799"><span class="linenos">1799</span></a>            <span class="p">]</span>
</span><span id="PromptSequencers-1800"><a href="#PromptSequencers-1800"><span class="linenos">1800</span></a>
</span><span id="PromptSequencers-1801"><a href="#PromptSequencers-1801"><span class="linenos">1801</span></a>        <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="PromptSequencers-1802"><a href="#PromptSequencers-1802"><span class="linenos">1802</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1803"><a href="#PromptSequencers-1803"><span class="linenos">1803</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1804"><a href="#PromptSequencers-1804"><span class="linenos">1804</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1805"><a href="#PromptSequencers-1805"><span class="linenos">1805</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PromptSequencers-1806"><a href="#PromptSequencers-1806"><span class="linenos">1806</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PromptSequencers-1807"><a href="#PromptSequencers-1807"><span class="linenos">1807</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PromptSequencers-1808"><a href="#PromptSequencers-1808"><span class="linenos">1808</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1809"><a href="#PromptSequencers-1809"><span class="linenos">1809</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Sequences token regions into a complete prompt.</span>
</span><span id="PromptSequencers-1810"><a href="#PromptSequencers-1810"><span class="linenos">1810</span></a><span class="sd">            Includes any boundary tokens in `constants.SPECIAL_TOKENS` such as &lt;ADJLIST_START&gt;, &lt;ORIGIN_END&gt;, etc.</span>
</span><span id="PromptSequencers-1811"><a href="#PromptSequencers-1811"><span class="linenos">1811</span></a><span class="sd">            # Parameters</span>
</span><span id="PromptSequencers-1812"><a href="#PromptSequencers-1812"><span class="linenos">1812</span></a><span class="sd">            - `adj_list`: Tokens representing the adjacency list</span>
</span><span id="PromptSequencers-1813"><a href="#PromptSequencers-1813"><span class="linenos">1813</span></a><span class="sd">            - `origin`: Tokens representing the origin</span>
</span><span id="PromptSequencers-1814"><a href="#PromptSequencers-1814"><span class="linenos">1814</span></a><span class="sd">            - `target`: Tokens representing the target</span>
</span><span id="PromptSequencers-1815"><a href="#PromptSequencers-1815"><span class="linenos">1815</span></a><span class="sd">            - `path`: Tokens representing the path</span>
</span><span id="PromptSequencers-1816"><a href="#PromptSequencers-1816"><span class="linenos">1816</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1817"><a href="#PromptSequencers-1817"><span class="linenos">1817</span></a>            <span class="k">pass</span>
</span><span id="PromptSequencers-1818"><a href="#PromptSequencers-1818"><span class="linenos">1818</span></a>
</span><span id="PromptSequencers-1819"><a href="#PromptSequencers-1819"><span class="linenos">1819</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PromptSequencers-1820"><a href="#PromptSequencers-1820"><span class="linenos">1820</span></a>            <span class="c1"># No invalid instances possible within data member type hint bounds</span>
</span><span id="PromptSequencers-1821"><a href="#PromptSequencers-1821"><span class="linenos">1821</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="PromptSequencers-1822"><a href="#PromptSequencers-1822"><span class="linenos">1822</span></a>
</span><span id="PromptSequencers-1823"><a href="#PromptSequencers-1823"><span class="linenos">1823</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers-1824"><a href="#PromptSequencers-1824"><span class="linenos">1824</span></a>    <span class="k">class</span> <span class="nc">AOTP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers-1825"><a href="#PromptSequencers-1825"><span class="linenos">1825</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1826"><a href="#PromptSequencers-1826"><span class="linenos">1826</span></a><span class="sd">        Sequences a prompt as [adjacency list, origin, target, path].</span>
</span><span id="PromptSequencers-1827"><a href="#PromptSequencers-1827"><span class="linenos">1827</span></a>
</span><span id="PromptSequencers-1828"><a href="#PromptSequencers-1828"><span class="linenos">1828</span></a><span class="sd">        # Parameters</span>
</span><span id="PromptSequencers-1829"><a href="#PromptSequencers-1829"><span class="linenos">1829</span></a><span class="sd">        - `target_tokenizer`: Tokenizer element which tokenizes the target(s) of a `TargetedLatticeMaze`.</span>
</span><span id="PromptSequencers-1830"><a href="#PromptSequencers-1830"><span class="linenos">1830</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `TargetTokenizer`.</span>
</span><span id="PromptSequencers-1831"><a href="#PromptSequencers-1831"><span class="linenos">1831</span></a><span class="sd">        - `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers-1832"><a href="#PromptSequencers-1832"><span class="linenos">1832</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers-1833"><a href="#PromptSequencers-1833"><span class="linenos">1833</span></a>
</span><span id="PromptSequencers-1834"><a href="#PromptSequencers-1834"><span class="linenos">1834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1835"><a href="#PromptSequencers-1835"><span class="linenos">1835</span></a>
</span><span id="PromptSequencers-1836"><a href="#PromptSequencers-1836"><span class="linenos">1836</span></a>        <span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1837"><a href="#PromptSequencers-1837"><span class="linenos">1837</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">Unlabeled</span><span class="p">(),</span>
</span><span id="PromptSequencers-1838"><a href="#PromptSequencers-1838"><span class="linenos">1838</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">TargetTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1839"><a href="#PromptSequencers-1839"><span class="linenos">1839</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers-1840"><a href="#PromptSequencers-1840"><span class="linenos">1840</span></a>        <span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1841"><a href="#PromptSequencers-1841"><span class="linenos">1841</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers-1842"><a href="#PromptSequencers-1842"><span class="linenos">1842</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1843"><a href="#PromptSequencers-1843"><span class="linenos">1843</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers-1844"><a href="#PromptSequencers-1844"><span class="linenos">1844</span></a>
</span><span id="PromptSequencers-1845"><a href="#PromptSequencers-1845"><span class="linenos">1845</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1846"><a href="#PromptSequencers-1846"><span class="linenos">1846</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1847"><a href="#PromptSequencers-1847"><span class="linenos">1847</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1848"><a href="#PromptSequencers-1848"><span class="linenos">1848</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1849"><a href="#PromptSequencers-1849"><span class="linenos">1849</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1850"><a href="#PromptSequencers-1850"><span class="linenos">1850</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1851"><a href="#PromptSequencers-1851"><span class="linenos">1851</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1852"><a href="#PromptSequencers-1852"><span class="linenos">1852</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers-1853"><a href="#PromptSequencers-1853"><span class="linenos">1853</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1854"><a href="#PromptSequencers-1854"><span class="linenos">1854</span></a>                <span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers-1855"><a href="#PromptSequencers-1855"><span class="linenos">1855</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1856"><a href="#PromptSequencers-1856"><span class="linenos">1856</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1857"><a href="#PromptSequencers-1857"><span class="linenos">1857</span></a>                <span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers-1858"><a href="#PromptSequencers-1858"><span class="linenos">1858</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1859"><a href="#PromptSequencers-1859"><span class="linenos">1859</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1860"><a href="#PromptSequencers-1860"><span class="linenos">1860</span></a>                <span class="o">*</span><span class="n">target</span><span class="p">,</span>
</span><span id="PromptSequencers-1861"><a href="#PromptSequencers-1861"><span class="linenos">1861</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1862"><a href="#PromptSequencers-1862"><span class="linenos">1862</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1863"><a href="#PromptSequencers-1863"><span class="linenos">1863</span></a>                <span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers-1864"><a href="#PromptSequencers-1864"><span class="linenos">1864</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1865"><a href="#PromptSequencers-1865"><span class="linenos">1865</span></a>            <span class="p">]</span>
</span><span id="PromptSequencers-1866"><a href="#PromptSequencers-1866"><span class="linenos">1866</span></a>
</span><span id="PromptSequencers-1867"><a href="#PromptSequencers-1867"><span class="linenos">1867</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers-1868"><a href="#PromptSequencers-1868"><span class="linenos">1868</span></a>    <span class="k">class</span> <span class="nc">AOP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers-1869"><a href="#PromptSequencers-1869"><span class="linenos">1869</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, path].</span>
</span><span id="PromptSequencers-1870"><a href="#PromptSequencers-1870"><span class="linenos">1870</span></a><span class="sd">        Still includes &quot;&lt;TARGET_START&gt;&quot; and &quot;&lt;TARGET_END&gt;&quot; tokens, but no representation of the target itself.</span>
</span><span id="PromptSequencers-1871"><a href="#PromptSequencers-1871"><span class="linenos">1871</span></a>
</span><span id="PromptSequencers-1872"><a href="#PromptSequencers-1872"><span class="linenos">1872</span></a><span class="sd">        # Parameters</span>
</span><span id="PromptSequencers-1873"><a href="#PromptSequencers-1873"><span class="linenos">1873</span></a><span class="sd">        - `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers-1874"><a href="#PromptSequencers-1874"><span class="linenos">1874</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers-1875"><a href="#PromptSequencers-1875"><span class="linenos">1875</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PromptSequencers-1876"><a href="#PromptSequencers-1876"><span class="linenos">1876</span></a>
</span><span id="PromptSequencers-1877"><a href="#PromptSequencers-1877"><span class="linenos">1877</span></a>        <span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers-1878"><a href="#PromptSequencers-1878"><span class="linenos">1878</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers-1879"><a href="#PromptSequencers-1879"><span class="linenos">1879</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers-1880"><a href="#PromptSequencers-1880"><span class="linenos">1880</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers-1881"><a href="#PromptSequencers-1881"><span class="linenos">1881</span></a>
</span><span id="PromptSequencers-1882"><a href="#PromptSequencers-1882"><span class="linenos">1882</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers-1883"><a href="#PromptSequencers-1883"><span class="linenos">1883</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers-1884"><a href="#PromptSequencers-1884"><span class="linenos">1884</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1885"><a href="#PromptSequencers-1885"><span class="linenos">1885</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1886"><a href="#PromptSequencers-1886"><span class="linenos">1886</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1887"><a href="#PromptSequencers-1887"><span class="linenos">1887</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers-1888"><a href="#PromptSequencers-1888"><span class="linenos">1888</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers-1889"><a href="#PromptSequencers-1889"><span class="linenos">1889</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers-1890"><a href="#PromptSequencers-1890"><span class="linenos">1890</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1891"><a href="#PromptSequencers-1891"><span class="linenos">1891</span></a>                <span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers-1892"><a href="#PromptSequencers-1892"><span class="linenos">1892</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1893"><a href="#PromptSequencers-1893"><span class="linenos">1893</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1894"><a href="#PromptSequencers-1894"><span class="linenos">1894</span></a>                <span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers-1895"><a href="#PromptSequencers-1895"><span class="linenos">1895</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1896"><a href="#PromptSequencers-1896"><span class="linenos">1896</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1897"><a href="#PromptSequencers-1897"><span class="linenos">1897</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1898"><a href="#PromptSequencers-1898"><span class="linenos">1898</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers-1899"><a href="#PromptSequencers-1899"><span class="linenos">1899</span></a>                <span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers-1900"><a href="#PromptSequencers-1900"><span class="linenos">1900</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers-1901"><a href="#PromptSequencers-1901"><span class="linenos">1901</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Namespace for <code>_PromptSequencer</code> subclass hierarchy used by <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code>.</p>
</div>


                            <div id="PromptSequencers.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;prompt_sequencer&#39;</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.key"></a>
    
    

                            </div>
                </section>
                <section id="PromptSequencers.AOTP">
                            <input id="PromptSequencers.AOTP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">PromptSequencers.AOTP</span><wbr>(<span class="base"><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1822-L1864" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP-1823"><a href="#PromptSequencers.AOTP-1823"><span class="linenos">1823</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP-1824"><a href="#PromptSequencers.AOTP-1824"><span class="linenos">1824</span></a>    <span class="k">class</span> <span class="nc">AOTP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP-1825"><a href="#PromptSequencers.AOTP-1825"><span class="linenos">1825</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOTP-1826"><a href="#PromptSequencers.AOTP-1826"><span class="linenos">1826</span></a><span class="sd">        Sequences a prompt as [adjacency list, origin, target, path].</span>
</span><span id="PromptSequencers.AOTP-1827"><a href="#PromptSequencers.AOTP-1827"><span class="linenos">1827</span></a>
</span><span id="PromptSequencers.AOTP-1828"><a href="#PromptSequencers.AOTP-1828"><span class="linenos">1828</span></a><span class="sd">        # Parameters</span>
</span><span id="PromptSequencers.AOTP-1829"><a href="#PromptSequencers.AOTP-1829"><span class="linenos">1829</span></a><span class="sd">        - `target_tokenizer`: Tokenizer element which tokenizes the target(s) of a `TargetedLatticeMaze`.</span>
</span><span id="PromptSequencers.AOTP-1830"><a href="#PromptSequencers.AOTP-1830"><span class="linenos">1830</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `TargetTokenizer`.</span>
</span><span id="PromptSequencers.AOTP-1831"><a href="#PromptSequencers.AOTP-1831"><span class="linenos">1831</span></a><span class="sd">        - `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers.AOTP-1832"><a href="#PromptSequencers.AOTP-1832"><span class="linenos">1832</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers.AOTP-1833"><a href="#PromptSequencers.AOTP-1833"><span class="linenos">1833</span></a>
</span><span id="PromptSequencers.AOTP-1834"><a href="#PromptSequencers.AOTP-1834"><span class="linenos">1834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOTP-1835"><a href="#PromptSequencers.AOTP-1835"><span class="linenos">1835</span></a>
</span><span id="PromptSequencers.AOTP-1836"><a href="#PromptSequencers.AOTP-1836"><span class="linenos">1836</span></a>        <span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP-1837"><a href="#PromptSequencers.AOTP-1837"><span class="linenos">1837</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">Unlabeled</span><span class="p">(),</span>
</span><span id="PromptSequencers.AOTP-1838"><a href="#PromptSequencers.AOTP-1838"><span class="linenos">1838</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">TargetTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers.AOTP-1839"><a href="#PromptSequencers.AOTP-1839"><span class="linenos">1839</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers.AOTP-1840"><a href="#PromptSequencers.AOTP-1840"><span class="linenos">1840</span></a>        <span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP-1841"><a href="#PromptSequencers.AOTP-1841"><span class="linenos">1841</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers.AOTP-1842"><a href="#PromptSequencers.AOTP-1842"><span class="linenos">1842</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers.AOTP-1843"><a href="#PromptSequencers.AOTP-1843"><span class="linenos">1843</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers.AOTP-1844"><a href="#PromptSequencers.AOTP-1844"><span class="linenos">1844</span></a>
</span><span id="PromptSequencers.AOTP-1845"><a href="#PromptSequencers.AOTP-1845"><span class="linenos">1845</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP-1846"><a href="#PromptSequencers.AOTP-1846"><span class="linenos">1846</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1847"><a href="#PromptSequencers.AOTP-1847"><span class="linenos">1847</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1848"><a href="#PromptSequencers.AOTP-1848"><span class="linenos">1848</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1849"><a href="#PromptSequencers.AOTP-1849"><span class="linenos">1849</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1850"><a href="#PromptSequencers.AOTP-1850"><span class="linenos">1850</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOTP-1851"><a href="#PromptSequencers.AOTP-1851"><span class="linenos">1851</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOTP-1852"><a href="#PromptSequencers.AOTP-1852"><span class="linenos">1852</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers.AOTP-1853"><a href="#PromptSequencers.AOTP-1853"><span class="linenos">1853</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1854"><a href="#PromptSequencers.AOTP-1854"><span class="linenos">1854</span></a>                <span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1855"><a href="#PromptSequencers.AOTP-1855"><span class="linenos">1855</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1856"><a href="#PromptSequencers.AOTP-1856"><span class="linenos">1856</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1857"><a href="#PromptSequencers.AOTP-1857"><span class="linenos">1857</span></a>                <span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1858"><a href="#PromptSequencers.AOTP-1858"><span class="linenos">1858</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1859"><a href="#PromptSequencers.AOTP-1859"><span class="linenos">1859</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1860"><a href="#PromptSequencers.AOTP-1860"><span class="linenos">1860</span></a>                <span class="o">*</span><span class="n">target</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1861"><a href="#PromptSequencers.AOTP-1861"><span class="linenos">1861</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1862"><a href="#PromptSequencers.AOTP-1862"><span class="linenos">1862</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1863"><a href="#PromptSequencers.AOTP-1863"><span class="linenos">1863</span></a>                <span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1864"><a href="#PromptSequencers.AOTP-1864"><span class="linenos">1864</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP-1865"><a href="#PromptSequencers.AOTP-1865"><span class="linenos">1865</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Sequences a prompt as [adjacency list, origin, target, path].</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#PromptSequencers.AOTP.target_tokenizer">target_tokenizer</a></code>: Tokenizer element which tokenizes the target(s) of a <code>TargetedLatticeMaze</code>.
Uses <code><a href="#PromptSequencers.AOTP.coord_tokenizer">coord_tokenizer</a></code> to tokenize coords if that is part of the design of that <code>TargetTokenizer</code>.</li>
<li><code><a href="#PromptSequencers.AOTP.path_tokenizer">path_tokenizer</a></code>: Tokenizer element which tokenizes the solution path of a <code>SolvedMaze</code>.
Uses <code><a href="#PromptSequencers.AOTP.coord_tokenizer">coord_tokenizer</a></code> to tokenize coords if that is part of the design of that <code>PathTokenizer</code>.</li>
</ul>
</div>


                            <div id="PromptSequencers.AOTP.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PromptSequencers.AOTP</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n"><a href="#CoordTokenizers.UT">CoordTokenizers.UT</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n"><a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a></span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_grouping</span><span class="o">=</span><span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">edge_subset</span><span class="o">=</span><span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">edge_permuter</span><span class="o">=</span><span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">())</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">target_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">TargetTokenizers</span><span class="o">.</span><span class="n">_TargetTokenizer</span> <span class="o">=</span> <span class="n"><a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a></span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>,</span><span class="param">	<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a></span><span class="p">(</span><span class="n">step_size</span><span class="o">=</span><span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">(),</span> <span class="n">step_tokenizers</span><span class="o">=</span><span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),),</span> <span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.__init__"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOTP.target_tokenizer" class="classattr">
                                <div class="attr variable">
            <span class="name">target_tokenizer</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.TargetTokenizers._TargetTokenizer</span>        =
<span class="default_value"><a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a>(post=False)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.target_tokenizer"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOTP.path_tokenizer" class="classattr">
                                <div class="attr variable">
            <span class="name">path_tokenizer</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.PathTokenizers._PathTokenizer</span>        =
<input id="PromptSequencers.AOTP.path_tokenizer-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="PromptSequencers.AOTP.path_tokenizer-view-value"></label><span class="default_value"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>(step_size=StepSizes.Singles(), step_tokenizers=(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,), pre=False, intra=False, post=False)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.path_tokenizer"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOTP.serialize" class="classattr">
                                        <input id="PromptSequencers.AOTP.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP.serialize-660"><a href="#PromptSequencers.AOTP.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOTP.serialize-661"><a href="#PromptSequencers.AOTP.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PromptSequencers.AOTP.serialize-662"><a href="#PromptSequencers.AOTP.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-663"><a href="#PromptSequencers.AOTP.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="PromptSequencers.AOTP.serialize-664"><a href="#PromptSequencers.AOTP.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="PromptSequencers.AOTP.serialize-665"><a href="#PromptSequencers.AOTP.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="PromptSequencers.AOTP.serialize-666"><a href="#PromptSequencers.AOTP.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="PromptSequencers.AOTP.serialize-667"><a href="#PromptSequencers.AOTP.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-668"><a href="#PromptSequencers.AOTP.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-669"><a href="#PromptSequencers.AOTP.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-670"><a href="#PromptSequencers.AOTP.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-671"><a href="#PromptSequencers.AOTP.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-672"><a href="#PromptSequencers.AOTP.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-673"><a href="#PromptSequencers.AOTP.serialize-673"><span class="linenos">673</span></a>
</span><span id="PromptSequencers.AOTP.serialize-674"><a href="#PromptSequencers.AOTP.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="PromptSequencers.AOTP.serialize-675"><a href="#PromptSequencers.AOTP.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-676"><a href="#PromptSequencers.AOTP.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-677"><a href="#PromptSequencers.AOTP.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="PromptSequencers.AOTP.serialize-678"><a href="#PromptSequencers.AOTP.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-679"><a href="#PromptSequencers.AOTP.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="PromptSequencers.AOTP.serialize-680"><a href="#PromptSequencers.AOTP.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-681"><a href="#PromptSequencers.AOTP.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.serialize-682"><a href="#PromptSequencers.AOTP.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="PromptSequencers.AOTP.serialize-683"><a href="#PromptSequencers.AOTP.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-684"><a href="#PromptSequencers.AOTP.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.serialize-685"><a href="#PromptSequencers.AOTP.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="PromptSequencers.AOTP.serialize-686"><a href="#PromptSequencers.AOTP.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="PromptSequencers.AOTP.serialize-687"><a href="#PromptSequencers.AOTP.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-688"><a href="#PromptSequencers.AOTP.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-689"><a href="#PromptSequencers.AOTP.serialize-689"><span class="linenos">689</span></a>
</span><span id="PromptSequencers.AOTP.serialize-690"><a href="#PromptSequencers.AOTP.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="PromptSequencers.AOTP.serialize-691"><a href="#PromptSequencers.AOTP.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOTP.serialize-692"><a href="#PromptSequencers.AOTP.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-693"><a href="#PromptSequencers.AOTP.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-694"><a href="#PromptSequencers.AOTP.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-695"><a href="#PromptSequencers.AOTP.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="PromptSequencers.AOTP.serialize-696"><a href="#PromptSequencers.AOTP.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-697"><a href="#PromptSequencers.AOTP.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-698"><a href="#PromptSequencers.AOTP.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-699"><a href="#PromptSequencers.AOTP.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.serialize-700"><a href="#PromptSequencers.AOTP.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="PromptSequencers.AOTP.serialize-701"><a href="#PromptSequencers.AOTP.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-702"><a href="#PromptSequencers.AOTP.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="PromptSequencers.AOTP.serialize-703"><a href="#PromptSequencers.AOTP.serialize-703"><span class="linenos">703</span></a>
</span><span id="PromptSequencers.AOTP.serialize-704"><a href="#PromptSequencers.AOTP.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="PromptSequencers.AOTP.serialize-705"><a href="#PromptSequencers.AOTP.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-706"><a href="#PromptSequencers.AOTP.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.serialize-707"><a href="#PromptSequencers.AOTP.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-708"><a href="#PromptSequencers.AOTP.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOTP.serialize-709"><a href="#PromptSequencers.AOTP.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.serialize-710"><a href="#PromptSequencers.AOTP.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.serialize-711"><a href="#PromptSequencers.AOTP.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-712"><a href="#PromptSequencers.AOTP.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-713"><a href="#PromptSequencers.AOTP.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.serialize-714"><a href="#PromptSequencers.AOTP.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.serialize-715"><a href="#PromptSequencers.AOTP.serialize-715"><span class="linenos">715</span></a>
</span><span id="PromptSequencers.AOTP.serialize-716"><a href="#PromptSequencers.AOTP.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOTP.load" class="classattr">
                                        <input id="PromptSequencers.AOTP.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP.load-723"><a href="#PromptSequencers.AOTP.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="PromptSequencers.AOTP.load-724"><a href="#PromptSequencers.AOTP.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOTP.load-725"><a href="#PromptSequencers.AOTP.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="PromptSequencers.AOTP.load-726"><a href="#PromptSequencers.AOTP.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-727"><a href="#PromptSequencers.AOTP.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="PromptSequencers.AOTP.load-728"><a href="#PromptSequencers.AOTP.load-728"><span class="linenos">728</span></a>
</span><span id="PromptSequencers.AOTP.load-729"><a href="#PromptSequencers.AOTP.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-730"><a href="#PromptSequencers.AOTP.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="PromptSequencers.AOTP.load-731"><a href="#PromptSequencers.AOTP.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.load-732"><a href="#PromptSequencers.AOTP.load-732"><span class="linenos">732</span></a>
</span><span id="PromptSequencers.AOTP.load-733"><a href="#PromptSequencers.AOTP.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-734"><a href="#PromptSequencers.AOTP.load-734"><span class="linenos">734</span></a>
</span><span id="PromptSequencers.AOTP.load-735"><a href="#PromptSequencers.AOTP.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="PromptSequencers.AOTP.load-736"><a href="#PromptSequencers.AOTP.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.load-737"><a href="#PromptSequencers.AOTP.load-737"><span class="linenos">737</span></a>
</span><span id="PromptSequencers.AOTP.load-738"><a href="#PromptSequencers.AOTP.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="PromptSequencers.AOTP.load-739"><a href="#PromptSequencers.AOTP.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-740"><a href="#PromptSequencers.AOTP.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="PromptSequencers.AOTP.load-741"><a href="#PromptSequencers.AOTP.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-742"><a href="#PromptSequencers.AOTP.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="PromptSequencers.AOTP.load-743"><a href="#PromptSequencers.AOTP.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="PromptSequencers.AOTP.load-744"><a href="#PromptSequencers.AOTP.load-744"><span class="linenos">744</span></a>
</span><span id="PromptSequencers.AOTP.load-745"><a href="#PromptSequencers.AOTP.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="PromptSequencers.AOTP.load-746"><a href="#PromptSequencers.AOTP.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-747"><a href="#PromptSequencers.AOTP.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="PromptSequencers.AOTP.load-748"><a href="#PromptSequencers.AOTP.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="PromptSequencers.AOTP.load-749"><a href="#PromptSequencers.AOTP.load-749"><span class="linenos">749</span></a>
</span><span id="PromptSequencers.AOTP.load-750"><a href="#PromptSequencers.AOTP.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="PromptSequencers.AOTP.load-751"><a href="#PromptSequencers.AOTP.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-752"><a href="#PromptSequencers.AOTP.load-752"><span class="linenos">752</span></a>
</span><span id="PromptSequencers.AOTP.load-753"><a href="#PromptSequencers.AOTP.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="PromptSequencers.AOTP.load-754"><a href="#PromptSequencers.AOTP.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-755"><a href="#PromptSequencers.AOTP.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="PromptSequencers.AOTP.load-756"><a href="#PromptSequencers.AOTP.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-757"><a href="#PromptSequencers.AOTP.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-758"><a href="#PromptSequencers.AOTP.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="PromptSequencers.AOTP.load-759"><a href="#PromptSequencers.AOTP.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-760"><a href="#PromptSequencers.AOTP.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-761"><a href="#PromptSequencers.AOTP.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PromptSequencers.AOTP.load-762"><a href="#PromptSequencers.AOTP.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-763"><a href="#PromptSequencers.AOTP.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-764"><a href="#PromptSequencers.AOTP.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-765"><a href="#PromptSequencers.AOTP.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="PromptSequencers.AOTP.load-766"><a href="#PromptSequencers.AOTP.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PromptSequencers.AOTP.load-767"><a href="#PromptSequencers.AOTP.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-768"><a href="#PromptSequencers.AOTP.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-769"><a href="#PromptSequencers.AOTP.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.load-770"><a href="#PromptSequencers.AOTP.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOTP.load-771"><a href="#PromptSequencers.AOTP.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-772"><a href="#PromptSequencers.AOTP.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-773"><a href="#PromptSequencers.AOTP.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="PromptSequencers.AOTP.load-774"><a href="#PromptSequencers.AOTP.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="PromptSequencers.AOTP.load-775"><a href="#PromptSequencers.AOTP.load-775"><span class="linenos">775</span></a>
</span><span id="PromptSequencers.AOTP.load-776"><a href="#PromptSequencers.AOTP.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="PromptSequencers.AOTP.load-777"><a href="#PromptSequencers.AOTP.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOTP.load-778"><a href="#PromptSequencers.AOTP.load-778"><span class="linenos">778</span></a>
</span><span id="PromptSequencers.AOTP.load-779"><a href="#PromptSequencers.AOTP.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="PromptSequencers.AOTP.load-780"><a href="#PromptSequencers.AOTP.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-781"><a href="#PromptSequencers.AOTP.load-781"><span class="linenos">781</span></a>
</span><span id="PromptSequencers.AOTP.load-782"><a href="#PromptSequencers.AOTP.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="PromptSequencers.AOTP.load-783"><a href="#PromptSequencers.AOTP.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.load-784"><a href="#PromptSequencers.AOTP.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="PromptSequencers.AOTP.load-785"><a href="#PromptSequencers.AOTP.load-785"><span class="linenos">785</span></a>
</span><span id="PromptSequencers.AOTP.load-786"><a href="#PromptSequencers.AOTP.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="PromptSequencers.AOTP.load-787"><a href="#PromptSequencers.AOTP.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOTP.validate_fields_types" class="classattr">
                                        <input id="PromptSequencers.AOTP.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOTP.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOTP.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOTP.validate_fields_types-271"><a href="#PromptSequencers.AOTP.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-272"><a href="#PromptSequencers.AOTP.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-273"><a href="#PromptSequencers.AOTP.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-274"><a href="#PromptSequencers.AOTP.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-275"><a href="#PromptSequencers.AOTP.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-276"><a href="#PromptSequencers.AOTP.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-277"><a href="#PromptSequencers.AOTP.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-278"><a href="#PromptSequencers.AOTP.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-279"><a href="#PromptSequencers.AOTP.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="PromptSequencers.AOTP.validate_fields_types-280"><a href="#PromptSequencers.AOTP.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></dt>
                                <dd id="PromptSequencers.AOTP.coord_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.coord_tokenizer">coord_tokenizer</a></dd>
                <dd id="PromptSequencers.AOTP.adj_list_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.adj_list_tokenizer">adj_list_tokenizer</a></dd>
                <dd id="PromptSequencers.AOTP.attribute_key" class="function"><a href="#PromptSequencers._PromptSequencer.attribute_key">attribute_key</a></dd>
                <dd id="PromptSequencers.AOTP.to_tokens" class="function"><a href="#PromptSequencers._PromptSequencer.to_tokens">to_tokens</a></dd>
                <dd id="PromptSequencers.AOTP.is_valid" class="function"><a href="#PromptSequencers._PromptSequencer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="PromptSequencers.AOTP.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="PromptSequencers.AOTP.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="PromptSequencers.AOTP.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="PromptSequencers.AOTP.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="PromptSequencers.AOTP.validate_field_type" class="function">validate_field_type</dd>
                <dd id="PromptSequencers.AOTP.diff" class="function">diff</dd>
                <dd id="PromptSequencers.AOTP.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PromptSequencers.AOP">
                            <input id="PromptSequencers.AOP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">PromptSequencers.AOP</span><wbr>(<span class="base"><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1866-L1900" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP-1867"><a href="#PromptSequencers.AOP-1867"><span class="linenos">1867</span></a>    <span class="nd">@serializable_dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP-1868"><a href="#PromptSequencers.AOP-1868"><span class="linenos">1868</span></a>    <span class="k">class</span> <span class="nc">AOP</span><span class="p">(</span><span class="n">_PromptSequencer</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP-1869"><a href="#PromptSequencers.AOP-1869"><span class="linenos">1869</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sequences a prompt as [adjacency list, origin, path].</span>
</span><span id="PromptSequencers.AOP-1870"><a href="#PromptSequencers.AOP-1870"><span class="linenos">1870</span></a><span class="sd">        Still includes &quot;&lt;TARGET_START&gt;&quot; and &quot;&lt;TARGET_END&gt;&quot; tokens, but no representation of the target itself.</span>
</span><span id="PromptSequencers.AOP-1871"><a href="#PromptSequencers.AOP-1871"><span class="linenos">1871</span></a>
</span><span id="PromptSequencers.AOP-1872"><a href="#PromptSequencers.AOP-1872"><span class="linenos">1872</span></a><span class="sd">        # Parameters</span>
</span><span id="PromptSequencers.AOP-1873"><a href="#PromptSequencers.AOP-1873"><span class="linenos">1873</span></a><span class="sd">        - `path_tokenizer`: Tokenizer element which tokenizes the solution path of a `SolvedMaze`.</span>
</span><span id="PromptSequencers.AOP-1874"><a href="#PromptSequencers.AOP-1874"><span class="linenos">1874</span></a><span class="sd">        Uses `coord_tokenizer` to tokenize coords if that is part of the design of that `PathTokenizer`.</span>
</span><span id="PromptSequencers.AOP-1875"><a href="#PromptSequencers.AOP-1875"><span class="linenos">1875</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOP-1876"><a href="#PromptSequencers.AOP-1876"><span class="linenos">1876</span></a>
</span><span id="PromptSequencers.AOP-1877"><a href="#PromptSequencers.AOP-1877"><span class="linenos">1877</span></a>        <span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP-1878"><a href="#PromptSequencers.AOP-1878"><span class="linenos">1878</span></a>            <span class="n">default</span><span class="o">=</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">StepSequence</span><span class="p">(),</span>
</span><span id="PromptSequencers.AOP-1879"><a href="#PromptSequencers.AOP-1879"><span class="linenos">1879</span></a>            <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PathTokenizers</span><span class="p">),</span>
</span><span id="PromptSequencers.AOP-1880"><a href="#PromptSequencers.AOP-1880"><span class="linenos">1880</span></a>        <span class="p">)</span>
</span><span id="PromptSequencers.AOP-1881"><a href="#PromptSequencers.AOP-1881"><span class="linenos">1881</span></a>
</span><span id="PromptSequencers.AOP-1882"><a href="#PromptSequencers.AOP-1882"><span class="linenos">1882</span></a>        <span class="k">def</span> <span class="nf">_sequence_tokens</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP-1883"><a href="#PromptSequencers.AOP-1883"><span class="linenos">1883</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1884"><a href="#PromptSequencers.AOP-1884"><span class="linenos">1884</span></a>            <span class="n">adj_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1885"><a href="#PromptSequencers.AOP-1885"><span class="linenos">1885</span></a>            <span class="n">origin</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1886"><a href="#PromptSequencers.AOP-1886"><span class="linenos">1886</span></a>            <span class="n">target</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1887"><a href="#PromptSequencers.AOP-1887"><span class="linenos">1887</span></a>            <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PromptSequencers.AOP-1888"><a href="#PromptSequencers.AOP-1888"><span class="linenos">1888</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOP-1889"><a href="#PromptSequencers.AOP-1889"><span class="linenos">1889</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="PromptSequencers.AOP-1890"><a href="#PromptSequencers.AOP-1890"><span class="linenos">1890</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1891"><a href="#PromptSequencers.AOP-1891"><span class="linenos">1891</span></a>                <span class="o">*</span><span class="n">adj_list</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1892"><a href="#PromptSequencers.AOP-1892"><span class="linenos">1892</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ADJLIST_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1893"><a href="#PromptSequencers.AOP-1893"><span class="linenos">1893</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1894"><a href="#PromptSequencers.AOP-1894"><span class="linenos">1894</span></a>                <span class="o">*</span><span class="n">origin</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1895"><a href="#PromptSequencers.AOP-1895"><span class="linenos">1895</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">ORIGIN_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1896"><a href="#PromptSequencers.AOP-1896"><span class="linenos">1896</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1897"><a href="#PromptSequencers.AOP-1897"><span class="linenos">1897</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">TARGET_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1898"><a href="#PromptSequencers.AOP-1898"><span class="linenos">1898</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_START</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1899"><a href="#PromptSequencers.AOP-1899"><span class="linenos">1899</span></a>                <span class="o">*</span><span class="n">path</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1900"><a href="#PromptSequencers.AOP-1900"><span class="linenos">1900</span></a>                <span class="n">VOCAB</span><span class="o">.</span><span class="n">PATH_END</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP-1901"><a href="#PromptSequencers.AOP-1901"><span class="linenos">1901</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Sequences a prompt as [adjacency list, origin, path].
Still includes "<TARGET_START>" and "<TARGET_END>" tokens, but no representation of the target itself.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#PromptSequencers.AOP.path_tokenizer">path_tokenizer</a></code>: Tokenizer element which tokenizes the solution path of a <code>SolvedMaze</code>.
Uses <code><a href="#PromptSequencers.AOP.coord_tokenizer">coord_tokenizer</a></code> to tokenize coords if that is part of the design of that <code>PathTokenizer</code>.</li>
</ul>
</div>


                            <div id="PromptSequencers.AOP.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">PromptSequencers.AOP</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">coord_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">_CoordTokenizer</span> <span class="o">=</span> <span class="n"><a href="#CoordTokenizers.UT">CoordTokenizers.UT</a></span><span class="p">()</span>,</span><span class="param">	<span class="n">adj_list_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">AdjListTokenizers</span><span class="o">.</span><span class="n">_AdjListTokenizer</span> <span class="o">=</span> <span class="n"><a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a></span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_grouping</span><span class="o">=</span><span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">edge_subset</span><span class="o">=</span><span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">edge_permuter</span><span class="o">=</span><span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">())</span>,</span><span class="param">	<span class="n">_type_</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOP">PromptSequencers.AOP</a>&#39;&gt;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;class &#39;<a href="#PromptSequencers.AOP">PromptSequencers.AOP</a>&#39;&gt;&quot;</span>,</span><span class="param">	<span class="n">path_tokenizer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">PathTokenizers</span><span class="o">.</span><span class="n">_PathTokenizer</span> <span class="o">=</span> <span class="n"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a></span><span class="p">(</span><span class="n">step_size</span><span class="o">=</span><span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">(),</span> <span class="n">step_tokenizers</span><span class="o">=</span><span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),),</span> <span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.__init__"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOP.path_tokenizer" class="classattr">
                                <div class="attr variable">
            <span class="name">path_tokenizer</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.PathTokenizers._PathTokenizer</span>        =
<input id="PromptSequencers.AOP.path_tokenizer-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="PromptSequencers.AOP.path_tokenizer-view-value"></label><span class="default_value"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a>(step_size=StepSizes.Singles(), step_tokenizers=(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,), pre=False, intra=False, post=False)</span>

        
    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.path_tokenizer"></a>
    
    

                            </div>
                            <div id="PromptSequencers.AOP.serialize" class="classattr">
                                        <input id="PromptSequencers.AOP.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP.serialize-660"><a href="#PromptSequencers.AOP.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOP.serialize-661"><a href="#PromptSequencers.AOP.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PromptSequencers.AOP.serialize-662"><a href="#PromptSequencers.AOP.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-663"><a href="#PromptSequencers.AOP.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="PromptSequencers.AOP.serialize-664"><a href="#PromptSequencers.AOP.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="PromptSequencers.AOP.serialize-665"><a href="#PromptSequencers.AOP.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="PromptSequencers.AOP.serialize-666"><a href="#PromptSequencers.AOP.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="PromptSequencers.AOP.serialize-667"><a href="#PromptSequencers.AOP.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-668"><a href="#PromptSequencers.AOP.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-669"><a href="#PromptSequencers.AOP.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="PromptSequencers.AOP.serialize-670"><a href="#PromptSequencers.AOP.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="PromptSequencers.AOP.serialize-671"><a href="#PromptSequencers.AOP.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-672"><a href="#PromptSequencers.AOP.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-673"><a href="#PromptSequencers.AOP.serialize-673"><span class="linenos">673</span></a>
</span><span id="PromptSequencers.AOP.serialize-674"><a href="#PromptSequencers.AOP.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="PromptSequencers.AOP.serialize-675"><a href="#PromptSequencers.AOP.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-676"><a href="#PromptSequencers.AOP.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-677"><a href="#PromptSequencers.AOP.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="PromptSequencers.AOP.serialize-678"><a href="#PromptSequencers.AOP.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-679"><a href="#PromptSequencers.AOP.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="PromptSequencers.AOP.serialize-680"><a href="#PromptSequencers.AOP.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-681"><a href="#PromptSequencers.AOP.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.serialize-682"><a href="#PromptSequencers.AOP.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="PromptSequencers.AOP.serialize-683"><a href="#PromptSequencers.AOP.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-684"><a href="#PromptSequencers.AOP.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.serialize-685"><a href="#PromptSequencers.AOP.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="PromptSequencers.AOP.serialize-686"><a href="#PromptSequencers.AOP.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="PromptSequencers.AOP.serialize-687"><a href="#PromptSequencers.AOP.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-688"><a href="#PromptSequencers.AOP.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-689"><a href="#PromptSequencers.AOP.serialize-689"><span class="linenos">689</span></a>
</span><span id="PromptSequencers.AOP.serialize-690"><a href="#PromptSequencers.AOP.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="PromptSequencers.AOP.serialize-691"><a href="#PromptSequencers.AOP.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOP.serialize-692"><a href="#PromptSequencers.AOP.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-693"><a href="#PromptSequencers.AOP.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-694"><a href="#PromptSequencers.AOP.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-695"><a href="#PromptSequencers.AOP.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="PromptSequencers.AOP.serialize-696"><a href="#PromptSequencers.AOP.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-697"><a href="#PromptSequencers.AOP.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-698"><a href="#PromptSequencers.AOP.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-699"><a href="#PromptSequencers.AOP.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.serialize-700"><a href="#PromptSequencers.AOP.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="PromptSequencers.AOP.serialize-701"><a href="#PromptSequencers.AOP.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-702"><a href="#PromptSequencers.AOP.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="PromptSequencers.AOP.serialize-703"><a href="#PromptSequencers.AOP.serialize-703"><span class="linenos">703</span></a>
</span><span id="PromptSequencers.AOP.serialize-704"><a href="#PromptSequencers.AOP.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="PromptSequencers.AOP.serialize-705"><a href="#PromptSequencers.AOP.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-706"><a href="#PromptSequencers.AOP.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.serialize-707"><a href="#PromptSequencers.AOP.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-708"><a href="#PromptSequencers.AOP.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOP.serialize-709"><a href="#PromptSequencers.AOP.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.serialize-710"><a href="#PromptSequencers.AOP.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.serialize-711"><a href="#PromptSequencers.AOP.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-712"><a href="#PromptSequencers.AOP.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-713"><a href="#PromptSequencers.AOP.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.serialize-714"><a href="#PromptSequencers.AOP.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="PromptSequencers.AOP.serialize-715"><a href="#PromptSequencers.AOP.serialize-715"><span class="linenos">715</span></a>
</span><span id="PromptSequencers.AOP.serialize-716"><a href="#PromptSequencers.AOP.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOP.load" class="classattr">
                                        <input id="PromptSequencers.AOP.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP.load-723"><a href="#PromptSequencers.AOP.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="PromptSequencers.AOP.load-724"><a href="#PromptSequencers.AOP.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="PromptSequencers.AOP.load-725"><a href="#PromptSequencers.AOP.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="PromptSequencers.AOP.load-726"><a href="#PromptSequencers.AOP.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-727"><a href="#PromptSequencers.AOP.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="PromptSequencers.AOP.load-728"><a href="#PromptSequencers.AOP.load-728"><span class="linenos">728</span></a>
</span><span id="PromptSequencers.AOP.load-729"><a href="#PromptSequencers.AOP.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-730"><a href="#PromptSequencers.AOP.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="PromptSequencers.AOP.load-731"><a href="#PromptSequencers.AOP.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.load-732"><a href="#PromptSequencers.AOP.load-732"><span class="linenos">732</span></a>
</span><span id="PromptSequencers.AOP.load-733"><a href="#PromptSequencers.AOP.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-734"><a href="#PromptSequencers.AOP.load-734"><span class="linenos">734</span></a>
</span><span id="PromptSequencers.AOP.load-735"><a href="#PromptSequencers.AOP.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="PromptSequencers.AOP.load-736"><a href="#PromptSequencers.AOP.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.load-737"><a href="#PromptSequencers.AOP.load-737"><span class="linenos">737</span></a>
</span><span id="PromptSequencers.AOP.load-738"><a href="#PromptSequencers.AOP.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="PromptSequencers.AOP.load-739"><a href="#PromptSequencers.AOP.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-740"><a href="#PromptSequencers.AOP.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="PromptSequencers.AOP.load-741"><a href="#PromptSequencers.AOP.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-742"><a href="#PromptSequencers.AOP.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="PromptSequencers.AOP.load-743"><a href="#PromptSequencers.AOP.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="PromptSequencers.AOP.load-744"><a href="#PromptSequencers.AOP.load-744"><span class="linenos">744</span></a>
</span><span id="PromptSequencers.AOP.load-745"><a href="#PromptSequencers.AOP.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="PromptSequencers.AOP.load-746"><a href="#PromptSequencers.AOP.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-747"><a href="#PromptSequencers.AOP.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="PromptSequencers.AOP.load-748"><a href="#PromptSequencers.AOP.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="PromptSequencers.AOP.load-749"><a href="#PromptSequencers.AOP.load-749"><span class="linenos">749</span></a>
</span><span id="PromptSequencers.AOP.load-750"><a href="#PromptSequencers.AOP.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="PromptSequencers.AOP.load-751"><a href="#PromptSequencers.AOP.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-752"><a href="#PromptSequencers.AOP.load-752"><span class="linenos">752</span></a>
</span><span id="PromptSequencers.AOP.load-753"><a href="#PromptSequencers.AOP.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="PromptSequencers.AOP.load-754"><a href="#PromptSequencers.AOP.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-755"><a href="#PromptSequencers.AOP.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="PromptSequencers.AOP.load-756"><a href="#PromptSequencers.AOP.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-757"><a href="#PromptSequencers.AOP.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-758"><a href="#PromptSequencers.AOP.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="PromptSequencers.AOP.load-759"><a href="#PromptSequencers.AOP.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-760"><a href="#PromptSequencers.AOP.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-761"><a href="#PromptSequencers.AOP.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PromptSequencers.AOP.load-762"><a href="#PromptSequencers.AOP.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-763"><a href="#PromptSequencers.AOP.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-764"><a href="#PromptSequencers.AOP.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-765"><a href="#PromptSequencers.AOP.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="PromptSequencers.AOP.load-766"><a href="#PromptSequencers.AOP.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PromptSequencers.AOP.load-767"><a href="#PromptSequencers.AOP.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-768"><a href="#PromptSequencers.AOP.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-769"><a href="#PromptSequencers.AOP.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.load-770"><a href="#PromptSequencers.AOP.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="PromptSequencers.AOP.load-771"><a href="#PromptSequencers.AOP.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-772"><a href="#PromptSequencers.AOP.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-773"><a href="#PromptSequencers.AOP.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="PromptSequencers.AOP.load-774"><a href="#PromptSequencers.AOP.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="PromptSequencers.AOP.load-775"><a href="#PromptSequencers.AOP.load-775"><span class="linenos">775</span></a>
</span><span id="PromptSequencers.AOP.load-776"><a href="#PromptSequencers.AOP.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="PromptSequencers.AOP.load-777"><a href="#PromptSequencers.AOP.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="PromptSequencers.AOP.load-778"><a href="#PromptSequencers.AOP.load-778"><span class="linenos">778</span></a>
</span><span id="PromptSequencers.AOP.load-779"><a href="#PromptSequencers.AOP.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="PromptSequencers.AOP.load-780"><a href="#PromptSequencers.AOP.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-781"><a href="#PromptSequencers.AOP.load-781"><span class="linenos">781</span></a>
</span><span id="PromptSequencers.AOP.load-782"><a href="#PromptSequencers.AOP.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="PromptSequencers.AOP.load-783"><a href="#PromptSequencers.AOP.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.load-784"><a href="#PromptSequencers.AOP.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="PromptSequencers.AOP.load-785"><a href="#PromptSequencers.AOP.load-785"><span class="linenos">785</span></a>
</span><span id="PromptSequencers.AOP.load-786"><a href="#PromptSequencers.AOP.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="PromptSequencers.AOP.load-787"><a href="#PromptSequencers.AOP.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="PromptSequencers.AOP.validate_fields_types" class="classattr">
                                        <input id="PromptSequencers.AOP.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="PromptSequencers.AOP.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#PromptSequencers.AOP.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PromptSequencers.AOP.validate_fields_types-271"><a href="#PromptSequencers.AOP.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-272"><a href="#PromptSequencers.AOP.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-273"><a href="#PromptSequencers.AOP.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-274"><a href="#PromptSequencers.AOP.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-275"><a href="#PromptSequencers.AOP.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-276"><a href="#PromptSequencers.AOP.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-277"><a href="#PromptSequencers.AOP.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-278"><a href="#PromptSequencers.AOP.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-279"><a href="#PromptSequencers.AOP.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="PromptSequencers.AOP.validate_fields_types-280"><a href="#PromptSequencers.AOP.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PromptSequencers._PromptSequencer">PromptSequencers._PromptSequencer</a></dt>
                                <dd id="PromptSequencers.AOP.coord_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.coord_tokenizer">coord_tokenizer</a></dd>
                <dd id="PromptSequencers.AOP.adj_list_tokenizer" class="variable"><a href="#PromptSequencers._PromptSequencer.adj_list_tokenizer">adj_list_tokenizer</a></dd>
                <dd id="PromptSequencers.AOP.attribute_key" class="function"><a href="#PromptSequencers._PromptSequencer.attribute_key">attribute_key</a></dd>
                <dd id="PromptSequencers.AOP.to_tokens" class="function"><a href="#PromptSequencers._PromptSequencer.to_tokens">to_tokens</a></dd>
                <dd id="PromptSequencers.AOP.is_valid" class="function"><a href="#PromptSequencers._PromptSequencer.is_valid">is_valid</a></dd>

            </div>
            <div><dt><a href="#_TokenizerElement">_TokenizerElement</a></dt>
                                <dd id="PromptSequencers.AOP.name" class="variable"><a href="#_TokenizerElement.name">name</a></dd>
                <dd id="PromptSequencers.AOP.tokenizer_elements" class="function"><a href="#_TokenizerElement.tokenizer_elements">tokenizer_elements</a></dd>
                <dd id="PromptSequencers.AOP.tokenizer_element_tree" class="function"><a href="#_TokenizerElement.tokenizer_element_tree">tokenizer_element_tree</a></dd>
                <dd id="PromptSequencers.AOP.tokenizer_element_dict" class="function"><a href="#_TokenizerElement.tokenizer_element_dict">tokenizer_element_dict</a></dd>

            </div>
            <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="PromptSequencers.AOP.validate_field_type" class="function">validate_field_type</dd>
                <dd id="PromptSequencers.AOP.diff" class="function">diff</dd>
                <dd id="PromptSequencers.AOP.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MazeTokenizerModular">
                            <input id="MazeTokenizerModular-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@serializable_dataclass(frozen=True, kw_only=True, properties_to_serialize=[&#39;tokenizer_element_tree_concrete&#39;, &#39;name&#39;])</div>

    <span class="def">class</span>
    <span class="name">MazeTokenizerModular</span><wbr>(<span class="base">muutils.json_serialize.serializable_dataclass.SerializableDataclass</span>):

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1903-L2195" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular-1904"><a href="#MazeTokenizerModular-1904"><span class="linenos">1904</span></a><span class="nd">@serializable_dataclass</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-1905"><a href="#MazeTokenizerModular-1905"><span class="linenos">1905</span></a>    <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-1906"><a href="#MazeTokenizerModular-1906"><span class="linenos">1906</span></a>    <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-1907"><a href="#MazeTokenizerModular-1907"><span class="linenos">1907</span></a>    <span class="n">properties_to_serialize</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tokenizer_element_tree_concrete&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="MazeTokenizerModular-1908"><a href="#MazeTokenizerModular-1908"><span class="linenos">1908</span></a><span class="p">)</span>
</span><span id="MazeTokenizerModular-1909"><a href="#MazeTokenizerModular-1909"><span class="linenos">1909</span></a><span class="k">class</span> <span class="nc">MazeTokenizerModular</span><span class="p">(</span><span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-1910"><a href="#MazeTokenizerModular-1910"><span class="linenos">1910</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tokenizer for mazes</span>
</span><span id="MazeTokenizerModular-1911"><a href="#MazeTokenizerModular-1911"><span class="linenos">1911</span></a>
</span><span id="MazeTokenizerModular-1912"><a href="#MazeTokenizerModular-1912"><span class="linenos">1912</span></a><span class="sd">    # Parameters</span>
</span><span id="MazeTokenizerModular-1913"><a href="#MazeTokenizerModular-1913"><span class="linenos">1913</span></a><span class="sd">    - `prompt_sequencer`: Tokenizer element which assembles token regions (adjacency list, origin, target, path) into a complete prompt.</span>
</span><span id="MazeTokenizerModular-1914"><a href="#MazeTokenizerModular-1914"><span class="linenos">1914</span></a>
</span><span id="MazeTokenizerModular-1915"><a href="#MazeTokenizerModular-1915"><span class="linenos">1915</span></a><span class="sd">    # Development</span>
</span><span id="MazeTokenizerModular-1916"><a href="#MazeTokenizerModular-1916"><span class="linenos">1916</span></a><span class="sd">    - To ensure backwards compatibility, the default constructor must always return a tokenizer equivalent to the legacy `TokenizationMode.AOTP_UT_Uniform`.</span>
</span><span id="MazeTokenizerModular-1917"><a href="#MazeTokenizerModular-1917"><span class="linenos">1917</span></a><span class="sd">    - Furthermore, the mapping reflected in `from_legacy` must also be maintained.</span>
</span><span id="MazeTokenizerModular-1918"><a href="#MazeTokenizerModular-1918"><span class="linenos">1918</span></a><span class="sd">    - Updates to `MazeTokenizerModular` or the `_TokenizerElement` hierarchy must maintain that behavior.</span>
</span><span id="MazeTokenizerModular-1919"><a href="#MazeTokenizerModular-1919"><span class="linenos">1919</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1920"><a href="#MazeTokenizerModular-1920"><span class="linenos">1920</span></a>
</span><span id="MazeTokenizerModular-1921"><a href="#MazeTokenizerModular-1921"><span class="linenos">1921</span></a>    <span class="n">prompt_sequencer</span><span class="p">:</span> <span class="n">PromptSequencers</span><span class="o">.</span><span class="n">_PromptSequencer</span> <span class="o">=</span> <span class="n">serializable_field</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-1922"><a href="#MazeTokenizerModular-1922"><span class="linenos">1922</span></a>        <span class="n">default</span><span class="o">=</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular-1923"><a href="#MazeTokenizerModular-1923"><span class="linenos">1923</span></a>        <span class="n">loading_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_load_tokenizer_element</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PromptSequencers</span><span class="p">),</span>
</span><span id="MazeTokenizerModular-1924"><a href="#MazeTokenizerModular-1924"><span class="linenos">1924</span></a>    <span class="p">)</span>
</span><span id="MazeTokenizerModular-1925"><a href="#MazeTokenizerModular-1925"><span class="linenos">1925</span></a>
</span><span id="MazeTokenizerModular-1926"><a href="#MazeTokenizerModular-1926"><span class="linenos">1926</span></a>    <span class="k">def</span> <span class="nf">hash_int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-1927"><a href="#MazeTokenizerModular-1927"><span class="linenos">1927</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-1928"><a href="#MazeTokenizerModular-1928"><span class="linenos">1928</span></a>            <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular-1929"><a href="#MazeTokenizerModular-1929"><span class="linenos">1929</span></a>            <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-1930"><a href="#MazeTokenizerModular-1930"><span class="linenos">1930</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-1931"><a href="#MazeTokenizerModular-1931"><span class="linenos">1931</span></a>
</span><span id="MazeTokenizerModular-1932"><a href="#MazeTokenizerModular-1932"><span class="linenos">1932</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-1933"><a href="#MazeTokenizerModular-1933"><span class="linenos">1933</span></a>        <span class="s2">&quot;Stable hash to identify unique `MazeTokenizerModular` instances. uses name&quot;</span>
</span><span id="MazeTokenizerModular-1934"><a href="#MazeTokenizerModular-1934"><span class="linenos">1934</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_int</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-1935"><a href="#MazeTokenizerModular-1935"><span class="linenos">1935</span></a>
</span><span id="MazeTokenizerModular-1936"><a href="#MazeTokenizerModular-1936"><span class="linenos">1936</span></a>    <span class="k">def</span> <span class="nf">hash_b64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-1937"><a href="#MazeTokenizerModular-1937"><span class="linenos">1937</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;filename-safe base64 encoding of the hash&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1938"><a href="#MazeTokenizerModular-1938"><span class="linenos">1938</span></a>        <span class="c1"># Use modulus to ensure the integer fits within n_bytes * 8 bits</span>
</span><span id="MazeTokenizerModular-1939"><a href="#MazeTokenizerModular-1939"><span class="linenos">1939</span></a>        <span class="n">hash_mod</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_int</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">n_bytes</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="MazeTokenizerModular-1940"><a href="#MazeTokenizerModular-1940"><span class="linenos">1940</span></a>
</span><span id="MazeTokenizerModular-1941"><a href="#MazeTokenizerModular-1941"><span class="linenos">1941</span></a>        <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-1942"><a href="#MazeTokenizerModular-1942"><span class="linenos">1942</span></a>            <span class="n">hash_mod</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span> <span class="n">altchars</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;-_&quot;</span>
</span><span id="MazeTokenizerModular-1943"><a href="#MazeTokenizerModular-1943"><span class="linenos">1943</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-1944"><a href="#MazeTokenizerModular-1944"><span class="linenos">1944</span></a>
</span><span id="MazeTokenizerModular-1945"><a href="#MazeTokenizerModular-1945"><span class="linenos">1945</span></a>        <span class="c1"># Remove any padding equals signs</span>
</span><span id="MazeTokenizerModular-1946"><a href="#MazeTokenizerModular-1946"><span class="linenos">1946</span></a>        <span class="k">return</span> <span class="n">encoded</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-1947"><a href="#MazeTokenizerModular-1947"><span class="linenos">1947</span></a>
</span><span id="MazeTokenizerModular-1948"><a href="#MazeTokenizerModular-1948"><span class="linenos">1948</span></a>    <span class="c1"># Information Querying Methods</span>
</span><span id="MazeTokenizerModular-1949"><a href="#MazeTokenizerModular-1949"><span class="linenos">1949</span></a>
</span><span id="MazeTokenizerModular-1950"><a href="#MazeTokenizerModular-1950"><span class="linenos">1950</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizerModular-1951"><a href="#MazeTokenizerModular-1951"><span class="linenos">1951</span></a>    <span class="k">def</span> <span class="nf">tokenizer_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-1952"><a href="#MazeTokenizerModular-1952"><span class="linenos">1952</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">()]</span>
</span><span id="MazeTokenizerModular-1953"><a href="#MazeTokenizerModular-1953"><span class="linenos">1953</span></a>
</span><span id="MazeTokenizerModular-1954"><a href="#MazeTokenizerModular-1954"><span class="linenos">1954</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-1955"><a href="#MazeTokenizerModular-1955"><span class="linenos">1955</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1956"><a href="#MazeTokenizerModular-1956"><span class="linenos">1956</span></a><span class="sd">        Returns a string representation of the tree of tokenizer elements contained in `self`.</span>
</span><span id="MazeTokenizerModular-1957"><a href="#MazeTokenizerModular-1957"><span class="linenos">1957</span></a>
</span><span id="MazeTokenizerModular-1958"><a href="#MazeTokenizerModular-1958"><span class="linenos">1958</span></a><span class="sd">        # Parameters</span>
</span><span id="MazeTokenizerModular-1959"><a href="#MazeTokenizerModular-1959"><span class="linenos">1959</span></a><span class="sd">        - `abstract: bool`: Whether to print the name of the abstract base class or the concrete class for each `_TokenizerElement` instance.</span>
</span><span id="MazeTokenizerModular-1960"><a href="#MazeTokenizerModular-1960"><span class="linenos">1960</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1961"><a href="#MazeTokenizerModular-1961"><span class="linenos">1961</span></a>
</span><span id="MazeTokenizerModular-1962"><a href="#MazeTokenizerModular-1962"><span class="linenos">1962</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-1963"><a href="#MazeTokenizerModular-1963"><span class="linenos">1963</span></a>            <span class="p">[</span>
</span><span id="MazeTokenizerModular-1964"><a href="#MazeTokenizerModular-1964"><span class="linenos">1964</span></a>                <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-1965"><a href="#MazeTokenizerModular-1965"><span class="linenos">1965</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-1966"><a href="#MazeTokenizerModular-1966"><span class="linenos">1966</span></a>                    <span class="n">abstract</span><span class="o">=</span><span class="n">abstract</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span>
</span><span id="MazeTokenizerModular-1967"><a href="#MazeTokenizerModular-1967"><span class="linenos">1967</span></a>                <span class="p">),</span>
</span><span id="MazeTokenizerModular-1968"><a href="#MazeTokenizerModular-1968"><span class="linenos">1968</span></a>            <span class="p">]</span>
</span><span id="MazeTokenizerModular-1969"><a href="#MazeTokenizerModular-1969"><span class="linenos">1969</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-1970"><a href="#MazeTokenizerModular-1970"><span class="linenos">1970</span></a>
</span><span id="MazeTokenizerModular-1971"><a href="#MazeTokenizerModular-1971"><span class="linenos">1971</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-1972"><a href="#MazeTokenizerModular-1972"><span class="linenos">1972</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree_concrete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-1973"><a href="#MazeTokenizerModular-1973"><span class="linenos">1973</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1974"><a href="#MazeTokenizerModular-1974"><span class="linenos">1974</span></a><span class="sd">        Property wrapper for `tokenizer_element_tree` so that it can be used in `properties_to_serialize`.</span>
</span><span id="MazeTokenizerModular-1975"><a href="#MazeTokenizerModular-1975"><span class="linenos">1975</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1976"><a href="#MazeTokenizerModular-1976"><span class="linenos">1976</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-1977"><a href="#MazeTokenizerModular-1977"><span class="linenos">1977</span></a>
</span><span id="MazeTokenizerModular-1978"><a href="#MazeTokenizerModular-1978"><span class="linenos">1978</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-1979"><a href="#MazeTokenizerModular-1979"><span class="linenos">1979</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1980"><a href="#MazeTokenizerModular-1980"><span class="linenos">1980</span></a><span class="sd">        Nested dictionary of the internal `TokenizerElement`s.</span>
</span><span id="MazeTokenizerModular-1981"><a href="#MazeTokenizerModular-1981"><span class="linenos">1981</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1982"><a href="#MazeTokenizerModular-1982"><span class="linenos">1982</span></a>        <span class="k">return</span> <span class="p">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_element_dict</span><span class="p">()}</span>
</span><span id="MazeTokenizerModular-1983"><a href="#MazeTokenizerModular-1983"><span class="linenos">1983</span></a>
</span><span id="MazeTokenizerModular-1984"><a href="#MazeTokenizerModular-1984"><span class="linenos">1984</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-1985"><a href="#MazeTokenizerModular-1985"><span class="linenos">1985</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-1986"><a href="#MazeTokenizerModular-1986"><span class="linenos">1986</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serializes MazeTokenizer into a key for encoding in zanj&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1987"><a href="#MazeTokenizerModular-1987"><span class="linenos">1987</span></a>        <span class="k">return</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span><span id="MazeTokenizerModular-1988"><a href="#MazeTokenizerModular-1988"><span class="linenos">1988</span></a>
</span><span id="MazeTokenizerModular-1989"><a href="#MazeTokenizerModular-1989"><span class="linenos">1989</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-1990"><a href="#MazeTokenizerModular-1990"><span class="linenos">1990</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1991"><a href="#MazeTokenizerModular-1991"><span class="linenos">1991</span></a><span class="sd">        Single-level dictionary of the internal `TokenizerElement`s.</span>
</span><span id="MazeTokenizerModular-1992"><a href="#MazeTokenizerModular-1992"><span class="linenos">1992</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-1993"><a href="#MazeTokenizerModular-1993"><span class="linenos">1993</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizerModular-1994"><a href="#MazeTokenizerModular-1994"><span class="linenos">1994</span></a>            <span class="c1"># &quot;prompt_sequencer&quot;: self.prompt_sequencer.name,</span>
</span><span id="MazeTokenizerModular-1995"><a href="#MazeTokenizerModular-1995"><span class="linenos">1995</span></a>            <span class="o">**</span><span class="p">{</span><span class="n">elem</span><span class="o">.</span><span class="n">attribute_key</span><span class="p">():</span> <span class="n">elem</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">}</span>
</span><span id="MazeTokenizerModular-1996"><a href="#MazeTokenizerModular-1996"><span class="linenos">1996</span></a>        <span class="p">}</span>
</span><span id="MazeTokenizerModular-1997"><a href="#MazeTokenizerModular-1997"><span class="linenos">1997</span></a>
</span><span id="MazeTokenizerModular-1998"><a href="#MazeTokenizerModular-1998"><span class="linenos">1998</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular-1999"><a href="#MazeTokenizerModular-1999"><span class="linenos">1999</span></a>    <span class="k">def</span> <span class="nf">_type_check</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2000"><a href="#MazeTokenizerModular-2000"><span class="linenos">2000</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method for `has_element`&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2001"><a href="#MazeTokenizerModular-2001"><span class="linenos">2001</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular-2002"><a href="#MazeTokenizerModular-2002"><span class="linenos">2002</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2003"><a href="#MazeTokenizerModular-2003"><span class="linenos">2003</span></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_TokenizerElement</span><span class="p">))</span>
</span><span id="MazeTokenizerModular-2004"><a href="#MazeTokenizerModular-2004"><span class="linenos">2004</span></a>        <span class="p">):</span>
</span><span id="MazeTokenizerModular-2005"><a href="#MazeTokenizerModular-2005"><span class="linenos">2005</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> is not a `_TokenizerElement` instance or subclass.&quot;</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2006"><a href="#MazeTokenizerModular-2006"><span class="linenos">2006</span></a>
</span><span id="MazeTokenizerModular-2007"><a href="#MazeTokenizerModular-2007"><span class="linenos">2007</span></a>    <span class="k">def</span> <span class="nf">_has_element_singular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">el</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">|</span> <span class="n">_TokenizerElement</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-2008"><a href="#MazeTokenizerModular-2008"><span class="linenos">2008</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method for `has_element`&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2009"><a href="#MazeTokenizerModular-2009"><span class="linenos">2009</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type_check</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2010"><a href="#MazeTokenizerModular-2010"><span class="linenos">2010</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-2011"><a href="#MazeTokenizerModular-2011"><span class="linenos">2011</span></a>            <span class="k">return</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">])</span>
</span><span id="MazeTokenizerModular-2012"><a href="#MazeTokenizerModular-2012"><span class="linenos">2012</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2013"><a href="#MazeTokenizerModular-2013"><span class="linenos">2013</span></a>            <span class="k">return</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span>
</span><span id="MazeTokenizerModular-2014"><a href="#MazeTokenizerModular-2014"><span class="linenos">2014</span></a>
</span><span id="MazeTokenizerModular-2015"><a href="#MazeTokenizerModular-2015"><span class="linenos">2015</span></a>    <span class="k">def</span> <span class="nf">has_element</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2016"><a href="#MazeTokenizerModular-2016"><span class="linenos">2016</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2017"><a href="#MazeTokenizerModular-2017"><span class="linenos">2017</span></a>        <span class="o">*</span><span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">|</span> <span class="n">_TokenizerElement</span><span class="p">],</span>
</span><span id="MazeTokenizerModular-2018"><a href="#MazeTokenizerModular-2018"><span class="linenos">2018</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2019"><a href="#MazeTokenizerModular-2019"><span class="linenos">2019</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if the `MazeTokenizerModular` instance contains ALL of the items specified in `elements`.</span>
</span><span id="MazeTokenizerModular-2020"><a href="#MazeTokenizerModular-2020"><span class="linenos">2020</span></a>
</span><span id="MazeTokenizerModular-2021"><a href="#MazeTokenizerModular-2021"><span class="linenos">2021</span></a><span class="sd">        Querying with a partial subset of `_TokenizerElement` fields is not currently supported.</span>
</span><span id="MazeTokenizerModular-2022"><a href="#MazeTokenizerModular-2022"><span class="linenos">2022</span></a><span class="sd">        To do such a query, assemble multiple calls to `has_elements`.</span>
</span><span id="MazeTokenizerModular-2023"><a href="#MazeTokenizerModular-2023"><span class="linenos">2023</span></a>
</span><span id="MazeTokenizerModular-2024"><a href="#MazeTokenizerModular-2024"><span class="linenos">2024</span></a><span class="sd">        # Parameters</span>
</span><span id="MazeTokenizerModular-2025"><a href="#MazeTokenizerModular-2025"><span class="linenos">2025</span></a><span class="sd">        - `elements`: Singleton or iterable of `_TokenizerElement` instances or classes.</span>
</span><span id="MazeTokenizerModular-2026"><a href="#MazeTokenizerModular-2026"><span class="linenos">2026</span></a><span class="sd">        If an instance is provided, then comparison is done via instance equality.</span>
</span><span id="MazeTokenizerModular-2027"><a href="#MazeTokenizerModular-2027"><span class="linenos">2027</span></a><span class="sd">        If a class is provided, then comparison isdone via `isinstance`. I.e., any instance of that class is accepted.</span>
</span><span id="MazeTokenizerModular-2028"><a href="#MazeTokenizerModular-2028"><span class="linenos">2028</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2029"><a href="#MazeTokenizerModular-2029"><span class="linenos">2029</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-2030"><a href="#MazeTokenizerModular-2030"><span class="linenos">2030</span></a>            <span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MazeTokenizerModular-2031"><a href="#MazeTokenizerModular-2031"><span class="linenos">2031</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_has_element_singular</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">])</span>
</span><span id="MazeTokenizerModular-2032"><a href="#MazeTokenizerModular-2032"><span class="linenos">2032</span></a>
</span><span id="MazeTokenizerModular-2033"><a href="#MazeTokenizerModular-2033"><span class="linenos">2033</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-2034"><a href="#MazeTokenizerModular-2034"><span class="linenos">2034</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2035"><a href="#MazeTokenizerModular-2035"><span class="linenos">2035</span></a><span class="sd">        Returns `True` if `self` is a valid tokenizer.</span>
</span><span id="MazeTokenizerModular-2036"><a href="#MazeTokenizerModular-2036"><span class="linenos">2036</span></a><span class="sd">        Evaluates the validity of all of `self.tokenizer_elements` according to each one&#39;s method.</span>
</span><span id="MazeTokenizerModular-2037"><a href="#MazeTokenizerModular-2037"><span class="linenos">2037</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2038"><a href="#MazeTokenizerModular-2038"><span class="linenos">2038</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">el</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">])</span>
</span><span id="MazeTokenizerModular-2039"><a href="#MazeTokenizerModular-2039"><span class="linenos">2039</span></a>
</span><span id="MazeTokenizerModular-2040"><a href="#MazeTokenizerModular-2040"><span class="linenos">2040</span></a>    <span class="k">def</span> <span class="nf">is_legacy_equivalent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2041"><a href="#MazeTokenizerModular-2041"><span class="linenos">2041</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if `self` has identical stringification behavior as any legacy `MazeTokenizer`.&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2042"><a href="#MazeTokenizerModular-2042"><span class="linenos">2042</span></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2043"><a href="#MazeTokenizerModular-2043"><span class="linenos">2043</span></a>            <span class="p">[</span>
</span><span id="MazeTokenizerModular-2044"><a href="#MazeTokenizerModular-2044"><span class="linenos">2044</span></a>                <span class="bp">self</span> <span class="o">==</span> <span class="n">MazeTokenizerModular</span><span class="o">.</span><span class="n">from_legacy</span><span class="p">(</span><span class="n">tok_mode</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2045"><a href="#MazeTokenizerModular-2045"><span class="linenos">2045</span></a>                <span class="k">for</span> <span class="n">tok_mode</span> <span class="ow">in</span> <span class="n">TokenizationMode</span>
</span><span id="MazeTokenizerModular-2046"><a href="#MazeTokenizerModular-2046"><span class="linenos">2046</span></a>            <span class="p">]</span>
</span><span id="MazeTokenizerModular-2047"><a href="#MazeTokenizerModular-2047"><span class="linenos">2047</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-2048"><a href="#MazeTokenizerModular-2048"><span class="linenos">2048</span></a>
</span><span id="MazeTokenizerModular-2049"><a href="#MazeTokenizerModular-2049"><span class="linenos">2049</span></a>    <span class="k">def</span> <span class="nf">is_tested_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_assert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2050"><a href="#MazeTokenizerModular-2050"><span class="linenos">2050</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if the tokenizer is returned by `all_tokenizers.get_all_tokenizers`, the set of tested and reliable tokenizers.</span>
</span><span id="MazeTokenizerModular-2051"><a href="#MazeTokenizerModular-2051"><span class="linenos">2051</span></a>
</span><span id="MazeTokenizerModular-2052"><a href="#MazeTokenizerModular-2052"><span class="linenos">2052</span></a><span class="sd">        Since evaluating `all_tokenizers.get_all_tokenizers` is expensive,</span>
</span><span id="MazeTokenizerModular-2053"><a href="#MazeTokenizerModular-2053"><span class="linenos">2053</span></a><span class="sd">        instead checks for membership of `self`&#39;s hash in `get_all_tokenizer_hashes()`.</span>
</span><span id="MazeTokenizerModular-2054"><a href="#MazeTokenizerModular-2054"><span class="linenos">2054</span></a>
</span><span id="MazeTokenizerModular-2055"><a href="#MazeTokenizerModular-2055"><span class="linenos">2055</span></a><span class="sd">        if `do_assert` is `True`, raises an `AssertionError` if the tokenizer is not tested.</span>
</span><span id="MazeTokenizerModular-2056"><a href="#MazeTokenizerModular-2056"><span class="linenos">2056</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2057"><a href="#MazeTokenizerModular-2057"><span class="linenos">2057</span></a>        <span class="n">all_tokenizer_hashes</span><span class="p">:</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular-2058"><a href="#MazeTokenizerModular-2058"><span class="linenos">2058</span></a>            <span class="n">get_all_tokenizer_hashes</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-2059"><a href="#MazeTokenizerModular-2059"><span class="linenos">2059</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-2060"><a href="#MazeTokenizerModular-2060"><span class="linenos">2060</span></a>        <span class="n">hash_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="MazeTokenizerModular-2061"><a href="#MazeTokenizerModular-2061"><span class="linenos">2061</span></a>
</span><span id="MazeTokenizerModular-2062"><a href="#MazeTokenizerModular-2062"><span class="linenos">2062</span></a>        <span class="n">in_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">hash_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2063"><a href="#MazeTokenizerModular-2063"><span class="linenos">2063</span></a>        <span class="n">hashes_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">all_tokenizer_hashes</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2064"><a href="#MazeTokenizerModular-2064"><span class="linenos">2064</span></a>        <span class="n">is_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-2065"><a href="#MazeTokenizerModular-2065"><span class="linenos">2065</span></a>
</span><span id="MazeTokenizerModular-2066"><a href="#MazeTokenizerModular-2066"><span class="linenos">2066</span></a>        <span class="k">if</span> <span class="n">do_assert</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2067"><a href="#MazeTokenizerModular-2067"><span class="linenos">2067</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular-2068"><a href="#MazeTokenizerModular-2068"><span class="linenos">2068</span></a>                <span class="n">in_range</span>
</span><span id="MazeTokenizerModular-2069"><a href="#MazeTokenizerModular-2069"><span class="linenos">2069</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hash_index</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is invalid, must be at most </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular-2070"><a href="#MazeTokenizerModular-2070"><span class="linenos">2070</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular-2071"><a href="#MazeTokenizerModular-2071"><span class="linenos">2071</span></a>                <span class="n">hashes_match</span>
</span><span id="MazeTokenizerModular-2072"><a href="#MazeTokenizerModular-2072"><span class="linenos">2072</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">all_tokenizer_hashes</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2"> != </span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular-2073"><a href="#MazeTokenizerModular-2073"><span class="linenos">2073</span></a>            <span class="k">assert</span> <span class="n">is_valid</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;self.is_valid returns False&quot;</span>
</span><span id="MazeTokenizerModular-2074"><a href="#MazeTokenizerModular-2074"><span class="linenos">2074</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="MazeTokenizerModular-2075"><a href="#MazeTokenizerModular-2075"><span class="linenos">2075</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2076"><a href="#MazeTokenizerModular-2076"><span class="linenos">2076</span></a>            <span class="k">return</span> <span class="n">in_range</span> <span class="ow">and</span> <span class="n">hashes_match</span> <span class="ow">and</span> <span class="n">is_valid</span>
</span><span id="MazeTokenizerModular-2077"><a href="#MazeTokenizerModular-2077"><span class="linenos">2077</span></a>
</span><span id="MazeTokenizerModular-2078"><a href="#MazeTokenizerModular-2078"><span class="linenos">2078</span></a>    <span class="k">def</span> <span class="nf">is_AOTP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2079"><a href="#MazeTokenizerModular-2079"><span class="linenos">2079</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_element</span><span class="p">(</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2080"><a href="#MazeTokenizerModular-2080"><span class="linenos">2080</span></a>
</span><span id="MazeTokenizerModular-2081"><a href="#MazeTokenizerModular-2081"><span class="linenos">2081</span></a>    <span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2082"><a href="#MazeTokenizerModular-2082"><span class="linenos">2082</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_element</span><span class="p">(</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2083"><a href="#MazeTokenizerModular-2083"><span class="linenos">2083</span></a>
</span><span id="MazeTokenizerModular-2084"><a href="#MazeTokenizerModular-2084"><span class="linenos">2084</span></a>    <span class="c1"># Alternate Constructors</span>
</span><span id="MazeTokenizerModular-2085"><a href="#MazeTokenizerModular-2085"><span class="linenos">2085</span></a>    <span class="c1"># ======================</span>
</span><span id="MazeTokenizerModular-2086"><a href="#MazeTokenizerModular-2086"><span class="linenos">2086</span></a>
</span><span id="MazeTokenizerModular-2087"><a href="#MazeTokenizerModular-2087"><span class="linenos">2087</span></a>    <span class="nd">@classmethod</span>
</span><span id="MazeTokenizerModular-2088"><a href="#MazeTokenizerModular-2088"><span class="linenos">2088</span></a>    <span class="k">def</span> <span class="nf">from_legacy</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2089"><a href="#MazeTokenizerModular-2089"><span class="linenos">2089</span></a>        <span class="bp">cls</span><span class="p">,</span> <span class="n">legacy_maze_tokenizer</span><span class="p">:</span> <span class="n">MazeTokenizer</span> <span class="o">|</span> <span class="n">TokenizationMode</span>
</span><span id="MazeTokenizerModular-2090"><a href="#MazeTokenizerModular-2090"><span class="linenos">2090</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeTokenizerModular&quot;</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2091"><a href="#MazeTokenizerModular-2091"><span class="linenos">2091</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Maps a legacy `MazeTokenizer` or `TokenizationMode` to its equivalent `MazeTokenizerModular` instance.&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2092"><a href="#MazeTokenizerModular-2092"><span class="linenos">2092</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legacy_maze_tokenizer</span><span class="p">,</span> <span class="n">MazeTokenizer</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-2093"><a href="#MazeTokenizerModular-2093"><span class="linenos">2093</span></a>            <span class="n">legacy_maze_tokenizer</span> <span class="o">=</span> <span class="n">legacy_maze_tokenizer</span><span class="o">.</span><span class="n">tokenization_mode</span>
</span><span id="MazeTokenizerModular-2094"><a href="#MazeTokenizerModular-2094"><span class="linenos">2094</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizerModular-2095"><a href="#MazeTokenizerModular-2095"><span class="linenos">2095</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular-2096"><a href="#MazeTokenizerModular-2096"><span class="linenos">2096</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular-2097"><a href="#MazeTokenizerModular-2097"><span class="linenos">2097</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2098"><a href="#MazeTokenizerModular-2098"><span class="linenos">2098</span></a>                <span class="n">prompt_sequencer</span><span class="o">=</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2099"><a href="#MazeTokenizerModular-2099"><span class="linenos">2099</span></a>                    <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">CTT</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-2100"><a href="#MazeTokenizerModular-2100"><span class="linenos">2100</span></a>                <span class="p">)</span>
</span><span id="MazeTokenizerModular-2101"><a href="#MazeTokenizerModular-2101"><span class="linenos">2101</span></a>            <span class="p">),</span>
</span><span id="MazeTokenizerModular-2102"><a href="#MazeTokenizerModular-2102"><span class="linenos">2102</span></a>        <span class="p">}[</span><span class="n">legacy_maze_tokenizer</span><span class="p">]</span>
</span><span id="MazeTokenizerModular-2103"><a href="#MazeTokenizerModular-2103"><span class="linenos">2103</span></a>
</span><span id="MazeTokenizerModular-2104"><a href="#MazeTokenizerModular-2104"><span class="linenos">2104</span></a>    <span class="c1"># Simple properties</span>
</span><span id="MazeTokenizerModular-2105"><a href="#MazeTokenizerModular-2105"><span class="linenos">2105</span></a>    <span class="c1"># =================</span>
</span><span id="MazeTokenizerModular-2106"><a href="#MazeTokenizerModular-2106"><span class="linenos">2106</span></a>    <span class="nd">@classmethod</span>
</span><span id="MazeTokenizerModular-2107"><a href="#MazeTokenizerModular-2107"><span class="linenos">2107</span></a>    <span class="k">def</span> <span class="nf">from_tokens</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2108"><a href="#MazeTokenizerModular-2108"><span class="linenos">2108</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2109"><a href="#MazeTokenizerModular-2109"><span class="linenos">2109</span></a>        <span class="n">tokens</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="MazeTokenizerModular-2110"><a href="#MazeTokenizerModular-2110"><span class="linenos">2110</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeTokenizerModular&quot;</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2111"><a href="#MazeTokenizerModular-2111"><span class="linenos">2111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2112"><a href="#MazeTokenizerModular-2112"><span class="linenos">2112</span></a><span class="sd">        Infers most `MazeTokenizerModular` parameters from a full sequence of tokens.</span>
</span><span id="MazeTokenizerModular-2113"><a href="#MazeTokenizerModular-2113"><span class="linenos">2113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2114"><a href="#MazeTokenizerModular-2114"><span class="linenos">2114</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2115"><a href="#MazeTokenizerModular-2115"><span class="linenos">2115</span></a>            <span class="s2">&quot;Recovering tokenizer objects from MazeTokenizerModular-produced strings is not supported&quot;</span>
</span><span id="MazeTokenizerModular-2116"><a href="#MazeTokenizerModular-2116"><span class="linenos">2116</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-2117"><a href="#MazeTokenizerModular-2117"><span class="linenos">2117</span></a>
</span><span id="MazeTokenizerModular-2118"><a href="#MazeTokenizerModular-2118"><span class="linenos">2118</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-2119"><a href="#MazeTokenizerModular-2119"><span class="linenos">2119</span></a>    <span class="k">def</span> <span class="nf">token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2120"><a href="#MazeTokenizerModular-2120"><span class="linenos">2120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from index to token&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2121"><a href="#MazeTokenizerModular-2121"><span class="linenos">2121</span></a>        <span class="k">return</span> <span class="n">VOCAB_LIST</span>
</span><span id="MazeTokenizerModular-2122"><a href="#MazeTokenizerModular-2122"><span class="linenos">2122</span></a>
</span><span id="MazeTokenizerModular-2123"><a href="#MazeTokenizerModular-2123"><span class="linenos">2123</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-2124"><a href="#MazeTokenizerModular-2124"><span class="linenos">2124</span></a>    <span class="k">def</span> <span class="nf">tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-2125"><a href="#MazeTokenizerModular-2125"><span class="linenos">2125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from token to index&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2126"><a href="#MazeTokenizerModular-2126"><span class="linenos">2126</span></a>        <span class="k">return</span> <span class="n">VOCAB_TOKEN_TO_INDEX</span>
</span><span id="MazeTokenizerModular-2127"><a href="#MazeTokenizerModular-2127"><span class="linenos">2127</span></a>
</span><span id="MazeTokenizerModular-2128"><a href="#MazeTokenizerModular-2128"><span class="linenos">2128</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-2129"><a href="#MazeTokenizerModular-2129"><span class="linenos">2129</span></a>    <span class="k">def</span> <span class="nf">vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2130"><a href="#MazeTokenizerModular-2130"><span class="linenos">2130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of tokens in the static vocab&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2131"><a href="#MazeTokenizerModular-2131"><span class="linenos">2131</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">VOCAB_LIST</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2132"><a href="#MazeTokenizerModular-2132"><span class="linenos">2132</span></a>
</span><span id="MazeTokenizerModular-2133"><a href="#MazeTokenizerModular-2133"><span class="linenos">2133</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-2134"><a href="#MazeTokenizerModular-2134"><span class="linenos">2134</span></a>    <span class="k">def</span> <span class="nf">n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2135"><a href="#MazeTokenizerModular-2135"><span class="linenos">2135</span></a>        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2136"><a href="#MazeTokenizerModular-2136"><span class="linenos">2136</span></a>            <span class="s2">&quot;`MazeTokenizerModular.n_tokens` has been removed. Use `len(maze_dataset.VOCAB_LIST)` instead.&quot;</span>
</span><span id="MazeTokenizerModular-2137"><a href="#MazeTokenizerModular-2137"><span class="linenos">2137</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-2138"><a href="#MazeTokenizerModular-2138"><span class="linenos">2138</span></a>
</span><span id="MazeTokenizerModular-2139"><a href="#MazeTokenizerModular-2139"><span class="linenos">2139</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular-2140"><a href="#MazeTokenizerModular-2140"><span class="linenos">2140</span></a>    <span class="k">def</span> <span class="nf">padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2141"><a href="#MazeTokenizerModular-2141"><span class="linenos">2141</span></a>        <span class="k">return</span> <span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PADDING</span><span class="p">]</span>
</span><span id="MazeTokenizerModular-2142"><a href="#MazeTokenizerModular-2142"><span class="linenos">2142</span></a>
</span><span id="MazeTokenizerModular-2143"><a href="#MazeTokenizerModular-2143"><span class="linenos">2143</span></a>    <span class="c1"># conversion functions</span>
</span><span id="MazeTokenizerModular-2144"><a href="#MazeTokenizerModular-2144"><span class="linenos">2144</span></a>    <span class="c1"># ============================================================</span>
</span><span id="MazeTokenizerModular-2145"><a href="#MazeTokenizerModular-2145"><span class="linenos">2145</span></a>
</span><span id="MazeTokenizerModular-2146"><a href="#MazeTokenizerModular-2146"><span class="linenos">2146</span></a>    <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2147"><a href="#MazeTokenizerModular-2147"><span class="linenos">2147</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2148"><a href="#MazeTokenizerModular-2148"><span class="linenos">2148</span></a>        <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2149"><a href="#MazeTokenizerModular-2149"><span class="linenos">2149</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-2150"><a href="#MazeTokenizerModular-2150"><span class="linenos">2150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts maze into a list of tokens.&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2151"><a href="#MazeTokenizerModular-2151"><span class="linenos">2151</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2152"><a href="#MazeTokenizerModular-2152"><span class="linenos">2152</span></a>
</span><span id="MazeTokenizerModular-2153"><a href="#MazeTokenizerModular-2153"><span class="linenos">2153</span></a>    <span class="k">def</span> <span class="nf">coords_to_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span> <span class="o">|</span> <span class="n">Coord</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-2154"><a href="#MazeTokenizerModular-2154"><span class="linenos">2154</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2155"><a href="#MazeTokenizerModular-2155"><span class="linenos">2155</span></a>            <span class="n">flatten</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2156"><a href="#MazeTokenizerModular-2156"><span class="linenos">2156</span></a>                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
</span><span id="MazeTokenizerModular-2157"><a href="#MazeTokenizerModular-2157"><span class="linenos">2157</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizerModular-2158"><a href="#MazeTokenizerModular-2158"><span class="linenos">2158</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-2159"><a href="#MazeTokenizerModular-2159"><span class="linenos">2159</span></a>
</span><span id="MazeTokenizerModular-2160"><a href="#MazeTokenizerModular-2160"><span class="linenos">2160</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular-2161"><a href="#MazeTokenizerModular-2161"><span class="linenos">2161</span></a>    <span class="k">def</span> <span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2162"><a href="#MazeTokenizerModular-2162"><span class="linenos">2162</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2163"><a href="#MazeTokenizerModular-2163"><span class="linenos">2163</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2164"><a href="#MazeTokenizerModular-2164"><span class="linenos">2164</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-2165"><a href="#MazeTokenizerModular-2165"><span class="linenos">2165</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2166"><a href="#MazeTokenizerModular-2166"><span class="linenos">2166</span></a>            <span class="s2">&quot;`MazeTokenizerModular.strings_to_coords` only supports legacy UT strings.&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2167"><a href="#MazeTokenizerModular-2167"><span class="linenos">2167</span></a>            <span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2168"><a href="#MazeTokenizerModular-2168"><span class="linenos">2168</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular-2169"><a href="#MazeTokenizerModular-2169"><span class="linenos">2169</span></a>        <span class="k">return</span> <span class="n">strings_to_coords</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2170"><a href="#MazeTokenizerModular-2170"><span class="linenos">2170</span></a>
</span><span id="MazeTokenizerModular-2171"><a href="#MazeTokenizerModular-2171"><span class="linenos">2171</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular-2172"><a href="#MazeTokenizerModular-2172"><span class="linenos">2172</span></a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular-2173"><a href="#MazeTokenizerModular-2173"><span class="linenos">2173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;encode a string or list of strings into a list of tokens&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2174"><a href="#MazeTokenizerModular-2174"><span class="linenos">2174</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2175"><a href="#MazeTokenizerModular-2175"><span class="linenos">2175</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MazeTokenizerModular-2176"><a href="#MazeTokenizerModular-2176"><span class="linenos">2176</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="MazeTokenizerModular-2177"><a href="#MazeTokenizerModular-2177"><span class="linenos">2177</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</span><span id="MazeTokenizerModular-2178"><a href="#MazeTokenizerModular-2178"><span class="linenos">2178</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2179"><a href="#MazeTokenizerModular-2179"><span class="linenos">2179</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2180"><a href="#MazeTokenizerModular-2180"><span class="linenos">2180</span></a>                <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2181"><a href="#MazeTokenizerModular-2181"><span class="linenos">2181</span></a>                <span class="sa">f</span><span class="s2">&quot;in `VOCAB`.&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular-2182"><a href="#MazeTokenizerModular-2182"><span class="linenos">2182</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizerModular-2183"><a href="#MazeTokenizerModular-2183"><span class="linenos">2183</span></a>
</span><span id="MazeTokenizerModular-2184"><a href="#MazeTokenizerModular-2184"><span class="linenos">2184</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular-2185"><a href="#MazeTokenizerModular-2185"><span class="linenos">2185</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span>
</span><span id="MazeTokenizerModular-2186"><a href="#MazeTokenizerModular-2186"><span class="linenos">2186</span></a>        <span class="n">token_ids</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MazeTokenizerModular-2187"><a href="#MazeTokenizerModular-2187"><span class="linenos">2187</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2188"><a href="#MazeTokenizerModular-2188"><span class="linenos">2188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;decode a list of tokens into a string or list of strings&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular-2189"><a href="#MazeTokenizerModular-2189"><span class="linenos">2189</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2190"><a href="#MazeTokenizerModular-2190"><span class="linenos">2190</span></a>            <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB_LIST</span><span class="p">[</span><span class="n">token_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">token_id</span> <span class="ow">in</span> <span class="n">token_ids</span><span class="p">]</span>
</span><span id="MazeTokenizerModular-2191"><a href="#MazeTokenizerModular-2191"><span class="linenos">2191</span></a>        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2192"><a href="#MazeTokenizerModular-2192"><span class="linenos">2192</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token index &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39; not found in `VOCAB`.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizerModular-2193"><a href="#MazeTokenizerModular-2193"><span class="linenos">2193</span></a>        <span class="k">if</span> <span class="n">joined_tokens</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2194"><a href="#MazeTokenizerModular-2194"><span class="linenos">2194</span></a>            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="MazeTokenizerModular-2195"><a href="#MazeTokenizerModular-2195"><span class="linenos">2195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular-2196"><a href="#MazeTokenizerModular-2196"><span class="linenos">2196</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>Tokenizer for mazes</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code><a href="#MazeTokenizerModular.prompt_sequencer">prompt_sequencer</a></code>: Tokenizer element which assembles token regions (adjacency list, origin, target, path) into a complete prompt.</li>
</ul>

<h1 id="development">Development</h1>

<ul>
<li>To ensure backwards compatibility, the default constructor must always return a tokenizer equivalent to the legacy <code>TokenizationMode.AOTP_UT_Uniform</code>.</li>
<li>Furthermore, the mapping reflected in <code><a href="#MazeTokenizerModular.from_legacy">from_legacy</a></code> must also be maintained.</li>
<li>Updates to <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> or the <code>_TokenizerElement</code> hierarchy must maintain that behavior.</li>
</ul>
</div>


                            <div id="MazeTokenizerModular.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">MazeTokenizerModular</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">prompt_sequencer</span><span class="p">:</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">_PromptSequencer</span> <span class="o">=</span> <span class="n"><a href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a></span><span class="p">(</span><span class="n">coord_tokenizer</span><span class="o">=</span><span class="n"><a href="#CoordTokenizers.UT">CoordTokenizers.UT</a></span><span class="p">(),</span> <span class="n">adj_list_tokenizer</span><span class="o">=</span><span class="n"><a href="#AdjListTokenizers.AdjListCoord">AdjListTokenizers.AdjListCoord</a></span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shuffle_d0</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_grouping</span><span class="o">=</span><span class="n"><a href="#EdgeGroupings.Ungrouped">EdgeGroupings.Ungrouped</a></span><span class="p">(</span><span class="n">connection_token_ordinal</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">edge_subset</span><span class="o">=</span><span class="n"><a href="#EdgeSubsets.ConnectionEdges">EdgeSubsets.ConnectionEdges</a></span><span class="p">(</span><span class="n">walls</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">edge_permuter</span><span class="o">=</span><span class="n"><a href="#EdgePermuters.RandomCoords">EdgePermuters.RandomCoords</a></span><span class="p">()),</span> <span class="n">target_tokenizer</span><span class="o">=</span><span class="n"><a href="#TargetTokenizers.Unlabeled">TargetTokenizers.Unlabeled</a></span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">path_tokenizer</span><span class="o">=</span><span class="n"><a href="#PathTokenizers.StepSequence">PathTokenizers.StepSequence</a></span><span class="p">(</span><span class="n">step_size</span><span class="o">=</span><span class="n"><a href="#StepSizes.Singles">StepSizes.Singles</a></span><span class="p">(),</span> <span class="n">step_tokenizers</span><span class="o">=</span><span class="p">(</span><span class="n"><a href="#StepTokenizers.Coord">StepTokenizers.Coord</a></span><span class="p">(),),</span> <span class="n">pre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intra</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MazeTokenizerModular.__init__"></a>
    
    

                            </div>
                            <div id="MazeTokenizerModular.prompt_sequencer" class="classattr">
                                <div class="attr variable">
            <span class="name">prompt_sequencer</span><span class="annotation">: maze_dataset.tokenization.maze_tokenizer.PromptSequencers._PromptSequencer</span>        =
<input id="MazeTokenizerModular.prompt_sequencer-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="MazeTokenizerModular.prompt_sequencer-view-value"></label><span class="default_value"><a href="#PromptSequencers.AOTP">PromptSequencers.AOTP</a>(coord_tokenizer=CoordTokenizers.UT(), adj_list_tokenizer=AdjListTokenizers.AdjListCoord(pre=False, post=True, shuffle_d0=True, edge_grouping=EdgeGroupings.Ungrouped(connection_token_ordinal=1), edge_subset=EdgeSubsets.ConnectionEdges(walls=False), edge_permuter=EdgePermuters.RandomCoords()), target_tokenizer=TargetTokenizers.Unlabeled(post=False), path_tokenizer=PathTokenizers.StepSequence(step_size=StepSizes.Singles(), step_tokenizers=(<a href="#StepTokenizers.Coord">StepTokenizers.Coord()</a>,), pre=False, intra=False, post=False))</span>

        
    </div>
    <a class="headerlink" href="#MazeTokenizerModular.prompt_sequencer"></a>
    
    

                            </div>
                            <div id="MazeTokenizerModular.hash_int" class="classattr">
                                        <input id="MazeTokenizerModular.hash_int-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hash_int</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.hash_int-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1925-L1929" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.hash_int"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.hash_int-1926"><a href="#MazeTokenizerModular.hash_int-1926"><span class="linenos">1926</span></a>    <span class="k">def</span> <span class="nf">hash_int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.hash_int-1927"><a href="#MazeTokenizerModular.hash_int-1927"><span class="linenos">1927</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.hash_int-1928"><a href="#MazeTokenizerModular.hash_int-1928"><span class="linenos">1928</span></a>            <span class="n">hashlib</span><span class="o">.</span><span class="n">blake2b</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular.hash_int-1929"><a href="#MazeTokenizerModular.hash_int-1929"><span class="linenos">1929</span></a>            <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.hash_int-1930"><a href="#MazeTokenizerModular.hash_int-1930"><span class="linenos">1930</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.hash_b64" class="classattr">
                                        <input id="MazeTokenizerModular.hash_b64-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hash_b64</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">n_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.hash_b64-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1935-L1945" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.hash_b64"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.hash_b64-1936"><a href="#MazeTokenizerModular.hash_b64-1936"><span class="linenos">1936</span></a>    <span class="k">def</span> <span class="nf">hash_b64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.hash_b64-1937"><a href="#MazeTokenizerModular.hash_b64-1937"><span class="linenos">1937</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;filename-safe base64 encoding of the hash&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.hash_b64-1938"><a href="#MazeTokenizerModular.hash_b64-1938"><span class="linenos">1938</span></a>        <span class="c1"># Use modulus to ensure the integer fits within n_bytes * 8 bits</span>
</span><span id="MazeTokenizerModular.hash_b64-1939"><a href="#MazeTokenizerModular.hash_b64-1939"><span class="linenos">1939</span></a>        <span class="n">hash_mod</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_int</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">n_bytes</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
</span><span id="MazeTokenizerModular.hash_b64-1940"><a href="#MazeTokenizerModular.hash_b64-1940"><span class="linenos">1940</span></a>
</span><span id="MazeTokenizerModular.hash_b64-1941"><a href="#MazeTokenizerModular.hash_b64-1941"><span class="linenos">1941</span></a>        <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.hash_b64-1942"><a href="#MazeTokenizerModular.hash_b64-1942"><span class="linenos">1942</span></a>            <span class="n">hash_mod</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span> <span class="n">altchars</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;-_&quot;</span>
</span><span id="MazeTokenizerModular.hash_b64-1943"><a href="#MazeTokenizerModular.hash_b64-1943"><span class="linenos">1943</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.hash_b64-1944"><a href="#MazeTokenizerModular.hash_b64-1944"><span class="linenos">1944</span></a>
</span><span id="MazeTokenizerModular.hash_b64-1945"><a href="#MazeTokenizerModular.hash_b64-1945"><span class="linenos">1945</span></a>        <span class="c1"># Remove any padding equals signs</span>
</span><span id="MazeTokenizerModular.hash_b64-1946"><a href="#MazeTokenizerModular.hash_b64-1946"><span class="linenos">1946</span></a>        <span class="k">return</span> <span class="n">encoded</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>filename-safe base64 encoding of the hash</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.tokenizer_elements" class="classattr">
                                        <input id="MazeTokenizerModular.tokenizer_elements-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tokenizer_elements</span><span class="annotation">: list[maze_dataset.tokenization.maze_tokenizer._TokenizerElement]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.tokenizer_elements-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1949-L1951" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.tokenizer_elements"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.tokenizer_elements-1950"><a href="#MazeTokenizerModular.tokenizer_elements-1950"><span class="linenos">1950</span></a>    <span class="nd">@cached_property</span>
</span><span id="MazeTokenizerModular.tokenizer_elements-1951"><a href="#MazeTokenizerModular.tokenizer_elements-1951"><span class="linenos">1951</span></a>    <span class="k">def</span> <span class="nf">tokenizer_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.tokenizer_elements-1952"><a href="#MazeTokenizerModular.tokenizer_elements-1952"><span class="linenos">1952</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">()]</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.tokenizer_element_tree" class="classattr">
                                        <input id="MazeTokenizerModular.tokenizer_element_tree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tokenizer_element_tree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">abstract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.tokenizer_element_tree-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1953-L1968" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.tokenizer_element_tree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.tokenizer_element_tree-1954"><a href="#MazeTokenizerModular.tokenizer_element_tree-1954"><span class="linenos">1954</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1955"><a href="#MazeTokenizerModular.tokenizer_element_tree-1955"><span class="linenos">1955</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1956"><a href="#MazeTokenizerModular.tokenizer_element_tree-1956"><span class="linenos">1956</span></a><span class="sd">        Returns a string representation of the tree of tokenizer elements contained in `self`.</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1957"><a href="#MazeTokenizerModular.tokenizer_element_tree-1957"><span class="linenos">1957</span></a>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1958"><a href="#MazeTokenizerModular.tokenizer_element_tree-1958"><span class="linenos">1958</span></a><span class="sd">        # Parameters</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1959"><a href="#MazeTokenizerModular.tokenizer_element_tree-1959"><span class="linenos">1959</span></a><span class="sd">        - `abstract: bool`: Whether to print the name of the abstract base class or the concrete class for each `_TokenizerElement` instance.</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1960"><a href="#MazeTokenizerModular.tokenizer_element_tree-1960"><span class="linenos">1960</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1961"><a href="#MazeTokenizerModular.tokenizer_element_tree-1961"><span class="linenos">1961</span></a>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1962"><a href="#MazeTokenizerModular.tokenizer_element_tree-1962"><span class="linenos">1962</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1963"><a href="#MazeTokenizerModular.tokenizer_element_tree-1963"><span class="linenos">1963</span></a>            <span class="p">[</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1964"><a href="#MazeTokenizerModular.tokenizer_element_tree-1964"><span class="linenos">1964</span></a>                <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1965"><a href="#MazeTokenizerModular.tokenizer_element_tree-1965"><span class="linenos">1965</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1966"><a href="#MazeTokenizerModular.tokenizer_element_tree-1966"><span class="linenos">1966</span></a>                    <span class="n">abstract</span><span class="o">=</span><span class="n">abstract</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1967"><a href="#MazeTokenizerModular.tokenizer_element_tree-1967"><span class="linenos">1967</span></a>                <span class="p">),</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1968"><a href="#MazeTokenizerModular.tokenizer_element_tree-1968"><span class="linenos">1968</span></a>            <span class="p">]</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree-1969"><a href="#MazeTokenizerModular.tokenizer_element_tree-1969"><span class="linenos">1969</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a string representation of the tree of tokenizer elements contained in <code>self</code>.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>abstract: bool</code>: Whether to print the name of the abstract base class or the concrete class for each <code>_TokenizerElement</code> instance.</li>
</ul>
</div>


                            </div>
                            <div id="MazeTokenizerModular.tokenizer_element_tree_concrete" class="classattr">
                                        <input id="MazeTokenizerModular.tokenizer_element_tree_concrete-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tokenizer_element_tree_concrete</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.tokenizer_element_tree_concrete-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1970-L1975" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.tokenizer_element_tree_concrete"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.tokenizer_element_tree_concrete-1971"><a href="#MazeTokenizerModular.tokenizer_element_tree_concrete-1971"><span class="linenos">1971</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree_concrete-1972"><a href="#MazeTokenizerModular.tokenizer_element_tree_concrete-1972"><span class="linenos">1972</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_tree_concrete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree_concrete-1973"><a href="#MazeTokenizerModular.tokenizer_element_tree_concrete-1973"><span class="linenos">1973</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree_concrete-1974"><a href="#MazeTokenizerModular.tokenizer_element_tree_concrete-1974"><span class="linenos">1974</span></a><span class="sd">        Property wrapper for `tokenizer_element_tree` so that it can be used in `properties_to_serialize`.</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree_concrete-1975"><a href="#MazeTokenizerModular.tokenizer_element_tree_concrete-1975"><span class="linenos">1975</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_element_tree_concrete-1976"><a href="#MazeTokenizerModular.tokenizer_element_tree_concrete-1976"><span class="linenos">1976</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_element_tree</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Property wrapper for <code><a href="#MazeTokenizerModular.tokenizer_element_tree">tokenizer_element_tree</a></code> so that it can be used in <code>properties_to_serialize</code>.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.tokenizer_element_dict" class="classattr">
                                        <input id="MazeTokenizerModular.tokenizer_element_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tokenizer_element_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.tokenizer_element_dict-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1977-L1981" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.tokenizer_element_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.tokenizer_element_dict-1978"><a href="#MazeTokenizerModular.tokenizer_element_dict-1978"><span class="linenos">1978</span></a>    <span class="k">def</span> <span class="nf">tokenizer_element_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.tokenizer_element_dict-1979"><a href="#MazeTokenizerModular.tokenizer_element_dict-1979"><span class="linenos">1979</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_element_dict-1980"><a href="#MazeTokenizerModular.tokenizer_element_dict-1980"><span class="linenos">1980</span></a><span class="sd">        Nested dictionary of the internal `TokenizerElement`s.</span>
</span><span id="MazeTokenizerModular.tokenizer_element_dict-1981"><a href="#MazeTokenizerModular.tokenizer_element_dict-1981"><span class="linenos">1981</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_element_dict-1982"><a href="#MazeTokenizerModular.tokenizer_element_dict-1982"><span class="linenos">1982</span></a>        <span class="k">return</span> <span class="p">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">tokenizer_element_dict</span><span class="p">()}</span>
</span></pre></div>


            <div class="docstring"><p>Nested dictionary of the internal <code>TokenizerElement</code>s.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.name" class="classattr">
                                        <input id="MazeTokenizerModular.name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">name</span><span class="annotation">: str</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.name-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1983-L1986" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.name-1984"><a href="#MazeTokenizerModular.name-1984"><span class="linenos">1984</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.name-1985"><a href="#MazeTokenizerModular.name-1985"><span class="linenos">1985</span></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.name-1986"><a href="#MazeTokenizerModular.name-1986"><span class="linenos">1986</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serializes MazeTokenizer into a key for encoding in zanj&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.name-1987"><a href="#MazeTokenizerModular.name-1987"><span class="linenos">1987</span></a>        <span class="k">return</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Serializes MazeTokenizer into a key for encoding in zanj</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.summary" class="classattr">
                                        <input id="MazeTokenizerModular.summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.summary-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L1988-L1995" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.summary-1989"><a href="#MazeTokenizerModular.summary-1989"><span class="linenos">1989</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.summary-1990"><a href="#MazeTokenizerModular.summary-1990"><span class="linenos">1990</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.summary-1991"><a href="#MazeTokenizerModular.summary-1991"><span class="linenos">1991</span></a><span class="sd">        Single-level dictionary of the internal `TokenizerElement`s.</span>
</span><span id="MazeTokenizerModular.summary-1992"><a href="#MazeTokenizerModular.summary-1992"><span class="linenos">1992</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.summary-1993"><a href="#MazeTokenizerModular.summary-1993"><span class="linenos">1993</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizerModular.summary-1994"><a href="#MazeTokenizerModular.summary-1994"><span class="linenos">1994</span></a>            <span class="c1"># &quot;prompt_sequencer&quot;: self.prompt_sequencer.name,</span>
</span><span id="MazeTokenizerModular.summary-1995"><a href="#MazeTokenizerModular.summary-1995"><span class="linenos">1995</span></a>            <span class="o">**</span><span class="p">{</span><span class="n">elem</span><span class="o">.</span><span class="n">attribute_key</span><span class="p">():</span> <span class="n">elem</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">}</span>
</span><span id="MazeTokenizerModular.summary-1996"><a href="#MazeTokenizerModular.summary-1996"><span class="linenos">1996</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Single-level dictionary of the internal <code>TokenizerElement</code>s.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.has_element" class="classattr">
                                        <input id="MazeTokenizerModular.has_element-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">has_element</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span><span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">|</span> <span class="n">maze_dataset</span><span class="o">.</span><span class="n">tokenization</span><span class="o">.</span><span class="n">maze_tokenizer</span><span class="o">.</span><span class="n">_TokenizerElement</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.has_element-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2014-L2030" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.has_element"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.has_element-2015"><a href="#MazeTokenizerModular.has_element-2015"><span class="linenos">2015</span></a>    <span class="k">def</span> <span class="nf">has_element</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.has_element-2016"><a href="#MazeTokenizerModular.has_element-2016"><span class="linenos">2016</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.has_element-2017"><a href="#MazeTokenizerModular.has_element-2017"><span class="linenos">2017</span></a>        <span class="o">*</span><span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">_TokenizerElement</span><span class="p">]</span> <span class="o">|</span> <span class="n">_TokenizerElement</span><span class="p">],</span>
</span><span id="MazeTokenizerModular.has_element-2018"><a href="#MazeTokenizerModular.has_element-2018"><span class="linenos">2018</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.has_element-2019"><a href="#MazeTokenizerModular.has_element-2019"><span class="linenos">2019</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if the `MazeTokenizerModular` instance contains ALL of the items specified in `elements`.</span>
</span><span id="MazeTokenizerModular.has_element-2020"><a href="#MazeTokenizerModular.has_element-2020"><span class="linenos">2020</span></a>
</span><span id="MazeTokenizerModular.has_element-2021"><a href="#MazeTokenizerModular.has_element-2021"><span class="linenos">2021</span></a><span class="sd">        Querying with a partial subset of `_TokenizerElement` fields is not currently supported.</span>
</span><span id="MazeTokenizerModular.has_element-2022"><a href="#MazeTokenizerModular.has_element-2022"><span class="linenos">2022</span></a><span class="sd">        To do such a query, assemble multiple calls to `has_elements`.</span>
</span><span id="MazeTokenizerModular.has_element-2023"><a href="#MazeTokenizerModular.has_element-2023"><span class="linenos">2023</span></a>
</span><span id="MazeTokenizerModular.has_element-2024"><a href="#MazeTokenizerModular.has_element-2024"><span class="linenos">2024</span></a><span class="sd">        # Parameters</span>
</span><span id="MazeTokenizerModular.has_element-2025"><a href="#MazeTokenizerModular.has_element-2025"><span class="linenos">2025</span></a><span class="sd">        - `elements`: Singleton or iterable of `_TokenizerElement` instances or classes.</span>
</span><span id="MazeTokenizerModular.has_element-2026"><a href="#MazeTokenizerModular.has_element-2026"><span class="linenos">2026</span></a><span class="sd">        If an instance is provided, then comparison is done via instance equality.</span>
</span><span id="MazeTokenizerModular.has_element-2027"><a href="#MazeTokenizerModular.has_element-2027"><span class="linenos">2027</span></a><span class="sd">        If a class is provided, then comparison isdone via `isinstance`. I.e., any instance of that class is accepted.</span>
</span><span id="MazeTokenizerModular.has_element-2028"><a href="#MazeTokenizerModular.has_element-2028"><span class="linenos">2028</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.has_element-2029"><a href="#MazeTokenizerModular.has_element-2029"><span class="linenos">2029</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.has_element-2030"><a href="#MazeTokenizerModular.has_element-2030"><span class="linenos">2030</span></a>            <span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MazeTokenizerModular.has_element-2031"><a href="#MazeTokenizerModular.has_element-2031"><span class="linenos">2031</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_has_element_singular</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Returns True if the <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> instance contains ALL of the items specified in <code>elements</code>.</p>

<p>Querying with a partial subset of <code>_TokenizerElement</code> fields is not currently supported.
To do such a query, assemble multiple calls to <code>has_elements</code>.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>elements</code>: Singleton or iterable of <code>_TokenizerElement</code> instances or classes.
If an instance is provided, then comparison is done via instance equality.
If a class is provided, then comparison isdone via <code>isinstance</code>. I.e., any instance of that class is accepted.</li>
</ul>
</div>


                            </div>
                            <div id="MazeTokenizerModular.is_valid" class="classattr">
                                        <input id="MazeTokenizerModular.is_valid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_valid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.is_valid-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2032-L2037" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.is_valid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.is_valid-2033"><a href="#MazeTokenizerModular.is_valid-2033"><span class="linenos">2033</span></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.is_valid-2034"><a href="#MazeTokenizerModular.is_valid-2034"><span class="linenos">2034</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.is_valid-2035"><a href="#MazeTokenizerModular.is_valid-2035"><span class="linenos">2035</span></a><span class="sd">        Returns `True` if `self` is a valid tokenizer.</span>
</span><span id="MazeTokenizerModular.is_valid-2036"><a href="#MazeTokenizerModular.is_valid-2036"><span class="linenos">2036</span></a><span class="sd">        Evaluates the validity of all of `self.tokenizer_elements` according to each one&#39;s method.</span>
</span><span id="MazeTokenizerModular.is_valid-2037"><a href="#MazeTokenizerModular.is_valid-2037"><span class="linenos">2037</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.is_valid-2038"><a href="#MazeTokenizerModular.is_valid-2038"><span class="linenos">2038</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">el</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_elements</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Returns <code>True</code> if <code>self</code> is a valid tokenizer.
Evaluates the validity of all of <code>self.tokenizer_elements</code> according to each one's method.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.is_legacy_equivalent" class="classattr">
                                        <input id="MazeTokenizerModular.is_legacy_equivalent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_legacy_equivalent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.is_legacy_equivalent-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2039-L2046" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.is_legacy_equivalent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.is_legacy_equivalent-2040"><a href="#MazeTokenizerModular.is_legacy_equivalent-2040"><span class="linenos">2040</span></a>    <span class="k">def</span> <span class="nf">is_legacy_equivalent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2041"><a href="#MazeTokenizerModular.is_legacy_equivalent-2041"><span class="linenos">2041</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if `self` has identical stringification behavior as any legacy `MazeTokenizer`.&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2042"><a href="#MazeTokenizerModular.is_legacy_equivalent-2042"><span class="linenos">2042</span></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2043"><a href="#MazeTokenizerModular.is_legacy_equivalent-2043"><span class="linenos">2043</span></a>            <span class="p">[</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2044"><a href="#MazeTokenizerModular.is_legacy_equivalent-2044"><span class="linenos">2044</span></a>                <span class="bp">self</span> <span class="o">==</span> <span class="n">MazeTokenizerModular</span><span class="o">.</span><span class="n">from_legacy</span><span class="p">(</span><span class="n">tok_mode</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2045"><a href="#MazeTokenizerModular.is_legacy_equivalent-2045"><span class="linenos">2045</span></a>                <span class="k">for</span> <span class="n">tok_mode</span> <span class="ow">in</span> <span class="n">TokenizationMode</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2046"><a href="#MazeTokenizerModular.is_legacy_equivalent-2046"><span class="linenos">2046</span></a>            <span class="p">]</span>
</span><span id="MazeTokenizerModular.is_legacy_equivalent-2047"><a href="#MazeTokenizerModular.is_legacy_equivalent-2047"><span class="linenos">2047</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns if <code>self</code> has identical stringification behavior as any legacy <code><a href="#MazeTokenizer">MazeTokenizer</a></code>.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.is_tested_tokenizer" class="classattr">
                                        <input id="MazeTokenizerModular.is_tested_tokenizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_tested_tokenizer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">do_assert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.is_tested_tokenizer-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2048-L2075" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.is_tested_tokenizer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.is_tested_tokenizer-2049"><a href="#MazeTokenizerModular.is_tested_tokenizer-2049"><span class="linenos">2049</span></a>    <span class="k">def</span> <span class="nf">is_tested_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_assert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2050"><a href="#MazeTokenizerModular.is_tested_tokenizer-2050"><span class="linenos">2050</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns if the tokenizer is returned by `all_tokenizers.get_all_tokenizers`, the set of tested and reliable tokenizers.</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2051"><a href="#MazeTokenizerModular.is_tested_tokenizer-2051"><span class="linenos">2051</span></a>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2052"><a href="#MazeTokenizerModular.is_tested_tokenizer-2052"><span class="linenos">2052</span></a><span class="sd">        Since evaluating `all_tokenizers.get_all_tokenizers` is expensive,</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2053"><a href="#MazeTokenizerModular.is_tested_tokenizer-2053"><span class="linenos">2053</span></a><span class="sd">        instead checks for membership of `self`&#39;s hash in `get_all_tokenizer_hashes()`.</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2054"><a href="#MazeTokenizerModular.is_tested_tokenizer-2054"><span class="linenos">2054</span></a>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2055"><a href="#MazeTokenizerModular.is_tested_tokenizer-2055"><span class="linenos">2055</span></a><span class="sd">        if `do_assert` is `True`, raises an `AssertionError` if the tokenizer is not tested.</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2056"><a href="#MazeTokenizerModular.is_tested_tokenizer-2056"><span class="linenos">2056</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2057"><a href="#MazeTokenizerModular.is_tested_tokenizer-2057"><span class="linenos">2057</span></a>        <span class="n">all_tokenizer_hashes</span><span class="p">:</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2058"><a href="#MazeTokenizerModular.is_tested_tokenizer-2058"><span class="linenos">2058</span></a>            <span class="n">get_all_tokenizer_hashes</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2059"><a href="#MazeTokenizerModular.is_tested_tokenizer-2059"><span class="linenos">2059</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2060"><a href="#MazeTokenizerModular.is_tested_tokenizer-2060"><span class="linenos">2060</span></a>        <span class="n">hash_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2061"><a href="#MazeTokenizerModular.is_tested_tokenizer-2061"><span class="linenos">2061</span></a>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2062"><a href="#MazeTokenizerModular.is_tested_tokenizer-2062"><span class="linenos">2062</span></a>        <span class="n">in_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">hash_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2063"><a href="#MazeTokenizerModular.is_tested_tokenizer-2063"><span class="linenos">2063</span></a>        <span class="n">hashes_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">all_tokenizer_hashes</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2064"><a href="#MazeTokenizerModular.is_tested_tokenizer-2064"><span class="linenos">2064</span></a>        <span class="n">is_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2065"><a href="#MazeTokenizerModular.is_tested_tokenizer-2065"><span class="linenos">2065</span></a>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2066"><a href="#MazeTokenizerModular.is_tested_tokenizer-2066"><span class="linenos">2066</span></a>        <span class="k">if</span> <span class="n">do_assert</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2067"><a href="#MazeTokenizerModular.is_tested_tokenizer-2067"><span class="linenos">2067</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2068"><a href="#MazeTokenizerModular.is_tested_tokenizer-2068"><span class="linenos">2068</span></a>                <span class="n">in_range</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2069"><a href="#MazeTokenizerModular.is_tested_tokenizer-2069"><span class="linenos">2069</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hash_index</span><span class="w"> </span><span class="si">= }</span><span class="s2"> is invalid, must be at most </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_tokenizer_hashes</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2070"><a href="#MazeTokenizerModular.is_tested_tokenizer-2070"><span class="linenos">2070</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2071"><a href="#MazeTokenizerModular.is_tested_tokenizer-2071"><span class="linenos">2071</span></a>                <span class="n">hashes_match</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2072"><a href="#MazeTokenizerModular.is_tested_tokenizer-2072"><span class="linenos">2072</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">all_tokenizer_hashes</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span><span class="w"> </span><span class="si">= }</span><span class="s2"> != </span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2073"><a href="#MazeTokenizerModular.is_tested_tokenizer-2073"><span class="linenos">2073</span></a>            <span class="k">assert</span> <span class="n">is_valid</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;self.is_valid returns False&quot;</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2074"><a href="#MazeTokenizerModular.is_tested_tokenizer-2074"><span class="linenos">2074</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2075"><a href="#MazeTokenizerModular.is_tested_tokenizer-2075"><span class="linenos">2075</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.is_tested_tokenizer-2076"><a href="#MazeTokenizerModular.is_tested_tokenizer-2076"><span class="linenos">2076</span></a>            <span class="k">return</span> <span class="n">in_range</span> <span class="ow">and</span> <span class="n">hashes_match</span> <span class="ow">and</span> <span class="n">is_valid</span>
</span></pre></div>


            <div class="docstring"><p>Returns if the tokenizer is returned by <code>all_tokenizers.get_all_tokenizers</code>, the set of tested and reliable tokenizers.</p>

<p>Since evaluating <code>all_tokenizers.get_all_tokenizers</code> is expensive,
instead checks for membership of <code>self</code>'s hash in <code><a href="#get_all_tokenizer_hashes">get_all_tokenizer_hashes()</a></code>.</p>

<p>if <code>do_assert</code> is <code>True</code>, raises an <code>AssertionError</code> if the tokenizer is not tested.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.is_AOTP" class="classattr">
                                        <input id="MazeTokenizerModular.is_AOTP-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_AOTP</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.is_AOTP-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2077-L2078" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.is_AOTP"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.is_AOTP-2078"><a href="#MazeTokenizerModular.is_AOTP-2078"><span class="linenos">2078</span></a>    <span class="k">def</span> <span class="nf">is_AOTP</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.is_AOTP-2079"><a href="#MazeTokenizerModular.is_AOTP-2079"><span class="linenos">2079</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_element</span><span class="p">(</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.is_UT" class="classattr">
                                        <input id="MazeTokenizerModular.is_UT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_UT</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.is_UT-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2080-L2081" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.is_UT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.is_UT-2081"><a href="#MazeTokenizerModular.is_UT-2081"><span class="linenos">2081</span></a>    <span class="k">def</span> <span class="nf">is_UT</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.is_UT-2082"><a href="#MazeTokenizerModular.is_UT-2082"><span class="linenos">2082</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_element</span><span class="p">(</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">UT</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.from_legacy" class="classattr">
                                        <input id="MazeTokenizerModular.from_legacy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_legacy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">legacy_maze_tokenizer</span><span class="p">:</span> <span class="n"><a href="#MazeTokenizer">MazeTokenizer</a></span> <span class="o">|</span> <span class="n"><a href="#TokenizationMode">TokenizationMode</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeTokenizerModular">MazeTokenizerModular</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.from_legacy-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2086-L2101" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.from_legacy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.from_legacy-2087"><a href="#MazeTokenizerModular.from_legacy-2087"><span class="linenos">2087</span></a>    <span class="nd">@classmethod</span>
</span><span id="MazeTokenizerModular.from_legacy-2088"><a href="#MazeTokenizerModular.from_legacy-2088"><span class="linenos">2088</span></a>    <span class="k">def</span> <span class="nf">from_legacy</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.from_legacy-2089"><a href="#MazeTokenizerModular.from_legacy-2089"><span class="linenos">2089</span></a>        <span class="bp">cls</span><span class="p">,</span> <span class="n">legacy_maze_tokenizer</span><span class="p">:</span> <span class="n">MazeTokenizer</span> <span class="o">|</span> <span class="n">TokenizationMode</span>
</span><span id="MazeTokenizerModular.from_legacy-2090"><a href="#MazeTokenizerModular.from_legacy-2090"><span class="linenos">2090</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeTokenizerModular&quot;</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.from_legacy-2091"><a href="#MazeTokenizerModular.from_legacy-2091"><span class="linenos">2091</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Maps a legacy `MazeTokenizer` or `TokenizationMode` to its equivalent `MazeTokenizerModular` instance.&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.from_legacy-2092"><a href="#MazeTokenizerModular.from_legacy-2092"><span class="linenos">2092</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legacy_maze_tokenizer</span><span class="p">,</span> <span class="n">MazeTokenizer</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.from_legacy-2093"><a href="#MazeTokenizerModular.from_legacy-2093"><span class="linenos">2093</span></a>            <span class="n">legacy_maze_tokenizer</span> <span class="o">=</span> <span class="n">legacy_maze_tokenizer</span><span class="o">.</span><span class="n">tokenization_mode</span>
</span><span id="MazeTokenizerModular.from_legacy-2094"><a href="#MazeTokenizerModular.from_legacy-2094"><span class="linenos">2094</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="MazeTokenizerModular.from_legacy-2095"><a href="#MazeTokenizerModular.from_legacy-2095"><span class="linenos">2095</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_uniform</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular.from_legacy-2096"><a href="#MazeTokenizerModular.from_legacy-2096"><span class="linenos">2096</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_UT_rasterized</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(),</span>
</span><span id="MazeTokenizerModular.from_legacy-2097"><a href="#MazeTokenizerModular.from_legacy-2097"><span class="linenos">2097</span></a>            <span class="n">TokenizationMode</span><span class="o">.</span><span class="n">AOTP_CTT_indexed</span><span class="p">:</span> <span class="n">MazeTokenizerModular</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.from_legacy-2098"><a href="#MazeTokenizerModular.from_legacy-2098"><span class="linenos">2098</span></a>                <span class="n">prompt_sequencer</span><span class="o">=</span><span class="n">PromptSequencers</span><span class="o">.</span><span class="n">AOTP</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.from_legacy-2099"><a href="#MazeTokenizerModular.from_legacy-2099"><span class="linenos">2099</span></a>                    <span class="n">coord_tokenizer</span><span class="o">=</span><span class="n">CoordTokenizers</span><span class="o">.</span><span class="n">CTT</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.from_legacy-2100"><a href="#MazeTokenizerModular.from_legacy-2100"><span class="linenos">2100</span></a>                <span class="p">)</span>
</span><span id="MazeTokenizerModular.from_legacy-2101"><a href="#MazeTokenizerModular.from_legacy-2101"><span class="linenos">2101</span></a>            <span class="p">),</span>
</span><span id="MazeTokenizerModular.from_legacy-2102"><a href="#MazeTokenizerModular.from_legacy-2102"><span class="linenos">2102</span></a>        <span class="p">}[</span><span class="n">legacy_maze_tokenizer</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Maps a legacy <code><a href="#MazeTokenizer">MazeTokenizer</a></code> or <code><a href="#TokenizationMode">TokenizationMode</a></code> to its equivalent <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> instance.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.from_tokens" class="classattr">
                                        <input id="MazeTokenizerModular.from_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_tokens</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">tokens</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#MazeTokenizerModular">MazeTokenizerModular</a></span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.from_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2105-L2115" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.from_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.from_tokens-2106"><a href="#MazeTokenizerModular.from_tokens-2106"><span class="linenos">2106</span></a>    <span class="nd">@classmethod</span>
</span><span id="MazeTokenizerModular.from_tokens-2107"><a href="#MazeTokenizerModular.from_tokens-2107"><span class="linenos">2107</span></a>    <span class="k">def</span> <span class="nf">from_tokens</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.from_tokens-2108"><a href="#MazeTokenizerModular.from_tokens-2108"><span class="linenos">2108</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.from_tokens-2109"><a href="#MazeTokenizerModular.from_tokens-2109"><span class="linenos">2109</span></a>        <span class="n">tokens</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="MazeTokenizerModular.from_tokens-2110"><a href="#MazeTokenizerModular.from_tokens-2110"><span class="linenos">2110</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MazeTokenizerModular&quot;</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.from_tokens-2111"><a href="#MazeTokenizerModular.from_tokens-2111"><span class="linenos">2111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.from_tokens-2112"><a href="#MazeTokenizerModular.from_tokens-2112"><span class="linenos">2112</span></a><span class="sd">        Infers most `MazeTokenizerModular` parameters from a full sequence of tokens.</span>
</span><span id="MazeTokenizerModular.from_tokens-2113"><a href="#MazeTokenizerModular.from_tokens-2113"><span class="linenos">2113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.from_tokens-2114"><a href="#MazeTokenizerModular.from_tokens-2114"><span class="linenos">2114</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.from_tokens-2115"><a href="#MazeTokenizerModular.from_tokens-2115"><span class="linenos">2115</span></a>            <span class="s2">&quot;Recovering tokenizer objects from MazeTokenizerModular-produced strings is not supported&quot;</span>
</span><span id="MazeTokenizerModular.from_tokens-2116"><a href="#MazeTokenizerModular.from_tokens-2116"><span class="linenos">2116</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Infers most <code><a href="#MazeTokenizerModular">MazeTokenizerModular</a></code> parameters from a full sequence of tokens.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.token_arr" class="classattr">
                                        <input id="MazeTokenizerModular.token_arr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">token_arr</span><span class="annotation">: list[str] | None</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.token_arr-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2117-L2120" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.token_arr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.token_arr-2118"><a href="#MazeTokenizerModular.token_arr-2118"><span class="linenos">2118</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.token_arr-2119"><a href="#MazeTokenizerModular.token_arr-2119"><span class="linenos">2119</span></a>    <span class="k">def</span> <span class="nf">token_arr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.token_arr-2120"><a href="#MazeTokenizerModular.token_arr-2120"><span class="linenos">2120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from index to token&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.token_arr-2121"><a href="#MazeTokenizerModular.token_arr-2121"><span class="linenos">2121</span></a>        <span class="k">return</span> <span class="n">VOCAB_LIST</span>
</span></pre></div>


            <div class="docstring"><p>map from index to token</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.tokenizer_map" class="classattr">
                                        <input id="MazeTokenizerModular.tokenizer_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tokenizer_map</span><span class="annotation">: dict[str, int]</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.tokenizer_map-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2122-L2125" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.tokenizer_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.tokenizer_map-2123"><a href="#MazeTokenizerModular.tokenizer_map-2123"><span class="linenos">2123</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.tokenizer_map-2124"><a href="#MazeTokenizerModular.tokenizer_map-2124"><span class="linenos">2124</span></a>    <span class="k">def</span> <span class="nf">tokenizer_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.tokenizer_map-2125"><a href="#MazeTokenizerModular.tokenizer_map-2125"><span class="linenos">2125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;map from token to index&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.tokenizer_map-2126"><a href="#MazeTokenizerModular.tokenizer_map-2126"><span class="linenos">2126</span></a>        <span class="k">return</span> <span class="n">VOCAB_TOKEN_TO_INDEX</span>
</span></pre></div>


            <div class="docstring"><p>map from token to index</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.vocab_size" class="classattr">
                                        <input id="MazeTokenizerModular.vocab_size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">vocab_size</span><span class="annotation">: int</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.vocab_size-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2127-L2130" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.vocab_size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.vocab_size-2128"><a href="#MazeTokenizerModular.vocab_size-2128"><span class="linenos">2128</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.vocab_size-2129"><a href="#MazeTokenizerModular.vocab_size-2129"><span class="linenos">2129</span></a>    <span class="k">def</span> <span class="nf">vocab_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.vocab_size-2130"><a href="#MazeTokenizerModular.vocab_size-2130"><span class="linenos">2130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of tokens in the static vocab&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.vocab_size-2131"><a href="#MazeTokenizerModular.vocab_size-2131"><span class="linenos">2131</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">VOCAB_LIST</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Number of tokens in the static vocab</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.n_tokens" class="classattr">
                                        <input id="MazeTokenizerModular.n_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n_tokens</span><span class="annotation">: int</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.n_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2132-L2136" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.n_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.n_tokens-2133"><a href="#MazeTokenizerModular.n_tokens-2133"><span class="linenos">2133</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.n_tokens-2134"><a href="#MazeTokenizerModular.n_tokens-2134"><span class="linenos">2134</span></a>    <span class="k">def</span> <span class="nf">n_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.n_tokens-2135"><a href="#MazeTokenizerModular.n_tokens-2135"><span class="linenos">2135</span></a>        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.n_tokens-2136"><a href="#MazeTokenizerModular.n_tokens-2136"><span class="linenos">2136</span></a>            <span class="s2">&quot;`MazeTokenizerModular.n_tokens` has been removed. Use `len(maze_dataset.VOCAB_LIST)` instead.&quot;</span>
</span><span id="MazeTokenizerModular.n_tokens-2137"><a href="#MazeTokenizerModular.n_tokens-2137"><span class="linenos">2137</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.padding_token_index" class="classattr">
                                        <input id="MazeTokenizerModular.padding_token_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">padding_token_index</span><span class="annotation">: int</span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.padding_token_index-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2138-L2140" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.padding_token_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.padding_token_index-2139"><a href="#MazeTokenizerModular.padding_token_index-2139"><span class="linenos">2139</span></a>    <span class="nd">@property</span>
</span><span id="MazeTokenizerModular.padding_token_index-2140"><a href="#MazeTokenizerModular.padding_token_index-2140"><span class="linenos">2140</span></a>    <span class="k">def</span> <span class="nf">padding_token_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.padding_token_index-2141"><a href="#MazeTokenizerModular.padding_token_index-2141"><span class="linenos">2141</span></a>        <span class="k">return</span> <span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">[</span><span class="n">VOCAB</span><span class="o">.</span><span class="n">PADDING</span><span class="p">]</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.to_tokens" class="classattr">
                                        <input id="MazeTokenizerModular.to_tokens-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_tokens</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">maze</span><span class="p">:</span> <span class="n"><a href="../../maze_dataset.html#LatticeMaze">maze_dataset.LatticeMaze</a></span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.to_tokens-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2145-L2150" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.to_tokens"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.to_tokens-2146"><a href="#MazeTokenizerModular.to_tokens-2146"><span class="linenos">2146</span></a>    <span class="k">def</span> <span class="nf">to_tokens</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.to_tokens-2147"><a href="#MazeTokenizerModular.to_tokens-2147"><span class="linenos">2147</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.to_tokens-2148"><a href="#MazeTokenizerModular.to_tokens-2148"><span class="linenos">2148</span></a>        <span class="n">maze</span><span class="p">:</span> <span class="n">LatticeMaze</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.to_tokens-2149"><a href="#MazeTokenizerModular.to_tokens-2149"><span class="linenos">2149</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.to_tokens-2150"><a href="#MazeTokenizerModular.to_tokens-2150"><span class="linenos">2150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts maze into a list of tokens.&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.to_tokens-2151"><a href="#MazeTokenizerModular.to_tokens-2151"><span class="linenos">2151</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts maze into a list of tokens.</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.coords_to_strings" class="classattr">
                                        <input id="MazeTokenizerModular.coords_to_strings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coords_to_strings</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int8</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;row_col&#39;</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.coords_to_strings-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2152-L2157" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.coords_to_strings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.coords_to_strings-2153"><a href="#MazeTokenizerModular.coords_to_strings-2153"><span class="linenos">2153</span></a>    <span class="k">def</span> <span class="nf">coords_to_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoordTup</span> <span class="o">|</span> <span class="n">Coord</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.coords_to_strings-2154"><a href="#MazeTokenizerModular.coords_to_strings-2154"><span class="linenos">2154</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.coords_to_strings-2155"><a href="#MazeTokenizerModular.coords_to_strings-2155"><span class="linenos">2155</span></a>            <span class="n">flatten</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.coords_to_strings-2156"><a href="#MazeTokenizerModular.coords_to_strings-2156"><span class="linenos">2156</span></a>                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt_sequencer</span><span class="o">.</span><span class="n">coord_tokenizer</span><span class="o">.</span><span class="n">to_tokens</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>
</span><span id="MazeTokenizerModular.coords_to_strings-2157"><a href="#MazeTokenizerModular.coords_to_strings-2157"><span class="linenos">2157</span></a>            <span class="p">)</span>
</span><span id="MazeTokenizerModular.coords_to_strings-2158"><a href="#MazeTokenizerModular.coords_to_strings-2158"><span class="linenos">2158</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.strings_to_coords" class="classattr">
                                        <input id="MazeTokenizerModular.strings_to_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">strings_to_coords</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">when_noncoord</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;except&#39;</span><span class="p">,</span> <span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;skip&#39;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.strings_to_coords-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2159-L2168" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.strings_to_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.strings_to_coords-2160"><a href="#MazeTokenizerModular.strings_to_coords-2160"><span class="linenos">2160</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2161"><a href="#MazeTokenizerModular.strings_to_coords-2161"><span class="linenos">2161</span></a>    <span class="k">def</span> <span class="nf">strings_to_coords</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2162"><a href="#MazeTokenizerModular.strings_to_coords-2162"><span class="linenos">2162</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2163"><a href="#MazeTokenizerModular.strings_to_coords-2163"><span class="linenos">2163</span></a>        <span class="n">when_noncoord</span><span class="p">:</span> <span class="n">WhenMissing</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2164"><a href="#MazeTokenizerModular.strings_to_coords-2164"><span class="linenos">2164</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">CoordTup</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2165"><a href="#MazeTokenizerModular.strings_to_coords-2165"><span class="linenos">2165</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2166"><a href="#MazeTokenizerModular.strings_to_coords-2166"><span class="linenos">2166</span></a>            <span class="s2">&quot;`MazeTokenizerModular.strings_to_coords` only supports legacy UT strings.&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2167"><a href="#MazeTokenizerModular.strings_to_coords-2167"><span class="linenos">2167</span></a>            <span class="n">TokenizerPendingDeprecationWarning</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2168"><a href="#MazeTokenizerModular.strings_to_coords-2168"><span class="linenos">2168</span></a>        <span class="p">)</span>
</span><span id="MazeTokenizerModular.strings_to_coords-2169"><a href="#MazeTokenizerModular.strings_to_coords-2169"><span class="linenos">2169</span></a>        <span class="k">return</span> <span class="n">strings_to_coords</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">when_noncoord</span><span class="o">=</span><span class="n">when_noncoord</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MazeTokenizerModular.encode" class="classattr">
                                        <input id="MazeTokenizerModular.encode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">encode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.encode-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2170-L2181" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.encode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.encode-2171"><a href="#MazeTokenizerModular.encode-2171"><span class="linenos">2171</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular.encode-2172"><a href="#MazeTokenizerModular.encode-2172"><span class="linenos">2172</span></a>    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.encode-2173"><a href="#MazeTokenizerModular.encode-2173"><span class="linenos">2173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;encode a string or list of strings into a list of tokens&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.encode-2174"><a href="#MazeTokenizerModular.encode-2174"><span class="linenos">2174</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.encode-2175"><a href="#MazeTokenizerModular.encode-2175"><span class="linenos">2175</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.encode-2176"><a href="#MazeTokenizerModular.encode-2176"><span class="linenos">2176</span></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.encode-2177"><a href="#MazeTokenizerModular.encode-2177"><span class="linenos">2177</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">VOCAB_TOKEN_TO_INDEX</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span>
</span><span id="MazeTokenizerModular.encode-2178"><a href="#MazeTokenizerModular.encode-2178"><span class="linenos">2178</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.encode-2179"><a href="#MazeTokenizerModular.encode-2179"><span class="linenos">2179</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.encode-2180"><a href="#MazeTokenizerModular.encode-2180"><span class="linenos">2180</span></a>                <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.encode-2181"><a href="#MazeTokenizerModular.encode-2181"><span class="linenos">2181</span></a>                <span class="sa">f</span><span class="s2">&quot;in `VOCAB`.&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.encode-2182"><a href="#MazeTokenizerModular.encode-2182"><span class="linenos">2182</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span></pre></div>


            <div class="docstring"><p>encode a string or list of strings into a list of tokens</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.decode" class="classattr">
                                        <input id="MazeTokenizerModular.decode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">decode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">token_ids</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>, </span><span class="param"><span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.decode-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2183-L2195" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.decode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.decode-2184"><a href="#MazeTokenizerModular.decode-2184"><span class="linenos">2184</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MazeTokenizerModular.decode-2185"><a href="#MazeTokenizerModular.decode-2185"><span class="linenos">2185</span></a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.decode-2186"><a href="#MazeTokenizerModular.decode-2186"><span class="linenos">2186</span></a>        <span class="n">token_ids</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">joined_tokens</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MazeTokenizerModular.decode-2187"><a href="#MazeTokenizerModular.decode-2187"><span class="linenos">2187</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.decode-2188"><a href="#MazeTokenizerModular.decode-2188"><span class="linenos">2188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;decode a list of tokens into a string or list of strings&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.decode-2189"><a href="#MazeTokenizerModular.decode-2189"><span class="linenos">2189</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.decode-2190"><a href="#MazeTokenizerModular.decode-2190"><span class="linenos">2190</span></a>            <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">VOCAB_LIST</span><span class="p">[</span><span class="n">token_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">token_id</span> <span class="ow">in</span> <span class="n">token_ids</span><span class="p">]</span>
</span><span id="MazeTokenizerModular.decode-2191"><a href="#MazeTokenizerModular.decode-2191"><span class="linenos">2191</span></a>        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.decode-2192"><a href="#MazeTokenizerModular.decode-2192"><span class="linenos">2192</span></a>            <span class="k">raise</span> <span class="n">TokenError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token index &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39; not found in `VOCAB`.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizerModular.decode-2193"><a href="#MazeTokenizerModular.decode-2193"><span class="linenos">2193</span></a>        <span class="k">if</span> <span class="n">joined_tokens</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.decode-2194"><a href="#MazeTokenizerModular.decode-2194"><span class="linenos">2194</span></a>            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.decode-2195"><a href="#MazeTokenizerModular.decode-2195"><span class="linenos">2195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.decode-2196"><a href="#MazeTokenizerModular.decode-2196"><span class="linenos">2196</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>decode a list of tokens into a string or list of strings</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.serialize" class="classattr">
                                        <input id="MazeTokenizerModular.serialize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">serialize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.serialize-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L659-L715" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.serialize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.serialize-660"><a href="#MazeTokenizerModular.serialize-660"><span class="linenos">660</span></a>        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.serialize-661"><a href="#MazeTokenizerModular.serialize-661"><span class="linenos">661</span></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MazeTokenizerModular.serialize-662"><a href="#MazeTokenizerModular.serialize-662"><span class="linenos">662</span></a>                <span class="s2">&quot;__format__&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(SerializableDataclass)&quot;</span>
</span><span id="MazeTokenizerModular.serialize-663"><a href="#MazeTokenizerModular.serialize-663"><span class="linenos">663</span></a>            <span class="p">}</span>
</span><span id="MazeTokenizerModular.serialize-664"><a href="#MazeTokenizerModular.serialize-664"><span class="linenos">664</span></a>            <span class="c1"># for each field in the class</span>
</span><span id="MazeTokenizerModular.serialize-665"><a href="#MazeTokenizerModular.serialize-665"><span class="linenos">665</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="MazeTokenizerModular.serialize-666"><a href="#MazeTokenizerModular.serialize-666"><span class="linenos">666</span></a>                <span class="c1"># need it to be our special SerializableField</span>
</span><span id="MazeTokenizerModular.serialize-667"><a href="#MazeTokenizerModular.serialize-667"><span class="linenos">667</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.serialize-668"><a href="#MazeTokenizerModular.serialize-668"><span class="linenos">668</span></a>                    <span class="k">raise</span> <span class="n">NotSerializableFieldException</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.serialize-669"><a href="#MazeTokenizerModular.serialize-669"><span class="linenos">669</span></a>                        <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a `SerializableField`, &quot;</span>
</span><span id="MazeTokenizerModular.serialize-670"><a href="#MazeTokenizerModular.serialize-670"><span class="linenos">670</span></a>                        <span class="sa">f</span><span class="s2">&quot;but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="MazeTokenizerModular.serialize-671"><a href="#MazeTokenizerModular.serialize-671"><span class="linenos">671</span></a>                        <span class="s2">&quot;this state should be inaccessible, please report this bug!&quot;</span>
</span><span id="MazeTokenizerModular.serialize-672"><a href="#MazeTokenizerModular.serialize-672"><span class="linenos">672</span></a>                    <span class="p">)</span>
</span><span id="MazeTokenizerModular.serialize-673"><a href="#MazeTokenizerModular.serialize-673"><span class="linenos">673</span></a>
</span><span id="MazeTokenizerModular.serialize-674"><a href="#MazeTokenizerModular.serialize-674"><span class="linenos">674</span></a>                <span class="c1"># try to save it</span>
</span><span id="MazeTokenizerModular.serialize-675"><a href="#MazeTokenizerModular.serialize-675"><span class="linenos">675</span></a>                <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">serialize</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.serialize-676"><a href="#MazeTokenizerModular.serialize-676"><span class="linenos">676</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.serialize-677"><a href="#MazeTokenizerModular.serialize-677"><span class="linenos">677</span></a>                        <span class="c1"># get the val</span>
</span><span id="MazeTokenizerModular.serialize-678"><a href="#MazeTokenizerModular.serialize-678"><span class="linenos">678</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.serialize-679"><a href="#MazeTokenizerModular.serialize-679"><span class="linenos">679</span></a>                        <span class="c1"># if it is a serializable dataclass, serialize it</span>
</span><span id="MazeTokenizerModular.serialize-680"><a href="#MazeTokenizerModular.serialize-680"><span class="linenos">680</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SerializableDataclass</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.serialize-681"><a href="#MazeTokenizerModular.serialize-681"><span class="linenos">681</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.serialize-682"><a href="#MazeTokenizerModular.serialize-682"><span class="linenos">682</span></a>                        <span class="c1"># if the value has a serialization function, use that</span>
</span><span id="MazeTokenizerModular.serialize-683"><a href="#MazeTokenizerModular.serialize-683"><span class="linenos">683</span></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;serialize&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.serialize-684"><a href="#MazeTokenizerModular.serialize-684"><span class="linenos">684</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.serialize-685"><a href="#MazeTokenizerModular.serialize-685"><span class="linenos">685</span></a>                        <span class="c1"># if the field has a serialization function, use that</span>
</span><span id="MazeTokenizerModular.serialize-686"><a href="#MazeTokenizerModular.serialize-686"><span class="linenos">686</span></a>                        <span class="c1"># it would be nice to be able to override a class&#39;s `.serialize()`, but that could lead to some inconsistencies!</span>
</span><span id="MazeTokenizerModular.serialize-687"><a href="#MazeTokenizerModular.serialize-687"><span class="linenos">687</span></a>                        <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.serialize-688"><a href="#MazeTokenizerModular.serialize-688"><span class="linenos">688</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">serialization_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.serialize-689"><a href="#MazeTokenizerModular.serialize-689"><span class="linenos">689</span></a>
</span><span id="MazeTokenizerModular.serialize-690"><a href="#MazeTokenizerModular.serialize-690"><span class="linenos">690</span></a>                        <span class="c1"># store the value in the result</span>
</span><span id="MazeTokenizerModular.serialize-691"><a href="#MazeTokenizerModular.serialize-691"><span class="linenos">691</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeTokenizerModular.serialize-692"><a href="#MazeTokenizerModular.serialize-692"><span class="linenos">692</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.serialize-693"><a href="#MazeTokenizerModular.serialize-693"><span class="linenos">693</span></a>                        <span class="k">raise</span> <span class="n">FieldSerializationError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.serialize-694"><a href="#MazeTokenizerModular.serialize-694"><span class="linenos">694</span></a>                            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.serialize-695"><a href="#MazeTokenizerModular.serialize-695"><span class="linenos">695</span></a>                                <span class="p">[</span>
</span><span id="MazeTokenizerModular.serialize-696"><a href="#MazeTokenizerModular.serialize-696"><span class="linenos">696</span></a>                                    <span class="sa">f</span><span class="s2">&quot;Error serializing field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.serialize-697"><a href="#MazeTokenizerModular.serialize-697"><span class="linenos">697</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.serialize-698"><a href="#MazeTokenizerModular.serialize-698"><span class="linenos">698</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.serialize-699"><a href="#MazeTokenizerModular.serialize-699"><span class="linenos">699</span></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.serialize-700"><a href="#MazeTokenizerModular.serialize-700"><span class="linenos">700</span></a>                                <span class="p">]</span>
</span><span id="MazeTokenizerModular.serialize-701"><a href="#MazeTokenizerModular.serialize-701"><span class="linenos">701</span></a>                            <span class="p">)</span>
</span><span id="MazeTokenizerModular.serialize-702"><a href="#MazeTokenizerModular.serialize-702"><span class="linenos">702</span></a>                        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MazeTokenizerModular.serialize-703"><a href="#MazeTokenizerModular.serialize-703"><span class="linenos">703</span></a>
</span><span id="MazeTokenizerModular.serialize-704"><a href="#MazeTokenizerModular.serialize-704"><span class="linenos">704</span></a>            <span class="c1"># store each property if we can get it</span>
</span><span id="MazeTokenizerModular.serialize-705"><a href="#MazeTokenizerModular.serialize-705"><span class="linenos">705</span></a>            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.serialize-706"><a href="#MazeTokenizerModular.serialize-706"><span class="linenos">706</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.serialize-707"><a href="#MazeTokenizerModular.serialize-707"><span class="linenos">707</span></a>                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.serialize-708"><a href="#MazeTokenizerModular.serialize-708"><span class="linenos">708</span></a>                    <span class="n">result</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeTokenizerModular.serialize-709"><a href="#MazeTokenizerModular.serialize-709"><span class="linenos">709</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.serialize-710"><a href="#MazeTokenizerModular.serialize-710"><span class="linenos">710</span></a>                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.serialize-711"><a href="#MazeTokenizerModular.serialize-711"><span class="linenos">711</span></a>                        <span class="sa">f</span><span class="s2">&quot;Cannot serialize property &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.serialize-712"><a href="#MazeTokenizerModular.serialize-712"><span class="linenos">712</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but it is in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_properties_to_serialize</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.serialize-713"><a href="#MazeTokenizerModular.serialize-713"><span class="linenos">713</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.serialize-714"><a href="#MazeTokenizerModular.serialize-714"><span class="linenos">714</span></a>                    <span class="p">)</span>
</span><span id="MazeTokenizerModular.serialize-715"><a href="#MazeTokenizerModular.serialize-715"><span class="linenos">715</span></a>
</span><span id="MazeTokenizerModular.serialize-716"><a href="#MazeTokenizerModular.serialize-716"><span class="linenos">716</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>returns the class as a dict, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.load" class="classattr">
                                        <input id="MazeTokenizerModular.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">~</span><span class="n">T</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Type</span><span class="p">[</span><span class="o">~</span><span class="n">T</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.load-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L722-L786" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.load-723"><a href="#MazeTokenizerModular.load-723"><span class="linenos">723</span></a>        <span class="nd">@classmethod</span>  <span class="c1"># type: ignore[misc]</span>
</span><span id="MazeTokenizerModular.load-724"><a href="#MazeTokenizerModular.load-724"><span class="linenos">724</span></a>        <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
</span><span id="MazeTokenizerModular.load-725"><a href="#MazeTokenizerModular.load-725"><span class="linenos">725</span></a>            <span class="c1"># HACK: this is kind of ugly, but it fixes a lot of issues for when we do recursive loading with ZANJ</span>
</span><span id="MazeTokenizerModular.load-726"><a href="#MazeTokenizerModular.load-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.load-727"><a href="#MazeTokenizerModular.load-727"><span class="linenos">727</span></a>                <span class="k">return</span> <span class="n">data</span>
</span><span id="MazeTokenizerModular.load-728"><a href="#MazeTokenizerModular.load-728"><span class="linenos">728</span></a>
</span><span id="MazeTokenizerModular.load-729"><a href="#MazeTokenizerModular.load-729"><span class="linenos">729</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.load-730"><a href="#MazeTokenizerModular.load-730"><span class="linenos">730</span></a>                <span class="n">data</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Mapping</span>
</span><span id="MazeTokenizerModular.load-731"><a href="#MazeTokenizerModular.load-731"><span class="linenos">731</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;When loading </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="si">= }</span><span class="s2"> expected a Mapping, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">data</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.load-732"><a href="#MazeTokenizerModular.load-732"><span class="linenos">732</span></a>
</span><span id="MazeTokenizerModular.load-733"><a href="#MazeTokenizerModular.load-733"><span class="linenos">733</span></a>            <span class="n">cls_type_hints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cls_type_hints</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-734"><a href="#MazeTokenizerModular.load-734"><span class="linenos">734</span></a>
</span><span id="MazeTokenizerModular.load-735"><a href="#MazeTokenizerModular.load-735"><span class="linenos">735</span></a>            <span class="c1"># initialize dict for keeping what we will pass to the constructor</span>
</span><span id="MazeTokenizerModular.load-736"><a href="#MazeTokenizerModular.load-736"><span class="linenos">736</span></a>            <span class="n">ctor_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.load-737"><a href="#MazeTokenizerModular.load-737"><span class="linenos">737</span></a>
</span><span id="MazeTokenizerModular.load-738"><a href="#MazeTokenizerModular.load-738"><span class="linenos">738</span></a>            <span class="c1"># iterate over the fields of the class</span>
</span><span id="MazeTokenizerModular.load-739"><a href="#MazeTokenizerModular.load-739"><span class="linenos">739</span></a>            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.load-740"><a href="#MazeTokenizerModular.load-740"><span class="linenos">740</span></a>                <span class="c1"># check if the field is a SerializableField</span>
</span><span id="MazeTokenizerModular.load-741"><a href="#MazeTokenizerModular.load-741"><span class="linenos">741</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.load-742"><a href="#MazeTokenizerModular.load-742"><span class="linenos">742</span></a>                    <span class="n">field</span><span class="p">,</span> <span class="n">SerializableField</span>
</span><span id="MazeTokenizerModular.load-743"><a href="#MazeTokenizerModular.load-743"><span class="linenos">743</span></a>                <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; on class </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not a SerializableField, but a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="si">}</span><span class="s2">. this state should be inaccessible, please report this bug!</span><span class="se">\n</span><span class="s2">https://github.com/mivanit/muutils/issues/new&quot;</span>
</span><span id="MazeTokenizerModular.load-744"><a href="#MazeTokenizerModular.load-744"><span class="linenos">744</span></a>
</span><span id="MazeTokenizerModular.load-745"><a href="#MazeTokenizerModular.load-745"><span class="linenos">745</span></a>                <span class="c1"># check if the field is in the data and if it should be initialized</span>
</span><span id="MazeTokenizerModular.load-746"><a href="#MazeTokenizerModular.load-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.load-747"><a href="#MazeTokenizerModular.load-747"><span class="linenos">747</span></a>                    <span class="c1"># get the value, we will be processing it</span>
</span><span id="MazeTokenizerModular.load-748"><a href="#MazeTokenizerModular.load-748"><span class="linenos">748</span></a>                    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="MazeTokenizerModular.load-749"><a href="#MazeTokenizerModular.load-749"><span class="linenos">749</span></a>
</span><span id="MazeTokenizerModular.load-750"><a href="#MazeTokenizerModular.load-750"><span class="linenos">750</span></a>                    <span class="c1"># get the type hint for the field</span>
</span><span id="MazeTokenizerModular.load-751"><a href="#MazeTokenizerModular.load-751"><span class="linenos">751</span></a>                    <span class="n">field_type_hint</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">cls_type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-752"><a href="#MazeTokenizerModular.load-752"><span class="linenos">752</span></a>
</span><span id="MazeTokenizerModular.load-753"><a href="#MazeTokenizerModular.load-753"><span class="linenos">753</span></a>                    <span class="c1"># we rely on the init of `SerializableField` to check that only one of `loading_fn` and `deserialize_fn` is set</span>
</span><span id="MazeTokenizerModular.load-754"><a href="#MazeTokenizerModular.load-754"><span class="linenos">754</span></a>                    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.load-755"><a href="#MazeTokenizerModular.load-755"><span class="linenos">755</span></a>                        <span class="c1"># if it has a deserialization function, use that</span>
</span><span id="MazeTokenizerModular.load-756"><a href="#MazeTokenizerModular.load-756"><span class="linenos">756</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">deserialize_fn</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-757"><a href="#MazeTokenizerModular.load-757"><span class="linenos">757</span></a>                    <span class="k">elif</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.load-758"><a href="#MazeTokenizerModular.load-758"><span class="linenos">758</span></a>                        <span class="c1"># if it has a loading function, use that</span>
</span><span id="MazeTokenizerModular.load-759"><a href="#MazeTokenizerModular.load-759"><span class="linenos">759</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">loading_fn</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-760"><a href="#MazeTokenizerModular.load-760"><span class="linenos">760</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="MazeTokenizerModular.load-761"><a href="#MazeTokenizerModular.load-761"><span class="linenos">761</span></a>                        <span class="n">field_type_hint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="MazeTokenizerModular.load-762"><a href="#MazeTokenizerModular.load-762"><span class="linenos">762</span></a>                        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field_type_hint</span><span class="p">,</span> <span class="s2">&quot;load&quot;</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-763"><a href="#MazeTokenizerModular.load-763"><span class="linenos">763</span></a>                        <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-764"><a href="#MazeTokenizerModular.load-764"><span class="linenos">764</span></a>                    <span class="p">):</span>
</span><span id="MazeTokenizerModular.load-765"><a href="#MazeTokenizerModular.load-765"><span class="linenos">765</span></a>                        <span class="c1"># if no loading function but has a type hint with a load method, use that</span>
</span><span id="MazeTokenizerModular.load-766"><a href="#MazeTokenizerModular.load-766"><span class="linenos">766</span></a>                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="MazeTokenizerModular.load-767"><a href="#MazeTokenizerModular.load-767"><span class="linenos">767</span></a>                            <span class="n">value</span> <span class="o">=</span> <span class="n">field_type_hint</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-768"><a href="#MazeTokenizerModular.load-768"><span class="linenos">768</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.load-769"><a href="#MazeTokenizerModular.load-769"><span class="linenos">769</span></a>                            <span class="k">raise</span> <span class="n">FieldLoadingError</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.load-770"><a href="#MazeTokenizerModular.load-770"><span class="linenos">770</span></a>                                <span class="sa">f</span><span class="s2">&quot;Cannot load value into </span><span class="si">{</span><span class="n">field_type_hint</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="si">= }</span><span class="s2"> to be a dict</span><span class="se">\n</span><span class="si">{</span><span class="n">value</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span>
</span><span id="MazeTokenizerModular.load-771"><a href="#MazeTokenizerModular.load-771"><span class="linenos">771</span></a>                            <span class="p">)</span>
</span><span id="MazeTokenizerModular.load-772"><a href="#MazeTokenizerModular.load-772"><span class="linenos">772</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.load-773"><a href="#MazeTokenizerModular.load-773"><span class="linenos">773</span></a>                        <span class="c1"># assume no loading needs to happen, keep `value` as-is</span>
</span><span id="MazeTokenizerModular.load-774"><a href="#MazeTokenizerModular.load-774"><span class="linenos">774</span></a>                        <span class="k">pass</span>
</span><span id="MazeTokenizerModular.load-775"><a href="#MazeTokenizerModular.load-775"><span class="linenos">775</span></a>
</span><span id="MazeTokenizerModular.load-776"><a href="#MazeTokenizerModular.load-776"><span class="linenos">776</span></a>                    <span class="c1"># store the value in the constructor kwargs</span>
</span><span id="MazeTokenizerModular.load-777"><a href="#MazeTokenizerModular.load-777"><span class="linenos">777</span></a>                    <span class="n">ctor_kwargs</span><span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="MazeTokenizerModular.load-778"><a href="#MazeTokenizerModular.load-778"><span class="linenos">778</span></a>
</span><span id="MazeTokenizerModular.load-779"><a href="#MazeTokenizerModular.load-779"><span class="linenos">779</span></a>            <span class="c1"># create a new instance of the class with the constructor kwargs</span>
</span><span id="MazeTokenizerModular.load-780"><a href="#MazeTokenizerModular.load-780"><span class="linenos">780</span></a>            <span class="n">output</span><span class="p">:</span> <span class="bp">cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">ctor_kwargs</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-781"><a href="#MazeTokenizerModular.load-781"><span class="linenos">781</span></a>
</span><span id="MazeTokenizerModular.load-782"><a href="#MazeTokenizerModular.load-782"><span class="linenos">782</span></a>            <span class="c1"># validate the types of the fields if needed</span>
</span><span id="MazeTokenizerModular.load-783"><a href="#MazeTokenizerModular.load-783"><span class="linenos">783</span></a>            <span class="k">if</span> <span class="n">on_typecheck_mismatch</span> <span class="o">!=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.load-784"><a href="#MazeTokenizerModular.load-784"><span class="linenos">784</span></a>                <span class="n">output</span><span class="o">.</span><span class="n">validate_fields_types</span><span class="p">(</span><span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span><span class="p">)</span>
</span><span id="MazeTokenizerModular.load-785"><a href="#MazeTokenizerModular.load-785"><span class="linenos">785</span></a>
</span><span id="MazeTokenizerModular.load-786"><a href="#MazeTokenizerModular.load-786"><span class="linenos">786</span></a>            <span class="c1"># return the new instance</span>
</span><span id="MazeTokenizerModular.load-787"><a href="#MazeTokenizerModular.load-787"><span class="linenos">787</span></a>            <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>takes in an appropriately structured dict and returns an instance of the class, implemented by using <code>@serializable_dataclass</code> decorator</p>
</div>


                            </div>
                            <div id="MazeTokenizerModular.validate_fields_types" class="classattr">
                                        <input id="MazeTokenizerModular.validate_fields_types-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_fields_types</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">json_serialize</span><span class="o">.</span><span class="n">serializable_dataclass</span><span class="o">.</span><span class="n">SerializableDataclass</span>,</span><span class="param">	<span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">muutils</span><span class="o">.</span><span class="n">errormode</span><span class="o">.</span><span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">ErrorMode</span><span class="o">.</span><span class="n">Except</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="MazeTokenizerModular.validate_fields_types-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L270-L279" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#MazeTokenizerModular.validate_fields_types"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MazeTokenizerModular.validate_fields_types-271"><a href="#MazeTokenizerModular.validate_fields_types-271"><span class="linenos">271</span></a><span class="k">def</span> <span class="nf">SerializableDataclass__validate_fields_types</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.validate_fields_types-272"><a href="#MazeTokenizerModular.validate_fields_types-272"><span class="linenos">272</span></a>    <span class="bp">self</span><span class="p">:</span> <span class="n">SerializableDataclass</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.validate_fields_types-273"><a href="#MazeTokenizerModular.validate_fields_types-273"><span class="linenos">273</span></a>    <span class="n">on_typecheck_error</span><span class="p">:</span> <span class="n">ErrorMode</span> <span class="o">=</span> <span class="n">_DEFAULT_ON_TYPECHECK_ERROR</span><span class="p">,</span>
</span><span id="MazeTokenizerModular.validate_fields_types-274"><a href="#MazeTokenizerModular.validate_fields_types-274"><span class="linenos">274</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="MazeTokenizerModular.validate_fields_types-275"><a href="#MazeTokenizerModular.validate_fields_types-275"><span class="linenos">275</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate the types of all the fields on a `SerializableDataclass`. calls `SerializableDataclass__validate_field_type` for each field&quot;&quot;&quot;</span>
</span><span id="MazeTokenizerModular.validate_fields_types-276"><a href="#MazeTokenizerModular.validate_fields_types-276"><span class="linenos">276</span></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.validate_fields_types-277"><a href="#MazeTokenizerModular.validate_fields_types-277"><span class="linenos">277</span></a>        <span class="n">SerializableDataclass__validate_fields_types__dict</span><span class="p">(</span>
</span><span id="MazeTokenizerModular.validate_fields_types-278"><a href="#MazeTokenizerModular.validate_fields_types-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">on_typecheck_error</span><span class="o">=</span><span class="n">on_typecheck_error</span>
</span><span id="MazeTokenizerModular.validate_fields_types-279"><a href="#MazeTokenizerModular.validate_fields_types-279"><span class="linenos">279</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="MazeTokenizerModular.validate_fields_types-280"><a href="#MazeTokenizerModular.validate_fields_types-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>validate the types of all the fields on a <code>SerializableDataclass</code>. calls <code>SerializableDataclass__validate_field_type</code> for each field</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>muutils.json_serialize.serializable_dataclass.SerializableDataclass</dt>
                                <dd id="MazeTokenizerModular.validate_field_type" class="function">validate_field_type</dd>
                <dd id="MazeTokenizerModular.diff" class="function">diff</dd>
                <dd id="MazeTokenizerModular.update_from_nested_dict" class="function">update_from_nested_dict</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="set_tokenizer_hashes_path">
                            <input id="set_tokenizer_hashes_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_tokenizer_hashes_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span></span><span class="return-annotation">):</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="set_tokenizer_hashes_path-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2204-L2228" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#set_tokenizer_hashes_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_tokenizer_hashes_path-2205"><a href="#set_tokenizer_hashes_path-2205"><span class="linenos">2205</span></a><span class="k">def</span> <span class="nf">set_tokenizer_hashes_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="set_tokenizer_hashes_path-2206"><a href="#set_tokenizer_hashes_path-2206"><span class="linenos">2206</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;set path to tokenizer hashes, and reload the hashes if needed</span>
</span><span id="set_tokenizer_hashes_path-2207"><a href="#set_tokenizer_hashes_path-2207"><span class="linenos">2207</span></a>
</span><span id="set_tokenizer_hashes_path-2208"><a href="#set_tokenizer_hashes_path-2208"><span class="linenos">2208</span></a><span class="sd">    the hashes are expected to be stored in and read from `_TOKENIZER_HASHES_PATH`,</span>
</span><span id="set_tokenizer_hashes_path-2209"><a href="#set_tokenizer_hashes_path-2209"><span class="linenos">2209</span></a><span class="sd">    which by default is `Path(__file__).parent / &quot;MazeTokenizerModular_hashes.npz&quot;` or in this file&#39;s directory.</span>
</span><span id="set_tokenizer_hashes_path-2210"><a href="#set_tokenizer_hashes_path-2210"><span class="linenos">2210</span></a>
</span><span id="set_tokenizer_hashes_path-2211"><a href="#set_tokenizer_hashes_path-2211"><span class="linenos">2211</span></a><span class="sd">    However, this might not always work, so we provide a way to change this.</span>
</span><span id="set_tokenizer_hashes_path-2212"><a href="#set_tokenizer_hashes_path-2212"><span class="linenos">2212</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="set_tokenizer_hashes_path-2213"><a href="#set_tokenizer_hashes_path-2213"><span class="linenos">2213</span></a>    <span class="k">global</span> <span class="n">_TOKENIZER_HASHES_PATH</span>
</span><span id="set_tokenizer_hashes_path-2214"><a href="#set_tokenizer_hashes_path-2214"><span class="linenos">2214</span></a>    <span class="k">global</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span><span id="set_tokenizer_hashes_path-2215"><a href="#set_tokenizer_hashes_path-2215"><span class="linenos">2215</span></a>
</span><span id="set_tokenizer_hashes_path-2216"><a href="#set_tokenizer_hashes_path-2216"><span class="linenos">2216</span></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="set_tokenizer_hashes_path-2217"><a href="#set_tokenizer_hashes_path-2217"><span class="linenos">2217</span></a>    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="set_tokenizer_hashes_path-2218"><a href="#set_tokenizer_hashes_path-2218"><span class="linenos">2218</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;MazeTokenizerModular_hashes.npz&quot;</span>
</span><span id="set_tokenizer_hashes_path-2219"><a href="#set_tokenizer_hashes_path-2219"><span class="linenos">2219</span></a>
</span><span id="set_tokenizer_hashes_path-2220"><a href="#set_tokenizer_hashes_path-2220"><span class="linenos">2220</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="set_tokenizer_hashes_path-2221"><a href="#set_tokenizer_hashes_path-2221"><span class="linenos">2221</span></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;could not find maze tokenizer hashes file at: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="set_tokenizer_hashes_path-2222"><a href="#set_tokenizer_hashes_path-2222"><span class="linenos">2222</span></a>
</span><span id="set_tokenizer_hashes_path-2223"><a href="#set_tokenizer_hashes_path-2223"><span class="linenos">2223</span></a>    <span class="k">if</span> <span class="n">_TOKENIZER_HASHES_PATH</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span> <span class="o">!=</span> <span class="n">path</span><span class="o">.</span><span class="n">absolute</span><span class="p">():</span>
</span><span id="set_tokenizer_hashes_path-2224"><a href="#set_tokenizer_hashes_path-2224"><span class="linenos">2224</span></a>        <span class="c1"># reload if they aren&#39;t equal</span>
</span><span id="set_tokenizer_hashes_path-2225"><a href="#set_tokenizer_hashes_path-2225"><span class="linenos">2225</span></a>        <span class="n">_TOKENIZER_HASHES_PATH</span> <span class="o">=</span> <span class="n">path</span>
</span><span id="set_tokenizer_hashes_path-2226"><a href="#set_tokenizer_hashes_path-2226"><span class="linenos">2226</span></a>        <span class="n">_ALL_TOKENIZER_HASHES</span> <span class="o">=</span> <span class="n">_load_tokenizer_hashes</span><span class="p">()</span>
</span><span id="set_tokenizer_hashes_path-2227"><a href="#set_tokenizer_hashes_path-2227"><span class="linenos">2227</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="set_tokenizer_hashes_path-2228"><a href="#set_tokenizer_hashes_path-2228"><span class="linenos">2228</span></a>        <span class="c1"># always set to new path</span>
</span><span id="set_tokenizer_hashes_path-2229"><a href="#set_tokenizer_hashes_path-2229"><span class="linenos">2229</span></a>        <span class="n">_TOKENIZER_HASHES_PATH</span> <span class="o">=</span> <span class="n">path</span>
</span></pre></div>


            <div class="docstring"><p>set path to tokenizer hashes, and reload the hashes if needed</p>

<p>the hashes are expected to be stored in and read from <code>_TOKENIZER_HASHES_PATH</code>,
which by default is <code>Path(__file__).parent / "MazeTokenizerModular_hashes.npz"</code> or in this file's directory.</p>

<p>However, this might not always work, so we provide a way to change this.</p>
</div>


                </section>
                <section id="get_all_tokenizer_hashes">
                            <input id="get_all_tokenizer_hashes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_all_tokenizer_hashes</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n">jaxtyping</span><span class="o">.</span><span class="n">Int64</span><span class="p">[</span><span class="n">ndarray</span><span class="p">,</span> <span class="s1">&#39;n_tokenizers&#39;</span><span class="p">]</span>:</span></span>

                <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="get_all_tokenizer_hashes-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/understanding-search/maze-dataset/blob/main/maze_dataset/tokenization/maze_tokenizer.py#L2246-L2257" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

    </div>
    <a class="headerlink" href="#get_all_tokenizer_hashes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_all_tokenizer_hashes-2247"><a href="#get_all_tokenizer_hashes-2247"><span class="linenos">2247</span></a><span class="k">def</span> <span class="nf">get_all_tokenizer_hashes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Int64</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;n_tokenizers&quot;</span><span class="p">]:</span>
</span><span id="get_all_tokenizer_hashes-2248"><a href="#get_all_tokenizer_hashes-2248"><span class="linenos">2248</span></a>    <span class="k">global</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span><span id="get_all_tokenizer_hashes-2249"><a href="#get_all_tokenizer_hashes-2249"><span class="linenos">2249</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="get_all_tokenizer_hashes-2250"><a href="#get_all_tokenizer_hashes-2250"><span class="linenos">2250</span></a>        <span class="n">got_tokenizers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_ALL_TOKENIZER_HASHES</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="get_all_tokenizer_hashes-2251"><a href="#get_all_tokenizer_hashes-2251"><span class="linenos">2251</span></a>        <span class="k">if</span> <span class="n">got_tokenizers</span><span class="p">:</span>
</span><span id="get_all_tokenizer_hashes-2252"><a href="#get_all_tokenizer_hashes-2252"><span class="linenos">2252</span></a>            <span class="k">return</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span><span id="get_all_tokenizer_hashes-2253"><a href="#get_all_tokenizer_hashes-2253"><span class="linenos">2253</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="get_all_tokenizer_hashes-2254"><a href="#get_all_tokenizer_hashes-2254"><span class="linenos">2254</span></a>            <span class="n">_ALL_TOKENIZER_HASHES</span> <span class="o">=</span> <span class="n">_load_tokenizer_hashes</span><span class="p">()</span>
</span><span id="get_all_tokenizer_hashes-2255"><a href="#get_all_tokenizer_hashes-2255"><span class="linenos">2255</span></a>    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
</span><span id="get_all_tokenizer_hashes-2256"><a href="#get_all_tokenizer_hashes-2256"><span class="linenos">2256</span></a>        <span class="n">_ALL_TOKENIZER_HASHES</span> <span class="o">=</span> <span class="n">_load_tokenizer_hashes</span><span class="p">()</span>
</span><span id="get_all_tokenizer_hashes-2257"><a href="#get_all_tokenizer_hashes-2257"><span class="linenos">2257</span></a>
</span><span id="get_all_tokenizer_hashes-2258"><a href="#get_all_tokenizer_hashes-2258"><span class="linenos">2258</span></a>    <span class="k">return</span> <span class="n">_ALL_TOKENIZER_HASHES</span>
</span></pre></div>


    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>